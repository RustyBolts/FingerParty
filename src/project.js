window.__require=function t(e,i,n){function o(c,s){if(!i[c]){if(!e[c]){var r=c.split("/");if(r=r[r.length-1],!e[r]){var l="function"==typeof __require&&__require;if(!s&&l)return l(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+c+"'")}}var h=i[c]={exports:{}};e[c][0].call(h.exports,function(t){return o(e[c][1][t]||t)},h,h.exports,t,e,i,n)}return i[c].exports}for(var a="function"==typeof __require&&__require,c=0;c<n.length;c++)o(n[c]);return o}({BargameControl:[function(t,e,i){"use strict";cc._RF.push(e,"e2105XNwNxAXIGDgEld0gJR","BargameControl");var o=null;cc.Class({extends:cc.Component,statics:{setTouchStart:function(t){o&&o.setTouchStart(t)},setTouchMove:function(t){o&&o.setTouchMove(t)},setTouchEnd:function(t){o&&o.setTouchEnd(t)},cleanAllTouch:function(){o&&o._clearTouchCallback()}},onLoad:function(){o=this,this._clearTouchCallback(),this._addTouchListener()},onDestroy:function(){this._removeTouchListener()},setTouchStart:function(t){this._touchStartCallback=t},setTouchMove:function(t){this._touchMoveCallback=t},setTouchEnd:function(t){this._touchEndCallback=t},clearTouchCallback:function(){this._clearTouchCallback()},_clearTouchCallback:function(){this._touchStartCallback=null,this._touchMoveCallback=null,this._touchEndCallback=null},_addTouchListener:function(){var t=this;this._clearTouchCallback(),this._startHandler=function(e){var i=e.touch;return t._touchStartCallback&&t._touchStartCallback(i.getLocation())},this._moveHandler=function(e){var i=e.touch;return t._touchMoveCallback&&t._touchMoveCallback(i.getDelta())},this._endHandler=function(e){var i=e.touch;return t._touchEndCallback&&t._touchEndCallback(i.getLocation())};var e=this.node;e.on(cc.Node.EventType.TOUCH_START,this._startHandler,this),e.on(cc.Node.EventType.TOUCH_MOVE,this._moveHandler,this),e.on(cc.Node.EventType.TOUCH_END,this._endHandler,this),e.on(cc.Node.EventType.TOUCH_CANCEL,this._endHandler,this)},_removeTouchListener:function(){n.off(cc.Node.EventType.TOUCH_START,this._startHandler,this),n.off(cc.Node.EventType.TOUCH_MOVE,this._moveHandler,this),n.off(cc.Node.EventType.TOUCH_END,this._endHandler,this),n.off(cc.Node.EventType.TOUCH_CANCEL,this._endHandler,this)}}),cc._RF.pop()},{}],CanvasResize:[function(t,e,i){"use strict";cc._RF.push(e,"f0150BCF7lLjqr/PB1lQcIS","CanvasResize"),cc.Class({extends:cc.Component,onLoad:function(){var t=this.node.getComponent(cc.Canvas);t.designResolution=cc.size(t.width,t.height)}}),cc._RF.pop()},{}],ChatBar:[function(t,e,i){"use strict";cc._RF.push(e,"1eda2p7WL5I+IYBDVTkPvMY","ChatBar");var n=t("Notifier");cc.Class({extends:cc.Component,properties:{Input:cc.EditBox},onLoad:function(){this._profileData=t("DataModal").getInstance().profileData},onSendClicked:function(){if(""!=this.Input.string){var t=this.Input.string.split("\n\n"),e=n.isHost()?"":this._profileData.uniqueid;t.forEach(function(t){n.notifyHost("utter",{player:e,text:t})}),this.Input.string=""}}}),cc._RF.pop()},{DataModal:"DataModal",Notifier:"Notifier"}],Client:[function(t,e,i){"use strict";cc._RF.push(e,"8ea0aihpz5Ai5PEBaFAQn6Y","Client");var n=t("Notifier");cc.Class({extends:cc.Component,onLoad:function(){n.mapClients(this)},onDestroy:function(){n.removeClient(this)},handleGetURL:function(t){t.url},handleJoinRoom:function(t){},handleInitiate:function(t){},handleInactive:function(t){},handleChairShuffle:function(){},handleAbort:function(t){t.player},_loadUI:function(t,e){cc.loader.loadRes("prefabs/board/"+t,function(i,n){if(i)return cc.error(i);var o=cc.instantiate(n);o.parent=this.node,e&&o.getComponent(t)[e.method](e.event)}.bind(this))}}),cc._RF.pop()},{Notifier:"Notifier"}],ControlMain:[function(t,e,i){"use strict";cc._RF.push(e,"93a33m1NEhJFJKVYP46lhyO","ControlMain"),cc.Class({extends:cc.Component,properties:{Target:cc.Node,Enermies:[cc.Node]},onLoad:function(){},start:function(){var t=this,e=this.node,i=this.Target,n=cc.Node.EventType;i.active=!0,this.Enermies.forEach(function(t){return t.getComponent("MagneticBall").lookAt(i)}),e.on(n.TOUCH_MOVE,function(e){var n=e.touch.getDelta();i.setPosition(i.x+n.x,i.y+n.y),t.Enermies.forEach(function(t){Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2),2)<100?t.color=cc.Color.RED:t.color=cc.Color.WHITE})})},onDestroy:function(){}}),cc._RF.pop()},{}],DataModal:[function(t,e,i){"use strict";cc._RF.push(e,"1296bDteI9PLZb5OXlnGByu","DataModal");var n=null,o=cc.Class({statics:{getInstance:function(){return n||(n=new o),n}},ctor:function(){var e=t("ProfileData");this.profileData=new e}});cc._RF.pop()},{ProfileData:"ProfileData"}],DndAbilityItem:[function(t,e,i){"use strict";cc._RF.push(e,"40c1awEqUdH5LMCmDoJUNyb","DndAbilityItem"),cc.Class({extends:t("DndEditItem"),properties:{NameLabel:cc.Label,AdjustmentLabel:cc.Label,NumberLabel:cc.Label,NumericalLift:t("NumericalLift")},onLoad:function(){this._valueName=""},setParam:function(t,e){this._valueName=t,this._dndRoleData=e;var i=this._dndRoleData.ability[this._valueName];this.NameLabel.string=i.label,this.NumberLabel.string=i.value.toString(),this._adjustmentValue(i.adjustment)},edit:function(t){var e=this,i=this._dndRoleData.ability[this._valueName];this.NumericalLift.node.active=t,t&&this.NumericalLift.setParam({num:i.value,callback:function(){e._dndRoleData.setAbility(e._valueName,e.NumericalLift.getParam().num),e._adjustmentValue(i.adjustment)}})},_adjustmentValue:function(t){this.AdjustmentLabel.string=t>-1?"+"+t:t},onClicked:function(){EVENT.dispatchNotify("NotifyFinishSetting"),this.NumericalLift.node.active=!0}}),cc._RF.pop()},{DndEditItem:"DndEditItem",NumericalLift:"NumericalLift"}],DndCharacterSheet:[function(t,e,i){"use strict";cc._RF.push(e,"b426cCgjNVGm7Nlf/6IUaXI","DndCharacterSheet");var n=t("DataModal");cc.Class({extends:t("Client"),properties:{AbilityLayout:cc.Node,AbilityNode:cc.Node,ExemptionLayout:cc.Node,ExemptionNode:cc.Node,SkillLayout:cc.Node,SkillNode:cc.Node},onLoad:function(){this.AbilityNode.active=!1,this.ExemptionNode.active=!1,this.SkillNode.active=!1,EVENT.addListener("NotifyFinishSetting",this._notifyFinishSetting,this);var t=n.getInstance().profileData;t.setDndRoleData("1"),this.open(t.dndRole[1])},open:function(t){var e=this,i=this._dndRoleData=t,n=function(t,e,n){var o=cc.instantiate(t),a=o.getComponent("DndEditItem");return o.parent=e,o.active=!0,o.name=n,a.setParam(n,i),a.edit(n,i,!0),a};this._abilityItems=Object.keys(i.ability).map(function(t){return n(e.AbilityNode,e.AbilityLayout,t)}),this._exemptionItems=Object.keys(i.ability).map(function(t){return n(e.ExemptionNode,e.ExemptionLayout,t)}),this._skillItems=Object.keys(i.skill).map(function(t){return n(e.SkillNode,e.SkillLayout,t)})},_notifyFinishSetting:function(){var t=this._dndRoleData,e=function(e){e.setParam(e.node.name,t),e.edit(!1)};this._abilityItems.forEach(function(t){return e(t)}),this._exemptionItems.forEach(function(t){return e(t)}),this._skillItems.forEach(function(t){return e(t)})},onOutsizeClicked:function(){this._notifyFinishSetting()}}),cc._RF.pop()},{Client:"Client",DataModal:"DataModal"}],DndChoiceItem:[function(t,e,i){"use strict";cc._RF.push(e,"61d04LP9uBFIJs8BfFWkxpP","DndChoiceItem"),cc.Class({extends:t("DndEditItem"),properties:{TitleLabel:cc.Label,ContentLabel:cc.Label},onLoad:function(){this._valueName=""},setParam:function(t,e,i,n){this._valueName=e,this._info=i,this._dndRoleData=n;var o=this._dndRoleData[this._valueName];this.TitleLabel.string=t,this.ContentLabel.string=o},onClicked:function(){}}),cc._RF.pop()},{DndEditItem:"DndEditItem"}],DndClientView:[function(t,e,i){"use strict";cc._RF.push(e,"26cd175ziNLpqzTKO0uXuQX","DndClientView");var n=t("Notifier"),o=t("BargameControl");cc.Class({extends:t("Client"),properties:{MapItems:[cc.Node]},start:function(){this._init()},onDestroy:function(){n.removeClient(this)},_init:function(){},_distance:function(t,e){if(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<100){var i=this._profileData;return i.setRandomRgba(),n.notifyHost("initiate",{game:e.name,join:1,player:{uniqueid:i.uniqueid,nickname:i.nickname,position:t,rgba:i.rgba}}),o.setTouchStart(null),!0}return!1}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client",Notifier:"Notifier"}],DndEditItem:[function(t,e,i){"use strict";cc._RF.push(e,"3e18dVAyKRPmJP6Zn2iC5dC","DndEditItem"),cc.Class({extends:cc.Component,setParam:function(t){}}),cc._RF.pop()},{}],DndExemptionItem:[function(t,e,i){"use strict";cc._RF.push(e,"99b94dF9j5I/6JJSsZWE3D+","DndExemptionItem"),cc.Class({extends:t("DndEditItem"),properties:{NameLabel:cc.Label,NumberLabel:cc.Label,SwitchToggle:t("SwitchToggle")},onLoad:function(){this._valueName=""},setParam:function(t,e){this._valueName=t,this._dndRoleData=e;var i=this._dndRoleData.ability[this._valueName];this.NameLabel.string=i.label,this.NumberLabel.string=i.exemption.toString()},edit:function(t){var e=this,i=this._dndRoleData.ability[this._valueName];this.SwitchToggle.node.active=t,t&&this.SwitchToggle.setParam({num:i.adjustment,callback:function(){e._dndRoleData.selectExemption(e._valueName,e.SwitchToggle.getParam().isToggle),e.NumberLabel.string=i.exemption.toString()}})},onClicked:function(){EVENT.dispatchNotify("NotifyFinishSetting"),this.SwitchToggle.node.active=!0}}),cc._RF.pop()},{DndEditItem:"DndEditItem",SwitchToggle:"SwitchToggle"}],DndGameEnum:[function(t,e,i){"use strict";var n,o,a,c;function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"85786faLeBKJJsOXhKEin8b","DndGameEnum");var r=cc.Enum({Strength:-1,Dexterity:-1,Constitution:-1,Intelligence:-1,Perception:-1,Charisma:-1}),l=(s(n={},r.Strength,{name:"Strength",label:"\u529b\u91cf"}),s(n,r.Dexterity,{name:"Dexterity",label:"\u654f\u6377"}),s(n,r.Constitution,{name:"Constitution",label:"\u9ad4\u8cea"}),s(n,r.Intelligence,{name:"Intellegence",label:"\u667a\u529b"}),s(n,r.Perception,{name:"Perception",label:"\u611f\u77e5"}),s(n,r.Charisma,{name:"Charisma",label:"\u9b45\u529b"}),n),h=cc.Enum({Athletics:-1,Thievery:-1,Stealth:-1,Acrobatics:-1,Insight:-1,History:-1,Arcane:-1,Nature:-1,Religion:-1,Tame:-1,Observing:-1,Heal:-1,Survival:-1,Bluff:-1,Intimidate:-1,Histrionics:-1,Diplomacy:-1}),u=(s(o={},h.Athletics,{label:"\u904b\u3000\u3000\u52d5",depend:r.Strength}),s(o,h.Thievery,{label:"\u5999\u624b\u7a7a\u7a7a",depend:r.Dexterity}),s(o,h.Stealth,{label:"\u96b1\u533f\u8eb2\u85cf",depend:r.Dexterity}),s(o,h.Acrobatics,{label:"\u7279\u6280\u52d5\u4f5c",depend:r.Dexterity}),s(o,h.Insight,{label:"\u8fa8\u8a8d\u8abf\u67e5",depend:r.Intelligence}),s(o,h.History,{label:"\u6b77\u53f2\u77e5\u8b58",depend:r.Intelligence}),s(o,h.Arcane,{label:"\u5967\u8853\u77e5\u8b58",depend:r.Intelligence}),s(o,h.Nature,{label:"\u81ea\u7136\u77e5\u8b58",depend:r.Intelligence}),s(o,h.Religion,{label:"\u5b97\u6559\u77e5\u8b58",depend:r.Intelligence}),s(o,h.Tame,{label:"\u99b4\u670d\u52d5\u7269",depend:r.Perception}),s(o,h.Observing,{label:"\u5bdf\u984f\u89c0\u8272",depend:r.Perception}),s(o,h.Heal,{label:"\u91ab\u7642\u6280\u8853",depend:r.Perception}),s(o,h.Perception,{label:"\u89c0\u5bdf\u611f\u77e5",depend:r.Perception}),s(o,h.Survival,{label:"\u6c42\u751f\u6280\u5de7",depend:r.Perception}),s(o,h.Bluff,{label:"\u552c\u5f04\u779e\u9a19",depend:r.Charisma}),s(o,h.Intimidate,{label:"\u5a01\u8105\u6050\u5687",depend:r.Charisma}),s(o,h.Histrionics,{label:"\u8868\u6f14\u85dd\u8853",depend:r.Charisma}),s(o,h.Diplomacy,{label:"\u4ea4\u6d89\u8aaa\u670d",depend:r.Charisma}),o),d=cc.Enum({Cleric:-1,Fighter:-1,Rouge:-1,Paladin:-1,Warlock:-1,Wizard:-1,Bard:-1,Ranger:-1,Warlord:-1,Barbarian:-1,Monk:-1,Druid:-1}),p=(s(a={},d.Cleric,{label:"\u7267\u5e2b",exemption:[r.Intelligence,r.Charisma],skillPoint:2,skill:[h.History,h.Religion,h.Observing,h.Heal,h.Diplomacy]}),s(a,d.Fighter,{label:"\u6230\u58eb",exemption:[r.Strength,r.Constitution],skillPoint:2,skill:[h.Acrobatics,h.Tame,h.Athletics,h.History,h.Intimidate,h.Perception,h.Survival]}),s(a,d.Rouge,{label:"\u904a\u76ea\u8005",exemption:[r.Dexterity,r.Intelligence],skillPoint:4,skill:[h.Acrobatics,h.Athletics,h.Bluff,h.Observing,h.Intimidate,h.Perception,h.Histrionics,h.Diplomacy,h.Insight,h.Thievery,h.Stealth]}),s(a,d.Paladin,{label:"\u8056\u9a0e\u58eb",exemption:[r.Perception,r.Charisma],skillPoint:2,skill:[h.Athletics,h.Observing,h.Intimidate,h.Heal,h.Diplomacy,h.Religion]}),s(a,d.Warlock,{label:"\u8853\u58eb",exemption:[r.Constitution,r.Charisma],skillPoint:2,skill:[h.Arcane,h.Bluff,h.Observing,h.Intimidate,h.Diplomacy,h.Religion]}),s(a,d.Wizard,{label:"\u6cd5\u5e2b",exemption:[r.Intelligence,r.Perception],skillPoint:2,skill:[h.Arcane,h.Histrionics,h.Observing,h.Insight,h.Heal,h.Religion]}),s(a,d.Bard,{label:"\u541f\u904a\u8a69\u4eba",exemption:[r.Dexterity,r.Charisma],skillPoint:3,skill:[h.Athletics,h.Thievery,h.Stealth,h.Acrobatics,h.Insight,h.History,h.Arcane,h.Nature,h.Religion,h.Tame,h.Observing,h.Heal,h.Survival,h.Bluff,h.Intimidate,h.Histrionics,h.Diplomacy]}),s(a,d.Ranger,{label:"\u904a\u4fe0",exemption:[r.Strength,r.Dexterity],skillPoint:3,skill:[h.Tame,h.Athletics,h.Observing,h.Insight,h.Nature,h.Perception,h.Stealth,h.Survival]}),s(a,d.Warlord,{label:"\u9b54\u5c0e\u58eb",exemption:[r.Perception,r.Charisma],skillPoint:2,skill:[h.Arcane,h.Bluff,h.Intimidate,h.Insight,h.History,h.Nature,h.Religion]}),s(a,d.Barbarian,{label:"\u91ce\u883b\u4eba",exemption:[r.Strength,r.Constitution],skillPoint:2,skill:[h.Tame,h.Athletics,h.Intimidate,h.Nature,h.Perception,h.Survival]}),s(a,d.Barbarian,{label:"\u6b66\u50e7",exemption:[r.Strength,r.Dexterity],skillPoint:2,skill:[h.Acrobatics,h.Athletics,h.History,h.Observing,h.Religion]}),s(a,d.Druid,{label:"\u5fb7\u9b6f\u4f9d",exemption:[r.Intelligence,r.Perception],skillPoint:2,skill:[h.Arcane,h.Tame,h.Observing,h.Heal,h.Nature,h.Perception,h.Religion,h.Survival]}),a),f=cc.Enum({Elf:-1,HalfElf:-1,Human:-1,Halfling:-1,Dwarf:-1,Gnome:-1,Tiefling:-1,Dragonborn:-1,HalfOrc:-1});s(c={},f.Elf,{label:"\u7cbe\u9748",speed:30,skillPoint:1,skill:[h.Perception],resistance:[]}),s(c,f.HalfElf,{label:"\u534a\u7cbe\u9748",speed:30,skillPoint:2,skill:[],resistance:[]}),s(c,f.Human,{label:"\u4eba\u985e",speed:30,skill:[],resistance:[]}),s(c,f.Halfling,{label:"\u534a\u8eab\u4eba",speed:25,skill:[h.Perception],resistance:[]}),s(c,f.Dwarf,{label:"\u77ee\u4eba",speed:25,skill:[],resistance:[]}),s(c,f.Gnome,{label:"\u5730\u4f8f",speed:25,skill:[],resistance:[]}),s(c,f.Tiefling,{label:"\u9b54\u4eba",speed:30,skill:[],resistance:[]}),s(c,f.Dragonborn,{label:"\u9f8d\u88d4",speed:30,skill:[],resistance:[]}),s(c,f.HalfOrc,{label:"\u534a\u7378\u4eba",speed:30,skill:[h.Intimidate],resistance:[]});e.exports={AbilityValue:r,AbilityInfo:l,SkillValue:h,SkillInfo:u,OccupationValue:d,OccupationInfo:p},cc._RF.pop()},{}],DndMapRole:[function(t,e,i){"use strict";cc._RF.push(e,"851d97bdQlIppBf69EiF5BL","DndMapRole");var n=t("Notifier");cc.Class({extends:cc.Component,properties:{ColorNode:cc.Node,ColorRoot:cc.Node,ColorDemoNode:cc.Node,NameInput:cc.EditBox,NameDemoText:cc.Label,SpedInput:cc.EditBox},onLoad:function(){this._profileData=t("DataModal").getInstance().profileData,n.mapClient(this),this._colorPettle()},start:function(){cc.log("~~~~~~~",this._profileData.nickname),this.NameInput.string=this._profileData.nickname},onDestroy:function(){n.removeClient(this)},map_role_close:function(){this.node.destroy()},_colorPettle:function(){var t=this;[cc.Color.RED,cc.Color.GREEN,cc.Color.BLUE,cc.Color.YELLOW,cc.Color.ORANGE,cc.Color.CYAN,cc.Color.MAGENTA].forEach(function(e){var i=cc.instantiate(t.ColorNode);i.parent=t.ColorRoot,i.active=!0,i.color=e})},_colorTransferAnimation:function(t){var e=t.r,i=t.b,n=t.g;this.ColorDemoNode.stopAllActions(),this.ColorDemoNode.runAction(cc.sequence(cc.scaleTo(.1,.8,.8),cc.spawn(cc.tintTo(.2,e,n,i),cc.scaleTo(.2,1.5,1.5).easing(cc.easeInOut(3))),cc.scaleTo(.2,1,1).easing(cc.easeInOut(3))))},onNameTextChanged:function(){this.NameDemoText.string=this.NameInput.string},onTarnsferColorClicked:function(t){var e=t.target;this._colorTransferAnimation(e.color)},onConfirmClicked:function(){n.notifyHost("role_join",{player:this._profileData.uniqueid,rgba:this.ColorDemoNode.color,name:this.NameInput.string,sped:parseInt(this.SpedInput.string,10)||1}),this.node.active=!1}}),cc._RF.pop()},{DataModal:"DataModal",Notifier:"Notifier"}],DndRoleData:[function(t,e,i){"use strict";cc._RF.push(e,"c5b1bdGzBFMJ5cEJPmd7HSx","DndRoleData");var n=t("DndGameEnum");cc.Class({ctor:function(){var t=this;this.level=0,this.name="",this.occupation="",this.background="",this.ethnicity="",this.alignment="",this.experience=0,this.conversancy=2,this.ability={},this.skill={},this.armorClass=0,this.strikeAdjustment=0,this.moveSpeed=0,this.curHitPoint=0,this.maxHitPoint=0,this.disposition="",this.idea="",this.relationship="",this.shortcoming="",this.combat={},this.weapon={},this.equipment={},this.tenure={cp:0,sp:0,ep:0,gp:0,pp:0},Object.keys(n.AbilityValue).forEach(function(e){var i=n.AbilityValue[e],o=n.AbilityInfo[i].label,a=Math.floor(-1);t.ability[i]={label:o,value:8,adjustment:a},t.selectExemption(i,!1)}),this.setSkill()},setLevel:function(t){var e=this;this._level=t,this.conversancy=Math.floor((this._level-1)/4)+2,Object.keys(this.skill).forEach(function(t){e.skill[t].isLearn&&e.selectSkill(t,!0)})},setAbility:function(t,e){var i=Math.floor(.5*(e-10));this.ability[t].value=e,this.ability[t].adjustment=i,this.selectExemption(t,!1),this.setSkill(),this.strikeAdjustment=this.ability[n.AbilityValue.Dexterity].adjustment},selectExemption:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.ability[t];i.isExemption=e,i.exemption=i.adjustment+(e?this.conversancy:0)},setSkill:function(){var t=this;Object.keys(n.SkillValue).forEach(function(e){var i=n.SkillValue[e],o=n.SkillInfo[i],a=o.label,c=t.ability[o.depend];t.skill[i]={label:a,ability:c,value:c.adjustment,add:0}})},selectSkill:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.skill[t],n=i.ability;i.add=e?this.conversancy:0,i.value=n.adjustment},setWeapon:function(t,e){var i=t.split("+"),n=e.split("d");weapon.push({label:t,add:i[1],unit:n[0],face:n[1],attack:attack,ability:ability})}}),cc._RF.pop()},{DndGameEnum:"DndGameEnum"}],DndSkillItem:[function(t,e,i){"use strict";cc._RF.push(e,"44018HCQTFCHbREk/G6m3aD","DndSkillItem"),cc.Class({extends:t("DndEditItem"),properties:{NameLabel:cc.Label,NumberLabel:cc.Label,SwitchToggle:t("SwitchToggle")},onLoad:function(){this._valueName=""},setParam:function(t,e){this._valueName=t,this._dndRoleData=e;var i=this._dndRoleData.skill[this._valueName];this.NameLabel.string=i.label,this.NumberLabel.string=(i.value+(i.add||0)).toString()},edit:function(t){var e=this,i=this._dndRoleData.skill[this._valueName];this.SwitchToggle.node.active=t,t&&this.SwitchToggle.setParam({num:i.value,callback:function(){e._dndRoleData.selectSkill(e._valueName,e.SwitchToggle.getParam().isToggle),i=e._dndRoleData.skill[e._valueName],e.NumberLabel.string=(i.value+i.add).toString()}})},onClicked:function(){EVENT.dispatchNotify("NotifyFinishSetting"),this.SwitchToggle.node.active=!0}}),cc._RF.pop()},{DndEditItem:"DndEditItem",SwitchToggle:"SwitchToggle"}],EditBoxTags:[function(t,e,i){"use strict";cc._RF.push(e,"84a2cxzwS5LI6EIQjMYV6Rq","EditBoxTags"),cc.Class({extends:cc.Component,properties:{EditBox:cc.EditBox,ListLayout:cc.Node,ListNode:cc.Node},onLoad:function(){this._touchStartCallback=this._selectTagString.bind(this),this._data=[]},setData:function(t){this._data=t},onTextChanged:function(t){this._filterTagString(t)},onEditBoxBegan:function(t){this._filterTagString(t.string||"")},onEditBoxEnded:function(){this.ListLayout.active=!1},_selectTagString:function(t){var e=t.target.name;this.EditBox.string=e,this.onTextChanged(e)},_filterTagString:function(t){var e=this,i=this._data.filter(function(e){return e.indexOf(t)>-1}),n=this.ListLayout.getChildren();n.forEach(function(t){return t.active=!1}),i.forEach(function(t,i){var o=n[i];o||((o=cc.instantiate(e.ListNode)).parent=e.ListLayout,o.on(cc.Node.EventType.TOUCH_START,e._touchStartCallback)),o.name=t,o.active=!0,o.getComponent(cc.Label).string=t}),this.ListLayout.active=!0}}),cc._RF.pop()},{}],EventButton:[function(t,e,i){"use strict";cc._RF.push(e,"0f215BLlFZMCJcg8nLLA57i","EventButton"),cc.Class({extends:cc.Component,properties:{EventName:cc.Label},setParams:function(t,e){this.EventName.string=t,this._callback=e},onClicked:function(){this._callback&&this._callback()}}),cc._RF.pop()},{}],EventRemover:[function(t,e,i){"use strict";cc._RF.push(e,"effaeb+2phELoiQQT5+Y30F","EventRemover"),cc.Class({extends:cc.Component,addEventParam:function(t){this._registeredEventList=this._registeredEventList?this._registeredEventList.push(t):[t]},onDestroy:function(){this._registeredEventList&&this._registeredEventList.forEach(function(t){EVENT.removeListener(t.name,t.func,t.target)})}}),cc._RF.pop()},{}],FingerpartyClientView:[function(t,e,i){"use strict";cc._RF.push(e,"294a0SEDlZJerOt5Kp6/bxc","FingerpartyClientView");var n=t("Notifier"),o=t("BargameControl");cc.Class({extends:t("Client"),properties:{GameItems:[cc.Node]},start:function(){var t=this;this._profileData.setIDNickname()?n.notifyHost("player_join",{player:{uniqueid:this._profileData.uniqueid,nickname:this._profileData.nickname}}):this._loadUI({name:"PersonalBoard"}),this._init(),EVENT.addListener("NotifyEventDone",function(){return t._init()},this)},onDestroy:function(){n.removeClient(this)},_init:function(){var t=this;o.setTouchStart(function(e){t.GameItems.some(function(i){return t._distance(e,i)})})},_distance:function(t,e){if(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<100){var i=this._profileData;return i.setRandomRgba(),n.notifyHost("Initiate",{game:e.name,join:1,player:{uniqueid:i.uniqueid,nickname:i.nickname,position:t,rgba:i.rgba}}),o.setTouchStart(null),!0}return!1},handleInitiate:function(t){var e=t;1==e.join&&this._loadUI(e.game,{method:"startGame",event:t})}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client",Notifier:"Notifier"}],FingerpartyCountPicker:[function(t,e,i){"use strict";cc._RF.push(e,"abf995XnZ5Er6DeDxJFDBoH","FingerpartyCountPicker");var n=t("Notifier"),o=t("BargameControl");t("MessageManager");cc.Class({extends:t("Client"),properties:{GameItems:[cc.Node]},start:function(){this._profileData=t("DataModal").getInstance().profileData},onDestroy:function(){n.removeClient(this)},_init:function(){var t=this;o.setTouchStart(function(e){t.GameItems.some(function(i){return t._distance(e,i)})})},_distance:function(t,e){if(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<100){var i=this._profileData;return i.setRandomRgba(),n.notifyHost("initiate",{game:e.name,join:1,player:{uniqueid:i.uniqueid,nickname:i.nickname,position:t,rgba:i.rgba}}),o.setTouchStart(null),!0}return!1},handleInitiate:function(t){var e=t;1==e.join&&this._loadUI(e.game,{method:"startGame",event:t})}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client",DataModal:"DataModal",MessageManager:"MessageManager",Notifier:"Notifier"}],FingerparytRoulette:[function(t,e,i){"use strict";cc._RF.push(e,"1a14f4kY5RJPKJD3HmrcKye","FingerparytRoulette");var n="BargameRoulette",o=t("Notifier"),a=t("BargameControl"),c=t("MessageManager");cc.Class({extends:t("Client"),properties:{TouchPointNode:cc.Node},start:function(){this._profileData=t("DataModal").getInstance().profileData},onDestroy:function(){this._super(),EVENT.dispatchNotify("NotifyEventDone")},startGame:function(t){var e=this;this.TouchPointNode.active=!1,this._touchpoints={},this._tapFlag=!1,this.inactive(t),this._profileData.uniqueid===t.player.uniqueid?a.setTouchEnd(function(t){a.setTouchEnd(null),e._notifyPlay()}):a.setTouchStart(function(t){a.setTouchStart(null),e._tapFlag=!e._tapFlag,e._notifyInactive(e._tapFlag?1:0,t)})},_notifyInactive:function(t,e){var i=this._profileData;i.setRandomRgba(),o.notifyHost("inactive",{game:n,join:t,player:{uniqueid:i.uniqueid,nickname:i.nickname,position:e,rgba:i.rgba}})},inactive:function(t){var e=this,i=t.join,n=t.player,o=n.uniqueid,a=this._touchpoints[o];i?(a||((a=cc.instantiate(this.TouchPointNode)).parent=this.node,this._touchpoints[o]=a.getComponent("TouchPoint")),a.active=!0,a.getComponent("TouchPoint").setParam(n)):a&&a.runAction(cc.sequence(cc.scaleTo(.3,.1).easing(cc.easeInOut(2.2)),cc.callFunc(function(t){a.destroy(),delete e._touchpoints[o]})))},_notifyPlay:function(){o.notifyHost("play",{game:n})},play:function(t){a.setTouchStart(null),this._notifyBet(1)},_notifyBet:function(t){o.notifyHost("bet",{game:n,player:{uniqueid:this._profileData.uniqueid,nickname:this._profileData.nickname},chip:t})},bet:function(){},call:function(t){o.isHost()&&this._notifyRoulette(t.count)},_notifyRoulette:function(t){var e=3*t,i=Math.round(100*Math.random())%t;o.notifyHost("Roulette",{game:n,count:e+i})},handleRoulette:function(t){var e=this,i=t.players,n=t.form,o=t.to,a=i.findIndex(function(t){return t.uniqueid===e._profileData.uniqueid});if(-1!=a){var s=this._profileData.rgba,r=i.length,l=n,h=o,u=1/r;(function t(){if(l<=h){var n=l%r;e._touchpoints[i[(n-1+r)%r].uniqueid].select(!1),e._touchpoints[i[n].uniqueid].select(!0),a==n&&(c.warn({color:s,text:" ",size:60}),u+=1/(h+1-l)),l++,e.unscheduleAllCallbacks(),e.scheduleOnce(t.bind(e),u)}else{var o=function(){e.node.destroy()};i[h%r].uniqueid==e._profileData.uniqueid?c.warn({text:"\u265b",size:260,flicker:5,color:s,callback:o.bind(e)}):o()}})()}else this.node.destroy()}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client",DataModal:"DataModal",MessageManager:"MessageManager",Notifier:"Notifier"}],GameEnum:[function(t,e,i){"use strict";cc._RF.push(e,"78564pyVw9A+7tKe5lCcuS9","GameEnum");var n=cc.Enum({StoryTeller:-1}),o=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}({},n.StoryTeller,"StoryTeller");e.exports={Games:n,GameName:o},cc._RF.pop()},{}],Hoster:[function(t,e,i){"use strict";cc._RF.push(e,"8773curYeFHIKbhCHpe2Ioi","Hoster");var n=t("Notifier");cc.Class({extends:cc.Component,onLoad:function(){n.mapHoster(this),this._players=[],this._chairs=[]},onDestroy:function(){n.removeHoster()},handleNewRoom:function(t){n.broadcast("JoinRoom",t)},handleStartActivity:function(t){n.broadcast("Initiate",t)},handleJoin:function(t){var e=t.player;this._players[e.uniqueid]=e,n.broadcast("Inactive",t)},handleChairShuffle:function(){this._chairs.map()},handleAbort:function(t){var e=t.player;delete this._players[e.uniqueid]}}),cc._RF.pop()},{Notifier:"Notifier"}],Identitiy:[function(t,e,i){"use strict";cc._RF.push(e,"246015Sd+VNsrmY6vvXOeoD","Identitiy");var n=t("Notifier").Link,o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(new Date).getTime().toString(16)+"_"+t};e.exports={getSession:function(t){return new Promise(function(e,i){var a=LocalCache.getItem("user_nickname",t),c=LocalCache.getItem("user_uniqueid",o());n.read("Users/"+c).then(function(t){var i=t.success,n=t.data;i?(cc.log("\u6709\u8cc7\u6599",c,n.nickname),e({uniqueid:c,nickname:n.nickname})):(cc.log("\u6c92\u8cc7\u6599"),e({uniqueid:c,nickname:a}))})})},trilLogin:function(t){return new Promise(function(e,i){n.read("Users/"+t).then(function(t){var n=t.success,o=t.data;n?e(o):i(null)})})},login:function(t,e){return new Promise(function(i,a){Config.LocalMode?i(o()):t&&e&&n.read("Users/").then(function(e){var n=e.success,o=e.data;n?Object.keys(o).some(function(e){if(e.split("_")[1]==t)return i(o),!0}):a(null)})})},logout:function(){LocalCache.removeItem("user_nickname"),LocalCache.removeItem("user_uniqueid")},timestampid:o,register:function(t,e,i){return t&&LocalCache.setItem("user_nickname",t),uniqueid&&LocalCache.setItem("user_uniqueid",o(e)),i&&LocalCache.setItem("user_password",i),n.write("Users/"+uniqueid,{nickname:t,password:i})},guestNickname:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Guest",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=t,n=0;n<e;n++)i+=(Math.round(100*Math.random())%10).toString();return i}},cc._RF.pop()},{Notifier:"Notifier"}],MapGridItem:[function(t,e,i){"use strict";cc._RF.push(e,"af41aI37tVMhZaDK/F3IrG5","MapGridItem"),cc.Class({extends:cc.Component,properties:{ColorBoard:cc.Node},onLoad:function(){},setGridSize:function(t,e){this.node.setContentSize(t),this.ColorBoard.setContentSize(t.width+e,t.height+e)},setOpacity:function(t){this.ColorBoard.opacity=t},setColor:function(t){return this.ColorBoard.color=t,this},setRole:function(t){t.parent=this.node,t.active=!0},getSiblingIndex:function(){return this.node.getSiblingIndex()},getColor:function(){return this.ColorBoard.color},onClicked:function(){EVENT.dispatchNotify("NotifyClickMapGridItem",this)}}),cc._RF.pop()},{}],MapGrid:[function(t,e,i){"use strict";cc._RF.push(e,"553089bTvRKqI+QZOKGMWBZ","MapGrid");var n=t("Notifier");cc.Class({extends:cc.Component,properties:{RoleList:t("RoleList"),RoleNode:cc.Node},onLoad:function(){this._profileData=t("DataModal").getInstance().profileData,this._roleNodes={},this._rgbaColor={},this._playerCount=0,n.mapClient(this),EVENT.addListener("NotifyClickMapGridItem",this._notifyClickMapGridItem,this)},onDestroy:function(){EVENT.removeListener("NotifyClickMapGridItem",this._notifyClickMapGridItem,this)},_setRoleColor:function(t){var e=t.r,i=t.g,n=t.b,o=t.a,a=void 0===o?255:o;this._rgbaColor={r:e,g:i,b:n,a:a}},handleShowMap:function(t){var e=t.url;this._loadMapPicture(e),this.node.active=!0},_roleJoin:function(t){var e=t,i=e.player,n=cc.instantiate(this.RoleNode);return n.name=i,n.color=new cc.Color(t.rgba),n.setPosition(0,0),n.getComponentInChildren(cc.Label).string=e.name,e.player==this._profileData.uniqueid&&this._setRoleColor(e.rgba),this._selectPlayer=i,this._roleNodes[i]=n,this._playerCount++,n},_loadMapPicture:function(t){var e=this.node.getComponent(cc.Sprite),i=this._rematchSize.bind(this);cc.loader.load({url:t,type:"png"},function(t,n){if(t)return cc.error(t);e.spriteFrame=new cc.SpriteFrame(n),i()})},move:function(t){var e=t.position;e.next&&this.node.children[e.next].getComponent("MapGridItem").setColor(new cc.Color(t.rgba)),e.prev&&this.node.children[e.prev].getComponent("MapGridItem").setColor(cc.Color.WHITE),e.curr&&this.node.children[e.curr].getComponent("MapGridItem").setRole(this._roleNodes[t.player])},_rematchSize:function(){this.node.children.forEach(function(t,e){return e>0&&t.destroy()});var t=cc.size(36.5,36.5),e=this.node.children[0].getComponent("MapGridItem");e.setGridSize(t,2),e.setOpacity(70),e.setColor(cc.Color.WHITE);var i=this.node.getContentSize(),n=i.width/36.5*i.height/36.5;n--;for(var o=0;o<n;o++){cc.instantiate(this.node.children[0]).parent=this.node}cc.log(this._selectPlayer,this._roleNodes[this._selectPlayer]),this.node.children[this._playerCount].getComponent("MapGridItem").setRole(this._roleNodes[this._selectPlayer])},_notifyClickMapGridItem:function(t){var e=t.detail;if(e.getColor()._val==cc.Color.WHITE._val){var i=e.getSiblingIndex(),o=this._selectPlayer,a={curr:i};n.notifyHost("move",{pic:"pic_02",rgba:this._rgbaColor,player:o,position:a}),this._position=a.next}},onHostMoveRoleClicked:function(t){var e=t.target.parent;n.isHost()&&(this._selectPlayer=e.name)},onHostRemoveRoleClicked:function(t){var e=t.target.parent;n.isHost()&&(this.RoleList.removeRole(e),this._roleNodes[e.name]&&this._roleNodes[e.name].destroy())}}),cc._RF.pop()},{DataModal:"DataModal",Notifier:"Notifier",RoleList:"RoleList"}],MessageBox:[function(t,e,i){"use strict";cc._RF.push(e,"00b0bArzIRNi6sx54PDq5Rg","MessageBox");t("Notifier");cc.Class({extends:cc.Component,properties:{MessageLine:cc.Node},onLoad:function(){},addMessage:function(t){var e=cc.instantiate(this.MessageLine);e.parent=this.node,e.active=!0,e.getComponent("MessageLine").setParam(t)},onReplaceWordClicked:function(){},onHideClicked:function(){this.node.active=!1}}),cc._RF.pop()},{Notifier:"Notifier"}],MessageLine:[function(t,e,i){"use strict";cc._RF.push(e,"4fecbAahPtEOLllSnsERZXw","MessageLine");var n=t("Notifier");cc.Class({extends:cc.Component,properties:{Label:cc.Label,Editbox:cc.EditBox},onLoad:function(){},setParam:function(t){this._player=t.player||"",this.Label.string=this._player?this._player+": "+t.text:t.text},replaceWord:function(t,e){var i=this.Label.string.replace(new RegExp(" "+t+" ","gi"),e);this.Label.string=i},onFirstClicked:function(){this.Editbox.node.active=!0,this.Label.node.active=!1,this.Editbox.node.height=this.Label.node.height,this.Editbox.string=this.Label.string},onBrocastClicked:function(){this.node.destroy(),n.notifyClient("utter",{player:this._player,text:this.Editbox.string})},onDeleteClicked:function(){this.node.destroy()}}),cc._RF.pop()},{Notifier:"Notifier"}],MessageManager:[function(t,e,i){"use strict";cc._RF.push(e,"7d7a84itmdEEZb0+xV0HzfL","MessageManager");var n=null,o=[];cc.Class({extends:cc.Component,statics:{warn:function(t){n&&n.warn(t)},addMessage:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(n){var i={view:cc.instantiate(n.Message).getComponent("MessageView"),param:t};e?n.addMessage(i):n.showMessage(i)}},closeMessage:function(t){n&&n.closeMessage(t)},closeAllMessage:function(){n&&(o=[],n._activeMessages.forEach(function(t){return n.closeMessage(t)}))}},properties:{Message:cc.Node,Warn:cc.Node},onLoad:function(){n=this,this._activeMessages=[]},warn:function(t){var e=this;this.Warn.color=t.color,this.Warn.active=!0,this.Warn.opacity=0,this.Warn.stopAllActions(),this.Warn.runAction(cc.sequence(cc.repeat(cc.sequence(cc.fadeTo(.2,255),cc.delayTime(.3),cc.fadeTo(.5,80)),t.flicker||1),cc.callFunc(function(i){e.Warn.active=!1,t.callback&&t.callback()})));var i=this.Warn.getComponentInChildren(cc.Label);t.text&&(i.string=t.text),t.size&&(i.fontSize=t.size,i.lineHeight=t.size+Math.floor(t.size/4))},addMessage:function(t){0==this._activeMessages.length?this.showMessage(t):o.push(t)},showMessage:function(t){if(t){var e=t.view;e.node.parent=this.node,e.setParam(t.param),e.show(),this._activeMessages.push(e)}},closeMessage:function(t){var e=this._activeMessages.findIndex(function(e){var i=e==t;return i&&e.node.destroy(),i});this._activeMessages.splice(e,1),0==this._activeMessages.length&&this.showMessage(o.shift())}}),cc._RF.pop()},{}],MessageView:[function(t,e,i){"use strict";cc._RF.push(e,"4797fkooQ5Oh5SS+d8e3lE6","MessageView");var n=t("MessageManager");cc.Class({extends:cc.Component,properties:{Label:cc.Label},setParam:function(t){this.Label.string=t.text,this._callback=t.callback},show:function(){this.node.active=!0,this._showAnimation()},close:function(){this._closeAnimation()},_showAnimation:function(){this.node.opacity=0,this.node.setScale(.6,.6),this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeTo(.2,220),cc.scaleTo(.2,1)))},_closeAnimation:function(){var t=this;this.node.runAction(cc.sequence(cc.spawn(cc.fadeTo(.2,0),cc.scaleTo(.2,.6)),cc.callFunc(function(e){return n.closeMessage(t)})))},onCloseClicked:function(){this._closeAnimation(),this._callback&&this._callback()}}),cc._RF.pop()},{MessageManager:"MessageManager"}],NodeResize:[function(t,e,i){"use strict";cc._RF.push(e,"d6491AFL1RM24q7fOIDGtq3","NodeResize"),cc.Class({extends:cc.Component,properties:{top:0,bottom:0},onEnable:function(){var t=cc.Canvas.instance.node.getContentSize();this.node.setContentSize(cc.size(t.width-this.top,t.height-this.bottom))}}),cc._RF.pop()},{}],Notifier:[function(t,e,i){"use strict";cc._RF.push(e,"7d141ewrHhOkKLwmS0HyZA+","Notifier");var n=!1,o=null,a=[],c=null,s="",r="",l=cc.Class({extends:cc.Component,properties:{ClientViewNode:cc.Node},statics:{mapHoster:function(t){o=t},removeHoster:function(){c&&c.clear()},mapClients:function(t){a.push(t)},removeClient:function(t){a.splice(a.findIndex(function(e){return e==t}),1)},request:function(t,e){if(c){var i=Object.assign({notify:t},e);c.hosterHandler({success:!0,data:i})}},broadcast:function(t,e){if(c||c.isHost){var i=Object.assign({notify:t},e);c.clientHandler({success:!0,data:i})}}},onLoad:function(){c=this;var t=this._getUrlHash();this._setNotifyString(t),this._addListener(t),this._addClientView(t)},clear:function(){this._removeListener(),s="",r="",o=null,client=[]},_getUrlHash:function(){var t={},e=window.location.search.split("?")[1];return e&&e.split("&").forEach(function(e){var i=e.split("=");t[i[0]]=i[1]||""}),t},_setNotifyString:function(t){var e=t.game,i=t.room||"lobby";s=e+"_"+i+"_hoster_notify",r=e+"_"+i+"_client_notify"},_addListener:function(t){(n=void 0!=t.host)&&FirebaseWrapper.addListener(s,this.hosterHandler,this),FirebaseWrapper.addListener(r,this.clientHandler,this)},_addClientView:function(t){if(t.client){var e=t.client+"ClientView";cc.loader.loadRes("prefabs/board/"+e,function(t,e){if(t)return cc.error(t);cc.instantiate(e).parent=this.ClientViewNode}.bind(this))}},_removeListener:function(){FirebaseWrapper.removeListener(r),n&&(FirebaseWrapper.removeListener(s),FirebaseWrapper.remove(s),FirebaseWrapper.remove(r))},hosterHandler:function(t){var e=t.success,i=t.data;if(e&&o){var n="handle"+i.notify;o[n]&&o[n](i)}},clientHandler:function(t){var e=t.success,i=t.data;e&&a.length>0&&a.forEach(function(t){var e="handle"+i.notify;t[e]&&t[e](i)})}});e.exports=l,cc._RF.pop()},{}],NumericalLift:[function(t,e,i){"use strict";cc._RF.push(e,"d8fbcm6sqBC35cJfN1njb4F","NumericalLift"),cc.Class({extends:cc.Component,properties:{NumberLabel:cc.Label,Maximum:0,Minimum:0,IsAbsolute:!1},setParam:function(t){var e=t.num,i=t.callback;this._num=e,cc.log("num:",this._num),this.NumberLabel.string=e.toString(),this._callback=i},getParam:function(){return{num:this._num}},_adjustment:function(t){this._num=t,this.NumberLabel.string=this._num.toString(),this._callback&&this._callback(this._num)},onAddClicked:function(t,e){var i=parseInt(e,10)||1,n=this._num+i;(n<=this.Maximum||0==this.Maximum)&&this._adjustment(n)},onLessClicked:function(t,e){if(!this.IsAbsolute||0!=this._num){var i=parseInt(e,10)||1,n=this._num-i;(n>=this.Minimum||0==this.Minimum)&&this._adjustment(n)}}}),cc._RF.pop()},{}],PixelCanvas2:[function(t,e,i){"use strict";cc._RF.push(e,"0aa2f56qKdJnpIk4OkfC23z","PixelCanvas2"),cc.Class({extends:cc.Component,properties:{PixelDot:cc.Node},dotRandomRgbColor:function(t){var e=t.length;this._dotList.forEach(function(i){i.color=t[Math.round(100*Math.random())%e],i.opacity=255})},setGridsSize:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e*i;this.PixelDot.setContentSize(t,t);for(var a=this.node.getChildren(),c=0;c<o;c++){var s=a[c]||cc.instantiate(this.PixelDot);s.active=!0,s.opacity=0,s.parent=this.node}this._dotList=this.node.getChildren(),this.node.setContentSize(e*(t+n)-n,i*(t+n)-n);var r=this.node.getComponent(cc.Layout)||this.node.addComponent(cc.Layout);r.type=cc.Layout.Type.GRID,r.spacingX=r.spacingY=n,r.horizontalDirection=cc.Layout.HorizontalDirection.LEFT_TO_RIGHT,r.verticalDirection=cc.Layout.VerticalDirection.BOTTOM_TO_TOP},setRgbColor:function(t,e){var i=this._dotList[t];i.color=e,i.opacity=255},setRbgColors:function(t){var e=this;t.forEach(function(t,i){return e.setRgbColor(i,t)})},setHexColors:function(t){var e=this;Object.keys(t).forEach(function(i){var n=(new cc.Color).fromHEX(i);t[i].forEach(function(t){return e.setRgbColor(t,n)})})},setHexColorFill:function(t){if("String"==typeof t)return cc.error(t,'\u7684\u683c\u5f0f\u4e0d\u7b26\uff0c\u61c9\u8a72\u70ba"ffcc00"\u9019\u6a23\u7684hex\u8a18\u865f');var e=(new cc.Color).fromHEX(t);this._dotList.forEach(function(t){t.color=e,t.opacity=255})},getHexColors:function(){var t={};return this._dotList.forEach(function(e,i){if(e.active&&0!=e.opacity){var n=e.color.toHEX("#rrggbb");t[n]?t[n].push(i):t[n]=[i]}}),t},cleanPixelsColor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;t>-1?this._dotList[t].opacity=0:this._dotList.forEach(function(t){return t.opacity=0})}}),cc._RF.pop()},{}],PixelCanvas:[function(t,e,i){"use strict";cc._RF.push(e,"0808eF8vQtCWbDXYF8dPaw2","PixelCanvas"),cc.Class({extends:cc.Component,properties:{PixelLayout:cc.Node,PixelDot:cc.Node,LoadingMask:cc.Node,LoadingTips:cc.Label},setPixelLayout:function(t,e,i){var n=t*e,o=this.PixelLayout.getChildren(),a=t*i,c=e*i;this.PixelDot.setContentSize(i,i),o.forEach(function(t){return t.active=!1});for(var s=0;s<n;s++){var r=o[s]||cc.instantiate(this.PixelDot);r.active=!0,r.parent=this.PixelLayout}this.node.setContentSize(a,c),this.LoadingMask.setContentSize(a,c),this.PixelLayout.setContentSize(a,c),this._canvasPixelWidth=t,this._canvasPixelHeight=e,this._pixelDotSize=i,this._pixels=this.PixelLayout.getChildren()},rgbDot:function(t,e){var i=this._pixels[t];i.color=e,i.opacity=255},rgbDotPick:function(t){return this._pixels[t].color},hexDraw:function(t){var e=this;Object.keys(t).forEach(function(i){var n=(new cc.Color).fromHEX(i);t[i].forEach(function(t){var i=e._pixels[t];i.opacity=255,i.color=n})})},hexColorPaint:function(t){var e=(new cc.Color).fromHEX(t);this._pixels.forEach(function(t){t.opacity=255,t.color=e})},dotRandomRgbColor:function(t){var e=t.length;this._pixels.forEach(function(i){i.color=t[Math.round(100*Math.random())%e],i.opacity=255})},hexCapture:function(){var t={};return this._pixels.forEach(function(e,i){if(e.active&&0!=e.opacity){var n=e.color.toHEX("#rrggbb");t[n]?t[n].push(i):t[n]=[i]}}),t},cleanAllPixelsColor:function(){this._pixels.forEach(function(t){return t.opacity=0})},loadingTips:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t>0&&(this.LoadingMask.stopAllActions(),this.LoadingMask.runAction(cc.fadeTo(t,e))),this.LoadingTips.string=i},getCanvasPixelWdith:function(){return this._canvasPixelWidth},getCanvasPixelHeight:function(){return this._canvasPixelHeight},_reverseCanvasDots:function(){var t=this,e=[];this._pixels.forEach(function(i,n){e.push(i.color),n>0&&n%(t._canvasPixelWidth-1)==0&&(e.reverse().forEach(function(e,i){t._pixels[n+i].color=e}),e=[])})}}),cc._RF.pop()},{}],PixelContentSlider:[function(t,e,i){"use strict";cc._RF.push(e,"8d300TzjiJEQolOL7y7T1TV","PixelContentSlider"),cc.Class({extends:cc.Component,properties:{MaskNode:cc.Node,PixelImagePainter:t("PixelImagePainter")},onLoad:function(){var t=cc.director.getScene().getChildren()[0];this._sceneWidth=t.width,this._sceneHeight=t.height,this._contentPixelWidth=0,this._contentPixelHeight=0,this._pixelDotSize=0,this._sliderDelta={x:0,y:0}},start:function(){this.setContentSize(10,10,20),this.PixelImagePainter.newCanvas()},setContentSize:function(t,e,i){this._contentPixelWidth=t,this._contentPixelHeight=e,this._pixelDotSize=i,this.PixelImagePainter.setCanvasSize(t,e,i),this.node.off(cc.Node.EventType.TOUCH_START,this._touchSideCallback),this._touchSideCallback=this._sideTouchEventHandler(this._startSlide.bind(this)),this.node.on(cc.Node.EventType.TOUCH_START,this._touchSideCallback)},getPixelSliderDelta:function(){return{x:Math.floor(this._sliderDelta.x/this._pixelDotSize)*this._pixelDotSize,y:Math.floor(this._sliderDelta.y/this._pixelDotSize)*this._pixelDotSize}},_startSlide:function(t){var e=.5*this._sceneWidth,i=.5*this._sceneHeight;(Math.abs(t.x-e)>.5*this.MaskNode.width||Math.abs(t.y-i)>.5*this.MaskNode.height)&&(this._caressSideCallback=this._sideTouchEventHandler(this._currentSlide.bind(this)),this._leaveSideCallback=this._sideTouchEventHandler(this._endSlide.bind(this)),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._caressSideCallback),this.node.on(cc.Node.EventType.TOUCH_END,this._leaveSideCallback))},_currentSlide:function(){this.PixelImagePainter.setCanvasPosition(this.getPixelSliderDelta())},_endSlide:function(){this.PixelImagePainter.setCanvasPosition(this.getPixelSliderDelta()),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._caressSideCallback),this.node.off(cc.Node.EventType.TOUCH_END,this._leaveSideCallback)},_sideTouchEventHandler:function(t){var e=this;return function(i){var n=i.touch.getLocation(),o=i.touch.getDelta();e._sliderDelta.x+=o.x,e._sliderDelta.y+=o.y,cc.log(e._sliderDelta,n),t(n)}},clickOnZoomIn:function(){this._pixelDotSize<20&&this.PixelImagePainter.setCanvasSize(this._contentPixelWidth,this._contentPixelHeight,++this._pixelDotSize)},clickOnZoomOut:function(){this._pixelDotSize>1&&this.PixelImagePainter.setCanvasSize(this._contentPixelWidth,this._contentPixelHeight,--this._pixelDotSize)}}),cc._RF.pop()},{PixelImagePainter:"PixelImagePainter"}],PixelImageEditor:[function(t,e,i){"use strict";cc._RF.push(e,"50f1elo8fpB8rIWuY1f7QAB","PixelImageEditor");t("PixelPackage");cc.Class({extends:cc.Component,properties:{PixelPreview:t("PixelPreview"),PixelContentSlider:t("PixelContentSlider"),PixelImagePainter:t("PixelImagePainter")},onLoad:function(){this.PixelPreview.open(),NAERT.addListener("NotifyPixelCanvasNew",this._pixelCanvasNew.bind(this)),NAERT.addListener("NotifyPixelCanvasEdit",this._pixelCanvasEdit.bind(this))},setCanvasSize:function(t,e,i){this.node.setContentSize(t*i,e*i),this.PixelContentSlider.setContentSize()},_pixelCanvasNew:function(){var t=this.PixelPreview.getInfo();this.setCanvasSize(t.width,t.height,8),this.PixelImagePainter.newCanvas()},_pixelCanvasEdit:function(){var t=this.PixelPreview.getInfo();this.setCanvasSize(t.width,t.height,8),this.PixelImagePainter.editCanvas()},_pixelCanvasSave:function(){var t=this.PixelImagePainter.captureCanvas();this.PixelPreview.previewImage(t)},clickOnSave:function(){this._pixelCanvasSave()},clickOnLoad:function(){this.PixelPreview.open()}}),cc._RF.pop()},{PixelContentSlider:"PixelContentSlider",PixelImagePainter:"PixelImagePainter",PixelPackage:"PixelPackage",PixelPreview:"PixelPreview"}],PixelImageLoader:[function(t,e,i){"use strict";cc._RF.push(e,"3c0e5jlHAxA4ZSkyKH17u46","PixelImageLoader");t("PixelPackage");cc.Class({extends:cc.Component,properties:{PixelCanvasNode:cc.Node,PixelSize:4,Path:""},start:function(){var t=this;this.PixelCanvasNode.active=!1,this.Path&&FirebaseWrapper.read("Pixel/"+this.Path).then(function(e){var i=e.success,n=e.data;if(i){var o=t.node.getComponent("PixelCanvas2")||t.node.addComponent("PixelCanvas2");o.setGridsSize(t.PixelSize,n.hor,n.ver),o.setHexColors(n.hex),t.PixelCanvasNode.active=!0}})},loadTypeList:function(t){var e=this;FirebaseWrapper.read("Pixel/"+t).then(function(t){var i=t.success,n=t.data;i&&Object.keys(n).forEach(function(t){cc.log(n[t]);var i=cc.instantiate(e.PixelCanvasNode);i.parent=e.node,i.active=!0;var o=i.getComponent("PixelCanvas2");o.setGridsSize(e.PixelSize,n[t].hor,n[t].ver),o.setHexColors(n[t].hex)})})}}),cc._RF.pop()},{PixelPackage:"PixelPackage"}],PixelImagePainter:[function(t,e,i){"use strict";var n;function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"2b4d8ijLmdB3qLkhY0uDCtm","PixelImagePainter");var a=cc.Enum({DOT_DRAW:-1,PAINT:-1,MIRROR:-1});cc.Class((o(n={extends:cc.Component,properties:{PixelCanvas:t("PixelCanvas"),RgbColorPicker:t("RgbColorPicker")},onLoad:function(){this._drawType=a.DOT_DRAW,this._sliderDelta={x:0,y:0},EVENT.addListener("NotifyRgbColorPickerPickColor",this._rgbColorPickerPickColor,this)},start:function(){this._rgbColorPickerPickColor()},setCanvasSize:function(t,e,i){this._canvasPixelWidth=t,this._canvasPixelHeight=e,this._pixelDotSize=i,this._tapedTimes=0,this._maximum=t*e,this.PixelCanvas.setPixelLayout(t,e,i),this.node.setContentSize(t*i,e*i),this._setPixelDrawCallback()},setCanvasPosition:function(t){var e=t.x,i=t.y;this.node.setPosition(e,i)},newCanvas:function(){this.PixelCanvas.cleanAllPixelsColor(),this.PixelCanvas.loadingTips(.1,0)},editCanvas:function(){this.PixelCanvas.hexDraw(info.pixels),this.PixelCanvas.loadingTips(.1,0)},captureCanvas:function(){return this.PixelCanvas.hexCapture()},_setPixelDrawCallback:function(){var t=cc.director.getScene().getChildren()[0],e=.5*t.width+this.node.x-this._canvasPixelWidth*this._pixelDotSize*.5+this._sliderDelta.x,i=.5*t.height+this.node.y-this._canvasPixelHeight*this._pixelDotSize*.5+this._sliderDelta.y;this.node.off(cc.Node.EventType.TOUCH_MOVE,this._touchPixelCallback),this._touchPixelCallback=this._pixelTouchEventHandler(e,i),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._touchPixelCallback)},_pixelTouchEventHandler:function(t,e){var i=this,n=this._drawSwitch();return function(o){var a=o.touch.getLocation(),c=i._canvasPixelHeight-Math.floor((a.y-e)/i._pixelDotSize)-1,s=Math.floor((a.x-t)/i._pixelDotSize),r=c*i._canvasPixelHeight+s;!i._checkSameColor(r)&&n(r)}},_checkSameColor:function(t){return!!this.PixelCanvas.rgbDotPick(t)&&this.PixelCanvas.rgbDotPick(t)._val==this._paintingColor._val},_drawSwitch:function(){switch(cc.log("this._drawType:",this._drawType),this._drawType){case a.DOT_DRAW:return this._dot.bind(this);case a.PAINT:return this._paint.bind(this);case a.MIRROR:return this._mirrorDot.bind(this)}},_dot:function(t){this.PixelCanvas.rgbDot(t,this._paintingColor)},_mirrorDot:function(t){var e=this._canvasPixelWidth-1-t%this._canvasPixelWidth;e+=Math.floor(t/this._canvasPixelWidth)*this._canvasPixelWidth,this.PixelCanvas.rgbDot(e,node.color),this.PixelCanvas.rgbDot(t,node.color)},_paint:function(t){this._rgbPaint(t,this._paintingColor)},_rgbPaint:function(t,e,i){if(t>-1&&t<this._maximum){var n=this.PixelCanvas.rgbDotPick(t);i?i._val==n._val&&this._spreadRgbPaint(t,e,i):this._spreadRgbPaint(t,e,n)}},_spreadRgbPaint:function(t,e,i){this.PixelCanvas.rgbDot(t,e),t%this._canvasPixelWidth!=0&&(this._rgbPaint(t-1,e,i),this._rgbPaint(t+1,e,i),this._rgbPaint(t-this._canvasPixelWidth,e,i),this._rgbPaint(t+this._canvasPixelWidth,e,i))},_rgbColorPickerPickColor:function(){this._paintingColor=this.RgbColorPicker.getPaletteColor()},clickOnDotDraw:function(){this._drawType=a.DOT_DRAW},clickOnPaint:function(){this._drawType=a.PAINT},clickOnMirror:function(){this._drawType=a.MIRROR}},"clickOnPaint",function(){this._drawType=a.PAINT,this._setPixelDrawCallback()}),o(n,"clickOnDot",function(){this._drawType=a.DOT_DRAW,this._setPixelDrawCallback()}),n)),cc._RF.pop()},{PixelCanvas:"PixelCanvas",RgbColorPicker:"RgbColorPicker"}],PixelPackage:[function(t,e,i){"use strict";cc._RF.push(e,"f8d1dS8vYRJdJeY4tlWrumH","PixelPackage");var n={};e.exports={layer:function(){return new Promise(function(t,e){FirebaseWrapper.read("Pixel/").then(function(i){var n=i.success,o=i.data;n?t(Object.keys(o)):e([])})})},layerIndex:function(t){return new Promise(function(e,i){FirebaseWrapper.read("Pixel/"+t).then(function(t){var n=t.success,o=t.data;n?e(Object.keys(o)):i([])})})},update:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"layer",e=arguments[1],i=type+"_"+e,o=n[i];return new Promise(function(a,c){o?a(o):e?FirebaseWrapper.read("Pixel/"+t+"/"+e).then(function(t){var e=t.success,o=t.data;e?a(n[i]=o):c("no image")}):c("no name")})},commit:function(t,e,i,n,o){return t&&e&&i&&n&&o?FirebaseWrapper.write("Pixel/"+t+"/"+e,{width:i,height:n,pixels:o}):Promise.reject("input fail")}},cc._RF.pop()},{}],PixelPainter:[function(t,e,i){"use strict";cc._RF.push(e,"cca207iYtZFKrFznSyeM88O","PixelPainter"),cc.Class({extends:cc.Component,properties:{EraserPixelCanvas:t("PixelCanvas2"),SavePixelCanvas:t("PixelCanvas2")},onLoad:function(){this._pencilMode=!0,EVENT.addListener("NotifyRgbColorPickerPickColor",this._notifyRgbColorPickerPickColor,this)},start:function(){return this._pixelCanvas=this.node.getComponentInChildren("PixelCanvas2"),this._pixelCanvas?(this._rgbColorPicker=this.node.getComponentInChildren("RgbColorPicker"),this._rgbColorPicker?(this.setPixelDraw(20,20,30,0),this._notifyRgbColorPickerPickColor(),void this.setBackgroundColor(new cc.Color(100,100,100,0))):cc.error("\u8acb\u5728\u7bc0\u9ede\u4e0b\u65b0\u589e RgbColorPicker")):cc.error("\u8acb\u5728\u7bc0\u9ede\u4e0b\u65b0\u589e PixelCanvas")},_notifyRgbColorPickerPickColor:function(){this._paintingColor=this._rgbColorPicker.getPaletteColor()},setBackgroundColor:function(t){this.node.color=t},setPixelDraw:function(t,e,i){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._pixelCanvas.setGridsSize(t,e,i,o),this.node.setContentSize(this._pixelCanvas.node);var a,c,s=.5*this.node.width-this.node.x+.5*t,r=.5*this.node.height-this.node.y;this.node.on(cc.Node.EventType.TOUCH_START,function(t){return function(t){a=t.x+s,c=t.y+r}(t.touch.getLocation())}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){return function(e){a+=e.x,c+=e.y,a>t&&a-n.node.width<t&&c>0&&c<n.node.height&&(n._pencilMode?n._pixelCanvas.setRgbColor(Math.floor(c/t)*i+Math.floor(a/t)-1,n._paintingColor):n._pixelCanvas.cleanPixelsColor(Math.floor(c/t)*i+Math.floor(a/t)-1))}(e.touch.getDelta())})},onEraserClicked:function(t){this._pencilMode=!this._pencilMode,t.target.color=this._pencilMode?cc.Color.WHITE:cc.Color.GREEN},onSaveClicked:function(t){var e=this._pixelCanvas.getHexColors(),i={hex:e,hor:20,ver:20};if(0!=Object.keys(e).length){cc.log(FirebaseWrapper.push("Pixel/Character",i))}}}),cc._RF.pop()},{PixelCanvas2:"PixelCanvas2"}],PixelPreview:[function(t,e,i){"use strict";cc._RF.push(e,"4a76asud9tClrkhRhaGYPwb","PixelPreview");var n=t("PixelPackage");cc.Class({extends:cc.Component,properties:{LayerEditBox:cc.EditBox,NameEditBox:cc.EditBox,WidthEditBox:cc.EditBox,HeightEditBox:cc.EditBox,DotSizeEditBox:cc.EditBox,CancelButton:cc.Button,SaveButton:cc.Button,LoadButton:cc.Button,EditButton:cc.Button,NewButton:cc.Button,CleanButton:cc.Button,LayerTagsEditbox:t("EditBoxTags"),NameTagsEditbox:t("EditBoxTags"),PixelCanvas:t("PixelCanvas")},onLoad:function(){this._pixelHexColors={}},open:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this.WidthEditBox.string=this._imageWidth=t,this.HeightEditBox.string=this._imageHeight=e,this.DotSizeEditBox.string=this._dotSize=i,this._init()},onLayerEditBoxEnded:function(){var t=this;n.layerIndex().then(function(e){return t.NameTagsEditbox.setData(e)})},onNameEditBoxEnded:function(){this.LoadButton.interactable=!0},onWidthEditBoxEnded:function(t){this._imageWidth=parseInt(t.string,10),this._resize()},onHeightEditBoxEnded:function(t){this._imageHeight=parseInt(t.string,10),this._resize()},onDotSizeEditBoxEnded:function(t){this._dotSize=parseInt(t.string,10),this._resize()},previewImage:function(t){this.node.active=!0;var e=this._pixelHexColors==t;this.CancelButton.interactable=!0,this.SaveButton.interactable=!e,this.LoadButton.interactable=e,this.EditButton.interactable=!0,this.NewButton.interactable=!1,this.CleanButton.interactable=!0,this.PixelCanvas.hexDraw(t),this._pixelHexColors=t},getInfo:function(){return{width:this._imageWidth,height:this._imageHeight,pixels:this._pixelHexColors}},_init:function(){this._resize(),this.PixelCanvas.loadingTips(.1,0),this.PixelCanvas.cleanAllPixelsColor()},_resize:function(){this.PixelCanvas.setPixelLayout(this._imageWidth,this._imageHeight,this._dotSize)},_previewUpload:function(){var t=this;this.PixelCanvas.loadingTips(1,255,"SAVING..."),this.CancelButton.interactable=!1,this.SaveButton.interactable=!1,this.LoadButton.interactable=!1,this.EditButton.interactable=!1,this.NewButton.interactable=!1,this.CleanButton.interactable=!1,n.commit(this.LayerEditBox.string,this.NameEditBox.string,parseInt(this.WidthEditBox.string,10),parseInt(this.HeightEditBox.string,10),parseInt(this.DotSizeEditBox.string,10),this._pixelHexColors).then(function(e){t.PixelCanvas.loadingTips(1,255,e?"SAVED!!!":"FAIL"),t.CancelButton.interactable=!0,t.SaveButton.interactable=!e,t.LoadButton.interactable=!0,t.EditButton.interactable=!0,t.NewButton.interactable=!1,t.CleanButton.interactable=!0}).catch(function(e){t.PixelCanvas.loadingTips(1,0,e),t.CancelButton.interactable=!0,t.SaveButton.interactable=!0,t.LoadButton.interactable=!1,t.EditButton.interactable=!0,t.NewButton.interactable=!1,t.CleanButton.interactable=!0})},_previewUpdate:function(){var t=this;this.PixelCanvas.loadingTips(1,255,"LOADING..."),this.CancelButton.interactable=!1,this.SaveButton.interactable=!1,this.LoadButton.interactable=!1,this.EditButton.interactable=!1,this.NewButton.interactable=!1,this.CleanButton.interactable=!1,n.update(this.LayerEditBox.string,this.NameEditBox.string).then(function(e){t._imageWidth=e.width,t._imageHeight=e.height,t._resize(),t.previewImage(e.pixels),t.PixelCanvas.loadingTips(.3,0)}).catch(function(e){return t.PixelCanvas.loadingTips(.1,255,e)})},onClickOpen:function(){this.open()},onClickClean:function(){this.PixelCanvas.cleanAllPixelsColor(),this._pixelHexColors={},this.CancelButton.interactable=!0,this.SaveButton.interactable=!1,this.LoadButton.interactable=!1,this.EditButton.interactable=!1,this.NewButton.interactable=!0,this.CleanButton.interactable=!1},onClickNew:function(){this._init(),this.node.active=!1,NAERT.dispatchCustomEvent("NotifyPixelCanvasNew")},onClickEdit:function(){this._init(),this.node.active=!1,NAERT.dispatchCustomEvent("NotifyPixelCanvasEdit")},onClickSave:function(){this._previewUpload()},onClickLoad:function(){this._previewUpdate()},onClickClose:function(){this._init(),this.node.active=!1},clickOnReverse:function(){this.PixelCanvas._reverseCanvasDots()},onClickZoomIn:function(){this._dotSize++,this.DotSizeEditBox.string=this._dotSize,this._resize()},onClickZoomOut:function(){this._dotSize>1&&(this._dotSize--,this.DotSizeEditBox.string=this._dotSize,this._resize())}}),cc._RF.pop()},{EditBoxTags:"EditBoxTags",PixelCanvas:"PixelCanvas",PixelPackage:"PixelPackage"}],PixelpainterClientView:[function(t,e,i){"use strict";cc._RF.push(e,"31790vyC8hP1YbVHJtQBKXv","PixelpainterClientView");var n=t("Notifier"),o=t("BargameControl");cc.Class({extends:t("Client"),properties:{GameItems:[cc.Node]},start:function(){},onDestroy:function(){n.removeClient(this)},_init:function(){var t=this;o.setTouchStart(function(e){t.GameItems.some(function(i){return t._distance(e,i)})})},_distance:function(t,e){if(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<100){var i=this._profileData;return i.setRandomRgba(),n.notifyHost("Initiate",{game:e.name,join:1,player:{uniqueid:i.uniqueid,nickname:i.nickname,position:t,rgba:i.rgba}}),o.setTouchStart(null),!0}return!1},handleInitiate:function(t){var e=t;1==e.join&&this._loadUI(e.game,{method:"startGame",event:t})}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client",Notifier:"Notifier"}],ProfileData:[function(t,e,i){"use strict";cc._RF.push(e,"a7ecfSsy25Lerz/Xoa40ake","ProfileData"),cc.Class({ctor:function(){this.uniqueid="",this.nickname="",this.position=cc.v2(0,0),this.rgba={r:255,g:255,b:255,a:255},this.dndRole={}},setIDNickname:function(){var t=(new Date).getTime().toString(16);return this.uniqueid=LocalCache.getItem("user_uniqueid",t),this.nickname=LocalCache.getItem("user_nickname",""),!!this.nickname},setRgba:function(t){var e=t.r,i=t.g,n=t.b,o=t.a,a=void 0===o?255:o;this.rgba={r:e,g:i,b:n,a:a}},setRandomRgba:function(){this.setRgba(this.getRandomColor())},getRandomColor:function(){return[cc.Color.RED,cc.Color.GREEN,cc.Color.YELLOW,cc.Color.ORANGE,cc.Color.CYAN,cc.Color.MAGENTA].sort(function(t){return Math.random()-.5})[0]},setDndRoleData:function(e){var i=new(t("DndRoleData"));this.dndRole[e]=i}}),cc._RF.pop()},{DndRoleData:"DndRoleData"}],RangeBar:[function(t,e,i){"use strict";cc._RF.push(e,"7d711FiU3xMvaboH3lJE/rh","RangeBar"),cc.Class({extends:cc.Component,properties:{Dot:cc.Node,Label:cc.Label,ScrollViewer:cc.ScrollView},onLoad:function(){var t=cc.director.getScene().children[0];this.Dot.active=!1,this._halfWidth=.5*t.width,this._halfHeight=.5*t.height},startUp:function(t,e,i,n,o,a){this._valueName=t,this._notifyName=e,this._lowNumber=i,this._startNumber=n,this._limitNumber=o,this._enabledHeight=a,this._oriHeight=this.node.height,this._gap=a/(o-i),this.Label.string=n+"\n"+t,this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchRangeBegin,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchRangeMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchRangeEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchRangeCancel,this)},finish:function(){return this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchRangeBegin,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchRangeMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchRangeEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchRangeCancel,this),this._range},_onTouchRangeBegin:function(t){var e=t.touch.getLocation();e={x:e.x-this._halfWidth,y:e.y-this._halfHeight},this._startPoint=e,this.Dot.active=!0,this.Dot.setPosition(e),this.node.height=this._enabledHeight,this.ScrollViewer.enabled=!1},_onTouchRangeMoved:function(t){var e=t.touch.getLocation();e={x:0,y:e.y-this._halfHeight},this.Dot.setPosition(e),this._range=Math.max(this._lowNumber,Math.min(this._limitNumber,Math.round((e.y-this._startPoint.y)/this._gap)+this._startNumber)),this.Label.string=this._range+"\n"+this._valueName,this.Label.node.setPosition(0,e.y+20)},_onTouchRangeEnd:function(){this._onEnded()},_onTouchRangeCancel:function(){this._onEnded()},_onEnded:function(){this.Dot.active=!1,this.node.height=this._oriHeight,this.Label.string=this._range+"\n"+this._valueName,this._startNumber=this._range,this.Label.node.setPosition(0,0),NAERT.dispatchCustomEvent(this._notifyName,this._range),this.ScrollViewer.enabled=!0}}),cc._RF.pop()},{}],RgbColorPicker:[function(t,e,i){"use strict";cc._RF.push(e,"6e5ac4lCZ1LC4ddv1FL//Zh","RgbColorPicker"),cc.Class({extends:cc.Component,properties:{PaletteLayout:cc.Node,PaletteNode:cc.Node,PreviewNode:cc.Node,LightBoxNode:cc.Node,SaveColorBtnNode:cc.Node,RgbPalette:t("RgbPalette")},onLoad:function(){this._paletteColors=[new cc.Color(0,0,0),new cc.Color(0,0,0),new cc.Color(255,255,255),new cc.Color(255,0,0),new cc.Color(0,255,0),new cc.Color(0,0,255)],this.PaletteLayout.children[0].color=this._paletteColors[0],this._expandCallback=this._expand.bind(this),this.PaletteLayout.on(cc.Node.EventType.TOUCH_START,this._expandCallback),this._collapse()},getPaletteColors:function(){return this._paletteColors},getPaletteColor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._paletteColors[t]},getPixelRgbColor:function(t,e,i){var n=4*(i*t.width+e),o=t.data;return[o[n],o[n+1],o[n+2],o[n+3]]},_collapse:function(){var t=this.PaletteNode.width,e=this.PaletteLayout.getChildren();this.PaletteLayout.setContentSize(t,t),e.forEach(function(t,e){return t.active=0==e}),this.PaletteLayout.off(cc.Node.EventType.TOUCH_MOVE,this._caressPixelCallback),this.PaletteLayout.off(cc.Node.EventType.TOUCH_END,this._touchPixelCallback),this.LightBoxNode.active=!1,this.PreviewNode.active=!1,e[0].setScale(1,1)},_expand:function(){var t=this,e=this.PaletteLayout.getChildren();this._paletteColors.forEach(function(i,n){var o=e[n];o||((o=cc.instantiate(t.PaletteNode)).parent=t.PaletteLayout),o.active=!0,o.color=i});var i=Math.ceil(Math.sqrt(this._paletteColors.length))*this.PaletteNode.width;this.PaletteLayout.setContentSize(i,i),this._caressPixelCallback=this._gridTouchEventHandler(this._previewColor),this._touchPixelCallback=this._gridTouchEventHandler(this._pickColor),this.PaletteLayout.on(cc.Node.EventType.TOUCH_MOVE,this._caressPixelCallback),this.PaletteLayout.on(cc.Node.EventType.TOUCH_END,this._touchPixelCallback),this.LightBoxNode.active=!0,e[0].setScale(.8,.8)},_gridTouchEventHandler:function(t){var e=this,i=this.PaletteLayout.height,n=this.PaletteNode.width,o=Math.floor(i/n);return function(i){var a=i.touch.getLocation(),c=Math.floor(a.x/n)+Math.floor(a.y/n)*o;t.call(e,c,a)}},_previewColor:function(t,e){var i=this._paletteColors[t];i&&(this.PreviewNode.setPosition(e.x,e.y+50),this.PreviewNode.active=!0,this.PreviewNode.children[0].color=i)},_pickColor:function(t){if(this.PreviewNode.active=!1,this._collapse(),!t)return this.RgbPalette.addToStage(),this.RgbPalette.setColor(new cc.Color(this._paletteColors[t])),void(this.SaveColorBtnNode.active=!0);var e=this._paletteColors[t];this.PaletteLayout.children[0].color=this._paletteColors[0]=e,EVENT.dispatchNotify("NotifyRgbColorPickerPickColor")},clickOnSaveNewColor:function(){var t=this.RgbPalette.pickRbgColor(),e=t._val;this._paletteColors.every(function(t){return t._val!=e})&&this._paletteColors.push(t),this.PaletteLayout.children[0].color=t,this.RgbPalette.behindStage(),this.SaveColorBtnNode.active=!1,this._collapse()}}),cc._RF.pop()},{RgbPalette:"RgbPalette"}],RgbPalette:[function(t,e,i){"use strict";cc._RF.push(e,"87997bi/mNPJ5HKICY1p8CW","RgbPalette"),cc.Class({extends:cc.Component,properties:{PreviewNode:cc.Node,RedLayout:cc.Node,RedNode:cc.Node,GreenLayout:cc.Node,GreenNode:cc.Node,BlueLayout:cc.Node,BlueNode:cc.Node,RedNumericalLift:t("NumericalLift"),GreenNumericalLift:t("NumericalLift"),BlueNumericalLift:t("NumericalLift")},setColor:function(t){var e=this,i=t.r,n=t.g,o=t.b,a=this.PreviewNode;a.color=new cc.Color(i,n,o);var c={Red:i,Green:n,Blue:o},s=function(){a.stopAllActions(),a.runAction(cc.sequence(cc.scaleTo(.1,.8,.8),cc.spawn(cc.tintTo(.2,c.Red,c.Green,c.Blue),cc.scaleTo(.2,1.5,1.5).easing(cc.easeInOut(3))),cc.scaleTo(.2,1,1).easing(cc.easeInOut(3))))},r=function(){a.stopAllActions(),a.runAction(cc.tintTo(.2,c.Red,c.Green,c.Blue))},l=function(t,e,i,n,o){var a=this[t+"Layout"],c=this[t+"Node"],s=a.children.find(function(t){return!t.active});s||((s=cc.instantiate(c)).parent=a),s.active=!0,s.opacity=n,s.setPosition(e),s.stopAllActions(),s.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,i.x,i.y),cc.fadeTo(.2,180),cc.scaleTo(.4,2,2).easing(cc.easeInOut(3))),cc.spawn(cc.scaleTo(.2,.2,.2).easing(cc.easeInOut(3)),cc.fadeTo(.2,0),cc.callFunc(o))))}.bind(this);Object.keys(c).forEach(function(t){var i=e[t+"NumericalLift"],n=c[t];i.setParam({num:n,callback:function(e){var n=i.node;c[t]<e?l(t,n,a,255,s):c[t]>e&&l(t,a,n,255,r),c[t]=e}})}),this._rgbColor=c},addToStage:function(){this.node.active=!0},behindStage:function(){this.node.active=!1},pickRbgColor:function(){return new cc.Color(this._rgbColor.Red,this._rgbColor.Green,this._rgbColor.Blue)}}),cc._RF.pop()},{NumericalLift:"NumericalLift"}],RoleCardData:[function(t,e,i){"use strict";cc._RF.push(e,"ce3a1+NWzBGspA/pBzaJ7Qr","RoleCardData"),cc.Class({ctor:function(){this.ability={"\u529b\u91cf":1,"\u654f\u6377":1,"\u7cbe\u795e":1,"\u667a\u6167":1}}}),cc._RF.pop()},{}],RoleList:[function(t,e,i){"use strict";cc._RF.push(e,"18b76006BdDyLPSDkE/4VFr","RoleList");t("Notifier");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this._selectedNode=null},pushRole:function(t){t.parent=this.node,t.active=!0},removeRole:function(t){this.node.children.find(function(e){return e==t&&e.destroy()})},onRoleBoardClicked:function(t){this._selectedNode=t.target}}),cc._RF.pop()},{Notifier:"Notifier"}],SiegeMagnetic:[function(t,e,i){"use strict";cc._RF.push(e,"58a1bHjAPZJOaKnbY0QUwJ2","SiegeMagnetic");var n=t("BargameControl");cc.Class({extends:t("Client"),properties:{TouchPointNode:cc.Node,Enermies:[cc.Node]},onLoad:function(){this._level=0},startGame:function(t){var e=this,i=this.TouchPointNode;n.setTouchMove(function(t){i.setPosition(i.x+t.x,i.y+t.y)});var o=0;this.schedule(function(t){e._level<e.Enermies.length&&(e._addEnermy(i),++o>=3*(e._level+1)&&e._level++)},5),EVENT.addListener("NotifyEventDone",function(){n.setTouchMove(null),e.node.destroy()},this)},_addEnermy:function(t){var e=cc.instantiate(this.Enermies[this._level]);cc.log(this.node),e.parent=this.node,e.active=!0,e.setPosition(1e3*Math.random()%640,1e3*Math.random()%960),e.getComponent("BulletEnermy").lookAt(this.TouchPointNode)}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client"}],SwitchToggle:[function(t,e,i){"use strict";cc._RF.push(e,"329d1j2261JrLzsIHvwpCSC","SwitchToggle"),cc.Class({extends:cc.Component,properties:{Background:cc.Node,Label:cc.Label},onLoad:function(){this._isToggle=!1,this._colorList=[this.Background.color,this.Label.node.color],this._callback=null},setParam:function(t){var e=t.callback;this._callback=e},getParam:function(){return{isToggle:this._isToggle}},onToggleClicked:function(){this._isToggle=!this._isToggle,this._isToggle?(this.Background.color=this._colorList[1],this.Label.node.color=this._colorList[0]):(this.Background.color=this._colorList[0],this.Label.node.color=this._colorList[1]),this._callback&&this._callback()}}),cc._RF.pop()},{}],Throw:[function(t,e,i){"use strict";cc._RF.push(e,"f8d20iHQLBMDK9DAoKdGmhH","Throw");var n=function(t,e,i){return i?{x:t.x+1e-4*Math.floor(i*Math.cos(e*Math.PI/180)*1e4),y:t.y+1e-4*Math.floor(i*Math.sin(e*Math.PI/180)*1e4)}:t},o=function(t,e){return Math.abs(t)>.001?t-=t*e:0};e.exports={prediction:function(t,e,i,a){for(var c={x:t.x,y:t.y},s=0;i>.05;)c=n(c,e,i),i=o(i,a),s++;return cc.log(s),c},angle:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)/Math.PI*180},project:n,retard:o},cc._RF.pop()},{}],TouchPoint:[function(t,e,i){"use strict";cc._RF.push(e,"a8696nCmcpHpqJsivD1cTGI","TouchPoint"),cc.Class({extends:cc.Component,properties:{ColorBackground:cc.Node,SideCircle:cc.Node,SideColorBackground:cc.Node,NicknameLabel:cc.Label},setParam:function(t){var e=t.nickname,i=t.position,n=t.rgba;this.ColorBackground.color=new cc.Color(n),this.SideColorBackground.color=new cc.Color(n),this.NicknameLabel.string=e,this.node.setPosition(i),this.node.setScale(.1),this.node.runAction(cc.scaleTo(.3,1).easing(cc.easeInOut(2.2))),this.select(!1)},select:function(t){this.SideCircle.active=t}}),cc._RF.pop()},{}]},{},["Client","Hoster","Notifier","BargameControl","ControlMain","DataModal","DndGameEnum","DndRoleData","GameEnum","ProfileData","RoleCardData","ChatBar","MessageBox","MessageLine","MessageManager","MessageView","CanvasResize","EditBoxTags","EventButton","EventRemover","Identitiy","NodeResize","RangeBar","Throw","TouchPoint","DndClientView","NumericalLift","SwitchToggle","DndAbilityItem","DndCharacterSheet","DndChoiceItem","DndEditItem","DndExemptionItem","DndSkillItem","DndMapRole","MapGrid","MapGridItem","RoleList","FingerpartyClientView","FingerpartyCountPicker","FingerparytRoulette","PixelCanvas","PixelCanvas2","PixelContentSlider","PixelImageEditor","PixelImageLoader","PixelImagePainter","PixelPackage","PixelPainter","PixelPreview","PixelpainterClientView","RgbColorPicker","RgbPalette","SiegeMagnetic"]);