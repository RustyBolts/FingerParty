window.__require=function t(e,i,n){function o(s,c){if(!i[s]){if(!e[s]){var r=s.split("/");if(r=r[r.length-1],!e[r]){var l="function"==typeof __require&&__require;if(!c&&l)return l(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+s+"'")}}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){return o(e[s][1][t]||t)},h,h.exports,t,e,i,n)}return i[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<n.length;s++)o(n[s]);return o}({BargameControl:[function(t,e,i){"use strict";cc._RF.push(e,"e2105XNwNxAXIGDgEld0gJR","BargameControl");var n=null;cc.Class({extends:cc.Component,statics:{setTouchStart:function(t){n&&(n._touchStartCallback=t)},setTouchMove:function(t){n&&(n._touchMoveCallback=t)},setTouchEnd:function(t){n&&(n._touchEndCallback=t)},cleanAllTouch:function(){n&&n._clearTouchCallback()}},onLoad:function(){var t=this;n=this,this._clearTouchCallback(),this._startHandler=function(e){var i=e.touch;return t._touchStartCallback&&t._touchStartCallback(i.getLocation())},this._moveHandler=function(e){var i=e.touch;return t._touchMoveCallback&&t._touchMoveCallback(i.getDelta())},this._endHandler=function(e){var i=e.touch;return t._touchEndCallback&&t._touchEndCallback(i.getLocation())};var e=this.node;e.on(cc.Node.EventType.TOUCH_START,this._startHandler,this),e.on(cc.Node.EventType.TOUCH_MOVE,this._moveHandler,this),e.on(cc.Node.EventType.TOUCH_END,this._endHandler,this),e.on(cc.Node.EventType.TOUCH_CANCEL,this._endHandler,this)},onDestroy:function(){var t=this.node;t.off(cc.Node.EventType.TOUCH_START,this._startHandler,this),t.off(cc.Node.EventType.TOUCH_MOVE,this._moveHandler,this),t.off(cc.Node.EventType.TOUCH_END,this._endHandler,this),t.off(cc.Node.EventType.TOUCH_CANCEL,this._endHandler,this),this._clearTouchCallback()},_clearTouchCallback:function(){this._touchStartCallback=null,this._touchMoveCallback=null,this._touchEndCallback=null}}),cc._RF.pop()},{}],BinanceApp:[function(t,e,i){"use strict";cc._RF.push(e,"20cdefxd05J/IoJDAOtfFYM","BinanceApp"),cc.Class({ctor:function(){}}),cc._RF.pop()},{}],BlackHole:[function(t,e,i){"use strict";cc._RF.push(e,"1d4f8XFtIBACqlMCI1uihzJ","BlackHole"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this._targetList=null},lookAt:function(t){this._targetList.push(t)}}),cc._RF.pop()},{}],BulletBall:[function(t,e,i){"use strict";cc._RF.push(e,"ab7bf2hrdtAwLr6Q8oV6ezp","BulletBall");var n=t("Throw");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.target=null,this._angle=0,this._magnitude=0,this._count=0},lookAt:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500;this.target=t,this._angle=e,this._magnitude=i,this._count=n},update:function(){this._count>0?(this.node.setPosition(n.project(this.node,this._angle,this._magnitude)),this._distance(this.node,this.target),this._count--):this.node.destroy()},_distance:function(t,e){Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<50&&EVENT.dispatchNotify("NotifyEventDone")}}),cc._RF.pop()},{Throw:"Throw"}],BulletClientView:[function(t,e,i){"use strict";cc._RF.push(e,"c0f1dDRPwpOzp/as+ui5eV7","BulletClientView"),cc.Class({extends:cc.Component,properties:{MoveTarget:t("Move")},onLoad:function(){var e=this;t("BargameControl").setTouchStart(function(t){return e.onPress(t)}),t("BargameControl").setTouchMove(function(t){return e.onMove(t)}),t("BargameControl").setTouchEnd(function(t){return e.onRelease(t)})},onPress:function(){this.MoveTarget.maxForce(6).gravity(-5).retard(.9).run()},onMove:function(t){this.MoveTarget.addForce(t.x)},onRelease:function(){this.MoveTarget.throw()}}),cc._RF.pop()},{BargameControl:"BargameControl",Move:"Move"}],BulletEnermy:[function(t,e,i){"use strict";cc._RF.push(e,"0bf194PI5lG5Izwsf4/FUt/","BulletEnermy"),cc.Class({extends:cc.Component,properties:{}}),cc._RF.pop()},{}],CanvasResize:[function(t,e,i){"use strict";cc._RF.push(e,"f0150BCF7lLjqr/PB1lQcIS","CanvasResize"),cc.Class({extends:cc.Component,onLoad:function(){var t=this.node.getComponent(cc.Canvas);t.designResolution=cc.size(t.width,t.height)}}),cc._RF.pop()},{}],CardSlider:[function(t,e,i){"use strict";cc._RF.push(e,"864c4A8Q6VBTr2FLbOFTcBG","CardSlider"),cc.Class({extends:cc.Component,properties:{CardRoot:cc.Node,CardNode:cc.Node,PageView:cc.PageView},onLoad:function(){var t=this;this._startHandler=function(e){var i=e.touch;return t._touchStartCallback&&t._touchStartCallback(i.getLocation())},this._moveHandler=function(e){var i=e.touch;return t._touchMoveCallback&&t._touchMoveCallback(i.getDelta())},this._endHandler=function(e){var i=e.touch;return t._touchEndCallback&&t._touchEndCallback(i.getLocation())};var e=this.node;e.on(cc.Node.EventType.TOUCH_START,this._startHandler,this),e.on(cc.Node.EventType.TOUCH_MOVE,this._moveHandler,this),e.on(cc.Node.EventType.TOUCH_END,this._endHandler,this),e.on(cc.Node.EventType.TOUCH_CANCEL,this._endHandler,this),EVENT.addListener("NotifyEventCardSortOut",this._notifyEventCardSortOut,this)},start:function(){this.CardNode.active=!1},onDestroy:function(){var t=this.node;t.off(cc.Node.EventType.TOUCH_START,this._startHandler,this),t.off(cc.Node.EventType.TOUCH_MOVE,this._moveHandler,this),t.off(cc.Node.EventType.TOUCH_END,this._endHandler,this),t.off(cc.Node.EventType.TOUCH_CANCEL,this._endHandler,this)},setParam:function(t){var e=t.length,i=this.CardRoot.getChildren(),n=this._colorListGenertor().sort(function(t){return Math.random()-.5});if(n.length<e)return cc.error("\u984f\u8272\u4e0d\u5920\u7528\u54e6~");this._dataList=t;for(var o=0;o<e;o++){if(this._dataList[o].color=n.shift(),!i[o]){var a=cc.instantiate(this.CardNode);a.name="card_"+(o+1),a.addComponent("EventCard"),this.PageView.addPage(a)}i[o].active=!0,this._setEventCardParam(i[o],o)}this.onCardChange(this.PageView)},clear:function(){this._dataList=[],this.PageView.removeAllPages()},addCard:function(t){var e=this._dataList.length,i=this.CardRoot.getChildren(),n=this._colorListGenertor().sort(function(t){return Math.random()-.5});if(t.color=n.shift(),this._dataList.push(t),!i[e]){var o=cc.instantiate(this.CardNode);o.name="card_"+(e+1),o.addComponent("EventCard"),this.PageView.addPage(o)}i[e].active=!0,this._setEventCardParam(i[e],e),cc.log("index:",e),this.PageView.setCurrentPageIndex(e),this.onCardChange(this.PageView)},_colorListGenertor:function(){for(var t=[],e=0;e<6;e++)for(var i=0;i<6;i++)for(var n=0;n<6;n++)t.push(new cc.Color(51*e,51*i,51*n));return t},_notifyEventCardSortOut:function(t){var e=this,i=t.index,n=this._dataList.splice(i,1);this._dataList.unshift(n[0]),this.CardRoot.children.forEach(function(t,i){return e._setEventCardParam(t,i)})},_setEventCardParam:function(t,e){var i=this._dataList[e],n=i.player,o=i.text,a=i.color,s=i.type;t.getComponent("EventCard").setParam({index:e,player:n,text:o,color:a,type:s})},onCardChange:function(t){var e=t.getPages()[t.getCurrentPageIndex()],i=e.getComponent("EventCard")||e.addComponent("EventCard");this._touchStartCallback=i.touchCard.bind(i),this._touchMoveCallback=i.moveCard.bind(i),this._touchEndCallback=i.releaseCard.bind(i),cc.log("pageView.curpage",t.getCurrentPageIndex())}}),cc._RF.pop()},{}],ChatBar:[function(t,e,i){"use strict";cc._RF.push(e,"1eda2p7WL5I+IYBDVTkPvMY","ChatBar");var n=t("Notifier");cc.Class({extends:cc.Component,properties:{Input:cc.EditBox},onLoad:function(){this._profileData=t("DataModal").getInstance().profileData},onSendClicked:function(){if(""!=this.Input.string){var t=this.Input.string.split("\n\n"),e=HASH.isHost?"":this._profileData.uniqueid;t.forEach(function(t){n.notifyHost("utter",{player:e,text:t})}),this.Input.string=""}}}),cc._RF.pop()},{DataModal:"DataModal",Notifier:"Notifier"}],ChatClientView:[function(t,e,i){"use strict";cc._RF.push(e,"c398fLX9d9M8aCu6kE++Ina","ChatClientView");var n=t("GameEnum"),o=t("Notifier"),a=null;cc.Class({extends:t("Client"),statics:{open:function(t,e,i){if(a)e?a[e](i):a.open();else{cc.loader.loadRes("prefabs/board/ChatClientView",function(n,o){if(n)return cc.error(n);var s=cc.instantiate(o);s.parent=t,a=s.getComponent("ChatClientView"),e&&a[e](i)}.bind(this))}}},properties:{ChatMessage:t("ChatMessage"),ChatInputBar:cc.Node,NameLabel:cc.Label,MessageEditbox:cc.EditBox,DescribeEditbox:cc.EditBox},start:function(){this._profileData=t("DataModal").getInstance().profileData,this._game=n.Games.Chat,this._isExtend=!1,this.ChatMessage.extend(this._isExtend),this.ChatInputBar.active=this._isExtend},onDestroy:function(){this._super(),a=null},setParam:function(t){var e=t.game;this._game=e},setName:function(t){this.NameLabel.string=t},_processMessage:function(){var t=this.NameLabel.string,e=this.MessageEditbox.string,i=this.DescribeEditbox.string;return this.MessageEditbox.string="",this.DescribeEditbox.string="",i&&e?"\u300c"+e+"\u300d"+t+" "+i:i?t+" "+i:e?t+":\u300c"+e+"\u300d":void 0},onExtendClicked:function(){this._isExtend=!this._isExtend,this.ChatMessage.extend(this._isExtend),this.ChatInputBar.active=this._isExtend,this.NameLabel.string="player"},onSendClicked:function(){var e=this._processMessage();if(e){var i=this._profileData,a=i.uniqueid,s=i.nickname,c=i.rgba;s=this.NameLabel.string,o.request("Utter",{game:n.GameName[this._game],message:e,player:{uniqueid:a,nickname:s,rgba:c}})}else t("CommonDialog").addDialog("CommonDialogView",{text:"\u8acb\u8f38\u5165\u8a0a\u606f\u5f8c\u518d\u9001\u51fa",buttons:[{text:"\u78ba\u5b9a"}],showClose:!1})}}),cc._RF.pop()},{ChatMessage:"ChatMessage",Client:"Client",CommonDialog:"CommonDialog",DataModal:"DataModal",GameEnum:"GameEnum",Notifier:"Notifier"}],ChatMessage:[function(t,e,i){"use strict";cc._RF.push(e,"4b029fpCTpJQq++xGWX2c5p","ChatMessage");t("Notifier");cc.Class({extends:t("Client"),properties:{TestLabel:cc.Label,label:cc.Label},onLoad:function(){this._super(),this._oriHeight=this.node.height},extend:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t?this._oriHeight:100;i?cc.tween(this.node).to(.2,{height:n}).call(function(){return e.node.getComponentInChildren(cc.ScrollView).scrollToBottom()}).start():this.node.height=n},handleUtter:function(t){var e=t.message;this.TestLabel.string+="\n"+e,this.node.getComponentInChildren(cc.ScrollView).scrollToBottom()}}),cc._RF.pop()},{Client:"Client",Notifier:"Notifier"}],Client:[function(t,e,i){"use strict";cc._RF.push(e,"8ea0aihpz5Ai5PEBaFAQn6Y","Client");var n=t("Notifier");cc.Class({extends:cc.Component,onLoad:function(){n.mapClient(this)},onDestroy:function(){n.removeClient(this)},handleGetURL:function(t){t.url},handleJoinRoom:function(t){},handleInitiate:function(t){},handleInactive:function(t){},handleChairShuffle:function(){},handleAbort:function(t){t.player},_loadUI:function(t,e){cc.loader.loadRes("prefabs/board/"+t,function(i,n){if(i)return cc.error(i);var o=cc.instantiate(n);o.parent=this.node,e&&o.getComponent(t)[e.method](e.event)}.bind(this))}}),cc._RF.pop()},{Notifier:"Notifier"}],CommonDialogView:[function(t,e,i){"use strict";cc._RF.push(e,"ca600m6AgNI25my2hXHDrn3","CommonDialogView"),cc.Class({extends:cc.Component,properties:{ContentLabel:cc.Label,InputEditbox:cc.EditBox},setParam:function(t){var e=t.text,i=t.placeholder;this.ContentLabel.node.active=!!e,e&&(this.ContentLabel.string=e),this.InputEditbox.node.active=!!i,i&&(this.InputEditbox.placeholder=i)},getParam:function(){return{text:this.InputEditbox?this.InputEditbox.string||this.InputEditbox.placeholder:""}}}),cc._RF.pop()},{}],CommonDialog:[function(t,e,i){"use strict";cc._RF.push(e,"40630bRNNdNm4pzaW1vUqqo","CommonDialog");var n=t("DialogManager"),o=null;cc.Class({extends:cc.Component,statics:{addDialog:function(t,e){cc.loader.loadRes("prefabs/dialog/commonDialog/"+t,function(i,o){if(i)return cc.error(i);e.componentView=cc.instantiate(o).getComponent(t),n.addDialog("CommonDialog",e)}.bind(o))},closeDialog:function(){o&&(o.close(),n.closeDialog(o))}},properties:{BackgroundNode:cc.Node,CloseButton:t("EventButton"),ContentNode:cc.Node,ViewNode:cc.Node,EventButton:cc.Node},onLoad:function(){o=this},setParam:function(t){var e=this,i=t.componentView,n=t.buttons,o=t.showClose;i.setParam(t),i.node.parent=this.ViewNode,this.CloseButton.node.active=o,o&&this.CloseButton.setParams("",this.close.bind(this)),this.EventButton.active=!1;var a=function(t){var n=t.text,o=t.callback,a=cc.instantiate(e.EventButton);return a.parent=e.EventButton.parent,a.active=!0,a.getComponent("EventButton").setParams(n,function(){var t=i.getParam?i.getParam():null;o&&o(t),e.close()}),a};n&&n.forEach(function(t){return a(t)}),this._param=t},show:function(){this._showAnimation()},close:function(){cc.isValid(this.BackgroundNode)&&this._closeAnimation()},_showAnimation:function(){this.BackgroundNode.opacity=0,cc.tween(this.BackgroundNode).to(.2,{opacity:150}).start(),this.ContentNode.setScale(.1),this.ContentNode.opacity=0,cc.tween(this.ContentNode).to(.3,{scale:1,opacity:255}).start()},_closeAnimation:function(){var t=this;cc.tween(this.BackgroundNode).to(.1,{opacity:0}).start(),cc.tween(this.ContentNode).to(.1,{scale:.1,opacity:0}).call(function(){n.closeDialog(t),t.node.destroy()}).start()},onCloseClicked:function(){this._closeAnimation()}}),cc._RF.pop()},{DialogManager:"DialogManager",EventButton:"EventButton"}],ControlMain:[function(t,e,i){"use strict";cc._RF.push(e,"93a33m1NEhJFJKVYP46lhyO","ControlMain"),cc.Class({extends:cc.Component,properties:{Target:cc.Node,Enermies:[cc.Node]},onLoad:function(){},start:function(){var t=this,e=this.node,i=this.Target,n=cc.Node.EventType;i.active=!0,this.Enermies.forEach(function(t){return t.getComponent("MagneticBall").lookAt(i)}),e.on(n.TOUCH_MOVE,function(e){var n=e.touch.getDelta();i.setPosition(i.x+n.x,i.y+n.y),t.Enermies.forEach(function(t){Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2),2)<100?t.color=cc.Color.RED:t.color=cc.Color.WHITE})})},onDestroy:function(){}}),cc._RF.pop()},{}],DataModal:[function(t,e,i){"use strict";cc._RF.push(e,"1296bDteI9PLZb5OXlnGByu","DataModal");var n=null,o=cc.Class({statics:{getInstance:function(){return n||(n=new o),n}},ctor:function(){var e=t("ProfileData");this.profileData=new e}});cc._RF.pop()},{ProfileData:"ProfileData"}],DialogManager:[function(t,e,i){"use strict";cc._RF.push(e,"c2966s7kg9N4ZtkKIJjP5Ob","DialogManager");var n=null,o=[];cc.Class({extends:cc.Component,statics:{addDialog:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n&&cc.loader.loadRes("prefabs/dialog/"+t,function(o,a){if(o)return cc.error(o);e.dialog=cc.instantiate(a).getComponent(t),n.addDialog(e,i)}.bind(n))},closeDialog:function(t){n&&n.closeDialog(t)},closeAllDialog:function(){n&&(o.length=0,o.forEach(function(t){return n.closeDialog(o.dialog)}))}},onLoad:function(){n=this},addDialog:function(t,e){o.push(t),1!==o.length&&e||this.showDialog(t)},showDialog:function(t){if(t){var e=t.dialog;e.node.parent=this.node,e.setParam(t),e.show(),this._currDialog=e}},closeDialog:function(t){var e,i=this;t?e=o.findIndex(function(e){return e.dialog==t}):this._currDialog&&(this._currDialog.close(),e=o.findIndex(function(t){return t.dialog==i._currDialog})),o.splice(e,1),o.length>0&&this.showDialog(o[0])}}),cc._RF.pop()},{}],DndAbilityItem:[function(t,e,i){"use strict";cc._RF.push(e,"40c1awEqUdH5LMCmDoJUNyb","DndAbilityItem"),cc.Class({extends:t("DndEditItem"),properties:{NameLabel:cc.Label,AdjustmentLabel:cc.Label,NumberLabel:cc.Label,NumericalLift:t("NumericalLift")},onLoad:function(){this._valueName=""},setParam:function(t,e){this._valueName=t,this._dndRoleData=e;var i=this._dndRoleData.ability[this._valueName];this.NameLabel.string=i.label,this.NumberLabel.string=i.value.toString(),this._adjustmentValue(i.adjustment)},edit:function(t){var e=this,i=this._dndRoleData.ability[this._valueName];this.NumericalLift.node.active=t,t&&this.NumericalLift.setParam({num:i.value,callback:function(){e._dndRoleData.setAbility(e._valueName,e.NumericalLift.getParam().num),e._adjustmentValue(i.adjustment)}})},_adjustmentValue:function(t){this.AdjustmentLabel.string=t>-1?"+"+t:t},onClicked:function(){EVENT.dispatchNotify("NotifyFinishSetting"),this.NumericalLift.node.active=!0}}),cc._RF.pop()},{DndEditItem:"DndEditItem",NumericalLift:"NumericalLift"}],DndBattleMap:[function(t,e,i){"use strict";cc._RF.push(e,"7cb25D+1D9Cl5kN2OuOJ74t","DndBattleMap");var n="DndBattleMap",o=t("Notifier");cc.Class({extends:t("Client"),properties:{MapGridRoot:cc.Node,MapGridItem:cc.Node,CharacterIconNode:cc.Node,DndStrategyMap:t("DndStrategyMap")},start:function(){this._roleList={},this._currPos=0,this.showUI(!1),EVENT.addListener("NotifyOpenBattleMap",this._notifyOpenBattleMap,this),EVENT.addListener("NotifyClickMapGridItem",this._notifyClickMapGridItem,this),EVENT.addListener("NotifyCharacterIconSelect",this._notifyCharacterIconSelect,this),EVENT.addListener("NotifyCharacterIconRemove",this._notifyCharacterIconRemove,this)},onDestroy:function(){},clear:function(){this._roleList={},this._selectedID="",this._currPos=-1,this._oriNodeSize=0,this._curSelectedItem=null},showUI:function(t){this.node.children.forEach(function(e){return e.active=t})},handleJoinRoom:function(t){var e=t.game,i=t.url,o=t.grid;if(e==n){this._grid=o,this.showUI(!0);var a=this.MapGridRoot,s=this.MapGridItem;a.children.forEach(function(t,e){return e>0&&t.destroy()});var c=a.getComponent(cc.Sprite);cc.loader.load({url:i,type:"png"},function(t,e){if(t)return cc.error(t);c.spriteFrame=new cc.SpriteFrame(e);var i=cc.size(o,o);s.active=!0,s.getComponent("MapGridItem").setGridSize(i,2).setOpacity(70).setSelectedColor(cc.Color.WHITE);for(var n=a.getContentSize(),r=n.width/o*n.height/o,l=1;l<r;l++){cc.instantiate(s).parent=a}}),this.DndStrategyMap.showUI(!1)}},handleLeaveRoom:function(t){t.game==n&&(this.showUI(!1),this.clear(),this.DndStrategyMap.showUI(!0),EVENT.dispatchNotify("NotifyLeaveRoom"))},handleInactive:function(t){var e=t.game,i=t.role,o=t.uniqueid;if(e==n){var a=cc.instantiate(this.CharacterIconNode);a.active=!0,a.name=o,this._roleList[o]=a,this.MapGridRoot.children[i.pos].getComponent("MapGridItem").setNodeIn(a),a.getComponent("DndCharacterIcon").setParam({name:i.name,image:{gridSize:2,horizontal:i.hor,vertical:i.ver,hex:i.hex}}),this._currPos=i.pos}},handleMove:function(t){var e=t.game,i=t.pos,o=t.uniqueid;e==n&&this.MapGridRoot.children[i.next].getComponent("MapGridItem").setNodeIn(this._roleList[o])},handleLeave:function(t){var e=t.game,i=t.uniqueid;e==n&&(this._roleList[i].destroy(),delete this._roleList[i],this._selectedID===i&&(this._selectedID=""),EVENT.dispatchNotify("NotifyLeaveRoom",i))},_notifyClickMapGridItem:function(t){var e=t;if(e.getSelectedColor()._val===cc.Color.WHITE._val)return this._curSelectedItem&&this._curSelectedItem.setSelectedColor(cc.Color.WHITE),this._curSelectedItem=e,e.setSelectedColor(cc.Color.RED);this._curSelectedItem&&this._curSelectedItem.setSelectedColor(cc.Color.WHITE),this._curSelectedItem=e;var i=e.node.getSiblingIndex();this._selectedID&&o.request("Move",{game:n,pos:{curr:this._currPos,next:i},uniqueid:this._selectedID}),this._currPos=i},_notifyCharacterIconSelect:function(t){var e=t;e.onSelected(!0);var i=e.name.split("<")[0];this._selectedID&&this._selectedID!=i&&this._roleList[this._selectedID].getComponent("DndCharacterIcon").onSelected(!1),this._selectedID=i},_notifyCharacterIconRemove:function(t){o.request("Abort",{game:n,uniqueid:this._selectedID}),this._selectedID=""},onScaleResizeClicked:function(t,e){var i=this,n=parseFloat(e);!this._oriNodeSize&&(this._oriNodeSize=this.MapGridRoot.getContentSize()),this.MapGridRoot.setContentSize({width:this._oriNodeSize.width*n,height:this._oriNodeSize.height*n}),this.MapGridRoot.children.forEach(function(t){var e=t.getContentSize();e.width=i._grid*n,e.height=i._grid*n,t.getComponent("MapGridItem").setGridSize(e,n)}),Object.keys(this._roleList).forEach(function(t){var e=i._roleList[t],o=e.getContentSize();o.width=i._grid*n,o.height=i._grid*n,e.setContentSize(o);var a=e.getComponent("DndCharacterIcon"),s=a.PixelCanvas.getGroupSize();a.setPixelCanvas({gridSize:2*n,horizontal:s.horizontal,vertical:s.vertical,hex:a.PixelCanvas.getHexColors()})})},_notifyOpenBattleMap:function(t){cc.log(t);var e=t.name,i=t.url,a=t.gridSize;o.request("NewRoom",{game:n,name:e,url:i,grid:a})},onCloseBattleMapClicked:function(){HASH.isHost&&o.request("KickRoom",{game:n})}}),cc._RF.pop()},{Client:"Client",DndStrategyMap:"DndStrategyMap",Notifier:"Notifier"}],DndCharacterIcon:[function(t,e,i){"use strict";cc._RF.push(e,"f8f6bAlUpJB+aw7LqjedLrv","DndCharacterIcon"),cc.Class({extends:cc.Component,properties:{NameLabel:cc.Label,PixelCanvas:t("PixelImageCanvas")},onLoad:function(){this.editTimes=0,this.setParam({name:"\u65b0\u589e",image:{gridSize:4,horizontal:20,vertical:20,hex:{bbbbbb:[49,50,51,69,70,71,89,90,91,109,110,111,129,130,131,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,209,210,211,229,230,231,249,250,251,269,270,271,289,290,291]}}})},setParam:function(t){var e=t.name,i=t.image;this.NameLabel.string=e,this.setPixelCanvas(i)},setPixelCanvas:function(t){var e=t.gridSize,i=t.horizontal,n=t.vertical,o=t.hex;this.PixelCanvas.setGridsSize(e,i,n),this.PixelCanvas.setHexColors(o),this._gridSize=e},onSelected:function(t){this.node.color=t?cc.Color.GRAY:cc.Color.WHITE},onClicked:function(){EVENT.dispatchNotify("NotifyCharacterIconClicked",this)},onSelectClicked:function(){EVENT.dispatchNotify("NotifyCharacterIconSelect",this)}}),cc._RF.pop()},{PixelImageCanvas:"PixelImageCanvas"}],DndCharacterInfo:[function(t,e,i){"use strict";cc._RF.push(e,"27960q6IGhAn4XyVpjcufNu","DndCharacterInfo");var n=t("Notifier");cc.Class({extends:cc.Component,properties:{NameLabel:cc.Label,NameEditbox:cc.EditBox,PixelCanvas:t("PixelImageCanvas"),PixelImageList:cc.Node,PixelSize:2,EventButton:cc.Node},onLoad:function(){var t=this;this.showUI(!1),this.EventButton.active=!1;var e=function(e,i){e=e.split("").join(" ");var n=cc.instantiate(t.EventButton);return n.parent=t.EventButton.parent,n.active=!1,n.getComponent("EventButton").setParams(e,i),n};this._editedButton=e("\u5b8c\u6210\u7de8\u8f2f",this.onEditedClicked.bind(this)),this._joinButton=e("\u52a0\u5165\u5730\u5716",this.onJoinClicked.bind(this)),this._removeButton=e("\u79fb\u9664\u89d2\u8272",this.onRemoveClicked.bind(this)),this._closeButton=e("\u95dc\u9589",this.onCloseClicked.bind(this)),EVENT.addListener("NotifyCharacterIconClicked",this._notifyCharacterIconClicked,this)},showUI:function(t){this.node.children.forEach(function(e){return e.active=t})},_notifyCharacterIconClicked:function(t){this._dndCharacterIcon=t;var e=0===this._dndCharacterIcon.editTimes;this.showUI(!0),this._editedButton.active=!0,this._joinButton.active=this._removeButton.active=!e,this._closeButton.active=!0;var i=e?"":this._dndCharacterIcon.NameLabel.string,n=this._dndCharacterIcon.PixelCanvas,o=n.getGroupSize(),a=e?{}:n.getHexColors();this.setParam({name:i,hex:a,groupSize:o})},setParam:function(t){var e=t.name,i=t.hex,n=t.groupSize,o=e.length>0;this.NameLabel.node.active=o,this.NameEditbox.node.active=!o,o?this.NameLabel.string=e:(this.NameEditbox.string="",this.NameEditbox.placeholder="\u8acb\u8f38\u5165\u89d2\u8272\u540d\u7a31");var a=Object.keys(i).length>0;this.PixelImageList.active=!a,a?(this.PixelCanvas.setGridsSize(this.PixelSize,n.horizontal,n.vertical),this.PixelCanvas.setHexColors(i)):this.PixelCanvas.cleanPixelsColor(),this._editedButton.active=!o||!a,this._closeButton.active=!0,this._iconInfo={name:e,hex:i}},onSelectIconClicked:function(t){var e=t.target.getComponent("PixelImageCanvas"),i=e.getGroupSize();this.PixelCanvas.setGridsSize(this.PixelSize,i.horizontal,i.vertical),this.PixelCanvas.setHexColors(e.getHexColors())},onEditedClicked:function(){var t=this.NameEditbox.string,e=this.PixelCanvas.getGroupSize(),i=this.PixelCanvas.getHexColors();if(""===this.NameEditbox.string)return cc.error("\u8acb\u8f38\u5165\u89d2\u8272\u540d\u7a31");if(0===Object.keys(i).length)return cc.error("\u8acb\u9078\u64c7\u5716\u793a");this.setParam({name:t,hex:i,groupSize:e}),this._editedButton.active=!1,this._joinButton.active=!0,this._closeButton.active=!0,this.NameEditbox.string="";var n=this._dndCharacterIcon.node;cc.instantiate(n).parent=n.parent,this._dndCharacterIcon.NameLabel.string=this.NameLabel.string;var o=this._dndCharacterIcon.PixelCanvas;o.setGridsSize(this.PixelSize,e.horizontal,e.vertical),o.setHexColors(i),this._dndCharacterIcon.editTimes++,EVENT.dispatchNotify("NotifySaveCharacterIconList",{name:this.NameLabel.string,image:{gridSize:this.PixelSize,horizontal:e.horizontal,vertical:e.vertical,hex:i}})},onJoinClicked:function(){this.showUI(!1);var t=this.PixelCanvas.getGroupSize();n.request("Join",{game:"DndBattleMap",role:{name:this.NameLabel.string,hex:this.PixelCanvas.getHexColors(),hor:t.horizontal,ver:t.vertical,pos:230},uniqueid:LocalCache.getTimestamp16()})},onRemoveClicked:function(){this._dndCharacterIcon.node.destroy(),EVENT.dispatchNotify("NotifyRemoveCharacterIconList",this._dndCharacterIcon.node.getSiblingIndex()),this.showUI(!1)},onCloseClicked:function(){this.showUI(!1)}}),cc._RF.pop()},{Notifier:"Notifier",PixelImageCanvas:"PixelImageCanvas"}],DndCharacterManager:[function(t,e,i){"use strict";cc._RF.push(e,"de399dciQpJ0bVaELK43AJf","DndCharacterManager"),cc.Class({extends:cc.Component,properties:{DndCharacterIcon:cc.Node},onLoad:function(){this._notifyLoadCharacterIconList(),EVENT.addListener("NotifySaveCharacterIconList",this._notifySaveCharacterIconList,this),EVENT.addListener("NotifyLoadCharacterIconList",this._notifyLoadCharacterIconList,this),EVENT.addListener("NotifyRemoveCharacterIconList",this._notifyRemoveCharacterIconList,this)},_notifySaveCharacterIconList:function(t){var e=JSON.stringify(t),i="DndCharacterIconList",n=JSON.parse(LocalCache.getItem(i,"[]"));n.push(e),LocalCache.setItem(i,JSON.stringify(n))},_notifyLoadCharacterIconList:function(t){var e=this;JSON.parse(LocalCache.getItem("DndCharacterIconList","[]")).forEach(function(t){var i=cc.instantiate(e.DndCharacterIcon);i.parent=e.DndCharacterIcon.parent;var n=i.getComponent("DndCharacterIcon"),o=JSON.parse(t);n.setParam(o),n.editTimes++,e.DndCharacterIcon.setSiblingIndex(999999)})},_notifyRemoveCharacterIconList:function(t){var e=t,i="DndCharacterIconList",n=JSON.parse(LocalCache.getItem(i,"[]"));n.splice(e,1),LocalCache.setItem(i,JSON.stringify(n))}}),cc._RF.pop()},{}],DndCharacterSheet:[function(t,e,i){"use strict";cc._RF.push(e,"b426cCgjNVGm7Nlf/6IUaXI","DndCharacterSheet");var n=t("DataModal");cc.Class({extends:t("Client"),properties:{AbilityLayout:cc.Node,AbilityNode:cc.Node,ExemptionLayout:cc.Node,ExemptionNode:cc.Node,SkillLayout:cc.Node,SkillNode:cc.Node},onLoad:function(){this.AbilityNode.active=!1,this.ExemptionNode.active=!1,this.SkillNode.active=!1,EVENT.addListener("NotifyFinishSetting",this._notifyFinishSetting,this);var t=n.getInstance().profileData;t.setDndRoleData("1"),this.open(t.dndRole[1])},open:function(t){var e=this,i=this._dndRoleData=t,n=function(t,e,n){var o=cc.instantiate(t),a=o.getComponent("DndEditItem");return o.parent=e,o.active=!0,o.name=n,a.setParam(n,i),a.edit(n,i,!0),a};this._abilityItems=Object.keys(i.ability).map(function(t){return n(e.AbilityNode,e.AbilityLayout,t)}),this._exemptionItems=Object.keys(i.ability).map(function(t){return n(e.ExemptionNode,e.ExemptionLayout,t)}),this._skillItems=Object.keys(i.skill).map(function(t){return n(e.SkillNode,e.SkillLayout,t)})},_notifyFinishSetting:function(){var t=this._dndRoleData,e=function(e){e.setParam(e.node.name,t),e.edit(!1)};this._abilityItems.forEach(function(t){return e(t)}),this._exemptionItems.forEach(function(t){return e(t)}),this._skillItems.forEach(function(t){return e(t)})},onOutsizeClicked:function(){this._notifyFinishSetting()}}),cc._RF.pop()},{Client:"Client",DataModal:"DataModal"}],DndChoiceItem:[function(t,e,i){"use strict";cc._RF.push(e,"61d04LP9uBFIJs8BfFWkxpP","DndChoiceItem"),cc.Class({extends:t("DndEditItem"),properties:{TitleLabel:cc.Label,ContentLabel:cc.Label},onLoad:function(){this._valueName=""},setParam:function(t,e,i,n){this._valueName=e,this._info=i,this._dndRoleData=n;var o=this._dndRoleData[this._valueName];this.TitleLabel.string=t,this.ContentLabel.string=o},onClicked:function(){}}),cc._RF.pop()},{DndEditItem:"DndEditItem"}],DndClientView:[function(t,e,i){"use strict";cc._RF.push(e,"26cd175ziNLpqzTKO0uXuQX","DndClientView");var n=t("Notifier"),o=t("BargameControl");cc.Class({extends:t("Client"),properties:{MapItems:[cc.Node]},start:function(){this._init(),t("ChatClientView").open(this.node),this._loadUI("StoryTellerClientView"),t("DndDiceClientView").open(this.node)},onDestroy:function(){n.removeClient(this)},_init:function(){},_distance:function(t,e){if(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<100){var i=this._profileData;return i.setRandomRgba(),n.notifyHost("initiate",{game:e.name,join:1,player:{uniqueid:i.uniqueid,nickname:i.nickname,position:t,rgba:i.rgba}}),o.setTouchStart(null),!0}return!1}}),cc._RF.pop()},{BargameControl:"BargameControl",ChatClientView:"ChatClientView",Client:"Client",DndDiceClientView:"DndDiceClientView",Notifier:"Notifier"}],DndDiceBoard:[function(t,e,i){"use strict";cc._RF.push(e,"351a9iH81JGzolED48L7y7K","DndDiceBoard");var n=t("GameEnum"),o=t("Notifier");cc.Class({extends:cc.Component,properties:{DiceNode:cc.Node,_string:"",string:{set:function(t){this._string=t,this.setDice(t)},get:function(){return this._string}}},onLoad:function(){var t=this.node;t.on(cc.Node.EventType.TOUCH_START,this._startHandler,this),t.on(cc.Node.EventType.TOUCH_MOVE,this._moveHandler,this),t.on(cc.Node.EventType.TOUCH_END,this._endHandler,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this._endHandler,this),this._oriPos=this.node.getPosition(),EVENT.addListener("NotifyDndDiceFinish",this._notifyDndDiceFinish,this)},start:function(){this._profileData=t("DataModal").getInstance().profileData,this._game=n.Games.Dice},extend:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments[1],i=t?this._oriPos:cc.v2(this.node.x,1.5*this.node.height+100);cc.tween(this.node).to(.2,{position:i}).call(function(){return e&&e()}).start()},setDice:function(t){for(var e=t.split("d"),i=e[0],n=e[1],o=this.node.getChildren(),a=0;a<i;a++){var s=o[a+1]||cc.instantiate(this.DiceNode);s.parent=this.node,s.setPosition(200*Math.random()-100,200*Math.random()-100),s.getComponent("DndDice").setPoint(n)}this._result=[],this._unit=i},_startHandler:function(t){t.touch.getLocation()},_moveHandler:function(t){t.touch.getDelta()},_endHandler:function(t){t.touch;this.node.children.forEach(function(t){return t.getComponent("DndDice")&&t.getComponent("DndDice").roll()})},_notifyDndDiceFinish:function(e){if(this._result.push(e),this._result.length==this._unit){this._profileData.nickname;"player",o.request("Utter",{game:n.GameName[this._game],message:"player\u9ab0\u51fa"+this._result.join("\u3001")}),t("DndDiceClientView").open(null,"open",!1)}}}),cc._RF.pop()},{DataModal:"DataModal",DndDiceClientView:"DndDiceClientView",GameEnum:"GameEnum",Notifier:"Notifier"}],DndDiceClientView:[function(t,e,i){"use strict";cc._RF.push(e,"4b6adX9JLxFw5+WwSmlAQdX","DndDiceClientView");var n=t("GameEnum"),o=t("Notifier"),a=null;cc.Class({extends:t("Client"),statics:{open:function(t,e,i){if(a)e?a[e](i):a.open();else{cc.loader.loadRes("prefabs/board/DndDiceClientView",function(n,o){if(n)return cc.error(n);var s=cc.instantiate(o);s.parent=t,a=s.getComponent("DndDiceClientView"),e&&a[e](i)}.bind(this))}},close:function(){a.node.destroy()}},properties:{DndDiceBoard:t("DndDiceBoard"),TipsLabel:cc.Label,InputResultEditbox:cc.EditBox},start:function(){EVENT.addListener("NotifyResult",this._notifyResult,this),this._profileData=t("DataModal").getInstance().profileData,this._game=n.Games.Dice,this._isExtend=!1,this.open(!1)},onDestroy:function(){this._super(),a=null},open:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=function(e){return t.node.children.forEach(function(t){return t.active=e})};e?(i(e),this.DndDiceBoard.extend(!1)):(this.DndDiceBoard.extend(e,i.bind(this,e)),this._isExtend=!1)},setParam:function(t){var e=t.game;this._game=e},handleRollDice:function(t){this.open(),cc.log(t);var e=t.message,i=t.roll;this._roll=i,this.TipsLabel.string=e},onExtendClicked:function(){this._isExtend||(this._isExtend=!this._isExtend,this.DndDiceBoard.extend(!0),this.DndDiceBoard.string=this._roll)},_notifyResult:function(t){var e=this._profileData,i=e.uniqueid,a=e.nickname,s=e.rgba,c=a+"\u9ab0\u51fa"+t;o.request("Utter",{game:n.GameName[this._game],message:c,player:{uniqueid:i,nickname:a,rgba:s}})},onSendResultClicked:function(){var t=parseInt(this.InputResultEditbox.string,10),e=this._profileData,i=e.uniqueid,a=e.nickname,s=e.rgba,c=a+"\u9ab0\u51fa"+t;o.request("Utter",{game:n.GameName[this._game],message:c,player:{uniqueid:i,nickname:a,rgba:s}})}}),cc._RF.pop()},{Client:"Client",DataModal:"DataModal",DndDiceBoard:"DndDiceBoard",GameEnum:"GameEnum",Notifier:"Notifier"}],DndDice:[function(t,e,i){"use strict";cc._RF.push(e,"c6d11xLVilExb8DybMLIh+C","DndDice"),cc.Class({extends:cc.Component,properties:{MoveTarget:t("Move"),DiceMask:cc.Mask,PointLabel:cc.Label},setPoint:function(t){this._point=t,this._result=0},getPoint:function(){return this._result},hit:function(){this.roll()},roll:function(){this._roll(),this.finish()},_roll:function(){this._result=Math.round(100*Math.random())%this._point+1,this.PointLabel.string=this._result},finish:function(){EVENT.dispatchNotify("NotifyDndDiceFinish",this._result)}}),cc._RF.pop()},{Move:"Move"}],DndEditItem:[function(t,e,i){"use strict";cc._RF.push(e,"3e18dVAyKRPmJP6Zn2iC5dC","DndEditItem"),cc.Class({extends:cc.Component,setParam:function(t){}}),cc._RF.pop()},{}],DndExemptionItem:[function(t,e,i){"use strict";cc._RF.push(e,"99b94dF9j5I/6JJSsZWE3D+","DndExemptionItem"),cc.Class({extends:t("DndEditItem"),properties:{NameLabel:cc.Label,NumberLabel:cc.Label,SwitchToggle:t("SwitchToggle")},onLoad:function(){this._valueName=""},setParam:function(t,e){this._valueName=t,this._dndRoleData=e;var i=this._dndRoleData.ability[this._valueName];this.NameLabel.string=i.label,this.NumberLabel.string=i.exemption.toString()},edit:function(t){var e=this,i=this._dndRoleData.ability[this._valueName];this.SwitchToggle.node.active=t,t&&this.SwitchToggle.setParam({num:i.adjustment,callback:function(){e._dndRoleData.selectExemption(e._valueName,e.SwitchToggle.getParam().isToggle),e.NumberLabel.string=i.exemption.toString()}})},onClicked:function(){EVENT.dispatchNotify("NotifyFinishSetting"),this.SwitchToggle.node.active=!0}}),cc._RF.pop()},{DndEditItem:"DndEditItem",SwitchToggle:"SwitchToggle"}],DndGameEnum:[function(t,e,i){"use strict";var n,o,a,s;function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"85786faLeBKJJsOXhKEin8b","DndGameEnum");var r=cc.Enum({Strength:-1,Dexterity:-1,Constitution:-1,Intelligence:-1,Perception:-1,Charisma:-1}),l=(c(n={},r.Strength,{name:"Strength",label:"\u529b\u91cf"}),c(n,r.Dexterity,{name:"Dexterity",label:"\u654f\u6377"}),c(n,r.Constitution,{name:"Constitution",label:"\u9ad4\u8cea"}),c(n,r.Intelligence,{name:"Intellegence",label:"\u667a\u529b"}),c(n,r.Perception,{name:"Perception",label:"\u611f\u77e5"}),c(n,r.Charisma,{name:"Charisma",label:"\u9b45\u529b"}),n),h=cc.Enum({Athletics:-1,Thievery:-1,Stealth:-1,Acrobatics:-1,Insight:-1,History:-1,Arcane:-1,Nature:-1,Religion:-1,Tame:-1,Observing:-1,Heal:-1,Survival:-1,Bluff:-1,Intimidate:-1,Histrionics:-1,Diplomacy:-1}),d=(c(o={},h.Athletics,{label:"\u904b\u3000\u3000\u52d5",depend:r.Strength}),c(o,h.Thievery,{label:"\u5999\u624b\u7a7a\u7a7a",depend:r.Dexterity}),c(o,h.Stealth,{label:"\u96b1\u533f\u8eb2\u85cf",depend:r.Dexterity}),c(o,h.Acrobatics,{label:"\u7279\u6280\u52d5\u4f5c",depend:r.Dexterity}),c(o,h.Insight,{label:"\u8fa8\u8a8d\u8abf\u67e5",depend:r.Intelligence}),c(o,h.History,{label:"\u6b77\u53f2\u77e5\u8b58",depend:r.Intelligence}),c(o,h.Arcane,{label:"\u5967\u8853\u77e5\u8b58",depend:r.Intelligence}),c(o,h.Nature,{label:"\u81ea\u7136\u77e5\u8b58",depend:r.Intelligence}),c(o,h.Religion,{label:"\u5b97\u6559\u77e5\u8b58",depend:r.Intelligence}),c(o,h.Tame,{label:"\u99b4\u670d\u52d5\u7269",depend:r.Perception}),c(o,h.Observing,{label:"\u5bdf\u984f\u89c0\u8272",depend:r.Perception}),c(o,h.Heal,{label:"\u91ab\u7642\u6280\u8853",depend:r.Perception}),c(o,h.Perception,{label:"\u89c0\u5bdf\u611f\u77e5",depend:r.Perception}),c(o,h.Survival,{label:"\u6c42\u751f\u6280\u5de7",depend:r.Perception}),c(o,h.Bluff,{label:"\u552c\u5f04\u779e\u9a19",depend:r.Charisma}),c(o,h.Intimidate,{label:"\u5a01\u8105\u6050\u5687",depend:r.Charisma}),c(o,h.Histrionics,{label:"\u8868\u6f14\u85dd\u8853",depend:r.Charisma}),c(o,h.Diplomacy,{label:"\u4ea4\u6d89\u8aaa\u670d",depend:r.Charisma}),o),u=cc.Enum({Cleric:-1,Fighter:-1,Rouge:-1,Paladin:-1,Warlock:-1,Wizard:-1,Bard:-1,Ranger:-1,Warlord:-1,Barbarian:-1,Monk:-1,Druid:-1}),p=(c(a={},u.Cleric,{label:"\u7267\u5e2b",exemption:[r.Intelligence,r.Charisma],skillPoint:2,skill:[h.History,h.Religion,h.Observing,h.Heal,h.Diplomacy]}),c(a,u.Fighter,{label:"\u6230\u58eb",exemption:[r.Strength,r.Constitution],skillPoint:2,skill:[h.Acrobatics,h.Tame,h.Athletics,h.History,h.Intimidate,h.Perception,h.Survival]}),c(a,u.Rouge,{label:"\u904a\u76ea\u8005",exemption:[r.Dexterity,r.Intelligence],skillPoint:4,skill:[h.Acrobatics,h.Athletics,h.Bluff,h.Observing,h.Intimidate,h.Perception,h.Histrionics,h.Diplomacy,h.Insight,h.Thievery,h.Stealth]}),c(a,u.Paladin,{label:"\u8056\u9a0e\u58eb",exemption:[r.Perception,r.Charisma],skillPoint:2,skill:[h.Athletics,h.Observing,h.Intimidate,h.Heal,h.Diplomacy,h.Religion]}),c(a,u.Warlock,{label:"\u8853\u58eb",exemption:[r.Constitution,r.Charisma],skillPoint:2,skill:[h.Arcane,h.Bluff,h.Observing,h.Intimidate,h.Diplomacy,h.Religion]}),c(a,u.Wizard,{label:"\u6cd5\u5e2b",exemption:[r.Intelligence,r.Perception],skillPoint:2,skill:[h.Arcane,h.Histrionics,h.Observing,h.Insight,h.Heal,h.Religion]}),c(a,u.Bard,{label:"\u541f\u904a\u8a69\u4eba",exemption:[r.Dexterity,r.Charisma],skillPoint:3,skill:[h.Athletics,h.Thievery,h.Stealth,h.Acrobatics,h.Insight,h.History,h.Arcane,h.Nature,h.Religion,h.Tame,h.Observing,h.Heal,h.Survival,h.Bluff,h.Intimidate,h.Histrionics,h.Diplomacy]}),c(a,u.Ranger,{label:"\u904a\u4fe0",exemption:[r.Strength,r.Dexterity],skillPoint:3,skill:[h.Tame,h.Athletics,h.Observing,h.Insight,h.Nature,h.Perception,h.Stealth,h.Survival]}),c(a,u.Warlord,{label:"\u9b54\u5c0e\u58eb",exemption:[r.Perception,r.Charisma],skillPoint:2,skill:[h.Arcane,h.Bluff,h.Intimidate,h.Insight,h.History,h.Nature,h.Religion]}),c(a,u.Barbarian,{label:"\u91ce\u883b\u4eba",exemption:[r.Strength,r.Constitution],skillPoint:2,skill:[h.Tame,h.Athletics,h.Intimidate,h.Nature,h.Perception,h.Survival]}),c(a,u.Barbarian,{label:"\u6b66\u50e7",exemption:[r.Strength,r.Dexterity],skillPoint:2,skill:[h.Acrobatics,h.Athletics,h.History,h.Observing,h.Religion]}),c(a,u.Druid,{label:"\u5fb7\u9b6f\u4f9d",exemption:[r.Intelligence,r.Perception],skillPoint:2,skill:[h.Arcane,h.Tame,h.Observing,h.Heal,h.Nature,h.Perception,h.Religion,h.Survival]}),a),f=cc.Enum({Elf:-1,HalfElf:-1,Human:-1,Halfling:-1,Dwarf:-1,Gnome:-1,Tiefling:-1,Dragonborn:-1,HalfOrc:-1});c(s={},f.Elf,{label:"\u7cbe\u9748",speed:30,skillPoint:1,skill:[h.Perception],resistance:[]}),c(s,f.HalfElf,{label:"\u534a\u7cbe\u9748",speed:30,skillPoint:2,skill:[],resistance:[]}),c(s,f.Human,{label:"\u4eba\u985e",speed:30,skill:[],resistance:[]}),c(s,f.Halfling,{label:"\u534a\u8eab\u4eba",speed:25,skill:[h.Perception],resistance:[]}),c(s,f.Dwarf,{label:"\u77ee\u4eba",speed:25,skill:[],resistance:[]}),c(s,f.Gnome,{label:"\u5730\u4f8f",speed:25,skill:[],resistance:[]}),c(s,f.Tiefling,{label:"\u9b54\u4eba",speed:30,skill:[],resistance:[]}),c(s,f.Dragonborn,{label:"\u9f8d\u88d4",speed:30,skill:[],resistance:[]}),c(s,f.HalfOrc,{label:"\u534a\u7378\u4eba",speed:30,skill:[h.Intimidate],resistance:[]});e.exports={AbilityValue:r,AbilityInfo:l,SkillValue:h,SkillInfo:d,OccupationValue:u,OccupationInfo:p},cc._RF.pop()},{}],DndMapItemInfo:[function(t,e,i){"use strict";cc._RF.push(e,"3899229IwlHa48YH8HIg98a","DndMapItemInfo"),cc.Class({extends:cc.Component,properties:{CharacterIcon:t("DndCharacterIcon"),EventButton:cc.Node,DetailEditBox:cc.EditBox},onLoad:function(){var t=this;this.showUI(!1);var e=function(e,i){var n=cc.instantiate(t.EventButton);return n.parent=t.EventButton.parent,n.getComponent("EventButton").setParams(e,i),n};this._detailButton=e("\u7d30\u7bc0",this.onDetailClicked.bind(this)),this._removeButton=e("\u79fb\u9664",this.onRemoveClicked.bind(this)),this._removeButton=e("\u95dc\u9589",this.showUI.bind(this,!1)),EVENT.addListener("NotifyCharacterIconSelect",this._notifyCharacterIconSelect,this),EVENT.addListener("NotifyLeaveRoom",this._notifyLeaveRoom,this)},setParam:function(t){var e=t.name,i=t.hex,n=t.groupSize;this.CharacterIcon.setParam({name:e,image:{gridSize:4,horizontal:n.horizontal,vertical:n.vertical,hex:i}})},showUI:function(t){this.node.children.forEach(function(e){return e.active=t}),t||(this._dndCharacterIcon=null)},_notifyCharacterIconSelect:function(t){this._dndCharacterIcon=t,this.showUI(!0),this._detailButton.active=!0,this._removeButton.active=!0,this.DetailEditBox.string=this._dndCharacterIcon.tempDetail||"";var e=this._dndCharacterIcon.NameLabel.string,i=this._dndCharacterIcon.PixelCanvas,n=i.getGroupSize(),o=i.getHexColors();this.setParam({name:e,hex:o,groupSize:n})},_notifyLeaveRoom:function(t){var e=t;(!e||this._dndCharacterIcon&&e==this._dndCharacterIcon.node.name)&&this.showUI(!1)},onDetailClicked:function(){this.DetailEditBox.node.active=!this.DetailEditBox.node.active,this.DetailEditBox.node.active?this.DetailEditBox.string=this._dndCharacterIcon.tempDetail||"":this._dndCharacterIcon.tempDetail=this.DetailEditBox.string},onRemoveClicked:function(){EVENT.dispatchNotify("NotifyCharacterIconRemove"),this.showUI(!1)}}),cc._RF.pop()},{DndCharacterIcon:"DndCharacterIcon"}],DndMapRole:[function(t,e,i){"use strict";cc._RF.push(e,"851d97bdQlIppBf69EiF5BL","DndMapRole");var n=t("Notifier");cc.Class({extends:cc.Component,properties:{ColorNode:cc.Node,ColorRoot:cc.Node,ColorDemoNode:cc.Node,NameInput:cc.EditBox,NameDemoText:cc.Label,SpedInput:cc.EditBox},onLoad:function(){this._profileData=t("DataModal").getInstance().profileData,n.mapClient(this),this._colorPettle()},start:function(){cc.log("~~~~~~~",this._profileData.nickname),this.NameInput.string=this._profileData.nickname},onDestroy:function(){n.removeClient(this)},map_role_close:function(){this.node.destroy()},_colorPettle:function(){var t=this;[cc.Color.RED,cc.Color.GREEN,cc.Color.BLUE,cc.Color.YELLOW,cc.Color.ORANGE,cc.Color.CYAN,cc.Color.MAGENTA].forEach(function(e){var i=cc.instantiate(t.ColorNode);i.parent=t.ColorRoot,i.active=!0,i.color=e})},_colorTransferAnimation:function(t){var e=t.r,i=t.b,n=t.g;this.ColorDemoNode.stopAllActions(),this.ColorDemoNode.runAction(cc.sequence(cc.scaleTo(.1,.8,.8),cc.spawn(cc.tintTo(.2,e,n,i),cc.scaleTo(.2,1.5,1.5).easing(cc.easeInOut(3))),cc.scaleTo(.2,1,1).easing(cc.easeInOut(3))))},onNameTextChanged:function(){this.NameDemoText.string=this.NameInput.string},onTarnsferColorClicked:function(t){var e=t.target;this._colorTransferAnimation(e.color)},onConfirmClicked:function(){n.notifyHost("role_join",{player:this._profileData.uniqueid,rgba:this.ColorDemoNode.color,name:this.NameInput.string,sped:parseInt(this.SpedInput.string,10)||1}),this.node.active=!1}}),cc._RF.pop()},{DataModal:"DataModal",Notifier:"Notifier"}],DndRoleData:[function(t,e,i){"use strict";cc._RF.push(e,"c5b1bdGzBFMJ5cEJPmd7HSx","DndRoleData");var n=t("DndGameEnum");cc.Class({ctor:function(){var t=this;this.level=0,this.name="",this.occupation="",this.background="",this.ethnicity="",this.alignment="",this.experience=0,this.conversancy=2,this.ability={},this.skill={},this.armorClass=0,this.strikeAdjustment=0,this.moveSpeed=0,this.curHitPoint=0,this.maxHitPoint=0,this.disposition="",this.idea="",this.relationship="",this.shortcoming="",this.combat={},this.weapon={},this.equipment={},this.tenure={cp:0,sp:0,ep:0,gp:0,pp:0},Object.keys(n.AbilityValue).forEach(function(e){var i=n.AbilityValue[e],o=n.AbilityInfo[i].label,a=Math.floor(-1);t.ability[i]={label:o,value:8,adjustment:a},t.selectExemption(i,!1)}),this.setSkill()},setLevel:function(t){var e=this;this._level=t,this.conversancy=Math.floor((this._level-1)/4)+2,Object.keys(this.skill).forEach(function(t){e.skill[t].isLearn&&e.selectSkill(t,!0)})},setAbility:function(t,e){var i=Math.floor(.5*(e-10));this.ability[t].value=e,this.ability[t].adjustment=i,this.selectExemption(t,!1),this.setSkill(),this.strikeAdjustment=this.ability[n.AbilityValue.Dexterity].adjustment},selectExemption:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.ability[t];i.isExemption=e,i.exemption=i.adjustment+(e?this.conversancy:0)},setSkill:function(){var t=this;Object.keys(n.SkillValue).forEach(function(e){var i=n.SkillValue[e],o=n.SkillInfo[i],a=o.label,s=t.ability[o.depend];t.skill[i]={label:a,ability:s,value:s.adjustment,add:0}})},selectSkill:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.skill[t],n=i.ability;i.add=e?this.conversancy:0,i.value=n.adjustment},setWeapon:function(t,e){var i=t.split("+"),n=e.split("d");weapon.push({label:t,add:i[1],unit:n[0],face:n[1],attack:attack,ability:ability})}}),cc._RF.pop()},{DndGameEnum:"DndGameEnum"}],DndSkillItem:[function(t,e,i){"use strict";cc._RF.push(e,"44018HCQTFCHbREk/G6m3aD","DndSkillItem"),cc.Class({extends:t("DndEditItem"),properties:{NameLabel:cc.Label,NumberLabel:cc.Label,SwitchToggle:t("SwitchToggle")},onLoad:function(){this._valueName=""},setParam:function(t,e){this._valueName=t,this._dndRoleData=e;var i=this._dndRoleData.skill[this._valueName];this.NameLabel.string=i.label,this.NumberLabel.string=(i.value+(i.add||0)).toString()},edit:function(t){var e=this,i=this._dndRoleData.skill[this._valueName];this.SwitchToggle.node.active=t,t&&this.SwitchToggle.setParam({num:i.value,callback:function(){e._dndRoleData.selectSkill(e._valueName,e.SwitchToggle.getParam().isToggle),i=e._dndRoleData.skill[e._valueName],e.NumberLabel.string=(i.value+i.add).toString()}})},onClicked:function(){EVENT.dispatchNotify("NotifyFinishSetting"),this.SwitchToggle.node.active=!0}}),cc._RF.pop()},{DndEditItem:"DndEditItem",SwitchToggle:"SwitchToggle"}],DndStoryNode:[function(t,e,i){"use strict";cc._RF.push(e,"894ddaIXPBI6Y1F3jPXopik","DndStoryNode"),cc.Class({extends:cc.Component,properties:{ItemRoot:cc.Node,ItemNode:cc.Node,TitleLabel:cc.Label},onLoad:function(){this._isClicked=!1,this._clickCallback=null},setClicked:function(t){this._clickCallback=t},split:function(t){var e=this,i=t.split("\n");this.ItemNode.active=!1,this.TitleLabel.string=i[0],this._nodeList=[],i.forEach(function(t){var i=cc.instantiate(e.ItemNode);i.parent=e.ItemRoot,i.getComponent("DndStorySentence").setText(t),e._nodeList.push(i)})},show:function(t){this._nodeList.forEach(function(e){return e.active=t})},onClicked:function(){this._clickCallback&&this._clickCallback(),this.show(this._isClicked=!this._isClicked)}}),cc._RF.pop()},{}],DndStoryScrollView:[function(t,e,i){"use strict";cc._RF.push(e,"a5103HA5+1O6baUB9Vr7adl","DndStoryScrollView"),cc.Class({extends:cc.Component,properties:{ItemRoot:cc.Node,ItemNode:cc.Node,Editbox:cc.EditBox},onLoad:function(){this.ItemNode.active=!1},start:function(){},split:function(t){var e=this,i=function(){e._storyNodes.forEach(function(t){return t.show(!1)})};this._storyNodes=[],t.split("\n\n").forEach(function(t){var n=cc.instantiate(e.ItemNode);n.parent=e.ItemRoot,n.active=!0;var o=n.getComponent("DndStoryNode");o.setClicked(i),o.split(t),e._storyNodes.push(o)});var n=this.node.getComponent(cc.ScrollView);n&&n.scrollToTop()},onSplitCliced:function(){var t=this.Editbox.node.parent.active;t&&(this.Editbox.string.length>0&&this.split(this.Editbox.string),this.Editbox.string=""),this.Editbox.node.parent.active=!t}}),cc._RF.pop()},{}],DndStorySentence:[function(t,e,i){"use strict";cc._RF.push(e,"a2faf0O7cpEto/JsfC2fwO/","DndStorySentence");var n=t("Notifier");cc.Class({extends:cc.Component,properties:{ReadyColor:cc.Color,DoneColor:cc.Color,ContentRichText:cc.RichText,ContentEditbox:cc.EditBox,BackgroundNode:cc.Node,EventButton:cc.Node},onLoad:function(){this.oriColor=this.node.color},setParam:function(t){var e=t.game;this._game=e},setText:function(t){this.ContentEditbox.node.active=!0,this.ContentRichText.string=t,this.ContentEditbox.node.active=!1},onSelectClicked:function(){this.BackgroundNode.color=this.ReadyColor,this.ContentRichText.node.active=!1,this.ContentEditbox.node.active=!0;var t=this.ContentRichText.string;this.ContentEditbox.string="\u3000\u3000"+t.split(t.substring(t.indexOf("("),t.indexOf(")")+1)).join("")},onSendClicked:function(){this.BackgroundNode.color=this.DoneColor;var t=this.ContentEditbox.string;t.indexOf(">>")>-1?n.request("RollDice",{game:"DndStoryMaker",roll:"1d20",message:t}):(n.request("Utter",{game:"DndStoryMaker",message:t}),this.ContentRichText.node.active=!0,this.ContentEditbox.node.active=!1)},onCancelClicked:function(){this.BackgroundNode.color=this.oriColor,this.ContentRichText.node.active=!0,this.ContentEditbox.node.active=!1,this.ContentEditbox.string=""}}),cc._RF.pop()},{Notifier:"Notifier"}],DndStrategyMapEditorView:[function(t,e,i){"use strict";cc._RF.push(e,"f651dE4aDVPT6OW3xDeoNi5","DndStrategyMapEditorView"),cc.Class({extends:t("CommonDialogView"),properties:{NameEditbox:cc.EditBox,UrlEditbox:cc.EditBox,SizeEditbox:cc.EditBox,EventButton:cc.Node},onLoad:function(){var t=this;this.EventButton.active=!1;var e=function(e,i){e=e.split("").join(" ");var n=cc.instantiate(t.EventButton);return n.parent=t.EventButton.parent,n.getComponent("EventButton").setParams(e,i),n};this._editedButton=e("\u5b8c\u6210\u7de8\u8f2f",this.onEditedClicked.bind(this)),this._battleMapButton=e("\u958b\u555f\u5730\u5716",this.onBattleMapClicked.bind(this))},start:function(){var t=this._itemTarget.getParam()||{},e=t.name,i=t.url,n=t.grid;this.NameEditbox.string=e||"",this.UrlEditbox.string=i||"",this.SizeEditbox.string=n||"",this._editedButton.active=!0,this._battleMapButton.active=e&&i&&n},setParam:function(t){var e=t.target;this._itemTarget=e,this._super(t)},onEditedClicked:function(){var e=this.NameEditbox.string,i=this.UrlEditbox.string,n=this.SizeEditbox.string;if(""===e)return this.ContentLabel.string="\u8acb\u70ba\u5730\u5716\u547d\u540d";if(""===i)return this.ContentLabel.string="\u8acb\u8f38\u5165\u7db2\u5740";if(""===n)return this.ContentLabel.string="\u8acb\u8f38\u5165\u683c\u7dda\u5927\u5c0f";var o={name:e,url:i,grid:parseFloat(n)};this._itemTarget.setParam(o);var a="DndStrategyMap/"+HASH.room+"/"+this._itemTarget.node.getSiblingIndex();FirebaseWrapper.write(a,o),t("CommonDialog").closeDialog()},onBattleMapClicked:function(){var e=this.NameEditbox.string,i=this.UrlEditbox.string,n=parseFloat(this.SizeEditbox.string);EVENT.dispatchNotify("NotifyOpenBattleMap",{name:e,url:i,gridSize:n}),t("CommonDialog").closeDialog()}}),cc._RF.pop()},{CommonDialog:"CommonDialog",CommonDialogView:"CommonDialogView"}],DndStrategyMapItem:[function(t,e,i){"use strict";cc._RF.push(e,"b3b5bOawLtNlaRg3gDCEjV9","DndStrategyMapItem"),cc.Class({extends:cc.Component,properties:{Label:cc.Label,Sprite:cc.Sprite},onLoad:function(){this.Label.node.active=!1},setParam:function(t){var e=t.name,i=t.url,n=this.Label;n.node.active=!0,n.string=e;var o=this.Sprite;cc.loader.load({url:i,type:"png"},function(t,e){if(t)return cc.error(t);o.node.active=!0,o.spriteFrame=new cc.SpriteFrame(e)}),this._data=t},getParam:function(){return this._data},onClicked:function(){HASH.isHost&&t("CommonDialog").addDialog("DndStrategyMapEditorView",{text:"\u586b\u5165\u8cc7\u8a0a\u4ee5\u5b8c\u6210\u5730\u5716\u7de8\u8f2f",target:this})}}),cc._RF.pop()},{CommonDialog:"CommonDialog"}],DndStrategyMap:[function(t,e,i){"use strict";cc._RF.push(e,"a7ff5PUhPVI/50Uw+qtnqSt","DndStrategyMap"),cc.Class({extends:cc.Component,properties:{MapGridRoot:cc.Node,MapGridItem:cc.Node},start:function(){this.showUI(!1),this._init()},showUI:function(t){this.node.children.forEach(function(e){return e.active=t})},_init:function(){var t,e=this.MapGridRoot,i=this.MapGridItem;e.active=!0,i.active=!1;for(var n=0;n<14;n++)for(var o=n%2==1,a=0;a<3;a++)(t=cc.instantiate(i)).parent=e,t.active=!0,t.opacity=o&&0==a?0:255,o&&(t.children[0].x-=t.width/2);var s=.5*i.height,c=e.getComponent(cc.Layout)||e.addComponent(cc.Layout);c.type=cc.Layout.Type.GRID,c.spacingY=-s,e.setContentSize(3*i.width,14*i.height*.5),this._setMapGridInfo(HASH.room).then(function(t){Object.keys(t).forEach(function(i){e.children[i].getComponent("DndStrategyMapItem").setParam(t[i])}),e.active=!0})},_setMapGridInfo:function(t){return FirebaseWrapper.read("DndStrategyMap/"+t).then(function(t){var e=t.success,i=t.data;return e?i:{}})}}),cc._RF.pop()},{}],EditBoxTags:[function(t,e,i){"use strict";cc._RF.push(e,"84a2cxzwS5LI6EIQjMYV6Rq","EditBoxTags"),cc.Class({extends:cc.Component,properties:{EditBox:cc.EditBox,ListLayout:cc.Node,ListNode:cc.Node},onLoad:function(){this._touchStartCallback=this._selectTagString.bind(this),this._data=[]},setData:function(t){this._data=t},onTextChanged:function(t){this._filterTagString(t)},onEditBoxBegan:function(t){this._filterTagString(t.string||"")},onEditBoxEnded:function(){this.ListLayout.active=!1},_selectTagString:function(t){var e=t.target.name;this.EditBox.string=e,this.onTextChanged(e)},_filterTagString:function(t){var e=this,i=this._data.filter(function(e){return e.indexOf(t)>-1}),n=this.ListLayout.getChildren();n.forEach(function(t){return t.active=!1}),i.forEach(function(t,i){var o=n[i];o||((o=cc.instantiate(e.ListNode)).parent=e.ListLayout,o.on(cc.Node.EventType.TOUCH_START,e._touchStartCallback)),o.name=t,o.active=!0,o.getComponent(cc.Label).string=t}),this.ListLayout.active=!0}}),cc._RF.pop()},{}],EventButton:[function(t,e,i){"use strict";cc._RF.push(e,"0f215BLlFZMCJcg8nLLA57i","EventButton"),cc.Class({extends:cc.Component,properties:{EventName:cc.Label},setParams:function(t,e){t&&(this.EventName.string=t),this._callback=e},onClicked:function(){this._callback&&this._callback()}}),cc._RF.pop()},{}],EventCard:[function(t,e,i){"use strict";cc._RF.push(e,"4fb1b7ql0FNvY5SELWeQQaT","EventCard"),cc.Class({extends:cc.Component,onLoad:function(){this._oriPos=this.node.getPosition(),this._detalY=0},setParam:function(t){var e=t.index,i=t.text,n=t.color;this.index=e,this.node.getComponentInChildren(cc.RichText).string="<outline color=black width=4>"+i+"</outline>"||"",this.node.color=n,this.param=t},touchCard:function(t){},moveCard:function(t){this.node.setPosition(this.node.x,this.node.y+t.y),this._detalY+=t.y},releaseCard:function(t){this._detalY>200?EVENT.dispatchNotify("NotifyEventCardRelease",this):this._detalY<-200&&EVENT.dispatchNotify("NotifyEventCardSortOut",this),this.node.setPosition(this._oriPos),this._detalY=0}}),cc._RF.pop()},{}],EventRemover:[function(t,e,i){"use strict";cc._RF.push(e,"effaeb+2phELoiQQT5+Y30F","EventRemover"),cc.Class({extends:cc.Component,addEventParam:function(t){this._registeredEventList=this._registeredEventList?this._registeredEventList.push(t):[t]},onDestroy:function(){this._registeredEventList&&this._registeredEventList.forEach(function(t){EVENT.removeListener(t.name,t.func,t.target)})}}),cc._RF.pop()},{}],FingerpartyClientView:[function(t,e,i){"use strict";cc._RF.push(e,"294a0SEDlZJerOt5Kp6/bxc","FingerpartyClientView");var n=t("Notifier"),o=t("BargameControl");cc.Class({extends:t("Client"),properties:{GameItems:[cc.Node]},start:function(){var t=this;this._profileData.setIDNickname()?n.notifyHost("player_join",{player:{uniqueid:this._profileData.uniqueid,nickname:this._profileData.nickname}}):this._loadUI({name:"PersonalBoard"}),this._init(),EVENT.addListener("NotifyEventDone",function(){return t._init()},this)},onDestroy:function(){n.removeClient(this)},_init:function(){var t=this;o.setTouchStart(function(e){t.GameItems.some(function(i){return t._distance(e,i)})})},_distance:function(t,e){if(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<100){var i=this._profileData;return i.setRandomRgba(),n.notifyHost("Initiate",{game:e.name,join:1,player:{uniqueid:i.uniqueid,nickname:i.nickname,position:t,rgba:i.rgba}}),o.setTouchStart(null),!0}return!1},handleInitiate:function(t){var e=t;1==e.join&&this._loadUI(e.game,{method:"startGame",event:t})}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client",Notifier:"Notifier"}],FingerpartyCountPicker:[function(t,e,i){"use strict";cc._RF.push(e,"abf995XnZ5Er6DeDxJFDBoH","FingerpartyCountPicker");var n=t("Notifier"),o=t("BargameControl");t("MessageManager");cc.Class({extends:t("Client"),properties:{GameItems:[cc.Node]},start:function(){this._profileData=t("DataModal").getInstance().profileData},onDestroy:function(){n.removeClient(this)},_init:function(){var t=this;o.setTouchStart(function(e){t.GameItems.some(function(i){return t._distance(e,i)})})},_distance:function(t,e){if(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<100){var i=this._profileData;return i.setRandomRgba(),n.notifyHost("initiate",{game:e.name,join:1,player:{uniqueid:i.uniqueid,nickname:i.nickname,position:t,rgba:i.rgba}}),o.setTouchStart(null),!0}return!1},handleInitiate:function(t){var e=t;1==e.join&&this._loadUI(e.game,{method:"startGame",event:t})}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client",DataModal:"DataModal",MessageManager:"MessageManager",Notifier:"Notifier"}],FingerparytRoulette:[function(t,e,i){"use strict";cc._RF.push(e,"1a14f4kY5RJPKJD3HmrcKye","FingerparytRoulette");var n="BargameRoulette",o=t("Notifier"),a=t("BargameControl"),s=t("MessageManager");cc.Class({extends:t("Client"),properties:{TouchPointNode:cc.Node},start:function(){this._profileData=t("DataModal").getInstance().profileData},onDestroy:function(){this._super(),EVENT.dispatchNotify("NotifyEventDone")},startGame:function(t){var e=this;this.TouchPointNode.active=!1,this._touchpoints={},this._tapFlag=!1,this.inactive(t),this._profileData.uniqueid===t.player.uniqueid?a.setTouchEnd(function(t){a.setTouchEnd(null),e._notifyPlay()}):a.setTouchStart(function(t){a.setTouchStart(null),e._tapFlag=!e._tapFlag,e._notifyInactive(e._tapFlag?1:0,t)})},_notifyInactive:function(t,e){var i=this._profileData;i.setRandomRgba(),o.notifyHost("inactive",{game:n,join:t,player:{uniqueid:i.uniqueid,nickname:i.nickname,position:e,rgba:i.rgba}})},inactive:function(t){var e=this,i=t.join,n=t.player,o=n.uniqueid,a=this._touchpoints[o];i?(a||((a=cc.instantiate(this.TouchPointNode)).parent=this.node,this._touchpoints[o]=a.getComponent("TouchPoint")),a.active=!0,a.getComponent("TouchPoint").setParam(n)):a&&a.runAction(cc.sequence(cc.scaleTo(.3,.1).easing(cc.easeInOut(2.2)),cc.callFunc(function(t){a.destroy(),delete e._touchpoints[o]})))},_notifyPlay:function(){o.notifyHost("play",{game:n})},play:function(t){a.setTouchStart(null),this._notifyBet(1)},_notifyBet:function(t){o.notifyHost("bet",{game:n,player:{uniqueid:this._profileData.uniqueid,nickname:this._profileData.nickname},chip:t})},bet:function(){},call:function(t){HASH.isHost&&this._notifyRoulette(t.count)},_notifyRoulette:function(t){var e=3*t,i=Math.round(100*Math.random())%t;o.notifyHost("Roulette",{game:n,count:e+i})},handleRoulette:function(t){var e=this,i=t.players,n=t.form,o=t.to,a=i.findIndex(function(t){return t.uniqueid===e._profileData.uniqueid});if(-1!=a){var c=this._profileData.rgba,r=i.length,l=n,h=o,d=1/r;(function t(){if(l<=h){var n=l%r;e._touchpoints[i[(n-1+r)%r].uniqueid].select(!1),e._touchpoints[i[n].uniqueid].select(!0),a==n&&(s.warn({color:c,text:" ",size:60}),d+=1/(h+1-l)),l++,e.unscheduleAllCallbacks(),e.scheduleOnce(t.bind(e),d)}else{var o=function(){e.node.destroy()};i[h%r].uniqueid==e._profileData.uniqueid?s.warn({text:"\u265b",size:260,flicker:5,color:c,callback:o.bind(e)}):o()}})()}else this.node.destroy()}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client",DataModal:"DataModal",MessageManager:"MessageManager",Notifier:"Notifier"}],GameEnum:[function(t,e,i){"use strict";var n;function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"78564pyVw9A+7tKe5lCcuS9","GameEnum");var a=cc.Enum({StoryTeller:-1,Dnd:-1,Chat:-1,Dice:-1,YellowCard:-1}),s=(o(n={},a.StoryTeller,"StoryTeller"),o(n,a.Dnd,"Dnd"),o(n,a.Chat,"Chat"),o(n,a.Dice,"Dice"),o(n,a.YellowCard,"YellowCard"),n);e.exports={Games:a,GameName:s},cc._RF.pop()},{}],Hoster:[function(t,e,i){"use strict";cc._RF.push(e,"8773curYeFHIKbhCHpe2Ioi","Hoster");var n=t("Notifier");cc.Class({extends:cc.Component,onLoad:function(){n.mapHoster(this),this._players=[],this._chairs=[]},handleNewRoom:function(t){n.broadcast("JoinRoom",t)},handleKickRoom:function(t){n.shutdown(),n.broadcast("LeaveRoom",t)},handleStartActivity:function(t){n.broadcast("Initiate",t)},handleJoin:function(t){n.broadcast("Inactive",t)},handleChairShuffle:function(){this._chairs.map()},handleAbort:function(t){n.broadcast("Leave",t)},handleMove:function(t){n.broadcast("Move",t)},handleUtter:function(t){n.broadcast("Utter",t)},handleAsk:function(t){n.broadcast("Ask",t)},handleRespon:function(t){n.broadcast("Respon",t)},handleWinner:function(t){n.broadcast("Winner",t)},handleRollDice:function(t){n.broadcast("RollDice",t)}}),cc._RF.pop()},{Notifier:"Notifier"}],Identitiy:[function(t,e,i){"use strict";cc._RF.push(e,"246015Sd+VNsrmY6vvXOeoD","Identitiy");var n=t("Notifier").Link,o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(new Date).getTime().toString(16)+"_"+t};e.exports={getSession:function(t){return new Promise(function(e,i){var a=LocalCache.getItem("user_nickname",t),s=LocalCache.getItem("user_uniqueid",o());n.read("Users/"+s).then(function(t){var i=t.success,n=t.data;i?(cc.log("\u6709\u8cc7\u6599",s,n.nickname),e({uniqueid:s,nickname:n.nickname})):(cc.log("\u6c92\u8cc7\u6599"),e({uniqueid:s,nickname:a}))})})},trilLogin:function(t){return new Promise(function(e,i){n.read("Users/"+t).then(function(t){var n=t.success,o=t.data;n?e(o):i(null)})})},login:function(t,e){return new Promise(function(i,a){Config.LocalMode?i(o()):t&&e&&n.read("Users/").then(function(e){var n=e.success,o=e.data;n?Object.keys(o).some(function(e){if(e.split("_")[1]==t)return i(o),!0}):a(null)})})},logout:function(){LocalCache.removeItem("user_nickname"),LocalCache.removeItem("user_uniqueid")},timestampid:o,register:function(t,e,i){return t&&LocalCache.setItem("user_nickname",t),uniqueid&&LocalCache.setItem("user_uniqueid",o(e)),i&&LocalCache.setItem("user_password",i),n.write("Users/"+uniqueid,{nickname:t,password:i})},guestNickname:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Guest",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=t,n=0;n<e;n++)i+=(Math.round(100*Math.random())%10).toString();return i}},cc._RF.pop()},{Notifier:"Notifier"}],MagneticBall:[function(t,e,i){"use strict";cc._RF.push(e,"ed5d3eOQIlP15CReYjlfq2z","MagneticBall");var n=t("Throw");cc.Class({extends:t("BulletEnermy"),properties:{},onLoad:function(){this.target=null},lookAt:function(t){var e=this,i=this.node,o=this.target=t,a=Math.random()+.5,s=Math.random(),c=3*Math.random()+1,r=500*Math.random()+300,l=3*Math.random()+1,h=-n.angle(i,o);i.runAction(cc.sequence(cc.rotateTo(a,h),cc.tintTo(s,cc.Color.YELLOW),cc.spawn(cc.tintTo(c,cc.Color.WHITE),cc.moveTo(c,n.project(i,-h,r)).easing(cc.easeOut(2))),cc.delayTime(l),cc.callFunc(function(t){return e.lookAt(o)})))},update:function(){this._distance(this.node,this.target)},_distance:function(t,e){Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<100?EVENT.dispatchNotify("NotifyEventDone"):t.color=cc.Color.WHITE}}),cc._RF.pop()},{BulletEnermy:"BulletEnermy",Throw:"Throw"}],MapGridItem:[function(t,e,i){"use strict";cc._RF.push(e,"af41aI37tVMhZaDK/F3IrG5","MapGridItem"),cc.Class({extends:cc.Component,properties:{ColorBoard:cc.Node},setGridSize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.node.setContentSize(t),this.ColorBoard.setContentSize(t.width+e,t.height+e),this},setOpacity:function(t){return this.ColorBoard.opacity=t,this},setSelectedColor:function(t){return this.ColorBoard.color=t,this},getSelectedColor:function(){return this.ColorBoard.color},setNodeIn:function(t){t.parent=this.node,t.active=!0},getSiblingIndex:function(){return this.node.getSiblingIndex()},onClicked:function(){EVENT.dispatchNotify("NotifyClickMapGridItem",this)}}),cc._RF.pop()},{}],MapGrid:[function(t,e,i){"use strict";cc._RF.push(e,"553089bTvRKqI+QZOKGMWBZ","MapGrid");var n=t("Notifier");cc.Class({extends:cc.Component,properties:{RoleList:t("RoleList"),RoleNode:cc.Node},onLoad:function(){this._profileData=t("DataModal").getInstance().profileData,this._roleNodes={},this._rgbaColor={},this._playerCount=0,n.mapClient(this),EVENT.addListener("NotifyClickMapGridItem",this._notifyClickMapGridItem,this)},onDestroy:function(){EVENT.removeListener("NotifyClickMapGridItem",this._notifyClickMapGridItem,this)},_setRoleColor:function(t){var e=t.r,i=t.g,n=t.b,o=t.a,a=void 0===o?255:o;this._rgbaColor={r:e,g:i,b:n,a:a}},handleShowMap:function(t){var e=t.url;this._loadMapPicture(e),this.node.active=!0},_roleJoin:function(t){var e=t,i=e.player,n=cc.instantiate(this.RoleNode);return n.name=i,n.color=new cc.Color(t.rgba),n.setPosition(0,0),n.getComponentInChildren(cc.Label).string=e.name,e.player==this._profileData.uniqueid&&this._setRoleColor(e.rgba),this._selectPlayer=i,this._roleNodes[i]=n,this._playerCount++,n},_loadMapPicture:function(t){var e=this.node.getComponent(cc.Sprite),i=this._rematchSize.bind(this);cc.loader.load({url:t,type:"png"},function(t,n){if(t)return cc.error(t);e.spriteFrame=new cc.SpriteFrame(n),i()})},move:function(t){var e=t.position;e.next&&this.node.children[e.next].getComponent("MapGridItem").setColor(new cc.Color(t.rgba)),e.prev&&this.node.children[e.prev].getComponent("MapGridItem").setColor(cc.Color.WHITE),e.curr&&this.node.children[e.curr].getComponent("MapGridItem").setRole(this._roleNodes[t.player])},_rematchSize:function(){this.node.children.forEach(function(t,e){return e>0&&t.destroy()});var t=cc.size(36.5,36.5),e=this.node.children[0].getComponent("MapGridItem");e.setGridSize(t,2),e.setOpacity(70),e.setColor(cc.Color.WHITE);var i=this.node.getContentSize(),n=i.width/36.5*i.height/36.5;n--;for(var o=0;o<n;o++){cc.instantiate(this.node.children[0]).parent=this.node}cc.log(this._selectPlayer,this._roleNodes[this._selectPlayer]),this.node.children[this._playerCount].getComponent("MapGridItem").setRole(this._roleNodes[this._selectPlayer])},_notifyClickMapGridItem:function(t){var e=t.detail;if(e.getColor()._val==cc.Color.WHITE._val){var i=e.getSiblingIndex(),o=this._selectPlayer,a={curr:i};n.notifyHost("move",{pic:"pic_02",rgba:this._rgbaColor,player:o,position:a}),this._position=a.next}},onHostMoveRoleClicked:function(t){var e=t.target.parent;HASH.isHost&&(this._selectPlayer=e.name)},onHostRemoveRoleClicked:function(t){var e=t.target.parent;HASH.isHost&&(this.RoleList.removeRole(e),this._roleNodes[e.name]&&this._roleNodes[e.name].destroy())}}),cc._RF.pop()},{DataModal:"DataModal",Notifier:"Notifier",RoleList:"RoleList"}],MessageBox:[function(t,e,i){"use strict";cc._RF.push(e,"00b0bArzIRNi6sx54PDq5Rg","MessageBox");t("Notifier");cc.Class({extends:cc.Component,properties:{MessageLine:cc.Node},onLoad:function(){},addMessage:function(t){var e=cc.instantiate(this.MessageLine);e.parent=this.node,e.active=!0,e.getComponent("MessageLine").setParam(t)},onReplaceWordClicked:function(){},onHideClicked:function(){this.node.active=!1}}),cc._RF.pop()},{Notifier:"Notifier"}],MessageLine:[function(t,e,i){"use strict";cc._RF.push(e,"4fecbAahPtEOLllSnsERZXw","MessageLine");var n=t("Notifier");cc.Class({extends:cc.Component,properties:{Label:cc.Label,Editbox:cc.EditBox},onLoad:function(){},setParam:function(t){this._player=t.player||"",this.Label.string=this._player?this._player+": "+t.text:t.text},replaceWord:function(t,e){var i=this.Label.string.replace(new RegExp(" "+t+" ","gi"),e);this.Label.string=i},onFirstClicked:function(){this.Editbox.node.active=!0,this.Label.node.active=!1,this.Editbox.node.height=this.Label.node.height,this.Editbox.string=this.Label.string},onBrocastClicked:function(){this.node.destroy(),n.notifyClient("utter",{player:this._player,text:this.Editbox.string})},onDeleteClicked:function(){this.node.destroy()}}),cc._RF.pop()},{Notifier:"Notifier"}],MessageManager:[function(t,e,i){"use strict";cc._RF.push(e,"7d7a84itmdEEZb0+xV0HzfL","MessageManager");var n=null,o=[];cc.Class({extends:cc.Component,statics:{warn:function(t){n&&n.warn(t)},addMessage:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(n){var i={view:cc.instantiate(n.Message).getComponent("MessageView"),param:t};e?n.addMessage(i):n.showMessage(i)}},closeMessage:function(t){n&&n.closeMessage(t)},closeAllMessage:function(){n&&(o=[],n._activeMessages.forEach(function(t){return n.closeMessage(t)}))}},properties:{Message:cc.Node,Warn:cc.Node},onLoad:function(){n=this,this._activeMessages=[]},warn:function(t){var e=this;this.Warn.color=t.color,this.Warn.active=!0,this.Warn.opacity=0,this.Warn.stopAllActions(),this.Warn.runAction(cc.sequence(cc.repeat(cc.sequence(cc.fadeTo(.2,255),cc.delayTime(.3),cc.fadeTo(.5,80)),t.flicker||1),cc.callFunc(function(i){e.Warn.active=!1,t.callback&&t.callback()})));var i=this.Warn.getComponentInChildren(cc.Label);t.text&&(i.string=t.text),t.size&&(i.fontSize=t.size,i.lineHeight=t.size+Math.floor(t.size/4))},addMessage:function(t){0==this._activeMessages.length?this.showMessage(t):o.push(t)},showMessage:function(t){if(t){var e=t.view;e.node.parent=this.node,e.setParam(t.param),e.show(),this._activeMessages.push(e)}},closeMessage:function(t){var e=this._activeMessages.findIndex(function(e){var i=e==t;return i&&e.node.destroy(),i});this._activeMessages.splice(e,1),0==this._activeMessages.length&&this.showMessage(o.shift())}}),cc._RF.pop()},{}],MessageView:[function(t,e,i){"use strict";cc._RF.push(e,"4797fkooQ5Oh5SS+d8e3lE6","MessageView");var n=t("MessageManager");cc.Class({extends:cc.Component,properties:{Label:cc.Label},setParam:function(t){this.Label.string=t.text,this._callback=t.callback},show:function(){this.node.active=!0,this._showAnimation()},close:function(){this._closeAnimation()},_showAnimation:function(){this.node.opacity=0,this.node.setScale(.6,.6),this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeTo(.2,220),cc.scaleTo(.2,1)))},_closeAnimation:function(){var t=this;this.node.runAction(cc.sequence(cc.spawn(cc.fadeTo(.2,0),cc.scaleTo(.2,.6)),cc.callFunc(function(e){return n.closeMessage(t)})))},onCloseClicked:function(){this._closeAnimation(),this._callback&&this._callback()}}),cc._RF.pop()},{MessageManager:"MessageManager"}],Move:[function(t,e,i){"use strict";cc._RF.push(e,"3c894Jsb6xK36NCHQaGiarY","Move"),cc.Class({extends:cc.Component,properties:{Target:cc.Node,ForceTarget:cc.Node},onLoad:function(){this._duration=.01,this._magnitude=0,this._xForce=0,this._damping=0,this._point={x:0,y:0}},start:function(){},faceTo:function(t,e){var i=this.node.getPosition(),n=t.x,o=t.y,a=180+Math.atan2(o-i.y,n-i.x)/Math.PI*180;return e?cc.tween(this.node).to(e,{angle:a}).start():this.ForceTarget.angle=a,this},maxForce:function(t){return this._maxMagnitude=t,this},addForce:function(t){var e=this._magnitude+t,i=this._maxMagnitude;return this._magnitude=Math.max(Math.min(i,e),-i),this.ForceTarget.angle=this._magnitude>0?180:0,this},gravity:function(t){return this._gravityFall=t,this},support:function(t){return this._supportForce=t,this._yForce=0,this},retard:function(t){return this._damping=t,this},run:function(){var t=this;this.unscheduleAllCallbacks(),this.schedule(function(){var e=Math.abs(t._magnitude);t._forceEffect(e)},this._duration,cc.repeatForever)},throw:function(){var t=this;this.unscheduleAllCallbacks(),this.schedule(function(){var e=Math.abs(t._magnitude);t._forceEffect(e),t._dampingEffect(e);t.theta(t._gravityFall,t._magnitude,1)},this._duration,cc.repeatForever)},_forceEffect:function(t){var e=this.node,i=e.x,n=e.y,o=this.ForceTarget.angle;this.node.setPosition(i-t*Math.cos(o*Math.PI/180),n-t*Math.sin(o*Math.PI/180))},_dampingEffect:function(t){t>.2?this._magnitude=t*this._damping:this.unscheduleAllCallbacks()},theta:function(t,e,i){var n=e/t,o=90-Math.atan(n)/Math.PI*180;cc.log(this.ForceTarget.angle,o),this.ForceTarget.angle=o}}),cc._RF.pop()},{}],NodeResize:[function(t,e,i){"use strict";cc._RF.push(e,"d6491AFL1RM24q7fOIDGtq3","NodeResize"),cc.Class({extends:cc.Component,properties:{top:0,bottom:0},onEnable:function(){var t=cc.Canvas.instance.node.getContentSize();this.node.setContentSize(cc.size(t.width-this.top,t.height-this.bottom))}}),cc._RF.pop()},{}],Notifier:[function(t,e,i){"use strict";cc._RF.push(e,"7d141ewrHhOkKLwmS0HyZA+","Notifier");var n=null,o=[],a=null,s=0;cc.Class({extends:cc.Component,properties:{ClientViewNode:cc.Node},statics:{mapHoster:function(t){n=t},mapClient:function(t){o.push(t)},removeClient:function(t){o.splice(o.findIndex(function(e){return e==t}),1)},request:function(t,e){a&&a.requestHandler(Object.assign(e,{notify:t}))},broadcast:function(t,e){HASH.isHost&&a&&a.broadcastHandler(Object.assign(e,{notify:t,sn:s+1}))},shutdown:function(){a&&(s=0,HASH.isHost&&FirebaseWrapper.remove(HASH.ref.reconnect))}},onLoad:function(){var t=this;if(a=this,this._addListener(),HASH.event){var e=HASH.event+"ClientView";cc.loader.loadRes("prefabs/board/"+e,function(t,e){t||(cc.instantiate(e).parent=this.ClientViewNode)}.bind(this))}this.requestHandler=HASH.isOnline?function(t){return FirebaseWrapper.write(HASH.ref.hoster,t)}:function(e){return t.hosterHandler({success:!0,data:e})},this.broadcastHandler=HASH.isOnline?function(t){FirebaseWrapper.write(HASH.ref.client,t),FirebaseWrapper.push(HASH.ref.reconnect,t)}:function(t){return a.clientHandler({success:!0,data:t})},window.onbeforeunload=this.clear.bind(this)},clear:function(){this._removeListener(),n=null,o=[]},_addListener:function(){HASH.isHost&&FirebaseWrapper.addListener(HASH.ref.hoster,this.hosterHandler,this),FirebaseWrapper.addListener(HASH.ref.client,this.clientHandler,this)},_removeListener:function(){FirebaseWrapper.removeListener(HASH.ref.client),HASH.isHost&&(FirebaseWrapper.removeListener(HASH.ref.hoster),FirebaseWrapper.remove(HASH.ref.hoster),FirebaseWrapper.remove(HASH.ref.client),FirebaseWrapper.remove(HASH.ref.reconnect))},hosterHandler:function(t){var e=t.success,i=t.data;if(e&&n){var o="handle"+i.notify;n[o]&&n[o](i)}},clientHandler:function(t){var e=t.success,i=t.data;if(e&&o.length>0){var n=function(t){var e="handle"+t.notify;o.forEach(function(i){i[e]&&i[e](t)})},a=i.sn-s;s=i.sn,1===a?n(i):HASH.isOnline&&FirebaseWrapper.read(HASH.ref.reconnect).then(function(t){var e=t.success,i=t.data;t.num;if(e){var o=Object.keys(i);o.splice(o.length-a).forEach(function(t){return n(i[t])})}})}}}),cc._RF.pop()},{}],NumericalLift:[function(t,e,i){"use strict";cc._RF.push(e,"d8fbcm6sqBC35cJfN1njb4F","NumericalLift"),cc.Class({extends:cc.Component,properties:{NumberLabel:cc.Label,Maximum:0,Minimum:0,IsAbsolute:!1},onLoad:function(){this._num=0},setParam:function(t){var e=t.num,i=t.callback;this._num=e,this.NumberLabel.string=e.toString(),this._callback=i},getParam:function(){return{num:this._num}},_adjustment:function(t){this._num=t,this.NumberLabel.string=this._num.toString(),this._callback&&this._callback(this._num)},onAddClicked:function(t,e){var i=parseInt(e,10)||1,n=this._num+i;(n<=this.Maximum||0==this.Maximum)&&this._adjustment(n)},onLessClicked:function(t,e){if(!this.IsAbsolute||0!=this._num){var i=parseInt(e,10)||1,n=this._num-i;(n>=this.Minimum||0==this.Minimum)&&this._adjustment(n)}}}),cc._RF.pop()},{}],PainterLoader:[function(t,e,i){"use strict";cc._RF.push(e,"3b856IhUnFCG5OhTOJpLbNW","PainterLoader"),cc.Class({extends:cc.Component,properties:{PixelImageCanvas:t("PixelImageCanvas")},onLoad:function(){},onClicked:function(t){var e=t.target.getComponent("PixelImageCanvas");e.getGroupSize();this.PixelImageCanvas.setHexColors(e.getHexColors())}}),cc._RF.pop()},{PixelImageCanvas:"PixelImageCanvas"}],PixelCanvas:[function(t,e,i){"use strict";cc._RF.push(e,"0808eF8vQtCWbDXYF8dPaw2","PixelCanvas"),cc.Class({extends:cc.Component,properties:{PixelLayout:cc.Node,PixelDot:cc.Node,LoadingMask:cc.Node,LoadingTips:cc.Label},setPixelLayout:function(t,e,i){var n=t*e,o=this.PixelLayout.getChildren(),a=t*i,s=e*i;this.PixelDot.setContentSize(i,i),o.forEach(function(t){return t.active=!1});for(var c=0;c<n;c++){var r=o[c]||cc.instantiate(this.PixelDot);r.active=!0,r.parent=this.PixelLayout}this.node.setContentSize(a,s),this.LoadingMask.setContentSize(a,s),this.PixelLayout.setContentSize(a,s),this._canvasPixelWidth=t,this._canvasPixelHeight=e,this._pixelDotSize=i,this._pixels=this.PixelLayout.getChildren()},rgbDot:function(t,e){var i=this._pixels[t];i.color=e,i.opacity=255},rgbDotPick:function(t){return this._pixels[t].color},hexDraw:function(t){var e=this;Object.keys(t).forEach(function(i){var n=(new cc.Color).fromHEX(i);t[i].forEach(function(t){var i=e._pixels[t];i.opacity=255,i.color=n})})},hexColorPaint:function(t){var e=(new cc.Color).fromHEX(t);this._pixels.forEach(function(t){t.opacity=255,t.color=e})},dotRandomRgbColor:function(t){var e=t.length;this._pixels.forEach(function(i){i.color=t[Math.round(100*Math.random())%e],i.opacity=255})},hexCapture:function(){var t={};return this._pixels.forEach(function(e,i){if(e.active&&0!=e.opacity){var n=e.color.toHEX("#rrggbb");t[n]?t[n].push(i):t[n]=[i]}}),t},cleanAllPixelsColor:function(){this._pixels.forEach(function(t){return t.opacity=0})},loadingTips:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t>0&&(this.LoadingMask.stopAllActions(),this.LoadingMask.runAction(cc.fadeTo(t,e))),this.LoadingTips.string=i},getCanvasPixelWdith:function(){return this._canvasPixelWidth},getCanvasPixelHeight:function(){return this._canvasPixelHeight},_reverseCanvasDots:function(){var t=this,e=[];this._pixels.forEach(function(i,n){e.push(i.color),n>0&&n%(t._canvasPixelWidth-1)==0&&(e.reverse().forEach(function(e,i){t._pixels[n+i].color=e}),e=[])})}}),cc._RF.pop()},{}],PixelContentSlider:[function(t,e,i){"use strict";cc._RF.push(e,"8d300TzjiJEQolOL7y7T1TV","PixelContentSlider"),cc.Class({extends:cc.Component,properties:{MaskNode:cc.Node,PixelImagePainter:t("PixelImagePainter")},onLoad:function(){var t=cc.director.getScene().getChildren()[0];this._sceneWidth=t.width,this._sceneHeight=t.height,this._contentPixelWidth=0,this._contentPixelHeight=0,this._pixelDotSize=0,this._sliderDelta={x:0,y:0}},start:function(){this.setContentSize(10,10,20),this.PixelImagePainter.newCanvas()},setContentSize:function(t,e,i){this._contentPixelWidth=t,this._contentPixelHeight=e,this._pixelDotSize=i,this.PixelImagePainter.setCanvasSize(t,e,i),this.node.off(cc.Node.EventType.TOUCH_START,this._touchSideCallback),this._touchSideCallback=this._sideTouchEventHandler(this._startSlide.bind(this)),this.node.on(cc.Node.EventType.TOUCH_START,this._touchSideCallback)},getPixelSliderDelta:function(){return{x:Math.floor(this._sliderDelta.x/this._pixelDotSize)*this._pixelDotSize,y:Math.floor(this._sliderDelta.y/this._pixelDotSize)*this._pixelDotSize}},_startSlide:function(t){var e=.5*this._sceneWidth,i=.5*this._sceneHeight;(Math.abs(t.x-e)>.5*this.MaskNode.width||Math.abs(t.y-i)>.5*this.MaskNode.height)&&(this._caressSideCallback=this._sideTouchEventHandler(this._currentSlide.bind(this)),this._leaveSideCallback=this._sideTouchEventHandler(this._endSlide.bind(this)),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._caressSideCallback),this.node.on(cc.Node.EventType.TOUCH_END,this._leaveSideCallback))},_currentSlide:function(){this.PixelImagePainter.setCanvasPosition(this.getPixelSliderDelta())},_endSlide:function(){this.PixelImagePainter.setCanvasPosition(this.getPixelSliderDelta()),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._caressSideCallback),this.node.off(cc.Node.EventType.TOUCH_END,this._leaveSideCallback)},_sideTouchEventHandler:function(t){var e=this;return function(i){var n=i.touch.getLocation(),o=i.touch.getDelta();e._sliderDelta.x+=o.x,e._sliderDelta.y+=o.y,cc.log(e._sliderDelta,n),t(n)}},clickOnZoomIn:function(){this._pixelDotSize<20&&this.PixelImagePainter.setCanvasSize(this._contentPixelWidth,this._contentPixelHeight,++this._pixelDotSize)},clickOnZoomOut:function(){this._pixelDotSize>1&&this.PixelImagePainter.setCanvasSize(this._contentPixelWidth,this._contentPixelHeight,--this._pixelDotSize)}}),cc._RF.pop()},{PixelImagePainter:"PixelImagePainter"}],PixelImageCanvas:[function(t,e,i){"use strict";cc._RF.push(e,"0aa2f56qKdJnpIk4OkfC23z","PixelImageCanvas"),cc.Class({extends:cc.Component,properties:{PixelDot:cc.Node},dotRandomRgbColor:function(t){var e=t.length;this._dotList.forEach(function(i){i.color=t[Math.round(100*Math.random())%e],i.opacity=255})},setGridsSize:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e*i;this.PixelDot.setContentSize(t,t);for(var a=this.node.getChildren(),s=0;s<o;s++){var c=a[s]||cc.instantiate(this.PixelDot);c.active=!0,c.opacity=0,c.parent=this.node,c.setContentSize(t,t)}this._dotList=this.node.getChildren(),this.node.setContentSize(e*(t+n)-n,i*(t+n)-n);var r=this.node.getComponent(cc.Layout)||this.node.addComponent(cc.Layout);r.type=cc.Layout.Type.GRID,r.spacingX=r.spacingY=n,r.horizontalDirection=cc.Layout.HorizontalDirection.LEFT_TO_RIGHT,r.verticalDirection=cc.Layout.VerticalDirection.BOTTOM_TO_TOP,this._groupSize={horizontal:e,vertical:i}},getGroupSize:function(){return this._groupSize},setRgbColor:function(t,e){var i=this._dotList[t];i.color=e,i.opacity=255},setRbgColors:function(t){var e=this;t.forEach(function(t,i){return e.setRgbColor(i,t)})},setHexColors:function(t){var e=this;Object.keys(t).forEach(function(i){var n=(new cc.Color).fromHEX(i);t[i].forEach(function(t){return e.setRgbColor(t,n)})})},setHexColorFill:function(t){if("String"==typeof t)return cc.error(t,'\u7684\u683c\u5f0f\u4e0d\u7b26\uff0c\u61c9\u8a72\u70ba"ffcc00"\u9019\u6a23\u7684hex\u8a18\u865f');var e=(new cc.Color).fromHEX(t);this._dotList.forEach(function(t){t.color=e,t.opacity=255})},getHexColors:function(){var t={};return this._dotList&&this._dotList.forEach(function(e,i){if(e.active&&0!=e.opacity){var n=e.color.toHEX("#rrggbb");t[n]?t[n].push(i):t[n]=[i]}}),t},cleanPixelsColor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._dotList&&(t>-1?this._dotList[t].opacity=0:this._dotList.forEach(function(t){return t.opacity=0}))}}),cc._RF.pop()},{}],PixelImageEditor:[function(t,e,i){"use strict";cc._RF.push(e,"50f1elo8fpB8rIWuY1f7QAB","PixelImageEditor");t("PixelPackage");cc.Class({extends:cc.Component,properties:{PixelPreview:t("PixelPreview"),PixelContentSlider:t("PixelContentSlider"),PixelImagePainter:t("PixelImagePainter")},onLoad:function(){this.PixelPreview.open(),NAERT.addListener("NotifyPixelCanvasNew",this._pixelCanvasNew.bind(this)),NAERT.addListener("NotifyPixelCanvasEdit",this._pixelCanvasEdit.bind(this))},setCanvasSize:function(t,e,i){this.node.setContentSize(t*i,e*i),this.PixelContentSlider.setContentSize()},_pixelCanvasNew:function(){var t=this.PixelPreview.getInfo();this.setCanvasSize(t.width,t.height,8),this.PixelImagePainter.newCanvas()},_pixelCanvasEdit:function(){var t=this.PixelPreview.getInfo();this.setCanvasSize(t.width,t.height,8),this.PixelImagePainter.editCanvas()},_pixelCanvasSave:function(){var t=this.PixelImagePainter.captureCanvas();this.PixelPreview.previewImage(t)},clickOnSave:function(){this._pixelCanvasSave()},clickOnLoad:function(){this.PixelPreview.open()}}),cc._RF.pop()},{PixelContentSlider:"PixelContentSlider",PixelImagePainter:"PixelImagePainter",PixelPackage:"PixelPackage",PixelPreview:"PixelPreview"}],PixelImageList:[function(t,e,i){"use strict";cc._RF.push(e,"8ccfcWVOspMcrNVdJIABeRc","PixelImageList");t("PixelPackage");cc.Class({extends:cc.Component,properties:{PixelCanvasRoot:cc.Node,PixelCanvasNode:cc.Node,PixelSize:4},start:function(){this.PixelCanvasNode.active=!1,this.loadTypeList("Character")},loadTypeList:function(t){var e=this;FirebaseWrapper.read("Pixel/"+t).then(function(t){var i=t.success,n=t.data;i&&Object.keys(n).forEach(function(t){var i=cc.instantiate(e.PixelCanvasNode);i.parent=e.PixelCanvasRoot,i.active=!0;var o=i.getComponent("PixelImageCanvas");o.setGridsSize(e.PixelSize,n[t].hor,n[t].ver),o.setHexColors(n[t].hex)})})}}),cc._RF.pop()},{PixelPackage:"PixelPackage"}],PixelImageLoader:[function(t,e,i){"use strict";cc._RF.push(e,"3c0e5jlHAxA4ZSkyKH17u46","PixelImageLoader");t("PixelPackage");cc.Class({extends:cc.Component,properties:{PixelCanvasNode:cc.Node,PixelSize:4,Path:""},start:function(){var t=this;this.PixelCanvasNode.active=!1,this.Path&&FirebaseWrapper.read("Pixel/"+this.Path).then(function(e){var i=e.success,n=e.data;if(i){var o=t.node.getComponent("PixelImageCanvas")||t.node.addComponent("PixelImageCanvas");o.setGridsSize(t.PixelSize,n.hor,n.ver),o.setHexColors(n.hex),t.PixelCanvasNode.active=!0}})}}),cc._RF.pop()},{PixelPackage:"PixelPackage"}],PixelImagePainter:[function(t,e,i){"use strict";var n;function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"2b4d8ijLmdB3qLkhY0uDCtm","PixelImagePainter");var a=cc.Enum({DOT_DRAW:-1,PAINT:-1,MIRROR:-1});cc.Class((o(n={extends:cc.Component,properties:{PixelCanvas:t("PixelCanvas"),RgbColorPicker:t("RgbColorPicker")},onLoad:function(){this._drawType=a.DOT_DRAW,this._sliderDelta={x:0,y:0},EVENT.addListener("NotifyRgbColorPickerPickColor",this._rgbColorPickerPickColor,this)},start:function(){this._rgbColorPickerPickColor()},setCanvasSize:function(t,e,i){this._canvasPixelWidth=t,this._canvasPixelHeight=e,this._pixelDotSize=i,this._tapedTimes=0,this._maximum=t*e,this.PixelCanvas.setPixelLayout(t,e,i),this.node.setContentSize(t*i,e*i),this._setPixelDrawCallback()},setCanvasPosition:function(t){var e=t.x,i=t.y;this.node.setPosition(e,i)},newCanvas:function(){this.PixelCanvas.cleanAllPixelsColor(),this.PixelCanvas.loadingTips(.1,0)},editCanvas:function(){this.PixelCanvas.hexDraw(info.pixels),this.PixelCanvas.loadingTips(.1,0)},captureCanvas:function(){return this.PixelCanvas.hexCapture()},_setPixelDrawCallback:function(){var t=cc.director.getScene().getChildren()[0],e=.5*t.width+this.node.x-this._canvasPixelWidth*this._pixelDotSize*.5+this._sliderDelta.x,i=.5*t.height+this.node.y-this._canvasPixelHeight*this._pixelDotSize*.5+this._sliderDelta.y;this.node.off(cc.Node.EventType.TOUCH_MOVE,this._touchPixelCallback),this._touchPixelCallback=this._pixelTouchEventHandler(e,i),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._touchPixelCallback)},_pixelTouchEventHandler:function(t,e){var i=this,n=this._drawSwitch();return function(o){var a=o.touch.getLocation(),s=i._canvasPixelHeight-Math.floor((a.y-e)/i._pixelDotSize)-1,c=Math.floor((a.x-t)/i._pixelDotSize),r=s*i._canvasPixelHeight+c;!i._checkSameColor(r)&&n(r)}},_checkSameColor:function(t){return!!this.PixelCanvas.rgbDotPick(t)&&this.PixelCanvas.rgbDotPick(t)._val==this._paintingColor._val},_drawSwitch:function(){switch(cc.log("this._drawType:",this._drawType),this._drawType){case a.DOT_DRAW:return this._dot.bind(this);case a.PAINT:return this._paint.bind(this);case a.MIRROR:return this._mirrorDot.bind(this)}},_dot:function(t){this.PixelCanvas.rgbDot(t,this._paintingColor)},_mirrorDot:function(t){var e=this._canvasPixelWidth-1-t%this._canvasPixelWidth;e+=Math.floor(t/this._canvasPixelWidth)*this._canvasPixelWidth,this.PixelCanvas.rgbDot(e,node.color),this.PixelCanvas.rgbDot(t,node.color)},_paint:function(t){this._rgbPaint(t,this._paintingColor)},_rgbPaint:function(t,e,i){if(t>-1&&t<this._maximum){var n=this.PixelCanvas.rgbDotPick(t);i?i._val==n._val&&this._spreadRgbPaint(t,e,i):this._spreadRgbPaint(t,e,n)}},_spreadRgbPaint:function(t,e,i){this.PixelCanvas.rgbDot(t,e),t%this._canvasPixelWidth!=0&&(this._rgbPaint(t-1,e,i),this._rgbPaint(t+1,e,i),this._rgbPaint(t-this._canvasPixelWidth,e,i),this._rgbPaint(t+this._canvasPixelWidth,e,i))},_rgbColorPickerPickColor:function(){this._paintingColor=this.RgbColorPicker.getPaletteColor()},clickOnDotDraw:function(){this._drawType=a.DOT_DRAW},clickOnPaint:function(){this._drawType=a.PAINT},clickOnMirror:function(){this._drawType=a.MIRROR}},"clickOnPaint",function(){this._drawType=a.PAINT,this._setPixelDrawCallback()}),o(n,"clickOnDot",function(){this._drawType=a.DOT_DRAW,this._setPixelDrawCallback()}),n)),cc._RF.pop()},{PixelCanvas:"PixelCanvas",RgbColorPicker:"RgbColorPicker"}],PixelPackage:[function(t,e,i){"use strict";cc._RF.push(e,"f8d1dS8vYRJdJeY4tlWrumH","PixelPackage");var n={};e.exports={layer:function(){return new Promise(function(t,e){FirebaseWrapper.read("Pixel/").then(function(i){var n=i.success,o=i.data;n?t(Object.keys(o)):e([])})})},layerIndex:function(t){return new Promise(function(e,i){FirebaseWrapper.read("Pixel/"+t).then(function(t){var n=t.success,o=t.data;n?e(Object.keys(o)):i([])})})},update:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"layer",e=arguments[1],i=type+"_"+e,o=n[i];return new Promise(function(a,s){o?a(o):e?FirebaseWrapper.read("Pixel/"+t+"/"+e).then(function(t){var e=t.success,o=t.data;e?a(n[i]=o):s("no image")}):s("no name")})},commit:function(t,e,i,n,o){return t&&e&&i&&n&&o?FirebaseWrapper.write("Pixel/"+t+"/"+e,{width:i,height:n,pixels:o}):Promise.reject("input fail")}},cc._RF.pop()},{}],PixelPainter:[function(t,e,i){"use strict";cc._RF.push(e,"cca207iYtZFKrFznSyeM88O","PixelPainter"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this._pencilMode=!0,EVENT.addListener("NotifyRgbColorPickerStartPickColor",this._notifyRgbColorPickerStartPickColor,this),EVENT.addListener("NotifyRgbColorPickerEndPickColor",this._notifyRgbColorPickerEndPickColor,this)},start:function(){return this._pixelCanvas=this.node.getComponentInChildren("PixelImageCanvas"),this._pixelCanvas?(this._rgbColorPicker=this.node.getComponentInChildren("RgbColorPicker"),this._rgbColorPicker?(this.setPixelDraw(20,20,30,0),this._notifyRgbColorPickerEndPickColor(),void this.setBackgroundColor(new cc.Color(100,100,100,0))):cc.error("\u8acb\u5728\u7bc0\u9ede\u4e0b\u65b0\u589e RgbColorPicker")):cc.error("\u8acb\u5728\u7bc0\u9ede\u4e0b\u65b0\u589e PixelCanvas")},_notifyRgbColorPickerStartPickColor:function(){this._isColorPicking=!0},_notifyRgbColorPickerEndPickColor:function(){this._isColorPicking=!1,this._paintingColor=this._rgbColorPicker.getPaletteColor()},setBackgroundColor:function(t){this.node.color=t},setPixelDraw:function(t,e,i){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=cc.director.getScene().children[0];this._pixelCanvas.setGridsSize(t,e,i,o),this.node.setContentSize(this._pixelCanvas.node);var s,c,r=.5*(this.node.width-a.width)+t,l=.5*(this.node.height-a.height),h=function(t){s=t.x+r,c=t.y+l},d=function(i){s+=i.x,c+=i.y,n._isColorPicking||s>t&&s-n.node.width<t&&c>0&&c<n.node.height&&(n._pencilMode?n._pixelCanvas.setRgbColor(Math.floor(c/t)*e+Math.floor(s/t)-1,n._paintingColor):n._pixelCanvas.cleanPixelsColor(Math.floor(c/t)*e+Math.floor(s/t)-1))};this.node.on(cc.Node.EventType.TOUCH_START,function(t){var e=t.touch;return h(e.getLocation())}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){var e=t.touch;return d(e.getDelta())})},onEraserClicked:function(t){this._pencilMode=!this._pencilMode,t.target.color=this._pencilMode?cc.Color.WHITE:cc.Color.GREEN},onSaveClicked:function(t){var e=this._pixelCanvas.getHexColors(),i={hex:e,hor:20,ver:30};if(0!=Object.keys(e).length){cc.log(FirebaseWrapper.push("Pixel/Character",i))}}}),cc._RF.pop()},{}],PixelPreview:[function(t,e,i){"use strict";cc._RF.push(e,"4a76asud9tClrkhRhaGYPwb","PixelPreview");var n=t("PixelPackage");cc.Class({extends:cc.Component,properties:{LayerEditBox:cc.EditBox,NameEditBox:cc.EditBox,WidthEditBox:cc.EditBox,HeightEditBox:cc.EditBox,DotSizeEditBox:cc.EditBox,CancelButton:cc.Button,SaveButton:cc.Button,LoadButton:cc.Button,EditButton:cc.Button,NewButton:cc.Button,CleanButton:cc.Button,LayerTagsEditbox:t("EditBoxTags"),NameTagsEditbox:t("EditBoxTags"),PixelCanvas:t("PixelCanvas")},onLoad:function(){this._pixelHexColors={}},open:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this.WidthEditBox.string=this._imageWidth=t,this.HeightEditBox.string=this._imageHeight=e,this.DotSizeEditBox.string=this._dotSize=i,this._init()},onLayerEditBoxEnded:function(){var t=this;n.layerIndex().then(function(e){return t.NameTagsEditbox.setData(e)})},onNameEditBoxEnded:function(){this.LoadButton.interactable=!0},onWidthEditBoxEnded:function(t){this._imageWidth=parseInt(t.string,10),this._resize()},onHeightEditBoxEnded:function(t){this._imageHeight=parseInt(t.string,10),this._resize()},onDotSizeEditBoxEnded:function(t){this._dotSize=parseInt(t.string,10),this._resize()},previewImage:function(t){this.node.active=!0;var e=this._pixelHexColors==t;this.CancelButton.interactable=!0,this.SaveButton.interactable=!e,this.LoadButton.interactable=e,this.EditButton.interactable=!0,this.NewButton.interactable=!1,this.CleanButton.interactable=!0,this.PixelCanvas.hexDraw(t),this._pixelHexColors=t},getInfo:function(){return{width:this._imageWidth,height:this._imageHeight,pixels:this._pixelHexColors}},_init:function(){this._resize(),this.PixelCanvas.loadingTips(.1,0),this.PixelCanvas.cleanAllPixelsColor()},_resize:function(){this.PixelCanvas.setPixelLayout(this._imageWidth,this._imageHeight,this._dotSize)},_previewUpload:function(){var t=this;this.PixelCanvas.loadingTips(1,255,"SAVING..."),this.CancelButton.interactable=!1,this.SaveButton.interactable=!1,this.LoadButton.interactable=!1,this.EditButton.interactable=!1,this.NewButton.interactable=!1,this.CleanButton.interactable=!1,n.commit(this.LayerEditBox.string,this.NameEditBox.string,parseInt(this.WidthEditBox.string,10),parseInt(this.HeightEditBox.string,10),parseInt(this.DotSizeEditBox.string,10),this._pixelHexColors).then(function(e){t.PixelCanvas.loadingTips(1,255,e?"SAVED!!!":"FAIL"),t.CancelButton.interactable=!0,t.SaveButton.interactable=!e,t.LoadButton.interactable=!0,t.EditButton.interactable=!0,t.NewButton.interactable=!1,t.CleanButton.interactable=!0}).catch(function(e){t.PixelCanvas.loadingTips(1,0,e),t.CancelButton.interactable=!0,t.SaveButton.interactable=!0,t.LoadButton.interactable=!1,t.EditButton.interactable=!0,t.NewButton.interactable=!1,t.CleanButton.interactable=!0})},_previewUpdate:function(){var t=this;this.PixelCanvas.loadingTips(1,255,"LOADING..."),this.CancelButton.interactable=!1,this.SaveButton.interactable=!1,this.LoadButton.interactable=!1,this.EditButton.interactable=!1,this.NewButton.interactable=!1,this.CleanButton.interactable=!1,n.update(this.LayerEditBox.string,this.NameEditBox.string).then(function(e){t._imageWidth=e.width,t._imageHeight=e.height,t._resize(),t.previewImage(e.pixels),t.PixelCanvas.loadingTips(.3,0)}).catch(function(e){return t.PixelCanvas.loadingTips(.1,255,e)})},onClickOpen:function(){this.open()},onClickClean:function(){this.PixelCanvas.cleanAllPixelsColor(),this._pixelHexColors={},this.CancelButton.interactable=!0,this.SaveButton.interactable=!1,this.LoadButton.interactable=!1,this.EditButton.interactable=!1,this.NewButton.interactable=!0,this.CleanButton.interactable=!1},onClickNew:function(){this._init(),this.node.active=!1,NAERT.dispatchCustomEvent("NotifyPixelCanvasNew")},onClickEdit:function(){this._init(),this.node.active=!1,NAERT.dispatchCustomEvent("NotifyPixelCanvasEdit")},onClickSave:function(){this._previewUpload()},onClickLoad:function(){this._previewUpdate()},onClickClose:function(){this._init(),this.node.active=!1},clickOnReverse:function(){this.PixelCanvas._reverseCanvasDots()},onClickZoomIn:function(){this._dotSize++,this.DotSizeEditBox.string=this._dotSize,this._resize()},onClickZoomOut:function(){this._dotSize>1&&(this._dotSize--,this.DotSizeEditBox.string=this._dotSize,this._resize())}}),cc._RF.pop()},{EditBoxTags:"EditBoxTags",PixelCanvas:"PixelCanvas",PixelPackage:"PixelPackage"}],PixelpainterClientView:[function(t,e,i){"use strict";cc._RF.push(e,"31790vyC8hP1YbVHJtQBKXv","PixelpainterClientView");var n=t("Notifier"),o=t("BargameControl");cc.Class({extends:t("Client"),properties:{GameItems:[cc.Node]},start:function(){},_init:function(){var t=this;o.setTouchStart(function(e){t.GameItems.some(function(i){return t._distance(e,i)})})},_distance:function(t,e){if(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<100){var i=this._profileData;return i.setRandomRgba(),n.notifyHost("Initiate",{game:e.name,join:1,player:{uniqueid:i.uniqueid,nickname:i.nickname,position:t,rgba:i.rgba}}),o.setTouchStart(null),!0}return!1}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client",Notifier:"Notifier"}],ProfileData:[function(t,e,i){"use strict";cc._RF.push(e,"a7ecfSsy25Lerz/Xoa40ake","ProfileData"),cc.Class({ctor:function(){this.uniqueid="",this.nickname="",this.position=cc.v2(0,0),this.rgba={r:255,g:255,b:255,a:255},this.dndRole={}},setIDNickname:function(t){t&&LocalCache.setItem("user_nickname",t);var e=(new Date).getTime().toString(16);return this.uniqueid=LocalCache.getItem("user_uniqueid",e),this.nickname=t||LocalCache.getItem("user_nickname",""),this.uniqueid&&this.nickname},setRgba:function(t){var e=t.r,i=t.g,n=t.b,o=t.a,a=void 0===o?255:o;this.rgba={r:e,g:i,b:n,a:a}},setRandomRgba:function(){this.setRgba(this.getRandomColor())},getRandomColor:function(){return[cc.Color.RED,cc.Color.GREEN,cc.Color.YELLOW,cc.Color.ORANGE,cc.Color.CYAN,cc.Color.MAGENTA].sort(function(t){return Math.random()-.5})[0]},setDndRoleData:function(e){var i=new(t("DndRoleData"));this.dndRole[e]=i}}),cc._RF.pop()},{DndRoleData:"DndRoleData"}],RangeBar:[function(t,e,i){"use strict";cc._RF.push(e,"7d711FiU3xMvaboH3lJE/rh","RangeBar"),cc.Class({extends:cc.Component,properties:{Dot:cc.Node,Label:cc.Label,ScrollViewer:cc.ScrollView},onLoad:function(){var t=cc.director.getScene().children[0];this.Dot.active=!1,this._halfWidth=.5*t.width,this._halfHeight=.5*t.height},startUp:function(t,e,i,n,o,a){this._valueName=t,this._notifyName=e,this._lowNumber=i,this._startNumber=n,this._limitNumber=o,this._enabledHeight=a,this._oriHeight=this.node.height,this._gap=a/(o-i),this.Label.string=n+"\n"+t,this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchRangeBegin,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchRangeMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchRangeEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchRangeCancel,this)},finish:function(){return this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchRangeBegin,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchRangeMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchRangeEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchRangeCancel,this),this._range},_onTouchRangeBegin:function(t){var e=t.touch.getLocation();e={x:e.x-this._halfWidth,y:e.y-this._halfHeight},this._startPoint=e,this.Dot.active=!0,this.Dot.setPosition(e),this.node.height=this._enabledHeight,this.ScrollViewer.enabled=!1},_onTouchRangeMoved:function(t){var e=t.touch.getLocation();e={x:0,y:e.y-this._halfHeight},this.Dot.setPosition(e),this._range=Math.max(this._lowNumber,Math.min(this._limitNumber,Math.round((e.y-this._startPoint.y)/this._gap)+this._startNumber)),this.Label.string=this._range+"\n"+this._valueName,this.Label.node.setPosition(0,e.y+20)},_onTouchRangeEnd:function(){this._onEnded()},_onTouchRangeCancel:function(){this._onEnded()},_onEnded:function(){this.Dot.active=!1,this.node.height=this._oriHeight,this.Label.string=this._range+"\n"+this._valueName,this._startNumber=this._range,this.Label.node.setPosition(0,0),NAERT.dispatchCustomEvent(this._notifyName,this._range),this.ScrollViewer.enabled=!0}}),cc._RF.pop()},{}],RgbColorPicker:[function(t,e,i){"use strict";cc._RF.push(e,"6e5ac4lCZ1LC4ddv1FL//Zh","RgbColorPicker"),cc.Class({extends:cc.Component,properties:{PaletteLayout:cc.Node,PaletteNode:cc.Node,PreviewNode:cc.Node,LightBoxNode:cc.Node,SaveColorBtnNode:cc.Node,RgbPalette:t("RgbPalette")},onLoad:function(){this.PaletteNode.setContentSize(30,30),this._paletteColors=this._colorListGenertor(),this.PaletteLayout.children[0].color=this._paletteColors[0],this._expandCallback=this._expand.bind(this),this.PaletteLayout.on(cc.Node.EventType.TOUCH_START,this._expandCallback),this._collapse()},_colorListGenertor:function(){for(var t=[],e=0;e<6;e++)for(var i=0;i<6;i++)for(var n=0;n<6;n++)t.push(new cc.Color(51*e,51*i,51*n));return t},getPaletteColors:function(){return this._paletteColors},getPaletteColor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._paletteColors[t]},getPixelRgbColor:function(t,e,i){var n=4*(i*t.width+e),o=t.data;return[o[n],o[n+1],o[n+2],o[n+3]]},_collapse:function(){var t=this.PaletteNode.width,e=this.PaletteLayout.getChildren();this.PaletteLayout.setContentSize(t,t),e.forEach(function(t,e){return t.active=0==e}),this.PaletteLayout.off(cc.Node.EventType.TOUCH_MOVE,this._caressPixelCallback),this.PaletteLayout.off(cc.Node.EventType.TOUCH_END,this._touchPixelCallback),this.LightBoxNode.active=!1,this.PreviewNode.active=!1,e[0].setScale(1,1)},_expand:function(){var t=this,e=this.PaletteLayout.getChildren();this._paletteColors.forEach(function(i,n){var o=e[n];o||((o=cc.instantiate(t.PaletteNode)).parent=t.PaletteLayout),o.active=!0,o.color=i});var i=cc.director.getScene().children[0],n=Math.ceil(Math.sqrt(this._paletteColors.length))*this.PaletteNode.width;this.PaletteLayout.setContentSize(Math.min(i.width,n),n),this._caressPixelCallback=this._gridTouchEventHandler(this._previewColor),this._touchPixelCallback=this._gridTouchEventHandler(this._pickColor),this.PaletteLayout.on(cc.Node.EventType.TOUCH_MOVE,this._caressPixelCallback),this.PaletteLayout.on(cc.Node.EventType.TOUCH_END,this._touchPixelCallback),this.LightBoxNode.active=!0,e[0].setScale(.8,.8),EVENT.dispatchNotify("NotifyRgbColorPickerStartPickColor")},_gridTouchEventHandler:function(t){var e=this,i=this.PaletteLayout.height,n=this.PaletteNode.width,o=Math.floor(i/n);return function(i){var a=i.touch.getLocation(),s=Math.floor(a.x/n)+Math.floor(a.y/n)*o;t.call(e,s,a)}},_previewColor:function(t,e){var i=this._paletteColors[t];i&&(this.PreviewNode.setPosition(e.x,e.y+100),this.PreviewNode.active=!0,this.PreviewNode.children[0].color=i)},_pickColor:function(t){if(this.PreviewNode.active=!1,this._collapse(),!t)return this.RgbPalette.addToStage(),this.RgbPalette.setColor(new cc.Color(this._paletteColors[t])),this.SaveColorBtnNode.active=!0,void(this.LightBoxNode.active=!0);var e=this._paletteColors[t];this.PaletteLayout.children[0].color=this._paletteColors[0]=e,EVENT.dispatchNotify("NotifyRgbColorPickerEndPickColor")},clickOnSaveNewColor:function(){var t=this.RgbPalette.pickRbgColor(),e=t._val;this._paletteColors.every(function(t){return t._val!=e})&&this._paletteColors.push(t),this.PaletteLayout.children[0].color=t,this.RgbPalette.behindStage(),this.SaveColorBtnNode.active=!1,this._collapse()}}),cc._RF.pop()},{RgbPalette:"RgbPalette"}],RgbPalette:[function(t,e,i){"use strict";cc._RF.push(e,"87997bi/mNPJ5HKICY1p8CW","RgbPalette"),cc.Class({extends:cc.Component,properties:{PreviewNode:cc.Node,RedLayout:cc.Node,RedNode:cc.Node,GreenLayout:cc.Node,GreenNode:cc.Node,BlueLayout:cc.Node,BlueNode:cc.Node,RedNumericalLift:t("NumericalLift"),GreenNumericalLift:t("NumericalLift"),BlueNumericalLift:t("NumericalLift")},setColor:function(t){var e=this,i=t.r,n=t.g,o=t.b,a=this.PreviewNode;a.color=new cc.Color(i,n,o);var s={Red:i,Green:n,Blue:o},c=function(){a.stopAllActions(),a.runAction(cc.sequence(cc.scaleTo(.1,.8,.8),cc.spawn(cc.tintTo(.2,s.Red,s.Green,s.Blue),cc.scaleTo(.2,1.5,1.5).easing(cc.easeInOut(3))),cc.scaleTo(.2,1,1).easing(cc.easeInOut(3))))},r=function(){a.stopAllActions(),a.runAction(cc.tintTo(.2,s.Red,s.Green,s.Blue))},l=function(t,e,i,n,o){var a=this[t+"Layout"],s=this[t+"Node"],c=a.children.find(function(t){return!t.active});c||((c=cc.instantiate(s)).parent=a),c.active=!0,c.opacity=n,c.setPosition(e),c.stopAllActions(),c.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,i.x,i.y),cc.fadeTo(.2,180),cc.scaleTo(.4,2,2).easing(cc.easeInOut(3))),cc.spawn(cc.scaleTo(.2,.2,.2).easing(cc.easeInOut(3)),cc.fadeTo(.2,0),cc.callFunc(o))))}.bind(this);Object.keys(s).forEach(function(t){var i=e[t+"NumericalLift"],n=s[t];i.setParam({num:n,callback:function(e){var n=i.node;s[t]<e?l(t,n,a,255,c):s[t]>e&&l(t,a,n,255,r),s[t]=e}})}),this._rgbColor=s},addToStage:function(){this.node.active=!0},behindStage:function(){this.node.active=!1},pickRbgColor:function(){return new cc.Color(this._rgbColor.Red,this._rgbColor.Green,this._rgbColor.Blue)}}),cc._RF.pop()},{NumericalLift:"NumericalLift"}],RoleCardData:[function(t,e,i){"use strict";cc._RF.push(e,"ce3a1+NWzBGspA/pBzaJ7Qr","RoleCardData"),cc.Class({ctor:function(){this.ability={"\u529b\u91cf":1,"\u654f\u6377":1,"\u7cbe\u795e":1,"\u667a\u6167":1}}}),cc._RF.pop()},{}],RoleList:[function(t,e,i){"use strict";cc._RF.push(e,"18b76006BdDyLPSDkE/4VFr","RoleList");t("Notifier");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this._selectedNode=null},pushRole:function(t){t.parent=this.node,t.active=!0},removeRole:function(t){this.node.children.find(function(e){return e==t&&e.destroy()})},onRoleBoardClicked:function(t){this._selectedNode=t.target}}),cc._RF.pop()},{Notifier:"Notifier"}],SiegeMagnetic:[function(t,e,i){"use strict";cc._RF.push(e,"58a1bHjAPZJOaKnbY0QUwJ2","SiegeMagnetic");var n=t("BargameControl");cc.Class({extends:t("Client"),properties:{TouchPointNode:cc.Node,Enermies:[cc.Node]},onLoad:function(){this._level=0},startGame:function(t){var e=this,i=this.TouchPointNode;n.setTouchMove(function(t){i.setPosition(i.x+t.x,i.y+t.y)});var o=0;this.schedule(function(t){e._level<e.Enermies.length&&(e._addEnermy(i),++o>=3*(e._level+1)&&e._level++)},5),EVENT.addListener("NotifyEventDone",function(){n.setTouchMove(null),e.node.destroy()},this)},_addEnermy:function(t){var e=cc.instantiate(this.Enermies[this._level]);cc.log(this.node),e.parent=this.node,e.active=!0,e.setPosition(1e3*Math.random()%640,1e3*Math.random()%960),e.getComponent("BulletEnermy").lookAt(this.TouchPointNode)}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client"}],SpitBall:[function(t,e,i){"use strict";cc._RF.push(e,"305f0WgTpFBWZorzcZo3KRs","SpitBall");var n=t("Throw");cc.Class({extends:t("BulletEnermy"),properties:{Bullet:cc.Node},onLoad:function(){this.target=null},lookAt:function(t){var e=this,i=this.node,o=this.target=t,a=Math.random()+.5,s=Math.random(),c=3*Math.random()+1,r=50*Math.random()+30,l=3*Math.random()+1,h=-n.angle(i,o);i.runAction(cc.sequence(cc.rotateTo(a,h),cc.tintTo(s,cc.Color.YELLOW),cc.spawn(cc.callFunc(this._shot.bind(this,-h)),cc.callFunc(this._shot.bind(this,-h-30)),cc.callFunc(this._shot.bind(this,30-h)),cc.tintTo(c,cc.Color.WHITE),cc.moveTo(c,n.project(i,-h,-r)).easing(cc.easeOut(2))),cc.delayTime(l),cc.callFunc(function(t){return e.lookAt(o)})))},_shot:function(t){var e=cc.instantiate(this.Bullet);e.parent=this.node.parent,e.active=!0,e.setPosition(this.node),e.getComponent("BulletBall").lookAt(this.target,t)},_distance:function(t,e){Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),2)<100&&EVENT.dispatchNotify("NotifyEventDone")}}),cc._RF.pop()},{BulletEnermy:"BulletEnermy",Throw:"Throw"}],StoryMakerData:[function(t,e,i){"use strict";cc._RF.push(e,"7d4e84op51IIrV0FACWapeQ","StoryMakerData"),cc.Class({ctor:function(){this.makerid=0,this.nickname="",this.hitpoint={"\u9ad4\u9b44":0,"\u610f\u5fd7":0},this.ability={"\u529b\u91cf":0,"\u654f\u6377":0,"\u667a\u6167":0,"\u7cbe\u795e":0},this.skill={"\u89ba\u67e5":1,"\u5999\u624b":1,"\u4ea4\u6d89":1,"\u883b\u529b":1,"\u5fcd\u8010":1,"\u907f\u5bb3":1,"\u904b\u52d5":1,"\u64cd\u5f04":1,"\u6b4c\u980c":1},this.item={"\u6a9c\u6728\u786c\u5e63":1}},getParam:function(){return{makerid:this.makerid,nickname:this.nickname,hitpoint:this.hitpoint,ability:this.ability,skill:this.skill,item:this.item}},randomAbility:function(){var t=[3,3,2,1].sort(function(t){return Math.random()-.5});this.ability={"\u529b\u91cf":t[0],"\u654f\u6377":t[1],"\u667a\u6167":t[2],"\u7cbe\u795e":t[3]},this.hitpoint={"\u9ad4\u9b44":this.ability["\u529b\u91cf"]+this.ability["\u654f\u6377"],"\u610f\u5fd7":this.ability["\u667a\u6167"]+this.ability["\u7cbe\u795e"]}}}),cc._RF.pop()},{}],SwitchToggle:[function(t,e,i){"use strict";cc._RF.push(e,"329d1j2261JrLzsIHvwpCSC","SwitchToggle"),cc.Class({extends:cc.Component,properties:{Background:cc.Node,Label:cc.Label},onLoad:function(){this._isToggle=!1,this._colorList=[this.Background.color,this.Label.node.color],this._callback=null},setParam:function(t){var e=t.callback;this._callback=e},getParam:function(){return{isToggle:this._isToggle}},onToggleClicked:function(){this._isToggle=!this._isToggle,this._isToggle?(this.Background.color=this._colorList[1],this.Label.node.color=this._colorList[0]):(this.Background.color=this._colorList[0],this.Label.node.color=this._colorList[1]),this._callback&&this._callback()}}),cc._RF.pop()},{}],Throw:[function(t,e,i){"use strict";cc._RF.push(e,"f8d20iHQLBMDK9DAoKdGmhH","Throw");var n=function(t,e){return Math.abs(t)>.001?t-=t*e:0};e.exports={prediction:function(t,e,i,o){for(var a={x:t.x,y:t.y},s=0;i>.05;)a=projectTo(a,e,i),i=n(i,o),s++;return cc.log(s),a},angle:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)/Math.PI*180},project:function(t,e,i){var n=t.x,o=t.y;return i?{x:n+i*Math.cos(e*Math.PI/180),y:o+i*Math.sin(e*Math.PI/180)}:{x:n,y:o}},retard:n},cc._RF.pop()},{}],TouchPoint:[function(t,e,i){"use strict";cc._RF.push(e,"a8696nCmcpHpqJsivD1cTGI","TouchPoint"),cc.Class({extends:cc.Component,properties:{ColorBackground:cc.Node,SideCircle:cc.Node,SideColorBackground:cc.Node,NicknameLabel:cc.Label},setParam:function(t){var e=t.nickname,i=t.position,n=t.rgba;this.ColorBackground.color=new cc.Color(n),this.SideColorBackground.color=new cc.Color(n),this.NicknameLabel.string=e,this.node.setPosition(i),this.node.setScale(.1),this.node.runAction(cc.scaleTo(.3,1).easing(cc.easeInOut(2.2))),this.select(!1)},select:function(t){this.SideCircle.active=t}}),cc._RF.pop()},{}],VerticalListView:[function(t,e,i){"use strict";cc._RF.push(e,"95164iPGG1K/KnQsc8ps1fd","VerticalListView"),cc.Class({extends:cc.Component,editor:!1,properties:{itemTemplate:cc.Node,maxSpawnCount:10,bufferZone:100,paddingTop:0},onLoad:function(){this.scrollView=this.node.getComponent(cc.ScrollView),this.view=this.scrollView.view,this.content=this.scrollView.content,this.content.height=this.paddingTop,this.items=[],this.positions=[],this._recycleItems=[]},start:function(){this.items.length||(this.enabled=!1)},fill:function(t,e){var i=this;this.delegate=e,t.forEach(function(t){return i.add(i.itemTemplate.height)})},add:function(t){if(.5==this.itemTemplate.anchorY?this.positions.push(-this.content.height-t/2):this.positions.push(-this.content.height),this.content.height+=t,this.items.length<this.maxSpawnCount){var e=this._recycleItems.length&&this._recycleItems.pop()||cc.instantiate(this.itemTemplate);this.items.push(e),e.active=!0,e.parent=this.content,e.dataIndex=this.items.length-1,e.y=this.positions[e.dataIndex],this.delegate.updateItem(e,e.dataIndex,this.items.length-1)}this.lastContentY=this.content.y-1,this.enabled=!0},clear:function(){var t=this;this.delegate=null,this.positions=[],this.items.forEach(function(e){e.active=!1,t._recycleItems.push(e)}),this.items=[],this.content.height=this.paddingTop,this.content.y=0,this.enabled=!1},update:function(t){if(this.content.y!=this.lastContentY){var e=this.items;if(this.content.y>this.lastContentY)for(;;){var i=e[0];if(this._getPositionInView(i).y>this.bufferZone){var n=e[e.length-1].dataIndex+1;if(this.delegate.checkIndexValid(n)){i.dataIndex=n,i.y=this.positions[n],this.delegate.updateItem(i,n,this.items.length-1),e.push(e.shift());continue}}break}else for(;;){var o=e[e.length-1];if(this._getPositionInView(o).y<-this.bufferZone){var a=e[0].dataIndex-1;if(this.delegate.checkIndexValid(a)){o.dataIndex=a,o.y=this.positions[a],this.delegate.updateItem(o,a,0),e.unshift(e.pop());continue}}break}this.lastContentY=this.content.y}},_getPositionInView:function(t){var e=t.parent.convertToWorldSpaceAR(t.position);return this.scrollView.node.convertToNodeSpaceAR(e)}}),cc._RF.pop()},{}],YellowCardClientView:[function(t,e,i){"use strict";cc._RF.push(e,"ffce7USl9xAGYdt4zNwfwPG","YellowCardClientView");var n=t("GameEnum"),o=t("Notifier"),a=t("BargameControl");cc.Class({extends:t("Client"),statics:{open:function(t,e,i){if(instance)e?instance[e](i):instance.open();else{cc.loader.loadRes("prefabs/board/YellowCardClientView",function(n,o){if(n)return cc.error(n);var a=cc.instantiate(o);a.parent=t,instance=a.getComponent("YellowCardClientView"),e&&instance[e](i)}.bind(this))}}},properties:{TopPromptLabel:cc.RichText,CardPageview:cc.Node,EarnWinnerToken:cc.Node},onLoad:function(){this._profileData=t("DataModal").getInstance().profileData,this._profileData.setIDNickname(),this._game=n.Games.YellowCard,cc.log("uniqueid:",this._profileData.uniqueid),this._questions=[],this._answers=[],this._handCards=[],this._dropCards=[],this._super(),EVENT.addListener("NotifyEventCardRelease",this._notifyEventCardRelease,this)},start:function(){var e=this;t("CommonDialog").addDialog("CommonDialogView",{text:"\u8acb\u8f38\u5165\u60a8\u5728\u904a\u6232\u4e2d\u4f7f\u7528\u7684\u540d\u7a31",placeholder:this._profileData.nickname||"\u53d6\u500b\u597d\u8a18\u7684\u66b1\u7a31\u5427",showClose:!1,buttons:[{text:"\u78ba\u8a8d\u9001\u51fa",callback:function(t){e._profileData.setIDNickname(t.text)}}]});for(var i=0;i<20;i++){var n=cc.instantiate(this.EarnWinnerToken.children[0]);n.parent=this.EarnWinnerToken,n.active=!1}this._init()},_init:function(){var t=this;this.CardPageview.getComponent("CardSlider").clear(),this.CardPageview.active=!1,this._responseCount=0,this._dropCards=[],a.setTouchStart(function(e){t._initiate(1)})},_initiate:function(t){var e=n.GameName[this._game],i=this._profileData;o.request("StartActivity",{game:e,join:t,player:{uniqueid:i.uniqueid,nickname:i.nickname}})},handleInitiate:function(e){var i=this,n=e.join,o=e.player;if(cc.log("player:",o.uniqueid,"profile:",this._profileData.uniqueid),this._isInitiater=o.uniqueid===this._profileData.uniqueid,t("DialogManager").closeDialog(),1==n)if(a.setTouchStart(null),this._isInitiater){this.TopPromptLabel.string="\u9078\u64c7\u4e00\u5f35\u5361\u7247\u505a\u70ba\u984c\u76ee\n(\u7a7a\u767d\u5361\u7247\u53ef\u81ea\u7531\u51fa\u984c)";var s=function(){var t=i._profileData,e={uniqueid:t.uniqueid,nickname:t.nickname};i.CardPageview.active=!0,i.CardPageview.getComponent("CardSlider").setParam([{text:i._questions.shift(),type:"question",player:e},{text:i._questions.shift(),type:"question",player:e},{text:"",type:"question",player:e}])};this._questions.length<2?FirebaseWrapper.read("YellowCard/Question").then(function(t){var e=t.success,n=t.data;e&&(i._questions=Object.keys(n).map(function(t){return n[t]}),i._questions=i._questions.sort(function(t){return Math.random()-.5}),s())}):s()}else t("CommonDialog").addDialog("CommonDialogView",{text:"\u7b49\u5f85\u5224\u683d\u51fa\u984c\u2026",showClose:!1});else cc.log("init!!!"),this._init()},handleAsk:function(e){var i=this;if(this._askSentence=e.text,!this._isInitiater){var n=e.text;cc.log("data:",e),this.TopPromptLabel.string=n,t("DialogManager").closeDialog();var o=function(){for(var t=i._profileData,e={uniqueid:t.uniqueid,nickname:t.nickname},n=13-i._handCards.length,o=0;o<n;o++)i._handCards.push({text:i._answers.shift(),type:"answer",player:e});i.CardPageview.active=!0,cc.log("this._handCards:",i._handCards),i.CardPageview.getComponent("CardSlider").setParam(i._handCards)};0==this._answers.length?FirebaseWrapper.read("YellowCard/Answer").then(function(t){var e=t.success,n=t.data;if(e){i._answers=Object.keys(n).map(function(t){return n[t]});for(var a=0;a<2;a++)i._answers.push("");i._answers=i._answers.sort(function(t){return Math.random()-.5}),o()}}):o()}},handleRespon:function(e){if(cc.log("\u9019\u908a\u662f\u767c\u8d77\u8005\u63a5\u5230\u7684\uff0c\u53c3\u8207\u8005\u7684\u56de\u61c9\uff1a",e),this._isInitiater){this.CardPageview.active=!0;var i=this._askSentence.split("_").join("<color=#f00>"+e.text+"</c>");this.CardPageview.getComponent("CardSlider").addCard({type:"respon",text:i,player:e.player}),this._responseCount++,this.TopPromptLabel.string="\u6536\u5230"+this._responseCount+"\u5247\u53e5\u5b50\n\u8acb\u5f9e\u53c3\u8207\u8005\u7684\u56de\u61c9\u4e2d\u9078\u64c7",t("DialogManager").closeDialog()}},handleWinner:function(e){var i=this,a=e.player;if(this._profileData.uniqueid===a.uniqueid){t("CommonDialog").addDialog("CommonDialogView",{text:"\u5224\u683d\u9078\u64c7\u4e86\u4f60\u7684\u5361\u7247",showClose:!1,buttons:[{text:"\u597d\u5427\u2026",callback:function(){i._initiate(0)}},{text:"\u6211\u8981\u68c4\u724c",callback:function(){i._handCards.forEach(function(t){return t.type="drop"}),i.CardPageview.active=!0,i.CardPageview.getComponent("CardSlider").setParam(i._handCards),i.TopPromptLabel.string="\u9078\u64c7\u4f60\u8981\u68c4\u6389\u7684\u724c";o.request("Utter",{game:n.GameName[i._game],message:"\u62dc\u8a17\u7b49\u6211\u4e00\u4e0b\uff0c\u6211\u68c4\u5e7e\u5f35\u624b\u724c\u2026",player:a})}}]});var s=this.EarnWinnerToken.children.findIndex(function(t){return!t.active&&(t.active=!0)})+1;if(this._winTimes=s,s%3==0){var c="\u6211\u62ff\u5230"+s+"\u5f35\u9ec3\u724c\u4e86\uff01";o.request("Utter",{game:n.GameName[this._game],message:c,player:a})}}else t("CommonDialog").addDialog("CommonDialogView",{text:a.nickname+"\u62ff\u5230\u4e86\u9ec3\u724c\u3002"});this.TopPromptLabel.string="",t("DialogManager").closeDialog()},handleUtter:function(e){var i=e.player,n=e.message;this._profileData.uniqueid!==i.uniqueid&&(t("DialogManager").closeDialog(),t("CommonDialog").addDialog("CommonDialogView",{text:i.nickname+" \u6709\u8a71\u8981\u8aaa\uff1a\n\u300c"+n+"\u300d",showClose:!1,buttons:[{text:"\u77e5\u9053\u4e86"}]}))},_notifyEventCardRelease:function(e){var i=this,a=e.param;if(this.CardPageview.getComponent("CardSlider").clear(),this.CardPageview.active=!1,cc.log("type:",a.type),"question"===a.type){var s=function(e){o.request("Ask",{text:e}),t("CommonDialog").addDialog("CommonDialogView",{text:"\u7b49\u5f85\u5927\u5bb6\u56de\u61c9\u2026",showClose:!1})};a.text?s(a.text):t("CommonDialog").addDialog("YellowCardEditorView",{text:'\u586b\u5165\u53e5\u5b50\uff0c\u4e26\u7528"_"\u4f5c\u586b\u7a7a',target:this,buttons:[{text:"\u5b8c\u6210\u9001\u51fa",callback:function(t){FirebaseWrapper.push("YellowCard/Question",t.text),s(t.text)}}]})}else if("answer"===a.type){s=function(e){var n=i.TopPromptLabel.string.split("_");i.TopPromptLabel.string=n.join("<color=#f00>"+e+"</c>"),t("CommonDialog").addDialog("CommonDialogView",{text:"\u7b49\u5f85\u5224\u683d\u9078\u64c7\u2026",showClose:!1});var s=a.player;o.request("Respon",{text:e,player:s}),i._handCards.splice(a.index,1)};a.text?s(a.text):t("CommonDialog").addDialog("YellowCardEditorView",{text:"\u8acb\u586b\u5165\u55ae\u5b57\n(\u52d5\u8a5e\u3001\u540d\u8a5e\u3001\u5f62\u5bb9\u8a5e)",target:this,buttons:[{text:"\u5b8c\u6210\u9001\u51fa",callback:function(t){FirebaseWrapper.push("YellowCard/Answer",t.text),s(t.text)}}]})}else if("respon"===a.type)cc.log(a),o.request("Winner",{player:a.player,text:a.text});else if("drop"===a.type){this._dropCards.push(a),this._handCards.splice(a.index,1);var c=[];this._handCards.forEach(function(t){t.type="drop",c.push(t)}),this.CardPageview.active=!0,this.CardPageview.getComponent("CardSlider").setParam(c);var r=function(t){i.scheduleOnce(function(){o.request("Utter",{game:n.GameName[i._game],message:t,player:a.player})},.1),i._handCards.forEach(function(t){return t.type="answer"})},l=this._dropCards.length,h=[];h.push({text:"\u6211\u4e0d\u68c4\u724c\u4e86",callback:function(){i._handCards=i._handCards.concat(i._dropCards),cc.log("\u624b\u724c\uff1a",i._handCards),i._dropCards=[],i._initiate(0),r("\u6211\u4e0d\u68c4\u724c\u4e86\uff0c\u6211\u5011\u7e7c\u7e8c\u5427~")}}),l<this._winTimes&&h.push({text:"\u9084\u8981\u518d\u9078"}),h.push({text:"\u68c4\u6389"+l+"\u5f35",callback:function(){i._initiate(0),r("\u6211\u68c4\u6389"+l+"\u5f35\u624b\u724c\uff0c\u53ef\u4ee5\u7e7c\u7e8c\u56c9\uff01")}}),t("CommonDialog").addDialog("CommonDialogView",{text:"\u68c4\u6389"+this._dropCards.map(function(t){return t.text}).join("\u3001")+"\n("+l+"/"+this._winTimes+")",showClose:!1,buttons:h})}},onAddQuestionClicked:function(){var e=this;t("CommonDialog").addDialog("YellowCardEditorView",{text:'\u586b\u5165\u53e5\u5b50\uff0c\u4e26\u7528"_"\u4f5c\u586b\u7a7a',target:this,showClose:!0,buttons:[{text:"\u5b8c\u6210\u9001\u51fa",callback:function(t){FirebaseWrapper.push("YellowCard/Question",t.text),e.onAddQuestionClicked()}}]})},onAddAnswerClicked:function(){var e=this;t("CommonDialog").addDialog("YellowCardEditorView",{text:"\u8acb\u586b\u5165\u55ae\u5b57\n(\u52d5\u8a5e\u3001\u540d\u8a5e\u3001\u5f62\u5bb9\u8a5e)",target:this,showClose:!0,buttons:[{text:"\u5b8c\u6210\u9001\u51fa",callback:function(t){FirebaseWrapper.push("YellowCard/Answer",t.text),e.onAddAnswerClicked()}}]})}}),cc._RF.pop()},{BargameControl:"BargameControl",Client:"Client",CommonDialog:"CommonDialog",DataModal:"DataModal",DialogManager:"DialogManager",GameEnum:"GameEnum",Notifier:"Notifier"}],YellowCardEditorView:[function(t,e,i){"use strict";cc._RF.push(e,"beb73UdNYlD+pLmVPyn+sd9","YellowCardEditorView");t("Notifier");cc.Class({extends:cc.Component,properties:{ContentLabel:cc.Label,SentenceEditbox:cc.EditBox},setParam:function(t){var e=t.text;this.ContentLabel.string=e},getParam:function(){return{text:this.SentenceEditbox.string}}}),cc._RF.pop()},{Notifier:"Notifier"}]},{},["Client","Hoster","Notifier","BargameControl","ControlMain","DataModal","DndGameEnum","DndRoleData","GameEnum","ProfileData","RoleCardData","StoryMakerData","DialogManager","CommonDialog","CommonDialogView","YellowCardEditorView","ChatBar","MessageBox","MessageLine","MessageManager","MessageView","BinanceApp","CanvasResize","CardSlider","EditBoxTags","EventButton","EventCard","EventRemover","Identitiy","Move","NodeResize","RangeBar","Throw","VerticalListView","TouchPoint","BlackHole","BulletBall","BulletClientView","BulletEnermy","MagneticBall","SpitBall","ChatClientView","ChatMessage","DndClientView","NumericalLift","SwitchToggle","DndAbilityItem","DndCharacterIcon","DndCharacterInfo","DndCharacterManager","DndCharacterSheet","DndChoiceItem","DndEditItem","DndExemptionItem","DndSkillItem","DndDice","DndDiceBoard","DndDiceClientView","DndBattleMap","DndMapItemInfo","DndMapRole","DndStrategyMap","DndStrategyMapEditorView","DndStrategyMapItem","MapGrid","MapGridItem","RoleList","DndStoryNode","DndStoryScrollView","DndStorySentence","FingerpartyClientView","FingerpartyCountPicker","FingerparytRoulette","PainterLoader","PixelCanvas","PixelContentSlider","PixelImageCanvas","PixelImageEditor","PixelImageList","PixelImageLoader","PixelImagePainter","PixelPackage","PixelPainter","PixelPreview","PixelpainterClientView","RgbColorPicker","RgbPalette","SiegeMagnetic","YellowCardClientView"]);