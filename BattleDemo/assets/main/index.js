System.register("chunks:///_virtual/AiIntentData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,i;return{setters:[function(t){n=t.createClass},function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"44b8cpbU6hA/53MuLEUTRN4","AiIntentData",void 0);t("AiIntentData",function(){function t(t,n){this._id=void 0,this._intents=void 0,this._id=t,this._intents=n}return t.fromCSV=function(n){var i=n.intents.map((function(t){return t.split(" ")}));return new t(n.id,i)},n(t,[{key:"id",get:function(){return this._id}},{key:"intents",get:function(){return this._intents}}]),t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/AudioHelper.ts",["cc","./AudioManager.ts"],(function(n){var u,i,o;return{setters:[function(n){u=n.cclegacy,i=n._decorator},function(n){o=n.AudioManager}],execute:function(){var a,c;u._RF.push({},"b4896iudoVCNYcBglAhYLkq","AudioHelper",void 0);var t=i.ccclass;n("AudioHelper",t("AudioHelper")(((c=function(){function n(){}return n.playMusic=function(n){var u=this.getPath(n);o.instance.playBackgroundMusic(u)},n.playSound=function(n){var u=this.getPath(n);o.instance.playSoundEffect(u)},n.getPath=function(n){return this.audioMap[n]||""},n}()).audioMap={backgroundMusic:"audio/dancing_on_table",clickSound:"audio/click",winSound:"audio/win",loseSound:"audio/lose"},a=c))||a);u._RF.pop()}}}));

System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,i,o,u,a,s,c,r,l,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,u=e.createClass},function(e){a=e.cclegacy,s=e._decorator,c=e.AudioSource,r=e.resources,l=e.AudioClip,d=e.Component}],execute:function(){var f,p,h,b,S,y,g,m;a._RF.push({},"c714bqcI0FN4Y+9uQVoTRJe","AudioManager",void 0);var M=s.ccclass,E=s.property;e("AudioManager",(f=M("AudioManager"),p=E(c),h=E(c),f(((m=function(e){function t(){for(var t,n=arguments.length,u=new Array(n),a=0;a<n;a++)u[a]=arguments[a];return t=e.call.apply(e,[this].concat(u))||this,i(t,"bgmSource",y,o(t)),i(t,"sfxSource",g,o(t)),t.isMusicEnabled=!0,t.isSoundEffectsEnabled=!0,t}n(t,e);var a=t.prototype;return a.onLoad=function(){t._instance?this.destroy():t._instance=this},a.playBackgroundMusic=function(e){this.isMusicEnabled&&this.loadAndPlay(this.bgmSource,e,!0)},a.playSoundEffect=function(e){this.isSoundEffectsEnabled&&this.loadAndPlay(this.sfxSource,e,!1)},a.loadAndPlay=function(e,t,n){r.load(t,l,(function(t,i){t?console.error("Failed to load audio: "+t):(e.clip=i,e.loop=n,e.play())}))},a.setMusicEnabled=function(e){this.isMusicEnabled=e,this.updateAudioState(this.bgmSource,e)},a.setSoundEffectsEnabled=function(e){this.isSoundEffectsEnabled=e,this.updateAudioState(this.sfxSource,e)},a.updateAudioState=function(e,t){t?e.playing||e.play():e.stop()},a.setMusicVolume=function(e){this.bgmSource.volume=Math.max(0,Math.min(1,e))},a.setSoundEffectVolume=function(e){this.sfxSource.volume=Math.max(0,Math.min(1,e))},u(t,null,[{key:"instance",get:function(){return this._instance}}]),t}(d))._instance=null,y=t((S=m).prototype,"bgmSource",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=t(S.prototype,"sfxSource",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=S))||b));a._RF.pop()}}}));

System.register("chunks:///_virtual/BattleManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./HandCards.ts","./CombatCardComponent.ts","./CombatCardManager.ts","./GameManager.ts","./CheckBoxComponent.ts","./CombatEffectManager.ts","./CombatEffectComponent.ts","./EmpowerCardsListItem.ts","./CombatCard.ts","./PopupWindowComponent.ts","./HitTag.ts","./CardMover.ts","./CameraCenterMover.ts","./AudioHelper.ts","./AudioManager.ts"],(function(t){var e,n,a,r,i,o,s,c,u,d,l,f,h,m,p,C,b,y,v,g,E,_,w,I,T,x,B,D,k,P;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,a=t.initializerDefineProperty,r=t.assertThisInitialized,i=t.createClass,o=t.asyncToGenerator,s=t.regeneratorRuntime},function(t){c=t.cclegacy,u=t._decorator,d=t.Node,l=t.Layout,f=t.Label,h=t.instantiate,m=t.Component,p=t.v3},function(t){C=t.HandCards},function(t){b=t.CombatCardComponent},function(t){y=t.CombatCardManager},function(t){v=t.GameManager},function(t){g=t.CheckBoxComponent},function(t){E=t.CombatEffectManager},function(t){_=t.CombatEffectComponent},function(t){w=t.EmpowerCardsListItem},function(t){I=t.CombatCard},function(t){T=t.PopupWindowComponent},function(t){x=t.HitTag},function(t){B=t.CardMover},function(t){D=t.CameraCenterMover},function(t){k=t.AudioHelper},function(t){P=t.AudioManager}],execute:function(){var M,L,U,O,A,N,z,F,S,H,j,W,R,V,G,q,J,Z,K,Q,X,Y,$,tt,et,nt;c._RF.push({},"75f1fvy7CZE6IJPWLrjCF5k","BattleManager",void 0);var at=u.ccclass,rt=u.property;t("BattleManager",(M=at("BattleManager"),L=rt(d),U=rt(d),O=rt(C),A=rt(_),N=rt(_),z=rt(l),F=rt(l),S=rt(d),H=rt(T),j=rt(D),W=rt(f),M(((nt=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i))||this,a(e,"combatNode",G,r(e)),a(e,"cardPrefab",q,r(e)),a(e,"handCards",J,r(e)),a(e,"myCombatEffectStatus",Z,r(e)),a(e,"enemyCombatEffectStatus",K,r(e)),a(e,"enemyFrontLayout",Q,r(e)),a(e,"empowerCardsListLayout",X,r(e)),a(e,"endTurnButton",Y,r(e)),a(e,"popupWindow",$,r(e)),a(e,"cameraCenterMover",tt,r(e)),a(e,"energyLabel",et,r(e)),e._empowerCombatCards={},e._currentTurnIndex=0,e._playerUnitId="",e._enemyUnitIds=[],e._combatCardDataList=void 0,e._recordEffects=[],e._turnOrder=[],e._enemyTeamData=[],e._hittingEnemyId="",e._isBattleEnd=!1,e._unitEnemyIds=[],e._tempBattleButton=null,e}n(e,t);var c=e.prototype;return c.onLoad=function(){e._instance||(e._instance=this),this.combatNode.active=!1,this.showEndTurnButton(!1)},c.start=function(){var t=this;this.scheduleOnce((function(){t._enemyTeamData=[].concat(v.instance.database.enemyTeamDatabase),k.playMusic("backgroundMusic"),P.instance.setMusicVolume(.2)}),.1)},c.getRandomInitiative=function(){return Math.floor(100*Math.random())},c.startBattle=function(){P.instance.setMusicVolume(1),this.setCombatCards(),this.setCombatEffectStatus(),this._currentTurnIndex=0,this._isBattleEnd=!1,E.instance.onBeginBattle(),this.startNextUnitTurn()},c.startNextUnitTurn=function(){var t=o(s().mark((function t(){var e,n,a=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this._turnOrder[this._currentTurnIndex],!E.instance.isStun(e)){t.next=5;break}return console.log("狀態影響，回合提前結束"),this.processEndTurn(),t.abrupt("return");case 5:return t.next=7,E.instance.hitRoll(e);case 7:if(E.instance.onTurnBegin(e),e!==this._playerUnitId){t.next=13;break}this.cameraCenterMover.moveToCenter(this.enemyFrontLayout.node),this.startPlayerTurn(),t.next=19;break;case 13:return console.log("開始AI行動，等骰命中後護甲動畫跑完"),n=E.instance.units[e],this.cameraCenterMover.moveToCenter(n.status.node),t.next=18,new Promise((function(t){return a.scheduleOnce(t,1)}));case 18:this.startAiTurn(e);case 19:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),c.startPlayerTurn=function(){this.showEndTurnButton(),this.onPlayerTurn();var t=E.instance.getCountdown(this._playerUnitId);t>0?this.startTurnTimer(t):console.log("正常走這邊，不限時間")},c.startTurnTimer=function(t){var e=this,n=t;this.schedule((function(){n--,e.updateTurnTimerUI(n),n<=0&&e.endPlayerTurn()}),1,t)},c.endPlayerTurn=function(){this.handCards.disableCards(),this.showEndTurnButton(!1),this.processEndTurn()},c.showEndTurnButton=function(t){void 0===t&&(t=!0),this.endTurnButton.active=t},c.updateTurnTimerUI=function(t){},c.processEndTurn=function(){if(this.isBattleOver())this.endBattle();else{var t=this._turnOrder[this._currentTurnIndex];E.instance.onTurnEnd(t),this._currentTurnIndex++,this._currentTurnIndex>=this._turnOrder.length&&(this._currentTurnIndex=0,E.instance.onRoundEnd(),this.handCards.cards.forEach((function(t){var e=t.getComponent(b);e.CombatCard.reset(),e.nameLabel.string=e.CombatCard.Name,e.updateEffects()})),console.log("回合結束後處理debuff，檢查死亡"),this.isBattleOver())?this.endBattle():this.startNextUnitTurn()}},c.startAiTurn=function(){var t=o(s().mark((function t(e){var n,a=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.getAiIntention(e),t.next=3,this.executeAiIntention(e,n);case 3:if(console.log("AI行動結束",n),!this.isBattleOver()){t.next=7;break}return this.endBattle(),t.abrupt("return");case 7:return t.next=9,new Promise((function(t){return a.scheduleOnce(t,1)}));case 9:this.processEndTurn();case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),c.getAiIntention=function(t){var e=this._unitEnemyIds[t];return v.instance.database.aiIntentDatabase.find((function(t){return t.id===e})).intents},c.executeAiIntention=function(){var t=o(s().mark((function t(e,n){var a,r,i,o,c,u,d,l,f=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=v.instance.database.combatCardDatabase,r=this._currentTurnIndex%n.length,i=n[r].map((function(t){return console.log(f._unitEnemyIds[e],"敵人施放:",t),a.find((function(e){return e.cardId===t}))})),E.instance.intentionHandsTip(e,i.length),t.next=6,new Promise((function(t){return f.scheduleOnce(t,1)}));case 6:o=!1,c=1.5;case 8:if(!(i.length>0)){t.next=26;break}return u=i.shift(),d=new I(u,o),console.log("AI行動:",null==u?void 0:u.cardName),t.next=14,E.instance.intentionHandsTip(e,i.length);case 14:return(l=h(this.cardPrefab)).parent=this.node,l.active=!0,l.getComponent(b).setup(d),t.next=20,B.moveCard(l,this.node,p(-200,150,0),c,1);case 20:return E.instance.onCardPlayed(d.Effects,e,[this._playerUnitId]),t.next=23,new Promise((function(t){return f.scheduleOnce(t,1)}));case 23:l.destroy(),t.next=8;break;case 26:return t.next=29,new Promise((function(t){return f.scheduleOnce(t,1)}));case 29:return t.abrupt("return",t.sent);case 30:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),c.intention=function(){var t=o(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),c.checkForDeaths=function(){this._turnOrder=this._turnOrder.filter((function(t){return E.instance.isAlive(t)}))},c.isBattleOver=function(){var t=this;this.checkForDeaths();var e=E.instance.isAlive(this._playerUnitId),n=[].concat(this._enemyUnitIds).some((function(e){var n=E.instance.isAlive(e);return n||(t.handCards.removeTag(t._unitEnemyIds[e]),console.log("敵人死亡",t._unitEnemyIds[e]),E.instance.quit(e),delete t._unitEnemyIds[e],t._enemyUnitIds.splice(t._enemyUnitIds.indexOf(e),1)),n}));return console.log("playerAlive:",e,"anyAiAlive:",n,this._enemyUnitIds),this._isBattleEnd=!e||!n,this._isBattleEnd},c.endBattle=function(){var t=o(s().mark((function t(){var e=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P.instance.setMusicVolume(.2),this.handCards.clear(),this.showEndTurnButton(!1),t.next=5,new Promise((function(t){return e.scheduleOnce(t,1)}));case 5:this.enemyFrontLayout.node.removeAllChildren(),this._enemyUnitIds.length=0,this._hittingEnemyId="",E.instance.isAlive(this._playerUnitId)?(this.showVictoryMessage(),this.playVictoryAnimation()):this.showDefeatMessage(),E.instance.onEnBattle();case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),c.showDefeatMessage=function(){var t=this;this.popupWindow.openPopup("戰鬥結果","敵方勝利",[{label:"返回主畫面",callback:function(){t.combatNode.active=!1,t._tempBattleButton.active=!0,t._enemyTeamData=[].concat(v.instance.database.enemyTeamDatabase)}}])},c.showVictoryMessage=function(){var t=this;this.popupWindow.openPopup("戰鬥結果","恭喜您獲得勝利",[{label:"下一場戰鬥",callback:function(){t.startBattle()}}])},c.playVictoryAnimation=function(){},c.setEmpowerCombatCards=function(){var t=[];this.empowerCardsListLayout.node.children.forEach((function(e){var n,a=e.getComponent(w);null!=(n=a.getComponentInChildren(g))&&n.isChecked&&t.push(a.empowerId)}));var e=v.instance.database.empowerCardDatabase,n=v.instance.database.combatCardDatabase,a={};e.forEach((function(e){var r=e.empowerId;t.includes(r)&&e.combatCards.forEach((function(t){var i=t.num,o=n.find((function(e){return e.cardId===t.id}));if(o){a[r]||(a[r]={name:e.empowerName,cards:[]}),console.log(e.empowerName+" 抽 "+i+" 張 "+o.cardName);for(var s=0;s<i;s++)a[r].cards.push(o)}}))})),console.log("empowerCombatCards:",a),this._empowerCombatCards=a},c.onBattleClicked=function(t){t.target.active=!1,this._tempBattleButton=t.target,this.setEmpowerCombatCards(),this.startBattle()},c.setCombatCards=function(){var t=this;this.combatNode.active=!0,this._combatCardDataList=Object.values(this._empowerCombatCards).map((function(t){return t.cards})).flat(),console.log("可用牌庫",this._combatCardDataList.map((function(t){return t.cardName})));var e=[];this._combatCardDataList.forEach((function(n){var a=h(t.cardPrefab);a.parent=t.cardPrefab.parent,a.active=!0;var r=new I(n,!1);a.getComponent(b).setup(r),e.push(a)})),y.instance.clear(),y.instance.addCardsToDeck(e),y.instance.shuffleDeck()},c.setCombatEffectStatus=function(){this._playerUnitId=E.instance.join(this.myCombatEffectStatus,"玩家",23,8,3,0,0,0),this.loadEnemyData(),this._turnOrder=[this._playerUnitId].concat(this._enemyUnitIds)},c.loadEnemyData=function(){var t=this,e=this._enemyTeamData.shift();if(e){var n=v.instance.database.enemyDatabase;e.enemies.forEach((function(e){var a=n.find((function(t){return t.id===e}));console.log("載入敵人:",a.name);var r=h(t.enemyCombatEffectStatus.node);r.parent=t.enemyFrontLayout.node,r.active=!0;var i=r.getComponent(_);i.Image=a.img;var o=E.instance.join(i,a.name,a.hp,a.ac,3,a.dexterity,a.wisdom,a.resilience);t._enemyUnitIds.push(o),t._unitEnemyIds[o]=e,r.getComponentInChildren(x).tagID=o})),this.handCards.catchTag()}else this.popupWindow.openPopup("恭喜您","已打倒全部敵人，挑戰成功！",[{label:"返回主畫面",callback:function(){t.combatNode.active=!1,t._tempBattleButton.active=!0,t._enemyTeamData=[].concat(v.instance.database.enemyTeamDatabase)}}])},c.onPlayerTurn=function(){var t=this._playerUnitId;this._recordEffects.length=0,this.energyLabel.string=E.instance.getEnergy(t);var e=E.instance.getDrawCount(t);E.instance.getCountdown(t);this.handCards.drawCard(e)},c.onRoundEndClicked=function(){},c.onTurnEndClicked=function(){this.endPlayerTurn()},c.onTouchedCardEvent=function(t){var e=t.getComponent(b).CombatCard;this.handCards.setNeedTarget(e.NeedTarget)},c.onPlayCardCheckEvent=function(t,e){var n=t.getComponent(b).CombatCard,a=this._playerUnitId;if(n){if(!E.instance.tryCostFee(a,n))return console.log("沒有足夠的能量"),void this.handCards.cancelSelect();n.NeedTarget&&(this._hittingEnemyId=e.getComponent(x).tagID),this.handCards.playCard()}else console.error("沒有選擇卡牌")},c.onPlayCardEvent=function(t){var e,n=this,a=t.Effects,r=this._playerUnitId,i=this._hittingEnemyId;this._hittingEnemyId="";var o=[].concat(a);if(t.EvolutionEffects.forEach((function(t){return o.push(n._playCard(t.effectId))})),console.log("combatEffects:",o.map((function(t){return t.effectName}))),i||!t.NeedTarget){i?E.instance.onCardPlayed(o,r,[i]):E.instance.onCardPlayed(o,r,this._enemyUnitIds),this.energyLabel.string=E.instance.getEnergy(r),(e=this._recordEffects).push.apply(e,a),console.log("本回合已使用效果:",this._recordEffects.map((function(t){return t.effectType})));var s=this._recordEffects.map((function(t){return t.effectType}));this.handCards.cards.forEach((function(t,e){var n=t.getComponent(b),a=n.CombatCard;s.length>0&&a.tryEvolutions(s)&&(a.EvolutionEffects.forEach((function(t){n.nameLabel.string=t.effectName})),n.updateEffects())}))}else console.error("沒有選擇目標")},c.onPlayedCardEvent=function(t){var e=this;if(!this._isBattleEnd){var n=this._playerUnitId;if(t.CombatCard.reset(),t.nameLabel.string=t.CombatCard.Name,t.updateEffects(),this.isBattleOver())this.endBattle();else{var a=E.instance.getExtraDraw(n);Object.keys(a).forEach((function(t){var r=a[t],i=[],o=!1;switch(t){case"atk":E.instance.tryExtraDraw(n,t)&&(i=Object.values(e._empowerCombatCards).map((function(t){return t.cards})).flat().filter((function(t){return t.cardId.indexOf("attack")>-1})),o=!0);break;case"def":E.instance.tryExtraDraw(n,t)&&(i=Object.values(e._empowerCombatCards).map((function(t){return t.cards})).flat().filter((function(t){return t.cardId.indexOf("defense")>-1})),o=!0);break;case"ran":if(E.instance.tryExtraDraw(n,t))return void e.handCards.drawCard(r);break;case"steal":if(console.log("extra steal:",a[t]),E.instance.tryExtraDraw(n,t))return e.handCards.drawCard(r),void console.warn("steal 效果尚未實作")}i=i.sort((function(){return Math.random()-.5})).slice(0,r);var s=e.parseCombatCards(i,o);y.instance.unshiftCardsToDraw(s),e.handCards.drawCard(r)}))}}},c.parseCombatCards=function(t,e){var n=this;void 0===e&&(e=!1);var a=[];return t.forEach((function(t){var r=h(n.cardPrefab);r.parent=n.cardPrefab.parent,r.active=!0;var i=new I(t,e);r.getComponent(b).setup(i),a.push(r)})),a},c.onEnermyAttackClicked=function(){var t=o(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=[],console.log("7. 施放流血予敵方"),e.length=0,e.push(this._playCard("bleed_1")),E.instance.onCardPlayed(e,this._playerUnitId,[this._enemyUnitIds[0]]);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),c._playCard=function(t){var e=v.instance.database.combatEffectDatabase.find((function(e){return e.effectId===t}));return console.log("combatEffectData:",e),E.instance.getCombatEffect(e)},i(e,null,[{key:"instance",get:function(){return this._instance}}]),e}(m))._instance=null,G=e((V=nt).prototype,"combatNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(V.prototype,"cardPrefab",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(V.prototype,"handCards",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(V.prototype,"myCombatEffectStatus",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(V.prototype,"enemyCombatEffectStatus",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(V.prototype,"enemyFrontLayout",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(V.prototype,"empowerCardsListLayout",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(V.prototype,"endTurnButton",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=e(V.prototype,"popupWindow",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=e(V.prototype,"cameraCenterMover",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=e(V.prototype,"energyLabel",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=V))||R));c._RF.pop()}}}));

System.register("chunks:///_virtual/CameraCenterMover.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,o,n,t,i,a,u,c,d,l,f,s;return{setters:[function(e){r=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,t=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,u=e.Node,c=e.view,d=e.Vec3,l=e.UITransform,f=e.tween,s=e.Component}],execute:function(){var p,g,m,b,v,h,y,w,N,z,C,F,k,M;i._RF.push({},"26e98L2djNEAIefDtGVZOdA","CameraCenterMover",void 0);var x=a.ccclass,A=a.property;e("CameraCenterMover",(p=x("CameraCenterMover"),g=A([u]),m=A([u]),b=A([u]),p((y=r((h=function(e){function r(){for(var r,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return r=e.call.apply(e,[this].concat(i))||this,n(r,"moveX",y,t(r)),n(r,"moveY",w,t(r)),n(r,"foregroundNodes",N,t(r)),n(r,"midgroundNodes",z,t(r)),n(r,"backgroundNodes",C,t(r)),n(r,"foregroundFactor",F,t(r)),n(r,"midgroundFactor",k,t(r)),n(r,"backgroundFactor",M,t(r)),r}o(r,e);var i=r.prototype;return i.start=function(){},i.moveToCenter=function(e){var r=this,o=c.getVisibleSize(),n=new d(o.width/2,o.height/2,0),t=e.getComponent(l).convertToWorldSpaceAR(new d(0,0,0)),i=new d(this.moveX?n.x-t.x:0,this.moveY?n.y-t.y:0,0);this.foregroundNodes.forEach((function(e){r.moveNode(e,i,r.foregroundFactor)})),this.midgroundNodes.forEach((function(e){r.moveNode(e,i,r.midgroundFactor)})),this.backgroundNodes.forEach((function(e){r.moveNode(e,i,r.backgroundFactor)}))},i.moveNode=function(e,r,o){var n=new d(r.x*o,r.y*o,r.z),t=e.position.clone().add(n);f(e).to(1,{position:t},{easing:"quadInOut"}).start()},r}(s)).prototype,"moveX",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),w=r(h.prototype,"moveY",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),N=r(h.prototype,"foregroundNodes",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),z=r(h.prototype,"midgroundNodes",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),C=r(h.prototype,"backgroundNodes",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=r(h.prototype,"foregroundFactor",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.2}}),k=r(h.prototype,"midgroundFactor",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),M=r(h.prototype,"backgroundFactor",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.8}}),v=h))||v));i._RF.pop()}}}));

System.register("chunks:///_virtual/CardMover.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e,o,r,a,i,s,c;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator,r=n.UITransform,a=n.tween,i=n.v3,s=n.Vec3,c=n.Component}],execute:function(){var u;e._RF.push({},"84f9242HqlIxoYCUsq4N1ow","CardMover",void 0);var d=o.ccclass;n("CardMover",d("CardMover")(u=function(n){function e(){return n.apply(this,arguments)||this}return t(e,n),e.moveCard=function(n,t,e,o,a,i){void 0===o&&(o=1),void 0===a&&(a=.02),void 0===i&&(i=.25);var s=n.parent.getComponent(r),c=t.getComponent(r);if(!s||!c)return Promise.reject(new Error("UITransform component is missing"));var u=s.convertToWorldSpaceAR(n.position);n.removeFromParent(),n.parent=t;var d=c.convertToNodeSpaceAR(u);return n.setPosition(d),this.animateCardMovement(n,e,o,a,i)},e.animateCardMovement=function(n,t,e,o,r){return new Promise((function(s){var c=a().delay(o).call((function(){return s()})),u=a(n).delay(r/2).to(r/4,{scale:i(e,e,1)},{easing:"quadInOut"}),d=a(n).to(r,{position:t},{easing:"quadInOut"});a(n).parallel(d,u,c).start()}))},e.scatterCards=function(n,t,e,o){return new Promise((function(r){n.forEach((function(n){var i=e[0],c=e[1],u=2*Math.random()*Math.PI,d=i+Math.random()*(c-i),v=new s(Math.cos(u),Math.sin(u),0),l=s.scaleAndAdd(new s,t.position,v,d);a(n).to(o,{position:l},{easing:"cubicOut"}).call((function(){return r()})).start()}))}))},e}(c))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/CheckBoxComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,c,i,n,o,r,s,h,a;return{setters:[function(e){t=e.applyDecoratedDescriptor,c=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized,o=e.createClass},function(e){r=e.cclegacy,s=e._decorator,h=e.Node,a=e.Component}],execute:function(){var k,u,l,p,C;r._RF.push({},"9182cS2L5BPUIFExtxBBEUL","CheckBoxComponent",void 0);var d=s.ccclass,f=s.property;e("CheckBoxComponent",(k=d("CheckBoxComponent"),u=f(h),k((C=t((p=function(e){function t(){for(var t,c=arguments.length,o=new Array(c),r=0;r<c;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,i(t,"checkmark",C,n(t)),t._isChecked=!1,t}c(t,e);var r=t.prototype;return r.onLoad=function(){this.checkmark.active=this._isChecked},r.check=function(){this._isChecked=!0,this.checkmark.active=!0},r.cancel=function(){this._isChecked=!1,this.checkmark.active=!1},r.onClicked=function(){this._isChecked=!this._isChecked,this.checkmark.active=this._isChecked},o(t,[{key:"isChecked",get:function(){return this._isChecked}}]),t}(a)).prototype,"checkmark",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=p))||l));r._RF.pop()}}}));

System.register("chunks:///_virtual/CombatCard.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts","./CombatEffectManager.ts"],(function(e){var t,n,a,i;return{setters:[function(e){t=e.createClass},function(e){n=e.cclegacy},function(e){a=e.GameManager},function(e){i=e.CombatEffectManager}],execute:function(){n._RF.push({},"7ca924FaMxPpJUAkJlPtpzg","CombatCard",void 0);e("CombatCard",function(){var e=n.prototype;function n(e,t){this._data=null,this._effects=[],this._evolutionEffects=[],this._feeType=void 0,this._fee=void 0,this._consumable=void 0,this._range=void 0,e?(this._data=e,this._feeType=e.feeType,this._fee=e.fee,this._range=e.range,this._consumable=t,this.parseCombatCard(e)):console.error("CombatCardData is null")}return e.tryEvolutions=function(e){var t=this;this._evolutionEffects.length=0;var n=!1;return this._data.evolutions.forEach((function(a){var i=a.conditions.split(" ").every((function(t){return e.includes(t)}));return i&&(t._evolutionEffects.push({effectId:a.effectId,effectName:a.effectName,feeType:a.feeType,fee:a.fee,range:a.range}),n=!0),i})),n},e.parseCombatCard=function(e){var t=this,n=a.instance.database.combatEffectDatabase;e.combatEffects.forEach((function(e){var a=n.find((function(t){return t.effectId===e.id}));a?t._effects.push(i.instance.getCombatEffect(a)):console.log("卡片抽光了")}))},e.changeFee=function(e,t){this._feeType=e,this._fee=t},e.changeRange=function(e){this._range=e},e.reset=function(){this._evolutionEffects.length=0,this._feeType=this._data.feeType,this._fee=this._data.fee,this._range=this._data.range},t(n,[{key:"Id",get:function(){return this._data.cardId}},{key:"Name",get:function(){return this._data.cardName}},{key:"Effects",get:function(){return this._effects}},{key:"EvolutionEffects",get:function(){return this._evolutionEffects}},{key:"Description",get:function(){return this._data.getDescription("\n")}},{key:"FeeType",get:function(){return this._feeType}},{key:"Fee",get:function(){return this._fee}},{key:"Consumable",get:function(){return this._consumable}},{key:"Range",get:function(){return this._range}},{key:"NeedTarget",get:function(){return"None"!=this.Range}}]),n}());n._RF.pop()}}}));

System.register("chunks:///_virtual/CombatCardComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,a,n,i,r,o,l,u,c;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized,r=e.createClass},function(e){o=e.cclegacy,l=e._decorator,u=e.Label,c=e.Component}],execute:function(){var s,f,b,m,p,d,h,C,g,y,L,v,E;o._RF.push({},"7a72cWn7flKx465/nIaH80W","CombatCardComponent",void 0);var F=l.ccclass,V=l.property;e("CombatCardComponent",(s=F("CombatCardComponent"),f=V(u),b=V(u),m=V(u),p=V(u),d=V(u),s((g=t((C=function(e){function t(){for(var t,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,n(t,"nameLabel",g,i(t)),n(t,"feeLabel",y,i(t)),n(t,"mainValueLabel",L,i(t)),n(t,"secondaryValueLabel",v,i(t)),n(t,"effectsLabel",E,i(t)),t._combatCard=null,t}a(t,e);var o=t.prototype;return o.setup=function(e){this._combatCard=e,this.nameLabel.string=e.Name,this.updateFee(e);var t=0,a=[];this.CombatCard.Effects.forEach((function(e){"damage"===e.effectType&&(t+=e.value),a.push(e.effectName)})),this.mainValueLabel.string=t?t.toString():"",this.effectsLabel.string=a.join("\n"),this.updateEffects()},o.updateEffects=function(){var e=this,t=0,a=0,n=0,i=[],r=[];this.CombatCard.Effects.forEach((function(e){"damage"===e.effectType?t+=e.value:"defense"===e.effectType?n+=e.value:e.diceInfo.indexOf("d")>-1&&(i.push(e.diceInfo),a=e.value),r.push(e.effectName)})),this.CombatCard.EvolutionEffects.forEach((function(t){r.includes(t.effectName)||r.push(t.effectName),e.CombatCard.changeFee(t.feeType,parseInt(t.fee,10)),e.CombatCard.changeRange(t.range)})),this.effectsLabel.string=r.join("\n"),this.secondaryValueLabel.string="",t>0?this.mainValueLabel.string=t.toString():a>0?(this.mainValueLabel.string=a.toString(),this.secondaryValueLabel.string=i.join("\n")):this.mainValueLabel.string=n>0?n.toString():"",this.updateFee(this.CombatCard)},o.updateFee=function(e){var t="";"action"===e.FeeType?t="動作":"reaction"===e.FeeType?t="反應":"bonus"===e.FeeType&&(t="備戰"),this.feeLabel.string=t?e.Fee+"\n"+t:""+e.Fee},o.isConsumable=function(){return this.CombatCard.Consumable},r(t,[{key:"Name",get:function(){var e;return null==(e=this._combatCard)?void 0:e.Name}},{key:"CombatCard",get:function(){return this._combatCard}},{key:"Effects",get:function(){var e;return null==(e=this._combatCard)?void 0:e.Effects}}]),t}(c)).prototype,"nameLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(C.prototype,"feeLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(C.prototype,"mainValueLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(C.prototype,"secondaryValueLabel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(C.prototype,"effectsLabel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=C))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/CombatCardData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i;return{setters:[function(t){e=t.createClass},function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"6281cLfjNxAfZ27Gtcn5Q+M","CombatCardData",void 0);t("CombatCardData",function(){function t(t,e,i,n,r,o,s,c){this._cardId=void 0,this._cardName=void 0,this._combatEffects=[],this._range=void 0,this._evolutions=[],this._description=[],this._feeType=void 0,this._fee=void 0,this._cardId=t,this._cardName=e,this._range=i,this._feeType=n,this._fee=r,this._combatEffects=o,this._evolutions=s,this._description=c}return t.prototype.getDescription=function(t){return this._description.join(t)},t.fromCSV=function(e){var i=parseInt(e.fee,10);return new t(e.id,e.name,e.range,e.feeType,i,e.effects,e.evolutions,e.description)},e(t,[{key:"cardId",get:function(){return this._cardId}},{key:"cardName",get:function(){return this._cardName}},{key:"combatEffects",get:function(){return this._combatEffects}},{key:"range",get:function(){return this._range}},{key:"evolutions",get:function(){return this._evolutions}},{key:"feeType",get:function(){return this._feeType}},{key:"fee",get:function(){return this._fee}}]),t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatCardManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatCardComponent.ts","./CardMover.ts"],(function(e){var n,t,i,r,o,a,c,s,l,h,d,u,p,f,w,v,C,m,g,y,P;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,a=e.createClass,c=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e._decorator,h=e.Node,d=e.ScrollView,u=e.EventHandler,p=e.Label,f=e.Vec3,w=e.instantiate,v=e.Component,C=e.v3,m=e.Sprite,g=e.Color},function(e){y=e.CombatCardComponent},function(e){P=e.CardMover}],execute:function(){var b,I,k,E,S,_,L,D,V,x,z,M,O,R,Z,T,B,F,H,N;s._RF.push({},"e3c4eMhBghL4LVTn4lhrJcB","CombatCardManager",void 0);var j=l.ccclass,A=l.property;e("CombatCardManager",(b=j("CombatCardManager"),I=A(h),k=A(h),E=A(h),S=A(h),_=A(h),L=A(d),D=A(u),V=A(u),b(((N=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,i(n,"cardPrefab",M,r(n)),i(n,"deckIcon",O,r(n)),i(n,"drawIcon",R,r(n)),i(n,"playedIcon",Z,r(n)),i(n,"consumedIcon",T,r(n)),i(n,"cardsScrollView",B,r(n)),i(n,"playCardEvent",F,r(n)),i(n,"playedCardEvent",H,r(n)),n.deck=[],n.hand=[],n.playedPile=[],n.consumedPile=[],n.drawPile=[],n._prviewIcon=null,n._prviewPile=[],n}t(n,e);var s=n.prototype;return s.onLoad=function(){n._instance||(n._instance=this)},s.start=function(){},s.sample=function(){},s.clear=function(){this.deck.forEach((function(e){return e.destroy()})),this.drawPile.forEach((function(e){return e.destroy()})),this.playedPile.forEach((function(e){return e.destroy()})),this.consumedPile.forEach((function(e){return e.destroy()})),this.deck.length=0,this.hand.length=0,this.drawPile.length=0,this.playedPile.length=0,this.consumedPile.length=0,this.deckIcon.getComponentInChildren(p).string="0",this.drawIcon.getComponentInChildren(p).string="0",this.playedIcon.getComponentInChildren(p).string="0",this.consumedIcon.getComponentInChildren(p).string="0"},s.hide=function(e){this.scheduleOnce((function(){e.forEach((function(e){e.active=!1}))}),.6)},s.addCardsToDeck=function(e){var n,t=this;(n=this.deck).push.apply(n,e),e.forEach((function(e){P.moveCard(e,t.deckIcon,f.ZERO,.2);var n=e.getComponent(y),i=w(e);i.parent=t.drawIcon,i.active=!1,i.getComponent(y).setup(n.CombatCard),t.drawPile.push(i)})),this.hide(e)},s.unshiftCardsToDraw=function(e){var n,t=this;(n=this.drawPile).unshift.apply(n,e),e.forEach((function(e){P.moveCard(e,t.drawIcon,f.ZERO,.2)}))},s.shuffleDeck=function(){for(var e=this.drawPile.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),t=[this.drawPile[n],this.drawPile[e]];this.drawPile[e]=t[0],this.drawPile[n]=t[1]}},s.drawCards=function(){var e=o(c().mark((function e(n){var t,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=[];n>0&&this.drawPile.length>0;)i.push(this.drawPile.shift()),n--;if((t=this.hand).push.apply(t,i),!(n>0)){e.next=9;break}return e.next=6,this.recyclePlayedCards();case 6:return this.drawPile.length<n&&(n=0,console.log("牌堆與抽牌堆的牌不足，無法正常抽牌，只能結束")),this.shuffleDeck(),e.abrupt("return",this.drawCards(n));case 9:return this.drawIcon.getComponentInChildren(p).string=this.drawPile.length.toString(),e.abrupt("return",this.hand);case 11:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),s.previewCard=function(e){if(console.log("出牌展示",e),e>=0&&e<this.hand.length)this.hand[e]},s.playCard=function(e){if(console.log("出牌",e),e>=0&&e<this.hand.length){var n=this.hand.splice(e,1)[0];this.isConsumable(n)?(this.consumedPile.push(n),this.displayCard(n,this.consumedIcon,this.consumedPile.length)):(this.playedPile.push(n),this.displayCard(n,this.playedIcon,this.playedPile.length))}},s.isConsumable=function(e){var n;return(null==(n=e.getComponent(y))?void 0:n.isConsumable())||!1},s.recyclePlayedCards=function(){var e=o(c().mark((function e(){var n,t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.drawPile).push.apply(n,this.playedPile),this.drawIcon.getComponentInChildren(p).string=this.drawPile.length.toString(),this.playedPile.forEach((function(e){e.getComponent(m).color=new g(255,255,255,255),P.moveCard(e,t.drawIcon,f.ZERO,.2)})),e.next=5,this.delaySeconds(1.5);case 5:this.playedPile.length=0,this.playedIcon.getComponentInChildren(p).string="0";case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.showDeckList=function(e){void 0===e&&(e=!0),this._prviewIcon=this.deckIcon,this._prviewPile=this.deck,this.showScrollview(e)},s.showDrawList=function(e){void 0===e&&(e=!0),this._prviewIcon=this.drawIcon,this._prviewPile=this.drawPile,this.showScrollview(e)},s.showPlayedList=function(e){void 0===e&&(e=!0),this._prviewIcon=this.playedIcon,this._prviewPile=this.playedPile,this.showScrollview(e)},s.showConsumedList=function(e){void 0===e&&(e=!0),this._prviewIcon=this.consumedIcon,this._prviewPile=this.consumedPile,this.showScrollview(e)},s.showScrollview=function(e){void 0===e&&(e=!0);for(var n=this._prviewIcon,t=this._prviewPile,i=this.cardsScrollView.content.children,r=i.length;r<t.length;r++){var o=w(i[0]);o.parent=this.cardsScrollView.content,o.active=!0}this.cardsScrollView.node.active=e,e?i.forEach((function(e,n){var i=t[n];i?(i.active=e.active=!0,P.moveCard(i,e,f.ZERO,1)):e.active=!1})):(i.forEach((function(e,i){var r=t[i];r?(r.active=e.active=!0,P.moveCard(r,n,f.ZERO,.2)):e.active=!1})),this.hide(t))},s.displayCard=function(e,n,t,i){var r=this;void 0===i&&(i=0),this.scheduleOnce(o(c().mark((function i(){var o;return c().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.isValid){i.next=3;break}return console.log("卡牌已被移除"),i.abrupt("return");case 3:return 1.5,e.scale=C(1.5,1.5,1),i.next=7,P.moveCard(e,r.node,C(0,150,0),1.5,.8);case 7:return o=e.getComponent(y),r.playCardEvent.forEach((function(e){return e.emit([o.CombatCard])})),i.next=11,P.moveCard(e,n,f.ZERO,.2,.25);case 11:e.active=!1,e.scale=f.ONE,r.playedCardEvent.forEach((function(e){return e.emit([o])})),n.getComponentInChildren(p).string=t.toString();case 15:case"end":return i.stop()}}),i)}))),i)},s.delaySeconds=function(e){var n=this;return new Promise((function(t){return n.scheduleOnce((function(){return t()}),e)}))},s.onDeckIconClick=function(){this.showDeckList(!this.cardsScrollView.node.active)},s.onDrawIconClick=function(){this.showDrawList(!this.cardsScrollView.node.active)},s.onPlayedIconClick=function(){this.showPlayedList(!this.cardsScrollView.node.active)},s.onConsumedIconClick=function(){this.showConsumedList(!this.cardsScrollView.node.active)},s.onClosePrivewClick=function(){this.showScrollview(!1)},a(n,null,[{key:"instance",get:function(){return this._instance}}]),n}(v))._instance=null,M=n((z=N).prototype,"cardPrefab",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=n(z.prototype,"deckIcon",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=n(z.prototype,"drawIcon",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=n(z.prototype,"playedIcon",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=n(z.prototype,"consumedIcon",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(z.prototype,"cardsScrollView",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=n(z.prototype,"playCardEvent",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=n(z.prototype,"playedCardEvent",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=z))||x));s._RF.pop()}}}));

System.register("chunks:///_virtual/CombatEffect.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i;return{setters:[function(t){e=t.createClass},function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"afe14JRpy1EaoVaSRoNni5X","CombatEffect",void 0);t("CombatEffect",function(){function t(t,e,i,n,c,o){this._effectName=void 0,this._effectType=void 0,this._value=void 0,this._diceInfo="",this._dc=void 0,this._description=void 0,this.adjustmentValue=0,this._effectName=t,this._effectType=e,this._value=i,this._diceInfo=n,this._dc=c,this._description=o}return t.prototype.tooltop=function(){return this._description},e(t,[{key:"effectName",get:function(){return this._effectName}},{key:"effectType",get:function(){return this._effectType}},{key:"value",get:function(){return this._value}},{key:"diceInfo",get:function(){return this._diceInfo}},{key:"dc",get:function(){return this._dc}},{key:"description",get:function(){return this._description}}]),t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatEffectComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./HitPointsBarComponent.ts","./ShakeAnimation.ts","./DodgeAnimation.ts","./DiceAnimation.ts","./DefenseAnimation.ts","./HideAnimation.ts","./StunAnimation.ts","./HitCheckAnimation.ts","./FloatingTextComponent.ts","./PixelImage.ts"],(function(t){var n,e,i,o,a,r,s,c,u,f,l,p,h,m,d,g,y,C,b,v,w,k,A,D,T,x,E;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.asyncToGenerator,r=t.regeneratorRuntime,s=t.createClass},function(t){c=t.cclegacy,u=t._decorator,f=t.Node,l=t.Label,p=t.randomRangeInt,h=t.Vec3,m=t.tween,d=t.Component,g=t.instantiate,y=t.UIOpacity},function(t){C=t.HitPointsBarComponent},function(t){b=t.default},function(t){v=t.DodgeAnimation},function(t){w=t.default},function(t){k=t.DefenseAnimation},function(t){A=t.HideAnimation},function(t){D=t.StunAnimation},function(t){T=t.HitCheckAnimation},function(t){x=t.FloatingTextComponent},function(t){E=t.PixelImage}],execute:function(){var H,B,_,P,S,z,N,I,O,L,F,R,M,U,V,j,q,G,X;c._RF.push({},"48a24wcO/NEgaUXiL0qFeIA","CombatEffectComponent",void 0);var J=u.ccclass,K=u.property;t("CombatEffectComponent",(H=J("CombatEffectComponent"),B=K(f),_=K(f),P=K(f),S=K(C),z=K(l),N=K(f),I=K(f),O=K(x),H((R=n((F=function(t){function n(){for(var n,e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return n=t.call.apply(t,[this].concat(a))||this,i(n,"iconContainer",R,o(n)),i(n,"displayContainer",M,o(n)),i(n,"entity",U,o(n)),i(n,"hitPointsBar",V,o(n)),i(n,"NameLabel",j,o(n)),i(n,"dice",q,o(n)),i(n,"handCardTip",G,o(n)),i(n,"tip",X,o(n)),n._combatEffects=new Map,n._isDefenseBroken=!1,n}e(n,t);var c=n.prototype;return c.onLoad=function(){this.iconContainer.children.forEach((function(t){return t.active=!1}))},c.showTip=function(t){this.tip.showText(t)},c.rollHitDice=function(t){var n=this;return new Promise(a(r().mark((function e(i){var o,a,s,c,u;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null==(o=n.dice)?void 0:o.getComponent(w)){e.next=4;break}return i(p(1,t)),e.abrupt("return");case 4:for(s=[],c=1;c<=t;c++)s.push(c);return s.sort((function(){return Math.random()-.5})),e.next=9,a.starAnimation(1,s);case 9:u=e.sent,i(u);case 11:case"end":return e.stop()}}),e)}))))},c.rollHitCheck=function(){var t=a(r().mark((function t(n){var e;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.entity.getComponent(T))){t.next=6;break}return e.stopAnimation(),t.next=5,e.startAnimation();case 5:e.Value=n;case 6:case"end":return t.stop()}}),t,this)})));return function(n){return t.apply(this,arguments)}}(),c.changeArmor=function(t,n){var e=this.entity.getComponent(k);e&&(t>0?e.increaseDefense(t,n):e.decreaseDefense(-t,n))},c.breakDefense=function(t){if(!this._isDefenseBroken){var n=this.entity.getComponent(k);n&&(n.defenseBroken(t),this.tip.showText("破防"),this._isDefenseBroken=!0)}},c.dodge=function(t){if(t){var n=this.entity.getComponent(v);n&&(n.stopAnimation(),n.startAnimation(),this.tip.showText("閃避"))}else this.tip.showText("閃避失敗")},c.hiding=function(t){void 0===t&&(t=!0);var n=this.entity.getComponent(A);n&&(n.stopAnimation(),t?(n.startAnimation(),this.tip.showText("隱匿中")):this.tip.showText("解除隱匿"))},c.stun=function(){var t=this.entity.getComponent(D);t&&(t.stopAnimation(),t.startAnimation(),this.tip.showText("暈眩"))},c.death=function(){this.tip.showText("死亡")},c.onTurnEnd=function(){var t=this.entity.getComponent(T);t&&t.hide()},c.handCount=function(t){var n=this;return new Promise((function(e){var i=n.handCardTip.children,o=i.filter((function(t){return t.active})).length,a=t-o,r=[];if(a>0)for(var s=function(t){if((u=i[t])||((u=g(i[0])).parent=n.handCardTip),u.active=!0,t>=o-a){var s=32*t;u.position=new h(s,-30,0),r.push(m(u).delay(.1*t).to(.2,{position:new h(s,0,0)},{easing:"cubicOut"}).call((function(){t===o-1&&e()}))),u.getComponent(y).opacity=0,r.push(m(u.getComponent(y)).delay(.1*t).to(.2,{opacity:255},{easing:"cubicOut"}))}},c=0;c<t;c++){var u;s(c)}else a<0?n.handCardTip.children.forEach((function(t,n){if(n>=o+a){var i=32*n;t.position=new h(i,0,0),r.push(m(t).delay(.1*n).to(.2,{position:new h(i,30,0)},{easing:"cubicOut"}).call((function(){t.active=!1,n===o-1&&e()})))}})):r.push(m(n.node).call((function(){return e()})));n.scheduleOnce((function(){r.forEach((function(t){return t.start()}))}),.1)}))},c.setEffectStatus=function(t){var n=this._combatEffects.get(t.effectType);n||(n={name:t.effectName,stack:0},this._combatEffects.set(t.effectType,n)),this.updateStatusDisplay(t.effectType,t.value)},c.updateStatusDisplay=function(t,n){var e=this,i=this._combatEffects.get(t);if(console.log(t,i),i){var o=this.iconContainer.getChildByName(t);if(o){o.active=!0;var a=o.parent,r=o.getComponentInChildren(l);r.string=i.stack.toString(),m(o).delay(0).call((function(){return o.parent=e.displayContainer})).to(.1,{scale:new h(1.5,1.5)},{easing:"cubicOut"}).call((function(){i.stack+=n,r.string=i.name+"\n"+i.stack,console.log(i.name,"數值變化",n)})).to(.25,{scale:h.ONE},{easing:"cubicIn"}).call((function(){o.parent=a,i.stack<=0&&e.removeStatusDisplay(t)})).start()}}},c.removeStatusDisplay=function(t){var n=this.iconContainer.getChildByName(t);n&&(n.active=!1),this._combatEffects.delete(t)},c.removeAllStatusDisplay=function(){var t=this;this._combatEffects.forEach((function(n,e){t.removeStatusDisplay(e)}))},s(n,[{key:"Name",set:function(t){this.NameLabel.string=t}},{key:"Image",set:function(t){var n=this.entity.getComponent(E);n&&n.setSpriteFrame(t)}},{key:"Hp",set:function(t){this.hitPointsBar.defaultHp=t}},{key:"HitCheck",set:function(t){this.rollHitCheck(t)}},{key:"Damage",set:function(t){this.hitPointsBar.changeHp(-t);var n=this.entity.getComponent(b);n&&(n.stopAnimation(),n.startAnimation(),this.scheduleOnce((function(){return n.stopAnimation()}),.5))}},{key:"Heal",set:function(t){this.hitPointsBar.changeHp(t)}},{key:"Defense",set:function(t){this._isDefenseBroken=!1;var n=this.entity.getComponent(k);n&&n.buildDefense(t)}}]),n}(d)).prototype,"iconContainer",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=n(F.prototype,"displayContainer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=n(F.prototype,"entity",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=n(F.prototype,"hitPointsBar",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=n(F.prototype,"NameLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=n(F.prototype,"dice",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=n(F.prototype,"handCardTip",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=n(F.prototype,"tip",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=F))||L));c._RF.pop()}}}));

System.register("chunks:///_virtual/CombatEffectData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,f;return{setters:[function(t){e=t.createClass},function(t){i=t.cclegacy,f=t.randomRangeInt}],execute:function(){i._RF.push({},"c34e5IgS79CdJxWRMmgBF7i","CombatEffectData",void 0);t("CombatEffectData",function(){function t(t,e,i,f,u,s){this._effectId=void 0,this._effectName=void 0,this._effectType=void 0,this._value=void 0,this._difficultyAttribute=void 0,this._difficultClass=void 0,this._description=void 0,this._effectId=t,this._effectName=e,this._effectType=i,this._value=f;var c=u.split("_");c.length<2?(this._difficultyAttribute="",this._difficultClass=0):(this._difficultyAttribute=c[0],this._difficultClass=Number(c[1])),this._description=s}return t.prototype.getEffectValue=function(){var t=0;if(this._value.indexOf("d")>-1){var e=this._value.split("d"),i=Number(e[0]),u=Number(e[1]);t=i*f(1,u)}else t=this._value?Number(this._value):0;return t},t.fromCSV=function(e){return new t(e.id,e.name,e.type,e.value,e.dc,e.description)},e(t,[{key:"effectId",get:function(){return this._effectId}},{key:"effectName",get:function(){return this._effectName}},{key:"effectType",get:function(){return this._effectType}},{key:"value",get:function(){return this._value}},{key:"dc",get:function(){return""===this._difficultyAttribute||0===this._difficultClass?null:{attribute:this._difficultyAttribute,class:this._difficultClass}}},{key:"description",get:function(){return this._description}}]),t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatEffectManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RandomString.ts","./CombatEffect.ts"],(function(t){var s,e,i,a,n,c,u,h,o,r;return{setters:[function(t){s=t.createClass,e=t.inheritsLoose,i=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){n=t.cclegacy,c=t._decorator,u=t.randomRangeInt,h=t.Component},function(t){o=t.RandomString},function(t){r=t.CombatEffect}],execute:function(){var f,l;n._RF.push({},"0999bVerhlP2bt4/tuii+28","CombatEffectManager",void 0);var d=c.ccclass,g=(t("CombatEffectManager",d("CombatEffectManager")(((l=function(t){function n(){for(var s,e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return(s=t.call.apply(t,[this].concat(i))||this).units={},s}e(n,t);var c=n.prototype;return c.onLoad=function(){n._instance||(n._instance=this)},c.join=function(t,s,e,i,a,n,c,u){var h=o.generate();return this.units[h]=new g(t,s,e,i,a,n,c,u),h},c.quit=function(t){return!!this.units[t]&&(this.units[t].status.death(),this.units[t].remove(),delete this.units[t],console.log("CombatUnit quit",t,this.units),!0)},c.isStun=function(t){var s=this.units[t];return s?(s.isStuned&&s.onStun(),this.units[t].isStuned):(console.warn("CombatUnit not found",t),!0)},c.getCombatEffect=function(t){return new r(t.effectName,t.effectType,t.getEffectValue(),t.value,t.dc,t.description)},c.onCardPlayed=function(t,s,e){var i=this;void 0===e&&(e=[]);var a=this.units[s];if(a){t.forEach((function(t){a.positive(t)}));var n=a.HitCheck;e.forEach((function(s){var e=i.units[s];e?(t.forEach((function(t){e.negative(t,n),e.Defense<=n&&e.status.breakDefense(e.Defense),"damage"===t.effectType&&e.onSquelch()})),e.squelch>0&&(a.damage+=e.squelch,e.squelch=0)):console.warn("CombatUnit not found",s)})),console.log("----caster----",this.units[s]),console.log("----receivers----",e.map((function(t){return i.units[t]}))),a.onBurning(),a.onPanic(),e.forEach((function(t){i.units[t].executeDamage()})),a.executeDamage()}},c.onBeginBattle=function(){var t=this;Object.keys(this.units).forEach((function(s){t.units[s].reset()}))},c.onEnBattle=function(){var t=this;Object.keys(this.units).forEach((function(s){var e=t.units[s];e.status.onTurnEnd(),e.remove()})),this.units={}},c.hitRoll=function(){var t=i(a().mark((function t(s){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.units[s],t.next=3,e.hitRoll();case 3:case"end":return t.stop()}}),t,this)})));return function(s){return t.apply(this,arguments)}}(),c.onTurnBegin=function(t){var s=this,e=this.units[t];e.reset(),e.onInaccurate();var i=e.HitCheck;Object.keys(this.units).forEach((function(e){if(e!=t){var a=s.units[e];a.Defense<=i?a.status.breakDefense(a.Defense):a.status.Defense=a.Defense}})),e.onFear()},c.onTurnEnd=function(t){this.units[t].status.onTurnEnd()},c.onRoundEnd=function(){for(var t in this.units){var s=this.units[t];s.onBleed(),s.executeDamage(),s.resetDraw()}},c.intentionHandsTip=function(t,s){return this.units[t].status.handCount(s)},c.getDrawCount=function(t){return this.units[t].draw},c.getCountdown=function(t){return this.units[t].cuntdown},c.getEnergy=function(t){return Object.values(this.units[t].energy).map((function(t,s){return["行動","反應","備戰"][s]+": "+t})).join("\n")},c.getExtraDraw=function(t){var s=this,e={};return Object.keys(this.units[t].extraDraw).forEach((function(i){var a=s.units[t].extraDraw[i];a&&(e[i]=a)})),e},c.tryExtraDraw=function(t,s){if(null==this.units[t].extraDraw[s])return!1;var e=this.units[t].extraDraw[s]>0;return this.units[t].extraDraw[s]=0,e},c.tryCostFee=function(t,s){var e=this.units[t],i=s.FeeType,a=s.Fee;if(0===a)return!0;if(void 0===e.energy[i])return console.error("無此類別能量:",i),!1;if(e.energy[i]<a){var n="";switch(i){case"action":n="行動";break;case"reaction":n="反應";break;case"bonus":n="備戰";break;default:return console.error("無此類別能量:",i),!1}return this.units[t].status.showTip(n+"\n點數不足"),!1}return e.energy[i]-=a,!0},c.isAlive=function(t){return this.units[t].HP>0},s(n,null,[{key:"instance",get:function(){return this._instance}}]),n}(h))._instance=null,f=l))||f),t("CombatUnit",function(){function t(t,s,e,i,a,n,c,u){this.status=null,this._hitPoint=0,this._armorClass=0,this._defense=0,this.damage=0,this.squelch=0,this.draw=0,this.extraDraw={},this._handCount=0,this._discardCount=0,this.energy={},this._hitBonus=0,this.dexterity=0,this.wisdom=0,this.resilience=0,this.cuntdown=0,this.isStuned=!1,this._effectDC=[],this._effectAcc=[],this._hitRoll=0,this.status=t,this.status.Name=s,this.status.Hp=e,this._hitPoint=e,this._armorClass=i,this.draw=this._handCount=a,this.dexterity=n,this.wisdom=c,this.resilience=u}var e=t.prototype;return e.hitRoll=function(){var t=i(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.status.rollHitDice(20);case 2:this._hitRoll=t.sent,this.status.HitCheck=this.HitCheck;case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.executeDamage=function(){var t;this.damage>0&&(this._hitPoint-=this.damage,this.status.Damage=this.damage,this.damage=0,(null==(t=this._effectDC.hide)?void 0:t.stack)>0&&(this._effectDC.hide.stack=0,this.status.removeStatusDisplay("hide"),this.status.hiding(!1)))},e.reset=function(){this._defense=this._armorClass,this.status.Defense=this.Defense,this._hitBonus=0,this.cuntdown=0,this.energy={action:1,reaction:1,bonus:1},this.extraDraw={atk:0,def:0,ran:0,steal:0}},e.remove=function(){var t;(null==(t=this._effectDC.hide)?void 0:t.stack)>0&&this.status.hiding(!1),this.status.removeAllStatusDisplay(),this.status=null},e.resetDraw=function(){this.draw=this._handCount},e.onBleed=function(){var t="bleed";if(this._effectAcc.bleed){var s=this._effectAcc.bleed;console.log(t,s),s>0&&(this._effectAcc.bleed--,this._hitPoint-=s,this.status.Damage=s,this.status.updateStatusDisplay(t,-1),console.log("受到流血傷害:",s))}},e.onBurning=function(){var t="burning";if(this._effectAcc.burning){var s=this._effectAcc.burning;console.log(t,s),s>0&&(this._effectAcc.burning--,this._hitPoint-=s,this.status.Damage=s,this.status.updateStatusDisplay(t,-1),console.log("受到灼燒傷害:",s))}},e.onVigilant=function(){var t="vigilant";this._effectAcc.vigilant&&this._effectAcc.vigilant>0&&(this._effectAcc.vigilant--,this.status.updateStatusDisplay(t,-1),console.log("抽一張牌"))},e.onInaccurate=function(){var t="inaccurate";this._effectAcc.inaccurate&&this._effectAcc.inaccurate>0&&(this._hitBonus-=this._effectAcc.inaccurate,this._effectAcc.inaccurate=0,this.status.removeStatusDisplay(t))},e.onStun=function(){var t,s="stun";(null==(t=this._effectDC.stun)?void 0:t.stack)>0?this._checkDifficultClass(s,0)?(console.log("韌性檢定成功，解除眩暈"),this._effectDC.stun.stack--,this.status.updateStatusDisplay(s,-1),this.isStuned=this._effectDC.stun.stack>0):(console.log("眩暈效果持續"),this.isStuned=!0,this.status.stun()):this.isStuned=!1},e.onFear=function(){var t,s="fear";(null==(t=this._effectDC.fear)?void 0:t.stack)>0&&(this._checkDifficultClass(s)?(console.log("韌性檢定成功，解除恐懼"),this._effectDC.fear.stack=0,this.status.removeStatusDisplay(s)):(console.log("恐懼效果持續"),this.cuntdown=6))},e.onPanic=function(){var t,s="panic";(null==(t=this._effectDC.panic)?void 0:t.stack)>0&&(this._checkDifficultClass(s)?(console.log("韌性檢定成功，解除慌亂"),this._effectDC.panic.stack=0,this.status.removeStatusDisplay(s)):(console.log("慌亂效果持續"),this._discardCount++))},e.onSquelch=function(){var t="squelch";this._effectAcc.squelch>0&&(this.squelch+=this._effectAcc.squelch,this._effectAcc.squelch=0,this.status.removeStatusDisplay(t))},e.positive=function(t){var s,e=t.effectType,i=t.value;switch(console.log("positive effect:",e,i),e){case"damage":this._effectAcc.internalInjury>0&&(t.adjustmentValue=-Math.floor(t.value/2),this._effectAcc.internalInjury--,console.log("內傷造成傷害減半"),this.status.updateStatusDisplay("internalInjury",-1)),(null==(s=this._effectDC.hide)?void 0:s.stack)>0&&(this._effectDC.hide.stack=0,this.status.removeStatusDisplay("hide"),this.status.hiding(!1));break;case"defense":var a=i;if(this._effectAcc.frigid>0){var n=Math.min(this._effectAcc.frigid,a);this._effectAcc.frigid-=n,this.status.updateStatusDisplay("frigid",-n),a=Math.round(a/2)}this.Defense+=a,this.status.changeArmor(a,this.Defense);break;case"heal":this._hitPoint=Math.min(this._hitPoint,this._hitPoint+i),this.status.Heal=i;break;case"squelch":this._addEffectAcc(e,i),this.status.setEffectStatus(t);break;case"hit":this._hitBonus+=i,this.status.HitCheck=this._hitRoll+this._hitBonus,this.status.showTip("命中上升");break;case"tourniquet":this._addEffectAcc("bleed",-i),this.status.updateStatusDisplay("bleed",-i),this.status.showTip("止血");break;case"vigilant":this._addEffectAcc(e,i),this.status.setEffectStatus(t);break;case"drawAtkCard":this.extraDraw.atk+=i;break;case"drawDefCard":this.extraDraw.def+=i;break;case"drawRanCard":this.extraDraw.ran+=i;break;case"steal":this.extraDraw.steal+=i;break;case"disarm":this._discardCount+=i;break;case"restoreAct":this.energy.action+=i;break;case"dodge":this._stackDifficultClass(t,!0),this.status.setEffectStatus(t);break;case"prejudgment":this._stackDifficultClass(t,!1),this.status.setEffectStatus(t);break;case"hide":this._stackDifficultClass(t,!0),this.status.setEffectStatus(t),this.status.hiding()}},e.negative=function(t,s){var e,i,a,n,c,u,h,o=t.effectType,r=t.value+t.adjustmentValue;if((null==(e=this._effectDC.prejudgment)?void 0:e.stack)>0){if(this._checkDifficultClass("prejudgment"))return void this.status.showTip("預判攻擊");this.status.showTip("誤判攻擊")}if((null==(i=this._effectDC.hide)?void 0:i.stack)>0&&("damage"===o||"bleed"===o)){if(this._checkDifficultClass("hide",0))return console.log("隱匿免疫攻擊成功"),void this.status.hiding();console.log("受到攻擊，隱匿失敗"),this._effectDC.hide.stack=0,this.status.removeStatusDisplay("hide"),this.status.hiding(!1)}var f=!1;switch((null==(a=this._effectDC.dodge)?void 0:a.stack)>0&&(this._checkDifficultClass("dodge",0)?(console.log("閃避攻擊"),f=!0):console.log("閃避失敗")),console.log("negative effect:",o,r),o){case"damage":if(this.onVigilant(),(null==(n=this._effectDC.dodge)?void 0:n.stack)>0&&(this._effectDC.dodge.stack--,this.status.updateStatusDisplay("dodge",-1),this.status.dodge(f)),f)return;console.log("this.defense:",this.Defense,s),this.Defense<=s?this.damage+=r:(this.Defense-=r,this.status.changeArmor(-r,this.Defense));break;case"detection":this._effectAcc.hide>0&&(this._effectAcc.hide=0,console.log("偵察效果解除隱匿"),this.status.removeStatusDisplay("hide"),this.status.hiding(!1),this.status.showTip("偵察"));break;case"bleed":if(f)return void console.log("閃避出血攻擊");this._addEffectAcc(o,r),this.status.setEffectStatus(t);break;case"internalInjury":if((null==(c=this._effectDC.dodge)?void 0:c.stack)>0&&(this._effectDC.dodge.stack--,this.status.updateStatusDisplay("dodge",-1),this.status.dodge(f)),f)return;this._addEffectAcc(o,r),this.status.setEffectStatus(t);break;case"burning":case"frigid":case"inaccurate":this._addEffectAcc(o,r),this.status.setEffectStatus(t);break;case"panic":this._stackDifficultClass(t,!0),this.status.setEffectStatus(t);break;case"laziness":this.draw=Math.max(this.draw-r,0),this.status.showTip("怠惰");break;case"stun":if((null==(u=this._effectDC.dodge)?void 0:u.stack)>0&&(this._effectDC.dodge.stack--,this.status.updateStatusDisplay("dodge",-1),this.status.dodge(f)),f)return void console.log("閃避暈眩攻擊");this._stackDifficultClass(t,!0),this.status.setEffectStatus(t),this.isStuned||this.onStun(),this.isStuned&&(null==(h=this._effectDC.dodge)?void 0:h.stack)>0&&(this._effectDC.dodge.stack=0,this.status.removeStatusDisplay("dodge"),console.log("暈眩中，解除掉閃避效果"),this.status.showTip("暈眩中"));break;case"fear":this._stackDifficultClass(t,!0),this.status.setEffectStatus(t)}},e._addEffectAcc=function(t,s){this._effectAcc[t]||(this._effectAcc[t]=0),this._effectAcc[t]+=s},e._stackDifficultClass=function(t,s){var e=t.effectType,i=t.dc,a=t.value,n=this._effectDC[e];n||(this._effectDC[e]=n={attriube:i.attribute,class:0,stack:0}),0===n.stack?n.class=i.class:n.class=s?Math.max(n.class,i.class):Math.min(n.class,i.class),n.stack+=a,console.log("檢定attribute:",i.attribute,this[i.attribute])},e._checkDifficultClass=function(t,s){void 0===s&&(s=1);var e=this._effectDC[t];if(console.log("檢定effectDc:",e),!e)return!1;console.log("檢定消費:",s),e.stack-=s,s>0&&this.status.updateStatusDisplay(t,-1);var i={class:u(1,20)},a=this[e.attriube];return console.log("檢定dc:",i.class,e.class),i.class+a>=e.class},s(t,[{key:"HP",get:function(){return this._hitPoint}},{key:"HitCheck",get:function(){return console.log("命中值",this._hitRoll,"+",this._hitBonus),this._hitRoll+this._hitBonus}},{key:"Defense",get:function(){return this._defense},set:function(t){this._defense=Math.max(t,0)}}]),t}()));n._RF.pop()}}}));

System.register("chunks:///_virtual/CounterComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o,r,i,u,a,c,s,l,p,f,d;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,r=t.assertThisInitialized,i=t.createClass},function(t){u=t.cclegacy,a=t._decorator,c=t.Label,s=t.Node,l=t.Vec3,p=t.tween,f=t.UIOpacity,d=t.Component}],execute:function(){var C,h,b,v,m;u._RF.push({},"a4592V7k85I6Y4OVwBiWMQr","CounterComponent",void 0);var y=a.ccclass,g=a.property;t("CounterComponent",(C=y("CounterComponent"),h=g(c),C((m=n((v=function(t){function n(){for(var n,e=arguments.length,i=new Array(e),u=0;u<e;u++)i[u]=arguments[u];return n=t.call.apply(t,[this].concat(i))||this,o(n,"counterLabel",m,r(n)),n.minCount=1,n.currentCount=0,n.deprecatedCount=0,n}e(n,t);var u=n.prototype;return u.start=function(){this.count=this.currentCount},u.updateLabel=function(){this.counterLabel.string=this.currentCount.toString()},u.addCount=function(t,n,e){var o=this;void 0===n&&(n=""),void 0===e&&(e=30),this.currentCount=Math.max(this.currentCount+t,this.minCount);var r=new s;r.parent=this.node;var i=r.addComponent(c);t>0?(r.position=new l(0,-80,0),i.string="+"+t+"\n"+n,i.fontSize=e,p(r).to(.5,{position:new l(0,0,0)},{easing:"cubicOut"}).call((function(){o.updateLabel(),o.counterEffect()})).removeSelf().start()):(r.position=new l(0,0,0),i.string=t+"\n"+n,i.fontSize=e,this.counterEffect(),p(r).to(.5,{position:new l(0,-80,0)},{easing:"cubicOut"}).call((function(){o.updateLabel()})).removeSelf().start());var u=r.addComponent(f);p(u).to(.7,{opacity:120},{easing:"cubicOut"}).to(.1,{opacity:0}).start()},u.counterEffect=function(){p(this.counterLabel.node).to(.01,{scale:new l(1.5,1.5,1)}).to(.2,{scale:new l(1,1,1)}).start()},i(n,[{key:"count",set:function(t){this.currentCount=t,this.updateLabel()}}]),n}(d)).prototype,"counterLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=v))||b));u._RF.pop()}}}));

System.register("chunks:///_virtual/CSVLoader.ts",["cc"],(function(r){var t,e,n;return{setters:[function(r){t=r.cclegacy,e=r._decorator,n=r.resources}],execute:function(){var o;t._RF.push({},"c4720GIVLlAOLtbrOZf7kjr","CSVLoader",void 0);var c=e.ccclass;r("CSVLoader",c("CSVLoader")(o=function(){function r(){}return r.loadCSV=function(r,t){var e=this;n.load(r,(function(r,n){if(r)console.error("Failed to load CSV:",r);else{var o=n.text,c=e.parseCSV(o);t(c)}}))},r.parseCSV=function(r){var t=r.split("\n"),e=t[0].split(",");return t.slice(1).map((function(r){var t=r.split(","),n={};return e.forEach((function(r,e){n[r.trim()]=t[e].trim()})),n}))},r}())||o);t._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/DefenseAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,o,n,r,a,s,c,d,l,u,p,f,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,o=e.initializerDefineProperty,n=e.assertThisInitialized,r=e.createClass},function(e){a=e.cclegacy,s=e._decorator,c=e.Node,d=e.Label,l=e.Vec3,u=e.UIOpacity,p=e.tween,f=e.v3,h=e.Component}],execute:function(){var y,b,m,g,N,v,O,_,L,w,D,C,P,z;a._RF.push({},"bf79d8GvnFMRL0TfWPWT1dq","DefenseAnimation",void 0);var A=s.ccclass,k=s.property;e("DefenseAnimation",(y=A("DefenseAnimation"),b=k(c),m=k(d),g=k(d),N=k(c),v=k(c),y((L=t((_=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,o(t,"defenseNode",L,n(t)),o(t,"defenseLabel",w,n(t)),o(t,"armoredLabel",D,n(t)),o(t,"armoredNode",C,n(t)),o(t,"eyeNode",P,n(t)),o(t,"distance",z,n(t)),t._defenseOpacity=null,t._oriPosition=new l,t}i(t,e);var a=t.prototype;return a.onLoad=function(){this.defenseNode.active=!1,this._oriPosition=this.node.position,this._defenseOpacity=this.defenseNode.getComponent(u),this._defenseOpacity||console.error("DefenseAnimation: _defenseOpacity is null")},a.buildDefense=function(e){var t=this.armoredLabel.getComponent(u);t&&(t.opacity=255),this.armor=e;var i=.5,o=this.armoredLabel.node.position.clone();this.armoredNode.forEach((function(e){return e.active=!0})),this.armoredNode[0].position=o.clone().subtract(new l(40,0,0)),this.armoredNode[1].position=o.clone().add(new l(40,0,0)),p(this.armoredNode[0]).to(i,{position:o},{easing:"cubicOut"}).start(),p(this.armoredNode[1]).to(i,{position:o},{easing:"cubicOut"}).start(),this.armoredNode[0].getComponent(u).opacity=0,this.armoredNode[1].getComponent(u).opacity=0,p(this.armoredNode[0].getComponent(u)).to(.25,{opacity:160},{easing:"cubicOut"}).delay(.25).start(),p(this.armoredNode[1].getComponent(u)).to(.125,{opacity:160},{easing:"cubicOut"}).delay(.25).start()},a.increaseDefense=function(e,t){var i=this;this.defenseNode.active=!0,this._defenseOpacity.opacity=0,this.defenseNode.position=this._oriPosition.clone().subtract(new l(0,this.distance,0)),this.defenseLabel.string="+"+e;p(this.defenseNode).to(1,{position:this._oriPosition},{easing:"cubicOut"}).call((function(){return i.armor=t})).start(),p(this._defenseOpacity).to(1/4,{opacity:255}).delay(.5).to(1/4,{opacity:0}).start()},a.decreaseDefense=function(e,t){var i=this;this.defenseNode.active=!0,this._defenseOpacity.opacity=0,this.defenseNode.position=this._oriPosition.clone().add(new l(0,this.distance,0)),this.defenseLabel.string="-"+e;p(this.defenseNode).to(.5,{position:this._oriPosition},{easing:"cubicOut"}).call((function(){return i.armor=t})).start(),p(this._defenseOpacity).to(.125,{opacity:255}).delay(.25).to(.125,{opacity:0}).start()},a.defenseBroken=function(e){var t=this,i=.5,o=this.armoredLabel.node.position.clone(),n=p(this.armoredNode[1]).to(i,{position:o.subtract3f(0,40,0)},{easing:"cubicOut"}).call((function(){t.armoredLabel.string=e+"\n(破碇)",t.armoredLabel.getComponent(u).opacity=180})),r=p(this.armoredNode[1].getComponent(u)).delay(.25).to(.125,{opacity:0},{easing:"cubicOut"});this.eyeNode.active=!0,this.eyeNode.position=o,p(this.eyeNode).to(.25,{scale:f(1.5,1.5,1)},{easing:"cubicOut"}).to(.25,{scale:f(1,1,1)},{easing:"cubicIn"}).call((function(){n.start(),r.start(),t.eyeNode.active=!1})).start()},r(t,[{key:"armor",set:function(e){this.armoredLabel.string=e.toString()}}]),t}(h)).prototype,"defenseNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(_.prototype,"defenseLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(_.prototype,"armoredLabel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(_.prototype,"armoredNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P=t(_.prototype,"eyeNode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(_.prototype,"distance",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),O=_))||O));a._RF.pop()}}}));

System.register("chunks:///_virtual/DiceAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var t,e,o,n,r,a,l,c,s,u,p,h,d,f;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,o=i.initializerDefineProperty,n=i.assertThisInitialized},function(i){r=i.cclegacy,a=i._decorator,l=i.Vec3,c=i.CCInteger,s=i.CCFloat,u=i.Node,p=i.Label,h=i.UIOpacity,d=i.tween,f=i.Component}],execute:function(){var g,y,b,_,m,V,v,D,w,L,z,O,C,M,P,I,Z,A,N;r._RF.push({},"df852/bswtF3blmL0rIX8iv","DiceAnimation",void 0);var x=a.ccclass,E=a.property;i("default",(g=x("DiceAnimation"),y=E({type:l,tooltip:"起點位置"}),b=E({type:c,tooltip:"移動方向的X軸力度"}),_=E({type:c,tooltip:"移動X軸的左極限"}),m=E({type:c,tooltip:"移動X軸的右極限"}),V=E({type:s,tooltip:"衰減值"}),v=E({type:s,tooltip:"力度極限值"}),D=E({type:u,tooltip:"骰子"}),w=E({type:p,tooltip:"骰子的值"}),g((O=t((z=function(i){function t(){for(var t,e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return t=i.call.apply(i,[this].concat(r))||this,o(t,"startPosition",O,n(t)),o(t,"force",C,n(t)),t._force=0,o(t,"leftLimit",M,n(t)),o(t,"rightLimit",P,n(t)),o(t,"decay",I,n(t)),o(t,"forceThreshold",Z,n(t)),o(t,"diceNode",A,n(t)),o(t,"diceValue",N,n(t)),t._isMoving=!1,t._diceValues=[],t._dropDiceValues=[],t._diceEndCallback=null,t._originalZOrder=l.ZERO,t}e(t,i);var r=t.prototype;return r.onLoad=function(){this._originalZOrder=this.node.position.clone(),this.startPosition=this.node.position.clone().add(this._originalZOrder)},r.update=function(i){var t;this._isMoving&&(this.node.position=this.node.position.add3f(this._force*i,0,0),(this.node.position.x<=this.leftLimit||this.node.position.x>=this.rightLimit)&&(this._force=-this._force,this.changeDiceValue()),this._force*=1-this.decay,Math.abs(this._force)<this.forceThreshold&&(this._isMoving=!1,null==(t=this._diceEndCallback)||t.call(this,parseInt(this.diceValue.string))))},r.starAnimation=function(i,t){var e=this;this._force=this.force,this.node.position=new l(this.startPosition.x,this._originalZOrder.y,0),this._isMoving=!0,this._diceValues=t,this.changeDiceValue();var o=this.diceNode.getComponent(h);return o.opacity=255,new Promise((function(t){d(e.diceNode).to(i/4,{position:new l(0,e.startPosition.y,0)},{easing:"cubicOut"}).parallel(d().to(i,{position:l.ZERO},{easing:"bounceOut"}),d().delay(i/3).call((function(){e.changeDiceValue()})).delay(i/3).call((function(){e.changeDiceValue()})).delay(i/4).call((function(){e.changeDiceValue()}))).call((function(){e._isMoving=!1,t(parseInt(e.diceValue.string))})).delay(1).call((function(){o&&d(o).to(.25,{opacity:0},{easing:"cubicOut"}).start()})).start()}))},r.changeDiceValue=function(){0===this._diceValues.length&&(this._diceValues=this._dropDiceValues.sort((function(){return Math.random()-.5})).slice(),this._dropDiceValues.length=0);var i=this._diceValues.shift();this.diceValue.string=i.toString(),this._dropDiceValues.push(i)},t}(f)).prototype,"startPosition",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(0,0,0)}}),C=t(z.prototype,"force",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),M=t(z.prototype,"leftLimit",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-100}}),P=t(z.prototype,"rightLimit",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),I=t(z.prototype,"decay",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),Z=t(z.prototype,"forceThreshold",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),A=t(z.prototype,"diceNode",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(z.prototype,"diceValue",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=z))||L));r._RF.pop()}}}));

System.register("chunks:///_virtual/DodgeAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,o,e,n,r,a,s,c,u,l,p;return{setters:[function(t){i=t.applyDecoratedDescriptor,o=t.inheritsLoose,e=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,s=t.Node,c=t.Vec3,u=t.tween,l=t.Tween,p=t.Component}],execute:function(){var g,d,m,h,f,v,b;r._RF.push({},"bbbad5Z7GlHLY/sdj0z7DaP","DodgeAnimation",void 0);var D=a.ccclass,y=a.property;t("DodgeAnimation",(g=D("DodgeAnimation"),d=y(s),g((f=i((h=function(t){function i(){for(var i,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return i=t.call.apply(t,[this].concat(r))||this,e(i,"targetNode",f,n(i)),e(i,"moveDistance",v,n(i)),e(i,"moveDuration",b,n(i)),i._originalPosition=void 0,i}o(i,t);var r=i.prototype;return r.start=function(){},r.startAnimation=function(){var t=this._originalPosition=this.node.position.clone(),i=Math.random()>.5?1:-1,o=new c(t.x+i*this.moveDistance,t.y,t.z);u(this.targetNode).to(this.moveDuration/2,{position:o},{easing:"cubicInOut"}).to(this.moveDuration,{position:t},{easing:"bounceOut"}).start()},r.stopAnimation=function(){l.stopAllByTarget(this.targetNode),this._originalPosition&&this.targetNode.setPosition(this._originalPosition)},i}(p)).prototype,"targetNode",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=i(h.prototype,"moveDistance",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),b=i(h.prototype,"moveDuration",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),m=h))||m));r._RF.pop()}}}));

System.register("chunks:///_virtual/DynamicWidthScrollView.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,n,e,o,r,l,c,s,a,h,d,u,p,f,g;return{setters:[function(t){i=t.inheritsLoose,n=t.applyDecoratedDescriptor,e=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose,l=t.createClass},function(t){c=t.cclegacy,s=t._decorator,a=t.ScrollView,h=t.Event,d=t.Vec3,u=t.UITransform,p=t.Layout,f=t.v3,g=t.Component}],execute:function(){var m,w,v,y,S,V,b,E,W,L;c._RF.push({},"97f47FpcPJIjKbS1g4ndve0","DynamicWidthScrollView",void 0);var C=s.ccclass,_=s.property,T=t("DynamicWidthScrollEvent",function(t){function n(i,n,e){var o;return(o=t.call(this,i,n)||this).detail=null,o.detail=e,o}return i(n,t),n}(h));T.DYNAMIC_WIDTH_SCROLL_EVENT="dynamic-width-scroll-event";t("DynamicWidthScrollView",(m=C("DynamicWidthScrollView"),w=_(a),m((S=n((y=function(t){function n(){for(var i,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return i=t.call.apply(t,[this].concat(r))||this,e(i,"scrollView",S,o(i)),e(i,"maxWidth",V,o(i)),e(i,"minWidth",b,o(i)),e(i,"spacingX",E,o(i)),e(i,"paddingLeft",W,o(i)),e(i,"paddingRight",L,o(i)),i._centerPosition=d.ZERO,i._scrollContentTrans=null,i}i(n,t);var c=n.prototype;return c.onLoad=function(){if(this.scrollView){this._centerPosition=this.scrollView.getComponent(u).convertToWorldSpaceAR(d.ZERO),this._scrollContentTrans=this.scrollView.content.getComponent(u);var t=this.scrollView.content.getComponent(p);t.spacingX=this.spacingX,t.paddingLeft=this.paddingLeft,t.paddingRight=this.paddingRight,this.scrollView.cancelInnerEvents=!1,this.scrollView.enabled=!1}else console.error("ScrollView component is not assigned.")},c.onEnable=function(){this.scrollView.node.on(a.EventType.SCROLLING,this.onScrolling,this),this.scrollView.node.on(a.EventType.SCROLL_ENDED,this.onScrollEnded,this)},c.onDisable=function(){this.scrollView.node.off(a.EventType.SCROLLING,this.onScrolling,this),this.scrollView.node.off(a.EventType.SCROLL_ENDED,this.onScrollEnded,this)},c.onScrolling=function(){for(var t,i=this._scrollContentTrans.node.children,n=r(i);!(t=n()).done;){var e=t.value,o=this._scrollContentTrans.convertToWorldSpaceAR(e.position),l=d.distance(o,this._centerPosition),c=this.calculateWidth(l);e.getComponent(u).width=c;var s=1+c/this.maxWidth;e.scale=f(s,s,1)}},c.onScrollEnded=function(){var t=this,i=[];this.scrollView.content.children.forEach((function(n){i.push(t._scrollContentTrans.convertToWorldSpaceAR(n.position))})),this.node.dispatchEvent(new T(T.DYNAMIC_WIDTH_SCROLL_EVENT,!0,{positions:i}))},c.calculateWidth=function(t){var i=this.scrollView.node.getComponent(u).width/2,n=this.minWidth+(this.maxWidth-this.minWidth)*(1-t/i);return n=Math.max(this.minWidth,Math.min(this.maxWidth,n))},l(n,[{key:"content",get:function(){return this.scrollView.content}}]),n}(g)).prototype,"scrollView",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=n(y.prototype,"maxWidth",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),b=n(y.prototype,"minWidth",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),E=n(y.prototype,"spacingX",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),W=n(y.prototype,"paddingLeft",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),L=n(y.prototype,"paddingRight",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=y))||v));c._RF.pop()}}}));

System.register("chunks:///_virtual/EmpowerCardData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r;return{setters:[function(e){t=e.createClass},function(e){r=e.cclegacy}],execute:function(){r._RF.push({},"ccd0ezjodZFI5/H0FYjbduc","EmpowerCardData",void 0);e("EmpowerCardData",function(){function e(e,t,r){this._empowerId=void 0,this._empowerName=void 0,this._combatCards=[],this._empowerId=e,this._empowerName=t,this._combatCards=r}return e.fromCSV=function(t){return new e(t.id,t.name,t.cards)},t(e,[{key:"empowerId",get:function(){return this._empowerId}},{key:"empowerName",get:function(){return this._empowerName}},{key:"combatCards",get:function(){return this._combatCards}}]),e}());r._RF.pop()}}}));

System.register("chunks:///_virtual/EmpowerCardsListItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,t,a,i,n,o,l,c,u,s;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){n=e.cclegacy,o=e._decorator,l=e.Node,c=e.Label,u=e.instantiate,s=e.Component}],execute:function(){var p,f,m,d,b,h,y,v,w;n._RF.push({},"15e66JpM99KFaMCBD5ZXhE3","EmpowerCardsListItem",void 0);var g=o.ccclass,C=o.property;e("EmpowerCardsListItem",(p=g("EmpowerCardsListItem"),f=C(l),m=C(c),d=C(l),p((y=r((h=function(e){function r(){for(var r,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return r=e.call.apply(e,[this].concat(n))||this,a(r,"layout",y,i(r)),a(r,"label",v,i(r)),a(r,"cardPrefab",w,i(r)),r.empowerId="",r}t(r,e);var n=r.prototype;return n.onLoad=function(){this.cardPrefab.active=!1},n.list=function(e){var r=this;this.layout.removeAllChildren(),this.empowerId=e.empowerId,this.label.string=e.empowerName,e.combatCards.forEach((function(e){for(var t=e.num,a=0;a<t;a++){var i=u(r.cardPrefab);i.active=!0,i.parent=r.layout,i.getComponentInChildren(c).string=e.name}}))},r}(s)).prototype,"layout",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=r(h.prototype,"label",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=r(h.prototype,"cardPrefab",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=h))||b));n._RF.pop()}}}));

System.register("chunks:///_virtual/EmpowerData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i;return{setters:[function(t){e=t.createClass},function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"29c0cmZm51PGI1hR+HUjJiK","EmpowerData",void 0);t("EmpowerData",function(){function t(t,e,i){this._id=void 0,this._name=void 0,this._triggers=[],this._id=t,this._name=e,this._triggers=i}return t.fromCSV=function(e){return new t(e.id,e.name,e.triggers)},e(t,[{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"triggers",get:function(){return this._triggers}}]),t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/EmpowerManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts"],(function(e){var r,a,t,n;return{setters:[function(e){r=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy,t=e._decorator},function(e){n=e.GameManager}],execute:function(){var o,s;a._RF.push({},"a7abbEaJMtIgb6pw2B6UKeL","EmpowerManager",void 0);var u=t.ccclass;e("EmpowerManager",u("EmpowerManager")(((s=function(){function e(){}return e.loadEmpowerData=function(){this.empowers=n.instance.database.empowerDatabase},e.triggerEmpower=function(e){for(var a,t=r(this.empowers);!(a=t()).done;){var n=a.value;n.triggers.every((function(r){return e.some((function(e){if(r.type===e.type){var a=r.key===e.key;switch(r.type){case"equip":return a&&r.value.indexOf(e.value)>=0;case"ability_score":return a&&Number(r.value)<=Number(e.value);case"skill":return a&&r.value===e.value;default:return!1}}}))}))&&(this.empowerIds.has(n.id)||this.empowerIds.add(n.id))}},e.getEmpoweredIds=function(){return Array.from(this.empowerIds)},e.getEmpoweredCardDataList=function(){var e=this;return n.instance.database.empowerCardDatabase.filter((function(r){return Array.from(e.empowerIds).includes(r.empowerId)}))},e}()).empowers=[],s.empowerIds=new Set,o=s))||o);a._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e;return{setters:[function(t){i=t.createClass},function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"28b50fCDddFEoSFzDbmRP9j","EnemyData",void 0);t("EnemyData",function(){function t(t,i,e,n,s,r,o,c){this._id=void 0,this._name=void 0,this._hp=void 0,this._ac=void 0,this._wisdom=void 0,this._resilience=void 0,this._dexterity=void 0,this._img=void 0,this._id=t,this._name=i,this._hp=e,this._ac=n,this._wisdom=s,this._resilience=r,this._dexterity=o,this._img=c}return t.fromCSV=function(i){var e=parseInt(i.hp,10),n=parseInt(i.ac,10),s=parseInt(i.wisdom,10),r=parseInt(i.resilience,10),o=parseInt(i.dexterity,10);return new t(i.id,i.name,e,n,s,r,o,i.img)},i(t,[{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"hp",get:function(){return this._hp}},{key:"ac",get:function(){return this._ac}},{key:"wisdom",get:function(){return this._wisdom}},{key:"resilience",get:function(){return this._resilience}},{key:"dexterity",get:function(){return this._dexterity}},{key:"img",get:function(){return this._img}}]),t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyTeamData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t;return{setters:[function(e){n=e.createClass},function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"2779ecWOjNL5IJSqyNH68qJ","EnemyTeamData",void 0);e("EnemyTeamData",function(){function e(e,n,t){this._id=void 0,this._challengeRank=void 0,this._enemies=void 0,this._id=e,this._challengeRank=n,this._enemies=t}return e.fromCSV=function(n){var t=parseInt(n.challengeRank);return new e(n.id,t,n.enemies)},n(e,[{key:"id",get:function(){return this._id}},{key:"cr",get:function(){return this._challengeRank}},{key:"enemies",get:function(){return this._enemies}}]),e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/FloatingTextComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,a,l,s,c,u,p,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,l=t.Color,s=t.Vec3,c=t.Label,u=t.instantiate,p=t.tween,b=t.Component}],execute:function(){var f,g,h,m,v,d,y,C,P,w,L,z,x;r._RF.push({},"6e930lNmNxI/bj5j7OKSnzK","FloatingTextComponent",void 0);var F=a.ccclass,T=a.property;t("FloatingTextComponent",(f=F("FloatingTextComponent"),g=T(l),h=T(l),m=T(s),v=T(s),d=T(c),f((P=e((C=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"positiveColor",P,o(e)),i(e,"negativeColor",w,o(e)),i(e,"startPoint",L,o(e)),i(e,"endPoint",z,o(e)),i(e,"templateLabel",x,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){this.templateLabel.node.active=!1},r.showNumber=function(t,e){var n=u(this.templateLabel.node);n.setParent(this.node),n.active=!0;var i=n.getComponent(c);i.string=(t>0?"+":"")+t.toString(),i.color=t>0?this.positiveColor:this.negativeColor,n.setPosition(this.startPoint),p(n).to(1.5,{position:this.endPoint},{easing:"elasticOut"}).call((function(){n.destroy(),null==e||e()})).start()},r.showText=function(t,e){var n=u(this.templateLabel.node);n.setParent(this.node),n.active=!0,n.getComponent(c).string=t,n.setPosition(this.startPoint),p(n).to(1.5,{position:this.endPoint},{easing:"elasticOut"}).call((function(){n.destroy(),null==e||e()})).start()},e}(b)).prototype,"positiveColor",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(0,255,0)}}),w=e(C.prototype,"negativeColor",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(255,0,0)}}),L=e(C.prototype,"startPoint",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s(0,0,0)}}),z=e(C.prototype,"endPoint",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s(0,100,0)}}),x=e(C.prototype,"templateLabel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=C))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/GameDatabase.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CSVLoader.ts","./EmpowerCardData.ts","./CombatCardData.ts","./CombatEffectData.ts","./EnemyData.ts","./EnemyTeamData.ts","./AiIntentData.ts"],(function(a){var t,e,n,o,i,r,s,c,f;return{setters:[function(a){t=a.createClass},function(a){e=a.cclegacy},function(a){n=a.CSVLoader},function(a){o=a.EmpowerCardData},function(a){i=a.CombatCardData},function(a){r=a.CombatEffectData},function(a){s=a.EnemyData},function(a){c=a.EnemyTeamData},function(a){f=a.AiIntentData}],execute:function(){e._RF.push({},"814245g0y1A567rYQuvik/O","GameDatabase",void 0);a("GameDatabase",function(){function a(){this._weaponDatabase=void 0,this._armorDatabase=void 0,this._empowerDatabase=[],this._empowerCardDatabase=[],this._combatCardDatabase=[],this._combatEffectDatabase=[],this._enemyTeamDatabase=[],this._enemyDatabase=[],this._aiIntentDatabase=[],this.loadEmpowerCardData(),this.loadCombatCardData(),this.loadCombatEffectData(),this.loadEnemyTeamData(),this.loadEnemyData(),this.loadeAiIntentData()}var e=a.prototype;return e.loadWeaponData=function(){var a=this;n.loadCSV("data/weapons",(function(t){a._weaponDatabase=t}))},e.loadArmorData=function(){var a=this;n.loadCSV("data/armors",(function(t){a._armorDatabase=t}))},e.loadEmpowerData=function(){var a=this;n.loadCSV("data/empower",(function(t){var e,n={};t.forEach((function(a){var t=a.id;n[t]||(n[t]={id:a.id,name:a.name,trigger:[]}),n[t].trigger.push({type:a.trigger_type,key:a.trigger_key,value:a.trigger_value,description:a.description})})),(e=a._empowerDatabase).push.apply(e,Object.values(n))}))},e.loadEmpowerCardData=function(){var a=this;n.loadCSV("data/empower_card",(function(t){var e,n={};t.forEach((function(a){var t=a.id;n[t]||(n[t]={id:a.id,name:a.name,cards:[]}),n[t].cards.push({id:a.card_id,name:a.card_name,num:parseInt(a.card_num,10)})})),(e=a._empowerCardDatabase).push.apply(e,Object.values(n).map((function(a){return o.fromCSV(a)})))}))},e.loadCombatCardData=function(){var a=this;n.loadCSV("data/combat_card",(function(t){var e,n={};t.forEach((function(a){var t=a.id;n[t]||(n[t]={id:a.id,name:a.name,range:a.range,feeType:a.fee_type,fee:a.fee,effects:[],description:[],evolutions:[]}),a.evolution_conditions?n[t].evolutions.push({conditions:a.evolution_conditions,name:a.name,range:a.range,feeType:a.fee_type,fee:a.fee,effectId:a.effect_id,effectName:a.effect_name}):(n[t].effects.push({id:a.effect_id,name:a.effect_name}),n[t].description.push(a.description))})),(e=a._combatCardDatabase).push.apply(e,Object.values(n).map((function(a){return i.fromCSV(a)})))}))},e.loadCombatEffectData=function(){var a=this;n.loadCSV("data/combat_effect",(function(t){a._combatEffectDatabase=t.map((function(a){return r.fromCSV(a)}))}))},e.loadEnemyTeamData=function(){var a=this;n.loadCSV("data/enemy_team",(function(t){var e,n={};t.forEach((function(a){var t=a.id;n[t]||(n[t]={id:a.id,challengeRank:a.challenge_rank,enemies:[]}),n[t].enemies.push(a.enemy_id)})),(e=a._enemyTeamDatabase).push.apply(e,Object.values(n).map((function(a){return c.fromCSV(a)})))}))},e.loadEnemyData=function(){var a=this;n.loadCSV("data/enemy",(function(t){a._enemyDatabase=t.map((function(a){return s.fromCSV(a)}))}))},e.loadeAiIntentData=function(){var a=this;n.loadCSV("data/ai_intent",(function(t){var e,n={};t.forEach((function(a){var t=a.id;n[t]||(n[t]={id:a.id,intents:[]}),n[t].intents.push(a.intent)})),(e=a._aiIntentDatabase).push.apply(e,Object.values(n).map((function(a){return f.fromCSV(a)})))}))},t(a,[{key:"weaponDatabase",get:function(){return this._weaponDatabase}},{key:"armorDatabase",get:function(){return this._armorDatabase}},{key:"empowerDatabase",get:function(){return this._empowerDatabase}},{key:"empowerCardDatabase",get:function(){return this._empowerCardDatabase}},{key:"combatCardDatabase",get:function(){return this._combatCardDatabase}},{key:"combatEffectDatabase",get:function(){return this._combatEffectDatabase}},{key:"enemyTeamDatabase",get:function(){return this._enemyTeamDatabase}},{key:"enemyDatabase",get:function(){return this._enemyDatabase}},{key:"aiIntentDatabase",get:function(){return this._aiIntentDatabase}}]),a}());e._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameDatabase.ts"],(function(e){var n,a,t,r,s,c;return{setters:[function(e){n=e.inheritsLoose,a=e.createClass},function(e){t=e.cclegacy,r=e._decorator,s=e.Component},function(e){c=e.GameDatabase}],execute:function(){var o,i;t._RF.push({},"6dcbd1szwBNRLtMHywedW9x","GameManager",void 0);var u=r.ccclass;r.property,e("GameManager",u("GameManager")(((i=function(e){function t(){for(var n,a=arguments.length,t=new Array(a),r=0;r<a;r++)t[r]=arguments[r];return(n=e.call.apply(e,[this].concat(t))||this).database=void 0,n}return n(t,e),t.prototype.onLoad=function(){t._instance||(t._instance=this),this.database=new c},a(t,null,[{key:"instance",get:function(){return this._instance}}]),t}(s))._instance=null,o=i))||o);t._RF.pop()}}}));

System.register("chunks:///_virtual/GameSetup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EmpowerManager.ts","./GameManager.ts","./EmpowerCardsListItem.ts","./CheckBoxComponent.ts","./PopupWindowComponent.ts","./AudioManager.ts"],(function(e){var t,n,i,o,a,r,s,u,c,p,l,d,m,f,w,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,s=e.Node,u=e.Layout,c=e.instantiate,p=e.Component},function(e){l=e.EmpowerManager},function(e){d=e.GameManager},function(e){m=e.EmpowerCardsListItem},function(e){f=e.CheckBoxComponent},function(e){w=e.PopupWindowComponent},function(e){C=e.AudioManager}],execute:function(){var b,h,L,g,v,E,y,k,_,M,I;a._RF.push({},"bb2ffInL51HnKcJWJ6pe0DS","GameSetup",void 0);var S=r.ccclass,V=r.property;e("GameSetup",(b=S("GameSetup"),h=V(s),L=V(u),g=V(m),v=V(w),b((k=t((y=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,i(t,"empowerCardsListView",k,o(t)),i(t,"empowerCardsListLayout",_,o(t)),i(t,"empowerCardsListItem",M,o(t)),i(t,"popupWindow",I,o(t)),t.empowerCombatCards={},t._musicEnabled=!0,t._soundEnabled=!0,t}n(t,e);var a=t.prototype;return a.start=function(){var e=this;l.loadEmpowerData(),this.scheduleOnce((function(){e.list(),e.empowerCardsListView.active=!0,e.popupWindow.openPopup("提示","請勾選戰鬥使用的賦能牌組，最多可選五組。",[{label:"知道了",callback:function(){return console.log("知道了")}}])}),.1)},a.list=function(){var e=this;this.empowerCardsListItem.node.active=!1,d.instance.database.empowerCardDatabase.forEach((function(t){var n=c(e.empowerCardsListItem.node);n.active=!0,n.parent=e.empowerCardsListLayout.node,n.getComponent(m).list(t)}))},a.onClicked=function(){this.list()},a.onUpdateEmpoweredCardsClicked=function(){},a.onDeckIconClick=function(){if(this.empowerCardsListView.active){var e=0;if(this.empowerCardsListLayout.node.children.forEach((function(t){var n;null!=(n=t.getComponent(m).getComponentInChildren(f))&&n.isChecked&&e++})),e>5)return void this.popupWindow.openPopup("提醒您","選用賦能過多，請不要超過5項賦能",[{label:"確定",callback:null}]);if(0===e)return void this.popupWindow.openPopup("提醒您","請至少選一項賦能",[{label:"確定",callback:null}]);C.instance.setMusicVolume(1)}else C.instance.setMusicVolume(.2);this.empowerCardsListView.active=!this.empowerCardsListView.active},a.onMusicToggleClick=function(){this._musicEnabled=!this._musicEnabled,C.instance.setMusicEnabled(this._musicEnabled)},a.onSoundToggleClick=function(){this._soundEnabled=!this._soundEnabled,C.instance.setSoundEffectsEnabled(this._soundEnabled)},t}(p)).prototype,"empowerCardsListView",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(y.prototype,"empowerCardsListLayout",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(y.prototype,"empowerCardsListItem",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(y.prototype,"popupWindow",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=y))||E));a._RF.pop()}}}));

System.register("chunks:///_virtual/GraphicsLineDrawer.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var i,r,n,t,a,o,l,c,s,h,p;return{setters:[function(e){i=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,t=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,l=e.Node,c=e.Graphics,s=e.Vec3,h=e.randomRangeInt,p=e.Component}],execute:function(){var u,f,g,d,w,y,_,v;a._RF.push({},"e0e0fhzL69JuKnuWTCWLWHY","GraphicsLineDrawer",void 0);var L=o.ccclass,b=o.property;e("GraphicsLineDrawer",(u=L("GraphicsLineDrawer"),f=b(l),u((w=i((d=function(e){function i(){for(var i,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=e.call.apply(e,[this].concat(a))||this,n(i,"arror",w,t(i)),n(i,"lineLength",y,t(i)),n(i,"lineSpacing",_,t(i)),n(i,"lineWidth",v,t(i)),i._fromNode=null,i._graphics=null,i}r(i,e);var a=i.prototype;return a.onLoad=function(){this._graphics=this.getComponent(c)},a.drawDashedLine=function(e){this._fromNode=e,this._graphics.clear();var i=this.arror.worldPosition,r=this._fromNode.worldPosition,n=s.distance(i,r),t=0;this._graphics.lineWidth=this.lineWidth,this._graphics.moveTo(i.x,i.y);for(var a=new s(h(-3,3),h(-3,3),0);t<n;){var o=t+this.lineLength;o>n&&(o=n);var l=t/n,c=o/n,p=s.lerp(new s,i,r,l);s.lerp(new s,i,r,c);if(this._graphics.lineTo(p.x+a.x,p.y+a.y),this._graphics.stroke(),(t=o+this.lineSpacing)<n){var u=s.lerp(new s,i,r,t/n);this._graphics.moveTo(u.x,u.y)}}},a.clearDashedLine=function(){this._graphics.clear()},i}(p)).prototype,"arror",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=i(d.prototype,"lineLength",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),_=i(d.prototype,"lineSpacing",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),v=i(d.prototype,"lineWidth",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),g=d))||g));a._RF.pop()}}}));

System.register("chunks:///_virtual/HandCards.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DynamicWidthScrollView.ts","./CardMover.ts","./CombatCardManager.ts","./HitBox.ts","./GraphicsLineDrawer.ts"],(function(t){var e,n,i,o,r,a,c,s,l,h,u,d,p,f,w,v,C,T,_,g,y,b,m,E,S;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass,a=t.asyncToGenerator,c=t.regeneratorRuntime},function(t){s=t.cclegacy,l=t._decorator,h=t.Node,u=t.Color,d=t.EventHandler,p=t.Vec3,f=t.UIOpacity,w=t.UITransform,v=t.Button,C=t.instantiate,T=t.Label,_=t.Sprite,g=t.Component},function(t){y=t.DynamicWidthScrollView},function(t){b=t.CardMover},function(t){m=t.CombatCardManager},function(t){E=t.HitBox},function(t){S=t.GraphicsLineDrawer}],execute:function(){var V,P,D,x,H,L,O,U,B,M,k,z,R,I,A,N,W,G,F;s._RF.push({},"880f34hHldLa4t21nW2dLUl","HandCards",void 0);var j=l.ccclass,Y=l.property;t("HandCards",(V=j("HandCards"),P=Y(h),D=Y(y),x=Y(u),H=Y(h),L=Y(E),O=Y(d),U=Y(d),B=Y(S),V((z=e((k=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"cardPrefab",z,o(e)),i(e,"dwScrollView",R,o(e)),i(e,"selectedColor",I,o(e)),i(e,"arrowTip",A,o(e)),i(e,"hitBox",N,o(e)),i(e,"touchedCardEvent",W,o(e)),i(e,"playCardCheckEvent",G,o(e)),i(e,"graphicsLineDrawer",F,o(e)),e._buttonTemps=[],e._oriColor=void 0,e._oriPositionY=void 0,e._selected=null,e._touchStartPos=null,e._oriCardPos=null,e._touchParent=null,e._selectCancel=!1,e._opacity=255,e._needTarget=!0,e}n(e,t);var s=e.prototype;return s.onEnable=function(){this.catchTag()},s.onDisable=function(){},s.onTouchStart=function(t){var e=t.target,n=t.getUILocation(),i=n.x,o=n.y;this._touchStartPos=new p(i,o+50,0),this._oriCardPos=e.position.clone(),this.arrowTip.setWorldPosition(this._touchStartPos),this._selectCancel=!1,this.touchedCardEvent.forEach((function(t){return t.emit([e])}))},s.onTouchMove=function(t){if(!this._selectCancel){var e=t.target,n=t.getUIDelta();if(!this._needTarget)return e.worldPosition.y-this._touchStartPos.y>100&&(this.dwScrollView.scrollView.enabled=!1),void e.setPosition(e.position.x,e.position.y+n.y);e.getComponent(f).opacity=120;var i=this.arrowTip;i.setPosition(i.position.x+n.x,i.position.y+n.y);var o=i.parent.getComponent(w).convertToWorldSpaceAR(i.position);i.active?this.graphicsLineDrawer.drawDashedLine(e):this.graphicsLineDrawer.clearDashedLine(),Math.abs(o.x-this._touchStartPos.x)>50?this._selectCancel=!i.active:o.y-this._touchStartPos.y>50&&(i.active=!0,this.dwScrollView.scrollView.enabled=!1,e.getComponent(f).opacity=180)}},s.onTouchEnd=function(t){var e=t.target;this.dwScrollView.scrollView.enabled=!0,this.arrowTip.active=!1,e.getComponent(f).opacity=255,!this._needTarget&&e.worldPosition.y-this._touchStartPos.y>120?(this._selected=e,this.playCardCheckEvent.forEach((function(t){return t.emit([e])}))):e.position=this._oriCardPos,this.graphicsLineDrawer.clearDashedLine()},s.onTouchCancel=function(t){var e=t.target;if(this.dwScrollView.scrollView.enabled=!0,this.arrowTip.active=!1,e.getComponent(f).opacity=255,!this._needTarget&&e.worldPosition.y-this._touchStartPos.y>120)this._selected=e,this.playCardCheckEvent.forEach((function(t){return t.emit([e])}));else if(this._needTarget&&this.hitBox.tryHit()){var n=this.hitBox.target;this._selected=e,this.playCardCheckEvent.forEach((function(t){return t.emit([e,n])}))}else e.position=this._oriCardPos;this.graphicsLineDrawer.clearDashedLine()},s.show=function(t){void 0===t&&(t=!0),this.node.active=t},s.lock=function(t){void 0===t&&(t=!0),this._buttonTemps.forEach((function(e){return e.interactable=!t}))},s.disableCards=function(){var t=this;this._buttonTemps.forEach((function(e){return t._removeEventTouch(e.node)}))},s.catchTag=function(){this.arrowTip.active=!1,this.hitBox.catchTag()},s.removeTag=function(t){this.hitBox.removeTag(t)},s.cancelSelect=function(){this._selected.position=this._oriCardPos},s.playCard=function(){if(this._selected){this._removeEventTouch(this._selected),this._buttonTemps.splice(this._buttonTemps.indexOf(this._selected.getComponent(v)),1);var t=this._selected.parent.getSiblingIndex();m.instance.playCard(t),this._selected.parent.setSiblingIndex(999),this._selected.parent.active=!1,this.dwScrollView.scrollView.enabled=!0;var e=this.dwScrollView.content.getComponent(w).convertToWorldSpaceAR(this._selected.position);this.dwScrollView.scrollView.scrollToPercentVertical(e.x/this.dwScrollView.scrollView.content.getComponent(w).width,.5)}else console.warn("HandCards: no selected card")},s.setCount=function(t){var e=this.dwScrollView.content,n=e.children;n.forEach((function(t){return t.active=!1}));for(var i=0;i<t;i++){var o=n[i];o||((o=C(this.cardPrefab)).parent=e),o.active=!0,o.getComponentInChildren(T).string=i.toString()}this.dwScrollView.scrollView.scrollToRight(1)},s.attach=function(t){var e=this,n=this.dwScrollView.content.children;t.forEach((function(t,e){b.moveCard(t,n[e],p.ZERO),t.active=!0})),this._buttonTemps.forEach((function(t){return e._removeEventTouch(t.node)})),this._buttonTemps.length=0,t.forEach((function(t){var n=t.getComponent(v);n?(e._setEventTouch(n.node),e._buttonTemps.push(n)):console.error(n.name,"HandCards: cardButton not found")})),this.dwScrollView.scrollView.enabled=!0},s.setNeedTarget=function(t){this._needTarget=t},s.clear=function(){var t;this.dwScrollView.content.children.forEach((function(t){return t.active=!1})),this.cards.forEach((function(t){return t.destroy()})),this._buttonTemps.length=0,null==(t=this._selected)||t.destroy(),this._selected=null,this.arrowTip.active=!1,this._needTarget=!1},s._setEventTouch=function(t){t.on(h.EventType.TOUCH_START,this.onTouchStart,this),t.on(h.EventType.TOUCH_MOVE,this.onTouchMove,this),t.on(h.EventType.TOUCH_END,this.onTouchEnd,this),t.on(h.EventType.TOUCH_CANCEL,this.onTouchCancel,this),t.getComponent(_).color=new u(0,255,0,this._opacity)},s._removeEventTouch=function(t){t.off(h.EventType.TOUCH_START,this.onTouchStart,this),t.off(h.EventType.TOUCH_MOVE,this.onTouchMove,this),t.off(h.EventType.TOUCH_END,this.onTouchEnd,this),t.off(h.EventType.TOUCH_CANCEL,this.onTouchCancel,this),t.getComponent(_).color=new u(0,255,255,this._opacity)},s.onDrawCardClick=function(){this.drawCard(3)},s.drawCard=function(){var t=a(c().mark((function t(e){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.instance.drawCards(e);case 2:n=t.sent,this.setCount(n.length),this.attach(n);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r(e,[{key:"cards",get:function(){return this._buttonTemps.map((function(t){return t.node}))}}]),e}(g)).prototype,"cardPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(k.prototype,"dwScrollView",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(k.prototype,"selectedColor",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u(255,255,255,255)}}),A=e(k.prototype,"arrowTip",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(k.prototype,"hitBox",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(k.prototype,"touchedCardEvent",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),G=e(k.prototype,"playCardCheckEvent",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=e(k.prototype,"graphicsLineDrawer",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=k))||M));s._RF.pop()}}}));

System.register("chunks:///_virtual/HideAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,o,r,a,c,s,u,l,p,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,c=t.Node,s=t.tween,u=t.v3,l=t.UIOpacity,p=t.Tween,d=t.Component}],execute:function(){var g,h,f,y,m,b;r._RF.push({},"d7439ZMnRZLfp1t6juGuJcD","HideAnimation",void 0);var v=a.ccclass,N=a.property;t("HideAnimation",(g=v("HideAnimation"),h=N(c),g((m=e((y=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"targetNode",m,o(e)),n(e,"duration",b,o(e)),e}i(e,t);var r=e.prototype;return r.startAnimation=function(){this.targetNode.position=this.node.position.clone(),this.targetNode.active=!0,s(this.targetNode).to(this.duration/2,{scale:u(1.5,1.5,1)},{easing:"cubicInOut"}).to(this.duration/2,{scale:u(1,1,1)},{easing:"cubicInOut"}).start(),this.targetNode.getComponent(l).opacity=0,s(this.targetNode.getComponent(l)).to(this.duration/2,{opacity:255},{easing:"cubicInOut"}).start()},r.stopAnimation=function(){p.stopAllByTarget(this.targetNode),this.targetNode.active=!1},e}(d)).prototype,"targetNode",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(y.prototype,"duration",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),f=y))||f));r._RF.pop()}}}));

System.register("chunks:///_virtual/HitBox.ts",["./rollupPluginModLoBabelHelpers.js","cc","./HitTag.ts"],(function(t){var e,n,r,i,o,a,s,c,u,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized,o=t.createClass},function(t){a=t.cclegacy,s=t._decorator,c=t.Node,u=t.Component},function(t){l=t.HitTag}],execute:function(){var p,g,h,f,_;a._RF.push({},"96ff9jpamdA2bWRunCbqZnm","HitBox",void 0);var v=s.ccclass,y=s.property;t("HitBox",(p=v("HitBox"),g=y({type:c,tooltip:'包含有"HitTag"子節點组件的父節點'}),p((_=e((f=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,r(e,"catchPools",_,i(e)),e._tags=[],e._target=null,e}n(e,t);var a=e.prototype;return a.catchTag=function(){var t=this;this._tags.length=0,this.catchPools.forEach((function(e){var n,r=e.getComponentsInChildren(l);(n=t._tags).push.apply(n,r)}))},a.removeTag=function(t){var e=this;[].concat(this._tags).some((function(n){return n.tagID===t&&(e._tags.splice(e._tags.indexOf(n),1),!0)}))},a.tryHit=function(){var t=this;return this._tags.some((function(e){var n=e.onHitTest(t.node);return n&&(t._target=e.node),n}))},o(e,[{key:"target",get:function(){return this._target}}]),e}(u)).prototype,"catchPools",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h=f))||h));a._RF.pop()}}}));

System.register("chunks:///_virtual/HitCheckAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,o,r,a,s,u,c,l,p,d,h,g,b,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass,a=t.asyncToGenerator,s=t.regeneratorRuntime},function(t){u=t.cclegacy,c=t._decorator,l=t.Node,p=t.Label,d=t.v3,h=t.Tween,g=t.tween,b=t.Component,f=t.UIOpacity}],execute:function(){var v,y,m,N,L,w,C,_;u._RF.push({},"b9eb2nvQ95OKbr7JRCkzMir","HitCheckAnimation",void 0);var k=c.ccclass,A=c.property;t("HitCheckAnimation",(v=k("HitCheckAnimation"),y=A(l),m=A(p),v((w=e((L=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"targetNode",w,o(e)),n(e,"valueLabel",C,o(e)),n(e,"duration",_,o(e)),e._oriPosition=d(),e}i(e,t);var u=e.prototype;return u.onLoad=function(){this.hide()},u.startAnimation=function(){var t=a(s().mark((function t(){var e=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._oriPosition=this.valueLabel.node.position.clone(),this.targetNode.active=!0,this.targetNode.position=this._oriPosition.clone().add3f(-120,0,0),this.targetNode.angle=-45,t.abrupt("return",new Promise((function(t){g(e.targetNode).parallel(g().to(e.duration,{position:e._oriPosition},{easing:"cubicInOut"}),g().to(e.duration,{angle:45},{easing:"cubicInOut"})).call((function(){t()})).start(),e.targetNode.getComponent(f).opacity=0,g(e.targetNode.getComponent(f)).to(e.duration/2,{opacity:255},{easing:"cubicInOut"}).start()})));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),u.stopAnimation=function(){h.stopAllByTarget(this.targetNode),this.targetNode.position=this._oriPosition},u.hide=function(){this.valueLabel.node.active=!1,this.targetNode.active=!1},r(e,[{key:"Value",set:function(t){this.valueLabel.string=t.toString(),this.valueLabel.node.active=!0,g(this.valueLabel.node).to(this.duration/2,{scale:d(1.5,1.5,1)},{easing:"cubicInOut"}).to(this.duration/2,{scale:d(1,1,1)},{easing:"cubicInOut"}).start()}}]),e}(b)).prototype,"targetNode",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=e(L.prototype,"valueLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(L.prototype,"duration",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),N=L))||N));u._RF.pop()}}}));

System.register("chunks:///_virtual/HitPointsBarComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FloatingTextComponent.ts"],(function(t){var e,n,i,o,r,a,p,s,u,l,c,h,m,H;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){a=t.cclegacy,p=t._decorator,s=t.ProgressBar,u=t.Node,l=t.Label,c=t.Vec3,h=t.tween,m=t.Component},function(t){H=t.FloatingTextComponent}],execute:function(){var f,b,g,d,x,P,y,B,C,w,L;a._RF.push({},"975d2k7B9dAQ7imcn3+VIGb","HitPointsBarComponent",void 0);var _=p.ccclass,v=p.property;t("HitPointsBarComponent",(f=_("HitPointsBarComponent"),b=v(s),g=v(H),d=v(u),x=v(l),f((B=e((y=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"hpBar",B,o(e)),i(e,"floatingTextComponent",C,o(e)),i(e,"textSpawnPoint",w,o(e)),i(e,"hpLabel",L,o(e)),e.curHp=100,e.maxHp=100,e._tempHp=0,e}n(e,t);var a=e.prototype;return a.changeHp=function(t){var e=this,n=Math.min(Math.max(this.curHp+t,0),this.maxHp),i=this.textSpawnPoint.position.clone(),o=new c(0,40,0),r=t<=0?i.add(o):i.subtract(o);this.floatingTextComponent.startPoint=r,this.floatingTextComponent.endPoint=this.textSpawnPoint.position,this.curHp=n,this.floatingTextComponent.showNumber(t,(function(){e.updateBar(),e.updateHpLabel()}))},a.updateBar=function(){this.hpBar.progress;var t=(this.curHp+this._tempHp)/this.maxHp;h(this.hpBar).to(.25,{progress:t}).start()},a.updateHpLabel=function(){this._tempHp?this.hpLabel.string="HP: "+(this.curHp+this._tempHp)+" (+"+this._tempHp+") / "+this.maxHp:this.hpLabel.string="HP: "+this.curHp+" / "+this.maxHp},r(e,[{key:"defaultHp",set:function(t){this.maxHp=t,this.curHp=t,this.updateBar(),this.updateHpLabel()}},{key:"tempHp",get:function(){return this._tempHp},set:function(t){this._tempHp=t,this.updateHpLabel()}}]),e}(m)).prototype,"hpBar",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=e(y.prototype,"floatingTextComponent",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(y.prototype,"textSpawnPoint",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(y.prototype,"hpLabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=y))||P));a._RF.pop()}}}));

System.register("chunks:///_virtual/HitTag.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,o,r,i,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,r=t.UITransform,i=t.Rect,c=t.Component}],execute:function(){var s;n._RF.push({},"c6070yqE7ZNV4279lc1aNrY","HitTag",void 0);var a=o.ccclass;o.property,t("HitTag",a("HitTag")(s=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))||this).tagID="",e}e(n,t);var o=n.prototype;return o.onHitTest=function(t){var e,n=null==(e=this.node)?void 0:e.getComponent(r),o=null==t?void 0:t.getComponent(r);if(!n||!o)return console.error("UITransform component is missing on one of the nodes."),!1;var i=this.getWorldRect(this.node,n),c=this.getWorldRect(t,o);return i.intersects(c)},o.getWorldRect=function(t,e){var n=t.getWorldPosition(),o=e.width,r=e.height;return new i(n.x-o/2,n.y-r/2,o,r)},n}(c))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./DefenseAnimation.ts","./DiceAnimation.ts","./DodgeAnimation.ts","./HideAnimation.ts","./HitCheckAnimation.ts","./ShakeAnimation.ts","./StunAnimation.ts","./CombatCard.ts","./CombatEffect.ts","./CombatEffectComponent.ts","./AiIntentData.ts","./CSVLoader.ts","./CombatCardData.ts","./CombatEffectData.ts","./EmpowerCardData.ts","./EmpowerData.ts","./EnemyData.ts","./EnemyTeamData.ts","./GameDatabase.ts","./AudioHelper.ts","./AudioManager.ts","./BattleManager.ts","./CombatCardManager.ts","./CombatEffectManager.ts","./EmpowerManager.ts","./GameManager.ts","./GameSetup.ts","./CameraCenterMover.ts","./CardMover.ts","./CheckBoxComponent.ts","./CounterComponent.ts","./DynamicWidthScrollView.ts","./FloatingTextComponent.ts","./GraphicsLineDrawer.ts","./HitBox.ts","./HitPointsBarComponent.ts","./HitTag.ts","./PixelImage.ts","./RandomString.ts","./EmpowerCardsListItem.ts","./CombatCardComponent.ts","./HandCards.ts","./PopupWindowComponent.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/PixelImage.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,i,o,n,a,s,l;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,i=e._decorator,o=e.Sprite,n=e.Texture2D,a=e.resources,s=e.SpriteFrame,l=e.Component}],execute:function(){var c;r._RF.push({},"1e6a61M7DpGTZ8ctRa3V2rU","PixelImage",void 0);var u=i.ccclass;i.property,e("PixelImage",u("PixelImage")(c=function(e){function r(){return e.apply(this,arguments)||this}t(r,e);var i=r.prototype;return i.onLoad=function(){var e,t=null==(e=this.node.getComponent(o).spriteFrame)?void 0:e.texture;t&&t.setFilters(n.Filter.NONE,n.Filter.NONE)},i.setSpriteFrame=function(e){var t=this.node.getComponent(o),r="picture/"+e+"/spriteFrame";a.load(r,s,(function(e,r){e?console.error("Failed to load image: "+e):(t.spriteFrame=r,t.spriteFrame.texture.setFilters(n.Filter.NONE,n.Filter.NONE))}))},r}(l))||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/PopupWindowComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,r,i,o,a,u,c,l,s,p,f,b,h,d,v;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){u=t.cclegacy,c=t._decorator,l=t.Node,s=t.Label,p=t.Button,f=t.instantiate,b=t.EventHandler,h=t.Component,d=t.Vec3,v=t.tween}],execute:function(){var m,w,g,C,y,P,k,L,x,z,N,E,I;u._RF.push({},"ef7f9o5MSdHJIyaJ+5Y6gKE","PopupWindowComponent",void 0);var T=c.ccclass,W=c.property;t("PopupWindowComponent",(m=T("PopupWindowComponent"),w=W(l),g=W(s),C=W(s),y=W(l),P=W(p),m((x=n((L=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return n=t.call.apply(t,[this].concat(o))||this,r(n,"dialogNode",x,i(n)),r(n,"titleLabel",z,i(n)),r(n,"contentLabel",N,i(n)),r(n,"buttonContainer",E,i(n)),r(n,"buttonPrefab",I,i(n)),n.callbacks={},n}e(n,t);var u=n.prototype;return u.openPopup=function(){var t=o(a().mark((function t(n,e,r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.node.active=!0,t.next=3,this.animateOpen();case 3:this.setupTitle(n),this.contentLabel.string=e,this.setupButtons(r);case 6:case"end":return t.stop()}}),t,this)})));return function(n,e,r){return t.apply(this,arguments)}}(),u.setupTitle=function(t){this.titleLabel.node.active=!!t,this.titleLabel.string=t||""},u.setupButtons=function(t){var n=this;this.buttonContainer.removeAllChildren(),t.forEach((function(t,e){var r=f(n.buttonPrefab.node),i=r.getComponent(p);r.getComponentInChildren(s).string=t.label,r.parent=n.buttonContainer,r.active=!0;var o="button_"+e;n.callbacks[o]=t.callback;var a=new b;a.target=n.node,a.component="PopupWindowComponent",a.handler="buttonClicked",a.customEventData=o,i.clickEvents.push(a)}))},u.buttonClicked=function(){var t=o(a().mark((function t(n,e){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.animateClose();case 2:null==(r=this.callbacks[e])||r();case 4:case"end":return t.stop()}}),t,this)})));return function(n,e){return t.apply(this,arguments)}}(),u.animateOpen=function(){var t=o(a().mark((function t(){var n=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){n.dialogNode.scale=new d(0,0,0),v(n.dialogNode).to(.3,{scale:new d(1,1,1)},{easing:"cubicInOut"}).call((function(){return t()})).start()})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),u.animateClose=function(){var t=o(a().mark((function t(){var n=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.reset(),t.abrupt("return",new Promise((function(t){v(n.dialogNode).to(.3,{scale:new d(0,0,0)},{easing:"cubicInOut"}).call((function(){t(),n.node.active=!1})).start()})));case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),u.reset=function(){this.setupTitle(""),this.contentLabel.string="",this.buttonContainer.removeAllChildren()},n}(h)).prototype,"dialogNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(L.prototype,"titleLabel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=n(L.prototype,"contentLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(L.prototype,"buttonContainer",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(L.prototype,"buttonPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=L))||k));u._RF.pop()}}}));

System.register("chunks:///_virtual/RandomString.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"6d68btvCrRImoQ92N8EOOsm","RandomString",void 0);n("RandomString",function(){function n(){}return n.generate=function(n){void 0===n&&(n=10);for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="",o=0;o<n;o++){r+=t[Math.floor(Math.random()*t.length)]}return r},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/ShakeAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,n,e,o,r,a,s,u,l,c,h,p;return{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,s=t.Node,u=t.tween,l=t.Tween,c=t.randomRange,h=t.v3,p=t.Component}],execute:function(){var g,d,f,y,k,m;r._RF.push({},"c60d2C3PxNPN4bC4RKZtYQc","ShakeAnimation",void 0);var b=a.ccclass,v=a.property;t("default",(g=v(s),b((y=i((f=function(t){function i(){for(var i,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return i=t.call.apply(t,[this].concat(r))||this,e(i,"targetNode",y,o(i)),e(i,"shakeDuration",k,o(i)),e(i,"shakeIntensity",m,o(i)),i._originalPosition=void 0,i}n(i,t);var r=i.prototype;return r.start=function(){},r.startAnimation=function(){var t=this,i=this._originalPosition=this.targetNode.position.clone();u(this.targetNode).to(this.shakeDuration/2,{position:this.getRandomShakePosition()},{easing:"bounceInOut"}).to(this.shakeDuration/2,{position:i}).call((function(){t.startAnimation()})).start()},r.stopAnimation=function(){l.stopAllByTarget(this.targetNode),this._originalPosition&&this.targetNode.setPosition(this._originalPosition)},r.getRandomShakePosition=function(){var t=c(-1,1)*this.shakeIntensity,i=c(-1,1)*this.shakeIntensity;return h(this.targetNode.position.x+t,this.targetNode.position.y+i,0)},i}(p)).prototype,"targetNode",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=i(f.prototype,"shakeDuration",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),m=i(f.prototype,"shakeIntensity",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),d=f))||d));r._RF.pop()}}}));

System.register("chunks:///_virtual/StunAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,i,r,o,a,l,u,c,s;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,l=t.Node,u=t.tween,c=t.Tween,s=t.Component}],execute:function(){var g,p,h,d,f,A,m;o._RF.push({},"20cceTBQ0dKcKTLx+gHgTvb","StunAnimation",void 0);var y=a.ccclass,b=a.property;t("StunAnimation",(g=y("StunAnimation"),p=b(l),g((f=n((d=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return n=t.call.apply(t,[this].concat(o))||this,i(n,"targetNode",f,r(n)),i(n,"duration",A,r(n)),i(n,"rotationAngle",m,r(n)),n._oriAngle=0,n}e(n,t);var o=n.prototype;return o.startAnimation=function(){var t=this;this._oriAngle=this.targetNode.angle,u(this.targetNode).to(this.duration,{angle:this.rotationAngle}).to(this.duration,{angle:-this.rotationAngle}).union().repeat(3).call((function(){t.stopAnimation()})).start()},o.stopAnimation=function(){c.stopAllByTarget(this.targetNode),this.targetNode.angle=this._oriAngle},n}(s)).prototype,"targetNode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=n(d.prototype,"duration",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),m=n(d.prototype,"rotationAngle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 30}}),h=d))||h));o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});