System.register("chunks:///_virtual/Ability.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"84f08yPe8ZDgIR8CzYwL3b1","Ability",void 0);e("Attribute",function(e){return e.Strength="strength",e.Dexterity="dexterity",e.Intelligence="intelligence",e.Wisdom="wisdom",e.Charisma="charisma",e.Resilience="resilience",e.Constitution="constitution",e.Spirit="spirit",e.Willpower="willpower",e.Athletics="athletics",e.Perception="perception",e.Response="response",e.Figurative="figurative",e}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/AdventureSkill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Skill.ts"],(function(e){var i,t,n,r;return{setters:[function(e){i=e.inheritsLoose},function(e){t=e.cclegacy},function(e){n=e.SkillProficiency,r=e.Skill}],execute:function(){t._RF.push({},"ea011GtbgdBdLlhL0aSKFxv","AdventureSkill",void 0);e("Adventure",function(e){return e.Stunts="stunts",e.Stealth="stealth",e.Dexterity="dexterity",e.Knowledge="knowledge",e.Experience="experience",e.Nature="nature",e.Religion="religion",e.Explore="explore",e.Nursing="nursing",e.Awareness="awareness",e.Taming="taming",e.Survival="survival",e.Observation="observation",e.Performance="performance",e.Persuasion="persuasion",e.Intimidation="intimidation",e.Shove="shove",e}({})),e("AdventureSkill",function(e){function t(i,t,r,o){var l;return void 0===r&&(r=""),void 0===o&&(o=n.Novice),(l=e.call(this,i,r,o)||this).linkedAttribute=void 0,l.linkedAttribute=t,l}return i(t,e),t.prototype.upgradeSkillProficiency=function(){return this.level!==n.Expert&&(this.level++,!0)},t}(r));t._RF.pop()}}}));

System.register("chunks:///_virtual/ArcherySkill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatSkill.ts"],(function(e){var t,i,n,a;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,n=e.randomRangeInt},function(e){a=e.CombatSkill}],execute:function(){i._RF.push({},"5dd90xf3B1PEpf98SkrtKgN","ArcherySkill",void 0);e("ArcherySkill",function(e){function i(t,i,n){return e.call(this,"弓道",i,t,n)||this}t(i,e);var a=i.prototype;return a.getAffix=function(){return[{name:"射擊:配合呼吸",description:"「冷靜，配合呼吸再放弓…」",effect:{affix:"inspiration",value:1,duration:2}},{name:"射擊:穩定姿態",description:"「讓手指保持穩定…」",effect:{affix:"inspiration",value:n(2,3),duration:2}},{name:"射擊:瞄定再發",description:"「先瞄準，再發射…」",effect:{affix:"precision",value:1,duration:2}},{name:"射擊:預測準星",description:"「我看見了…能命中！」",effect:{affix:"precision",value:n(2,3),duration:2}}]},a.getSkill=function(){return[{name:"xx1",description:"「射擊技能1」",skillType:"DamageExtra",hits:"",damage:"1d4"},{name:"xx2",description:"「射擊技能2」",skillType:"HitExtra",hits:"1d4",damage:""},{name:"xx3",description:"「射擊技能3」",skillType:"HitBonus",hits:"+1",damage:""},{name:"xx4",description:"「射擊技能4」",skillType:"DamageBonus",hits:"",damage:"+1"}]},a.applySkillEffects=function(e,t,i){var a=this;if(i>this.level)console.log("等級不足");else switch(i){case 1:console.log("弱點射擊");var o={affix:"inspiration",value:n(3,6),duration:2};this.activateSkillEffect(e,o);break;case 2:console.log("精準射擊");o={affix:"precision",value:n(1,6),duration:2};this.activateSkillEffect(e,o);break;case 3:console.log("分裂箭");break;case 4:console.log("突襲射擊");break;case 5:t.forEach((function(e){console.log("光眩射擊"),Math.random()<.25&&(console.log(e.name+" is blid."),a.activateSkillEffect(e,{affix:"eye",value:1,duration:3}))}));break;case 6:console.log("末日之雨"),t.forEach((function(e){}))}},a.getSkill1=function(){return[{serialId:"skill1",level:1,name:"復仇",description:"承受攻擊時進行反擊6點。",cost:{type:"Reaction",fee:1},modifiers:[{attribute:"DamageBonus",bonus:"+6",duration:1,conditions:["Melee","UnderDamage"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"閃避反擊",description:"閃避攻擊後進行反擊4點。",cost:{type:"Reaction",fee:1},modifiers:[{attribute:"DamageBonus",bonus:"+4",duration:1,conditions:["Melee","Dodge"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"卸力",description:"在承受傷害時減緩衝擊，以臨時生命6點作為可承受的傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"Defense",bonus:"+6",duration:1,conditions:["Hitpoints"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"預判",description:"察覺敵人動向，提前行動。下一輪攻擊有優勢",cost:{type:"Intent",fee:1},modifiers:[{attribute:"Attack",bonus:"+6",duration:1,conditions:["Advantage"]}],target:"self",range:"Melee",type:"damage",animation:"attack"}]},a.getSkill2=function(){return[{serialId:"skill1",level:1,name:"拳擊",description:"使用拳擊動作助攻，+1命中。徒手時傷害+1。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+1",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+1",duration:1,conditions:["Melee","Unarmed"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"猛擊",description:"使用敲擊動作助攻，+1命中。武器有鈍器屬性時+4點傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+1",duration:1,conditions:["Melee"]},{attribute:"Stun",bonus:"+1",description:"武器有鈍器的特性時目標受暈眩效果。",conditions:["Melee","Bludgeoning"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"斬擊",description:"使用揮砍動作助攻，+1命中。武器有揮砍屬性時+1點傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+1",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+1",duration:1,conditions:["Melee","Slashing"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"突刺",description:"使用穿刺動作助攻，+1命中。若武器有穿刺屬性時+1點傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+1",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+1",duration:1,conditions:["Melee","Piercing"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"反手格擋",description:"攻守合一，+1命中、+1臨時護甲值。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+1",duration:1,conditions:["Melee"]},{attribute:"Defense",bonus:"+1",duration:1,conditions:["Defense"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"專注防禦",description:"專心防禦，+2臨時護甲值。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"Defense",bonus:"+2",duration:1,conditions:["Defense"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"靈活步伐",description:"攻擊時讓腳步靈動，+1命中，+2臨時護甲值。但你穿著重甲時無法靈活行動而失敗。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+1",duration:1,conditions:["Melee","LightArmor"]},{attribute:"Defense",bonus:"+2",duration:1,conditions:["Defense","LightArmor"]}],target:"self",range:"Melee",type:"damage",animation:"attack"}]},a.getSkill3=function(){return[{serialId:"skill1",level:1,name:"拳擊+1",description:"使用拳擊動作助攻，+3命中。徒手時傷害+2。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+3",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+2",duration:1,conditions:["Melee","Unarmed"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"猛擊+1",description:"使用敲擊動作助攻，+2命中。武器有鈍器屬性時+6點傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+2",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+6",duration:1,conditions:["Melee","Bludgeoning"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"斬擊+1",description:"使用揮砍動作助攻，+2命中。武器有揮砍屬性時+4點傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+4",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+2",duration:1,conditions:["Melee","Slashing"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"突刺+1",description:"使用穿刺動作助攻，+2命中。若武器有穿刺屬性時+4點傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+2",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+4",duration:1,conditions:["Melee","Piercing"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"反手格擋+1",description:"攻守合一，+2命中、+2臨時護甲值。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+2",duration:1,conditions:["Melee"]},{attribute:"Defense",bonus:"+2",duration:1,conditions:["Defense"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"力量熟練",description:"若有武器熟練時+2點力量傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"DamageBonus",bonus:"+2",duration:1,conditions:["Melee","strength"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"專注防禦+1",description:"專心防禦，+4臨時護甲值。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"Defense",bonus:"+4",duration:1,conditions:["Defense"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"狡詐技巧",description:"使用假動作誘導敵人，額外造成1d4命中。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitExtra",bonus:"1d4",duration:1,conditions:["Melee"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"靈活步伐+1",description:"攻擊時讓腳步靈動，+2命中，+3臨時護甲值。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+2",duration:1,conditions:["Melee"]},{attribute:"Defense",bonus:"+3",duration:1,conditions:["Defense"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"突襲",description:"趁人不備打擊敵人要害，額外傷害2d4。使用靈活武器時傷害+2",cost:{type:"Intent",fee:1},modifiers:[{attribute:"DamageExtra",bonus:"2d4",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+2",duration:1,conditions:["Melee","Finesse"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"打擊弱點",description:"專心打擊敵人要害，額外傷害1d4。武器有穿刺屬性時傷害+2",cost:{type:"Intent",fee:1},modifiers:[{attribute:"DamageExtra",bonus:"1d4",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+2",duration:1,conditions:["Piercing"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"復仇",description:"承受攻擊時進行反擊6點。",cost:{type:"Reaction",fee:1},modifiers:[{attribute:"DamageBonus",bonus:"+6",duration:1,conditions:["Melee","UnderDamage"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"閃避反擊",description:"閃避攻擊後進行反擊4點。但在穿著重甲時無法靈活地反擊。",cost:{type:"Reaction",fee:1},modifiers:[{attribute:"DamageBonus",bonus:"+4",duration:1,conditions:["Melee","Dodge","LightArmor"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"卸力",description:"在承受傷害時減緩衝擊，以臨時生命6點作為可承受的傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"Defense",bonus:"+6",duration:1,conditions:["Hitpoints"]}],target:"self",range:"Melee",type:"damage",animation:"attack"}]},i}(a));i._RF.pop()}}}));

System.register("chunks:///_virtual/Armor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Item.ts"],(function(e){var t,r,a;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy},function(e){a=e.Item}],execute:function(){r._RF.push({},"e9232ucOdFK3q1sHt4TR+KC","Armor",void 0);e("ArmorStyle",function(e){return e.AllLightArmors="AllLightArmors",e.Padded="Padded",e.Leather="Leather",e.StuddedLeather="Studded Leather",e.AllMediumArmors="AllMediumArmors",e.Hide="Hide",e.ChainShirt="Chain Shirt",e.ScaleMail="Scale Mail",e.Breastplate="Breastplate",e.HalfPlate="Half Plate",e.AllHeavyArmors="AllHeavyArmors",e.RingMail="Ring Mail",e.ChainMail="Chain Mail",e.Splint="Splint",e.Plate="Plate",e}({})),e("Armor",function(e){function r(t,r,a,i,l,n,s,o){var u;return(u=e.call(this,t,a,i,1)||this).armorClassBase=void 0,u.strengthRequirement=void 0,u.stealthDisadvantage=void 0,u.armorType=void 0,u.iconName=void 0,u.iconName=r,u.armorClassBase=l,u.strengthRequirement=n,u.stealthDisadvantage=s,u.armorType=o,u}t(r,e);var a=r.prototype;return a.calculateArmorClass=function(e){var t=this.getMaxDexBonus(),r=null!==t?Math.min(e,t):e;return this.armorClassBase+r},a.getMaxDexBonus=function(){switch(this.armorType){case"Light":return null;case"Medium":return 2;case"Heavy":return 0;default:return null}},r}(a));r._RF.pop()}}}));

System.register("chunks:///_virtual/ArmorDraggable.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Draggable.ts","./EventManager.ts","./EquipmentDropZone.ts"],(function(e){var n,t,r,o,a,i,s,l;return{setters:[function(e){n=e.inheritsLoose,t=e.createClass},function(e){r=e.cclegacy,o=e._decorator,a=e.Label},function(e){i=e.Draggable},function(e){s=e.EventManager},function(e){l=e.EquipmentDropZoneIndex}],execute:function(){var c;r._RF.push({},"47b056lZsJImI5+vts2KNpl","ArmorDraggable",void 0);var u=o.ccclass;o.property,e("ArmorDraggable",u("ArmorDraggable")(c=function(e){function r(){for(var n,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(n=e.call.apply(e,[this].concat(r))||this).nameLabel=null,n._armor=null,n.equipmentIndex=l.None,n}return n(r,e),r.prototype.onTouchStart=function(n){if(e.prototype.onTouchStart.call(this,n),this.equipmentIndex!==l.None){var t=this.zone;s.instance.emit("CharacterEquipArmor",{index:t.serialIndex,item:null}),this.equipmentIndex=l.None}},t(r,[{key:"armor",set:function(e){this._armor=e,console.log("Armor = ",e),this.nameLabel=this.node.getComponentInChildren(a),this.nameLabel.string=e.name,this.setPhotoImage(e.iconName)}},{key:"item",get:function(){return this._armor}}]),r}(i))||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/AttributeAllocation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,n,o,a,l,s,r;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){a=t.cclegacy,l=t._decorator,s=t.Label,r=t.Component}],execute:function(){var c,u,p,b,A;a._RF.push({},"1ad13PVlEBAPb3cnjqRj12a","AttributeAllocation",void 0);var h=l.ccclass,d=l.property;t("AttributeAllocation",(c=h("AttributeAllocation"),u=d(s),c((A=i((b=function(t){function i(){for(var i,e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];return i=t.call.apply(t,[this].concat(a))||this,n(i,"pointsAvailableLabel",A,o(i)),i.totalPoints=0,i.pointsUsed=0,i}e(i,t);var a=i.prototype;return a.onLoad=function(){this.updatePointsAvailableLabel()},a.allocatePoints=function(t){return this.pointsUsed+t<=this.totalPoints&&(this.pointsUsed+=t,this.updatePointsAvailableLabel(),!0)},a.freePoints=function(t){this.pointsUsed-=t,this.updatePointsAvailableLabel()},a.updatePointsAvailableLabel=function(){this.pointsAvailableLabel.string="Available Points: "+(this.totalPoints-this.pointsUsed)},i}(r)).prototype,"pointsAvailableLabel",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=b))||p));a._RF.pop()}}}));

System.register("chunks:///_virtual/AttributeComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AttributeAllocation.ts"],(function(t){var e,i,n,r,a,u,o,l,c,s,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized,a=t.createClass},function(t){u=t.cclegacy,o=t._decorator,l=t.Label,c=t.Button,s=t.Component},function(t){b=t.AttributeAllocation}],execute:function(){var p,f,h,m,y,d,A,_,g,V,B,L,v;u._RF.push({},"587242a40JCjqpB/v5QWP6G","AttributeComponent",void 0);var z=o.ccclass,C=o.property;t("AttributeComponent",(p=z("AttributeComponent"),f=C(l),h=C(l),m=C(c),y=C(c),d=C(b),p((g=e((_=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return e=t.call.apply(t,[this].concat(a))||this,n(e,"attributeNameLabel",g,r(e)),n(e,"attributeValueLabel",V,r(e)),n(e,"increaseButton",B,r(e)),n(e,"decreaseButton",L,r(e)),n(e,"allocation",v,r(e)),e._attributeName="",e._attributeValue=0,e}i(e,t);var u=e.prototype;return u.onLoad=function(){this.increaseButton.node.on("click",this.increaseAttribute,this),this.decreaseButton.node.on("click",this.decreaseAttribute,this)},u.increaseAttribute=function(){this.allocation.allocatePoints(1)&&this.Value++},u.decreaseAttribute=function(){this._attributeValue>0&&(this.allocation.freePoints(1),this.Value--)},a(e,[{key:"Value",get:function(){return this._attributeValue},set:function(t){this._attributeValue=t,this.attributeValueLabel.string=this._attributeName+": "+this._attributeValue}},{key:"Name",get:function(){return this._attributeName},set:function(t){this._attributeName=t}}]),e}(s)).prototype,"attributeNameLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(_.prototype,"attributeValueLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(_.prototype,"increaseButton",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(_.prototype,"decreaseButton",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=e(_.prototype,"allocation",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=_))||A));u._RF.pop()}}}));

System.register("chunks:///_virtual/AudioController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var e,t,r,n,i,u,c,a,l;return{setters:[function(o){e=o.applyDecoratedDescriptor,t=o.inheritsLoose,r=o.initializerDefineProperty,n=o.assertThisInitialized},function(o){i=o.cclegacy,u=o._decorator,c=o.AudioSource,a=o.assert,l=o.Component}],execute:function(){var s,p,d,f,y;i._RF.push({},"c714bqcI0FN4Y+9uQVoTRJe","AudioController",void 0);var h=u.ccclass,v=u.property;o("AudioController",(s=h("AudioController"),p=v(c),s((y=e((f=function(o){function e(){for(var e,t=arguments.length,i=new Array(t),u=0;u<t;u++)i[u]=arguments[u];return e=o.call.apply(o,[this].concat(i))||this,r(e,"_audioSource",y,n(e)),e}t(e,o);var i=e.prototype;return i.onLoad=function(){var o=this.node.getComponent(c);a(o),this._audioSource=o},i.start=function(){var o=this,e=document.querySelector("video");if(e){var t=e.play();void 0!==t&&t.then((function(e){o.play()})).catch((function(o){console.log("Autoplay prevented")}))}},i.play=function(){this._audioSource.play()},i.pause=function(){this._audioSource.pause()},e}(l)).prototype,"_audioSource",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));i._RF.pop()}}}));

System.register("chunks:///_virtual/BaseCardDisplay.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CardComponent2.ts"],(function(e){var n,t,o,i,r,a,l,s,c,d,u,h,p,f,C,g,v,m,b;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,l=e.Prefab,s=e.Node,c=e.CCInteger,d=e.Sprite,u=e.Color,h=e.UITransform,p=e.instantiate,f=e.Layout,C=e.Button,g=e.Vec3,v=e.tween,m=e.Component},function(e){b=e.CardComponent}],execute:function(){var P,y,N,S,w,I,x,M,z,D,L;r._RF.push({},"bf0beYLhbxN67m5aSRVMCJL","BaseCardDisplay",void 0);var B=a.ccclass,E=a.property;e("BaseCardDisplay",(P=B("BaseCardDisplay"),y=E(l),N=E(s),S=E(s),w=E(c),P((M=n((x=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=e.call.apply(e,[this].concat(r))||this,o(n,"cardPrefab",M,i(n)),o(n,"positionContainer",z,i(n)),o(n,"cardContainer",D,i(n)),o(n,"selectedPositionY",L,i(n)),n.oriPositionY=0,n.selected=[],n.selectedCardNodes=[],n.originalIndexMap=new Map,n}t(n,e);var r=n.prototype;return r.initPositionNodes=function(e){this.positionContainer.removeAllChildren();for(var n=0;n<e;n++){var t=new s;t.name="Position_"+n,t.parent=this.positionContainer,t.addComponent(d).color=u.RED,t.getComponent(h).setContentSize(100,100)}},r.followPosition=function(){this.node.active=!0,this.updatePositionLayout();var e=this.cardContainer.children,n=this.positionContainer.children;console.log("followPosition cardNodes.length:",e.length),console.log("followPosition positionNodes.length:",n.length),e.length===n.length?n.forEach((function(n,t){e[t].setPosition(n.position),console.log("followPosition positionNode.position:",n.position)})):console.error("卡牌數量與定位節點數量不符")},r.showCards=function(e){var n=this;this.positionContainer.children.length===e.length?(this.selectedCardNodes.length>0&&console.error("已經有選取的卡片，請先清除之前的選取"),this.cardContainer.removeAllChildren(),e.forEach((function(e,t){var o=p(n.cardPrefab);o.name="Card_"+t,o.getComponent(b).setup(e),o.parent=n.cardContainer}))):console.error("卡牌數量與定位節點數量不符")},r.setToggleSelection=function(e){var n=this;void 0===e&&(e=null),this.cardContainer.children.forEach((function(t){t.on("click",(function(){return n.toggleCardSelection(t,e)}),n)}))},r.stopToggleSelection=function(){this.cardContainer.children.forEach((function(e){e.off("click")}))},r.toggleCardSelection=function(e,n){var t=this;void 0===n&&(n=null);var o=this.selectedCardNodes.includes(e);if(o){this.selectedCardNodes=this.selectedCardNodes.filter((function(n){return n!==e}));var i=this.originalIndexMap.get(e)||0;e.setSiblingIndex(i)}else this.selectedCardNodes.push(e),this.originalIndexMap.set(e,e.getSiblingIndex()),e.setSiblingIndex(this.cardContainer.children.length-1);var r=o?0:this.selectedPositionY;this.animateSelectCardMovement(e,r).then((function(){null==n||n(o),console.log("toggleCardSelection selectedCardNodes:",t.selectedCardNodes)}))},r.updatePositionLayout=function(){var e=this.positionContainer.getComponent(f);e.enabled=!0,e.updateLayout(),e.enabled=!1},r.unselectAllCards=function(){var e=this;return console.log("取消所有共",this.selected.length,"張卡牌選取"),this.selected.length=0,Promise.all(this.selectedCardNodes.map((function(n){return e.animateSelectCardMovement(n,0).then((function(){e.selectedCardNodes=e.selectedCardNodes.filter((function(e){return e!==n}));var t=e.originalIndexMap.get(n)||0;n.setSiblingIndex(t)}))})))},r.getCardNodes=function(e){var n=[];return this.cardContainer.children.forEach((function(t){var o=t.getComponent(b);e.find((function(e){o&&o.card===e&&n.push(t)}))})),n},r.animateSelectCardMovement=function(e,n){var t=this,o=e.getComponent(C);return o.interactable=!1,new Promise((function(i){var r=t.oriPositionY+n,a=new g(e.position.x,r,e.position.z);v(e).to(.25,{position:a},{easing:"quadInOut"}).call((function(){o.interactable=!0,i()})).start()}))},n}(m)).prototype,"cardPrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(x.prototype,"positionContainer",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(x.prototype,"cardContainer",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=n(x.prototype,"selectedPositionY",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),I=x))||I));r._RF.pop()}}}));

System.register("chunks:///_virtual/Card.ts",["cc"],(function(i){var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"b67e4ftXxNI+IGCQiVuo91W","Card",void 0);i("Card",(function(){this.suit=void 0,this.rank=void 0,this.conditions=void 0})),i("CombatCard",(function(){this.name=void 0,this.description=void 0,this.cost=void 0,this.modifiers=void 0,this.target=void 0})),i("TipCard",(function(){this.string=void 0,this.type=void 0,this.description=void 0,this.action=void 0,this.conditions=void 0,this.coping=void 0,this.response=void 0,this.dc=void 0,this.success=void 0,this.failure=void 0,this.link=void 0}));t._RF.pop()}}}));

System.register("chunks:///_virtual/CardCombatTest.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TeamMember.ts","./Ability.ts","./Character.ts","./EventManager.ts","./CharacterInfo.ts","./Weapon.ts","./Armor.ts","./Shield.ts","./ParticleEffectComponent.ts","./Inventory.ts","./ClassFeatureImplementation.ts","./UIManager.ts","./CombatController.ts"],(function(t){var e,n,r,i,a,o,c,l,s,m,h,u,d,f,g,y,p,b,v,C,I,w,E;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,c=t.instantiate,l=t.randomRangeInt,s=t.Component},function(t){m=t.TeamMember},function(t){h=t.Attribute},function(t){u=t.Character},function(t){d=t.EventManager},function(t){f=t.CharacterInfo},function(t){g=t.Weapon,y=t.WeaponStyle},function(t){p=t.Armor},function(t){b=t.Shield},function(t){v=t.ParticleEffectComponent},function(t){C=t.Inventory},function(t){I=t.warriorFeatures},function(t){w=t.UIEvent},function(t){E=t.CombatControllerEvent}],execute:function(){var S,A,M,P,T,D,L,z,F;a._RF.push({},"67cf2gqfz5JJKd+peoFZl++","CardCombatTest",void 0);var x=o.ccclass,_=o.property;t("default",(S=x("CardCombatCheckTest"),A=_(f),M=_(v),P=_(C),S((L=e((D=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,r(e,"characterInfo",L,i(e)),r(e,"particleEffect",z,i(e)),r(e,"inventory",F,i(e)),e.monsterEmeny=null,e.emenyParam={constitution:5,spirit:20,willpower:15},e.emenyAC=10,e}n(e,t);var a=e.prototype;return a.start=function(){var t,e=this;d.instance.on("battleStart",this.battleStart.bind(this)),[new g("長劍","15 gold",3,y.Longsword,"long_swood",{dice:"1d8",dice2:"1d10",type:"Slashing"},["Versatile"],"Melee"),new g("銅錘","2 gold",2,y.LightHammer,"hammer",{dice:"1d4",type:"Bludgeoning"},["Light","Thrown"],"Melee"),new g("匕首","2 gold",1,y.Dagger,"dagger",{dice:"1d4",type:"Piercing"},["Finesse","Light","Thrown"],"Melee"),new g("手斧","5 gold",2,y.Handaxe,"axe",{dice:"1d6",type:"Slashing"},["Light","Thrown"],"Melee")].forEach((function(t){return e.inventory.addItem(t)})),[new p("綿甲","padded","5 gold",8,11,0,"Disadvantage","Light"),new p("生皮甲","rawhide","10 gold",12,12,0,"None","Medium"),new p("鎖子甲","chainmail","75 gold",55,16,13,"Disadvantage","Heavy")].forEach((function(t){return e.inventory.addItem(t)})),this.inventory.addItem(new b("盾牌","shield","5 gold",9,2));var n=((t={})[h.Strength]=15,t[h.Dexterity]=14,t[h.Intelligence]=13,t[h.Wisdom]=12,t[h.Charisma]=10,t[h.Resilience]=8,t);this.characterInfo.character=new u("warrior",1,n,I),this.characterInfo.rollInitiativeOrder(),d.instance.emit(w.BaseAbilityAllocation,{allocatePoints:0,baseAbilities:n});var r=c(this.characterInfo.member.node);this.monsterEmeny=r.getComponent(m)},a.onDestroy=function(){d.instance.off("battleStart",this.battleStart)},a.battleStart=function(){this.characterInfo.rollInitiativeOrder(),this.emenyParam.constitution+=l(1,10),this.emenyAC=Math.min(18,Math.max(this.emenyAC,this.emenyAC+l(-1,2))),this.monsterEmeny.monsterInitial("monster",this.emenyParam,this.emenyAC),this.monsterEmeny.rollInitiativeOrder(1);var t=this.characterInfo.member;d.instance.emit(E.InitiativeOrder,{mainCharacter:t,team:[[t],[this.monsterEmeny]]})},a.onBattleStartClicked=function(t){t.target.active=!1,this.battleStart()},e}(s)).prototype,"characterInfo",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(D.prototype,"particleEffect",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(D.prototype,"inventory",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=D))||T));a._RF.pop()}}}));

System.register("chunks:///_virtual/CardComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var t,n,e,i,a,o,c,u;return{setters:[function(r){t=r.applyDecoratedDescriptor,n=r.inheritsLoose,e=r.initializerDefineProperty,i=r.assertThisInitialized},function(r){a=r.cclegacy,o=r._decorator,c=r.Label,u=r.Component}],execute:function(){var l,s,p,d,f,h,y;a._RF.push({},"398eaEOcg5IPKuVXD3G9D9s","CardComponent",void 0);var g=o.ccclass,m=o.property;r("CardComponent",(l=g("CardComponent"),s=m(c),p=m(c),l((h=t((f=function(r){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=r.call.apply(r,[this].concat(a))||this,e(t,"cardSuit",h,i(t)),e(t,"cardRank",y,i(t)),t.card=null,t}return n(t,r),t.prototype.setup=function(r){this.card=r,this.cardSuit.string=r.name,this.cardRank.string=r.description},t}(u)).prototype,"cardSuit",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(f.prototype,"cardRank",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/CardComponent2.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var t,n,e,i,a,o,c,u;return{setters:[function(r){t=r.applyDecoratedDescriptor,n=r.inheritsLoose,e=r.initializerDefineProperty,i=r.assertThisInitialized},function(r){a=r.cclegacy,o=r._decorator,c=r.Label,u=r.Component}],execute:function(){var l,s,p,d,f,h,y;a._RF.push({},"a2c30irv0FH6YP5VA6kIv7h","CardComponent",void 0);var v=o.ccclass,C=o.property;r("CardComponent",(l=v("CardComponent"),s=C(c),p=C(c),l((h=t((f=function(r){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=r.call.apply(r,[this].concat(a))||this,e(t,"cardSuit",h,i(t)),e(t,"cardRank",y,i(t)),t.card=void 0,t}return n(t,r),t.prototype.setup=function(r){this.card=r,this.cardSuit.string=["♠","♥","♦","♣"][r.suit],this.cardRank.string=r.rank},t}(u)).prototype,"cardSuit",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(f.prototype,"cardRank",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/CardMover.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e,o,r,a,i,c;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator,r=n.UITransform,a=n.tween,i=n.Vec3,c=n.Component}],execute:function(){var s;e._RF.push({},"84f9242HqlIxoYCUsq4N1ow","CardMover",void 0);var u=o.ccclass;n("CardMover",u("CardMover")(s=function(n){function e(){return n.apply(this,arguments)||this}return t(e,n),e.moveCard=function(n,t,e,o,a){void 0===o&&(o=.02),void 0===a&&(a=.25);var i=n.parent;if(i===t)return this.animateCardMovement(n,e,o,a);var c=i.getComponent(r).convertToWorldSpaceAR(n.position);n.removeFromParent(),n.parent=t;var s=t.getComponent(r).convertToNodeSpaceAR(c);return n.setPosition(s),this.animateCardMovement(n,e,o,a)},e.animateCardMovement=function(n,t,e,o){return new Promise((function(r){var i=a().delay(e).call((function(){return r()})),c=a(n).to(o,{position:t},{easing:"quadInOut"});a(n).parallel(c,i).start()}))},e.scatterCards=function(n,t,e,o){return new Promise((function(r){n.forEach((function(n){var c=e[0],s=e[1],u=2*Math.random()*Math.PI,d=c+Math.random()*(s-c),v=new i(Math.cos(u),Math.sin(u),0),l=i.scaleAndAdd(new i,t.position,v,d);a(n).to(o,{position:l},{easing:"cubicOut"}).call((function(){return r()})).start()}))}))},e}(c))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/CardReward.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RewardCards.ts","./EventManager.ts","./GameEvents.ts"],(function(e){var r,t,n,a,i,o,c,s,l,d,u,p,f,y;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){i=e.cclegacy,o=e._decorator,c=e.Node,s=e.Vec3,l=e.UIOpacity,d=e.tween,u=e.Component},function(e){p=e.RewardCards},function(e){f=e.EventManager},function(e){y=e.PlayerHandCardEvent}],execute:function(){var w,v,h,C,b,g,R;i._RF.push({},"48690Waly9Mo67Q2dd2F4P4","CardReward",void 0);var m=o.ccclass,E=o.property;e("CardReward",(w=m("CardReward"),v=E(c),h=E(p),w((g=r((b=function(e){function r(){for(var r,t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i))||this,n(r,"blocker",g,a(r)),n(r,"rewardCards",R,a(r)),r}t(r,e);var i=r.prototype;return i.show=function(e){this.node.position=s.ZERO,this.node.active=e;var r=this.blocker.getComponent(l);r.opacity=0,e&&d(r).delay(.1).to(.25,{opacity:185},{easing:"linear"}).start()},i.init=function(e){f.instance.emit(y.ShowCards,e)},r}(u)).prototype,"blocker",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=r(b.prototype,"rewardCards",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=b))||C));i._RF.pop()}}}));

System.register("chunks:///_virtual/Character.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Ability.ts"],(function(i){var e,t,r,o;return{setters:[function(i){e=i.extends,t=i.createForOfIteratorHelperLoose},function(i){r=i.cclegacy},function(i){o=i.Attribute}],execute:function(){r._RF.push({},"0514f2WZqhIVoc4soO6O7Rc","Character",void 0);i("Character",function(){function i(i,e,t,r,o){void 0===o&&(o=25),this.name=void 0,this.level=void 0,this.abilities=void 0,this.primaryAttribute=null,this.savingThrowProficiencies=[],this.armorProficiencies=[],this.weaponProficiencies=[],this.movement=void 0,this.skills={},this.name=i,this.level=e,this.abilities=t,this.primaryAttribute=r.primaryAttribute,this.savingThrowProficiencies=r.savingThrowProficiencies,this.armorProficiencies=r.armorProficiencies,this.weaponProficiencies=r.weaponProficiencies,this.movement=o}var r=i.prototype;return r.calculateClassProficiencyBonus=function(){return this.level>=17?6:this.level>=13?5:this.level>=9?4:this.level>=5?3:2},r.calculateAbilityScoreModifier=function(i){return Math.floor(this.abilities[i]/2)-5},r.calculateProficienciesBonus=function(){for(var i,r,c=((i={})[o.Strength]=this.calculateAbilityScoreModifier(o.Strength),i[o.Dexterity]=this.calculateAbilityScoreModifier(o.Dexterity),i[o.Intelligence]=this.calculateAbilityScoreModifier(o.Intelligence),i[o.Wisdom]=this.calculateAbilityScoreModifier(o.Wisdom),i[o.Charisma]=this.calculateAbilityScoreModifier(o.Charisma),i[o.Resilience]=this.calculateAbilityScoreModifier(o.Resilience),i),s=this.calculateClassProficiencyBonus(),l=e({},c),n=t(this.savingThrowProficiencies);!(r=n()).done;){var a=r.value;console.log("豁免:",a),l[a]+=s}return l},r.calculateCompositeAbilities=function(){var i,e=this.abilities,t=e.strength,r=e.dexterity,c=e.intelligence,s=e.wisdom,l=e.charisma,n=e.resilience;return(i={})[o.Constitution]=Math.floor((2*t+r+n)/2)+10,i[o.Spirit]=Math.floor((2*c+s)/2)+10,i[o.Willpower]=Math.floor((2*n+l)/2)+10,i},i}());r._RF.pop()}}}));

System.register("chunks:///_virtual/CharacterInfo.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TeamMember.ts","./Character.ts","./Ability.ts","./EventManager.ts","./CardMover.ts","./AdventureSkill.ts","./Skill.ts","./ClassFeatureImplementation.ts","./CopingSkillCheck.ts"],(function(e){var i,t,n,r,a,s,o,l,c,h,u,d,f,p,m,v,S,k,g,b,C,w,_,A;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.createClass,s=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){l=e.cclegacy,c=e._decorator,h=e.Node,u=e.RichText,d=e.Vec3,f=e.randomRangeInt,p=e.Component},function(e){m=e.TeamMember},function(e){v=e.Character},function(e){S=e.Attribute},function(e){k=e.EventManager},function(e){g=e.CardMover},function(e){b=e.Adventure,C=e.AdventureSkill},function(e){w=e.SkillProficiency},function(e){_=e.warriorFeatures},function(e){A=e.CopingSkillCheck}],execute:function(){var y,I,x,E,M,q,P,B,R,D,W;l._RF.push({},"82acfU+CGFNcJsOleMa9nq0","CharacterInfo",void 0);var T=c.ccclass,N=c.property;e("CharacterInfo",(y=T("CharacterInfo"),I=N(m),x=N(h),E=N(u),M=N(A),y((B=i((P=function(e){function i(){for(var i,t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return i=e.call.apply(e,[this].concat(a))||this,n(i,"member",B,r(i)),n(i,"characterInfoPos",R,r(i)),n(i,"abilitiesInfoText",D,r(i)),n(i,"copingSkillCheck",W,r(i)),i._character=null,i._proficiencyAbilities=null,i._combatCardDeck=[],i._combatSkills=[],i.weapons=[],i.armor=null,i.shield=null,i.eventBus=null,i.shielded=!1,i._adventureSkills={},i}t(i,e);var l=i.prototype;return l.onLoad=function(){k.instance.on("CharacterEquipWeapon",this.onEquipWeapon.bind(this)),k.instance.on("CharacterEquipArmor",this.onEquipArmor.bind(this)),k.instance.on("CharacterEquipShield",this.onEquipShield.bind(this)),k.instance.on("CharacterUnequip",this.onUnequip.bind(this)),k.instance.on("ResultBattle",this.onResultBattle.bind(this)),k.instance.on("CopingSkillButtonClicked",this.onCopingSkillButtonClicked.bind(this))},l.onDestroy=function(){k.instance.off("CharacterEquipWeapon",this.onEquipWeapon),k.instance.off("CharacterEquipArmor",this.onEquipArmor),k.instance.off("CharacterEquipShield",this.onEquipShield),k.instance.off("CharacterUnequip",this.onUnequip),k.instance.off("ResultBattle",this.onResultBattle),k.instance.off("CopingSkillButtonClicked",this.onCopingSkillButtonClicked)},l.start=function(){this.node.position=d.ZERO},l.sample=function(){var e,i=((e={})[S.Strength]=15,e[S.Dexterity]=14,e[S.Intelligence]=13,e[S.Wisdom]=12,e[S.Charisma]=10,e[S.Resilience]=8,e);this._character=new v("warrior",1,i,_)},l.init=function(){var e,i;this._adventureSkills=((e={})[b.Stunts]=new C(b.Stunts,S.Dexterity,"特技，肢體動作能演繹出超乎常人的巧妙"),e[b.Stealth]=new C(b.Stealth,S.Dexterity,"隱匿，身形藏於目標的眼光之外而被忽視"),e[b.Dexterity]=new C(b.Dexterity,S.Dexterity,"巧手，細微且冷靜地靈活運用手腕乃至手指"),e[b.Knowledge]=new C(b.Knowledge,S.Intelligence,"知識，常鑽研書中的事物而獲得深厚的學問"),e[b.Experience]=new C(b.Experience,S.Intelligence,"閱歷，長期冒險時得到的經驗與觀察力"),e[b.Nature]=new C(b.Nature,S.Intelligence,"自然，遵循萬物平衡真理而存留下的軌跡"),e[b.Religion]=new C(b.Religion,S.Intelligence,"宗教，從信仰的神明到儀式的文化有所認識"),e[b.Explore]=new C(b.Explore,S.Intelligence,"探索，從調查細節乃搜索區域而得到訊息"),e[b.Nursing]=new C(b.Nursing,S.Wisdom,"護理，發現生理結構的徴結而掌握的救護"),e[b.Awareness]=new C(b.Awareness,S.Wisdom,"覺察，藉由察顏觀色而獲得行動先機"),e[b.Taming]=new C(b.Taming,S.Wisdom,"馴服，理解並能受到動物的認同而接受指令"),e[b.Survival]=new C(b.Survival,S.Wisdom,"生存，在野外生存或遭受意外的判斷與技巧"),e[b.Observation]=new C(b.Observation,S.Wisdom,"觀察，敏銳抓出細節差異或感受違和的發展"),e[b.Performance]=new C(b.Performance,S.Charisma,"表演，將肢體化為語言來傳達的藝術表現"),e[b.Persuasion]=new C(b.Persuasion,S.Charisma,"說服，藉由靈活的口才令聞者動搖心智"),e[b.Intimidation]=new C(b.Intimidation,S.Charisma,"威嚇，以言語或動作表情傳達出脅迫之意"),e[b.Shove]=new C(b.Shove,S.Strength,"推撞，以自身的力量推撞對手而使其退開"),e),null==(i=this.copingSkillCheck)||i.init(this._adventureSkills)},l.refreshCharacterInfo=function(){this.init(),this.member.characterInitial(this._character),this.member.disableSelect(),this._proficiencyAbilities=this._character.calculateProficienciesBonus();var e=this._character.calculateProficienciesBonus(),i=this._character.calculateCompositeAbilities(),t=this._character.abilities,n=t.strength,r=t.dexterity,a=t.intelligence,s=t.wisdom,o=t.charisma,l=t.resilience;this.abilitiesInfoText.string="姓名: "+this._character.name+"\n等級: "+this._character.level+"\n力量: "+n+"(+"+e.strength+")\n敏捷: "+r+"(+"+e.dexterity+")\n智力: "+a+"(+"+e.intelligence+")\n睿知: "+s+"(+"+e.wisdom+")\n魅力: "+o+"(+"+e.charisma+")\n韌性: "+l+"(+"+e.resilience+")\n體質: "+i.constitution+"\n精神: "+i.spirit+"\n意志: "+i.willpower+"\n"+this._adventureSkills[b.Stunts].description+" | +"+this.getAdventureSkillModifier(b.Stunts)+"\n"+this._adventureSkills[b.Stealth].description+" | +"+this.getAdventureSkillModifier(b.Stealth)+"\n"+this._adventureSkills[b.Dexterity].description+" | +"+this.getAdventureSkillModifier(b.Dexterity)+"\n"+this._adventureSkills[b.Knowledge].description+" | +"+this.getAdventureSkillModifier(b.Knowledge)+"\n"+this._adventureSkills[b.Experience].description+" | +"+this.getAdventureSkillModifier(b.Experience)+"\n"+this._adventureSkills[b.Nature].description+" | +"+this.getAdventureSkillModifier(b.Nature)+"\n"+this._adventureSkills[b.Religion].description+" | +"+this.getAdventureSkillModifier(b.Religion)+"\n"+this._adventureSkills[b.Explore].description+" | +"+this.getAdventureSkillModifier(b.Explore)+"\n"+this._adventureSkills[b.Nursing].description+" | +"+this.getAdventureSkillModifier(b.Nursing)+"\n"+this._adventureSkills[b.Awareness].description+" | +"+this.getAdventureSkillModifier(b.Awareness)+"\n"+this._adventureSkills[b.Taming].description+" | +"+this.getAdventureSkillModifier(b.Taming)+"\n"+this._adventureSkills[b.Survival].description+" | +"+this.getAdventureSkillModifier(b.Survival)+"\n"+this._adventureSkills[b.Observation].description+" | +"+this.getAdventureSkillModifier(b.Observation)+"\n"+this._adventureSkills[b.Performance].description+" | +"+this.getAdventureSkillModifier(b.Performance)+"\n"+this._adventureSkills[b.Persuasion].description+" | +"+this.getAdventureSkillModifier(b.Persuasion)+"\n"+this._adventureSkills[b.Intimidation].description+" | +"+this.getAdventureSkillModifier(b.Intimidation)+"\n"},l.upgradeAdventureSkill=function(e){var i;return!(null==(i=this._adventureSkills[e])||!i.upgradeSkillProficiency())},l.getAdventureSkillModifier=function(e){var i=this._adventureSkills[e],t=i.level,n=i.linkedAttribute,r=this._character.calculateAbilityScoreModifier(n);switch(t){case w.Proficient:r+=this._character.calculateClassProficiencyBonus();break;case w.Expert:r+=2*this._character.calculateClassProficiencyBonus()}return r},l.onCopingSkillButtonClicked=function(e){var i=e.name,t=e.coping,n=this.getAdventureSkillModifier(i),r=f(1,20);this.copingSkillCheck.performCheck(r,n,i,t)},l.performAdventureSkillCheck=function(e){var i=this.getAdventureSkillModifier(e);return f(1,20)+i},l.rollInitiativeOrder=function(){this.member.rollInitiativeOrder(this._proficiencyAbilities.dexterity)},l.addCombatCard=function(e){this._combatCardDeck.push(e)},l.getCombatCards=function(){return this._combatCardDeck},l.onEquipWeapon=function(e){var i=e.index,t=e.item;console.log("onEquipWeapon",i,t);var n=this._character.primaryAttribute,r=this._proficiencyAbilities[n];this.member.setWeapon(i,t,r),this.member.showCharacterInfo(),this.weapons[i]=t},l.onEquipArmor=function(e){var i=e.index,t=e.item;this.member.setArmor(i,t),this.member.showCharacterInfo(),this.armor=t},l.onEquipShield=function(e){var i=e.index,t=e.item;this.member.setShield(i,t),this.member.showCharacterInfo(),this.shield=t},l.onUnequip=function(e){var i=e.index;console.log("onCharacterUnequip",i),this.member.setWeapon(i,null),this.member.showCharacterInfo(),this.weapons[i]=null},l.refreshItemInfo=function(){var e=this;this.weapons.forEach((function(i,t){var n=e._character.primaryAttribute,r=e._proficiencyAbilities[n];e.member.setWeapon(t,i,r),e.member.showCharacterInfo()})),this.armor&&this.member.setArmor(0,this.armor),this.shield&&this.member.setShield(0,this.shield)},l.onResultBattle=function(){var e=s(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.moveCard(this.member.node,this.characterInfoPos,new d(0,0,0));case 2:this.member.leaveCombatTeam();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a(i,[{key:"character",get:function(){return this._character},set:function(e){this._character=e,this.member.characterInitial(e),this.refreshCharacterInfo()}}]),i}(p)).prototype,"member",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=i(P.prototype,"characterInfoPos",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=i(P.prototype,"abilitiesInfoText",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=i(P.prototype,"copingSkillCheck",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=P))||q));l._RF.pop()}}}));

System.register("chunks:///_virtual/ClassFeatureImplementation.ts",["cc","./Ability.ts","./Armor.ts","./Weapon.ts"],(function(e){var i,r,a,t;return{setters:[function(e){i=e.cclegacy},function(e){r=e.Attribute},function(e){a=e.ArmorStyle},function(e){t=e.WeaponStyle}],execute:function(){i._RF.push({},"390f3OgRrNHhbeJPh79FV1O","ClassFeatureImplementation",void 0);var o=[a.Padded,a.Leather,a.StuddedLeather],n=[a.Hide,a.ChainShirt,a.ScaleMail,a.Breastplate,a.HalfPlate],s=[a.RingMail,a.ChainMail,a.Splint,a.Plate],l=[t.Club,t.Dagger,t.Greatclub,t.Handaxe,t.Javelin,t.LightHammer,t.Mace,t.Quarterstaff,t.Sickle,t.Spear,t.LightCrossbow,t.Dart,t.Shortbow,t.Sling],c=[t.Battleaxe,t.Flail,t.Glaive,t.Greataxe,t.Greatsword,t.Halberd,t.Lance,t.Longsword,t.Maul,t.Morningstar,t.Pike,t.Rapier,t.Scimitar,t.ShortSword,t.Trident,t.WarPick,t.Warhammer,t.Whip,t.Blowgun,t.HandCrossbow,t.HeavyCrossbow,t.Longbow,t.Net],h=e("ClassFeatureImplementation",(function(e,i,r,h,u){var m=this;this.primaryAttribute=null,this.savingThrowProficiencies=[],this.armorProficiencies=[],this.weaponProficiencies=[],this.additionalFeatures=[],this.primaryAttribute=e,this.savingThrowProficiencies=i,r.forEach((function(e){e===a.AllLightArmors?m.armorProficiencies.concat(o):e===a.AllMediumArmors?m.armorProficiencies.concat(n):e===a.AllHeavyArmors?m.armorProficiencies.concat(s):m.armorProficiencies.push(e)})),h.forEach((function(e){e===t.AllSimpleWeapons?m.weaponProficiencies=m.weaponProficiencies.concat(l):e===t.AllMartialWeapons?m.weaponProficiencies=m.weaponProficiencies.concat(c):m.weaponProficiencies.push(e)})),this.additionalFeatures=u}));e("warriorFeatures",new h(r.Strength,[r.Strength,r.Resilience],[a.AllLightArmors,a.AllMediumArmors,a.AllHeavyArmors],[t.AllSimpleWeapons,t.AllMartialWeapons],["Combat versatility","Second wind"])),e("rogueFeatures",new h(r.Dexterity,[r.Dexterity,r.Intelligence],[a.AllLightArmors],[t.AllSimpleWeapons,t.HandCrossbow,t.Longsword,t.ShortSword,t.Rapier],["Expertise","Sneak attack","Thieves' cant"]));i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatArmor.ts",["cc"],(function(s){var t;return{setters:[function(s){t=s.cclegacy}],execute:function(){t._RF.push({},"f8fbbhTLSdFFInIexPelVQ6","CombatArmor",void 0);s("CombatArmor",function(){function s(s,t,r){this.name=void 0,this.dexterity=void 0,this.shielded=!1,this.armorClass=void 0,this.armorDefault=null,this.isLightArmor=!1,this.isCasterArmor=!1,this.name=s||"無裝甲",this.dexterity=t,this.armorDefault=r,this.armorClass=r.calculateArmorClass(this.dexterity),console.log("this.dexterity:",this.dexterity),console.log("this.armorClass:",this.armorClass)}var t=s.prototype;return t.dress=function(s){this.armorClass=0,s?(this.armorClass=s.calculateArmorClass(this.dexterity),this.isCasterArmor="Light"===s.armorType,this.isCasterArmor||"Medium"===s.armorType?this.isLightArmor=!0:(this.isCasterArmor=!1,this.isLightArmor=!1)):(this.name="無裝甲",this.armorClass=this.armorDefault.calculateArmorClass(this.dexterity),this.isLightArmor=!0),console.log("this.dexterity:",this.dexterity),console.log("this.armorClass:",this.armorClass),console.log("this.isLightArmor:",this.isLightArmor),console.log("this.isCasterArmor:",this.isCasterArmor)},t.shield=function(s){this.shielded=s},s}());t._RF.pop()}}}));

System.register("chunks:///_virtual/CombatCharacter.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatEntity.ts"],(function(t){var o,e,a;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy},function(t){a=t.CombatEntity}],execute:function(){e._RF.push({},"54634mJR51DG5Lnnb/s3y99","CombatCharacter",void 0);t("CombatCharacter",function(t){function e(o,e,a,n,i){var s;return(s=t.call(this,o,e,a.dexterity,i)||this).proficiencyBonus=void 0,s.proficiencyBonus=a,s.weaponProficiencies=n,s}o(e,t);var a=e.prototype;return a.hit=function(){return this.attackHitRoll=this.rollHit(0),this.attackHitRoll},a.advantageHit=function(){var t=[this.rollHit(0),this.rollHit(0)];return this.attackHitRoll=t.sort((function(t,o){return o.roll-t.roll}))[0],t},a.disadvantageHit=function(){var t=[this.rollHit(0),this.rollHit(0)];return this.attackHitRoll=t.sort((function(t,o){return t.roll-o.roll}))[0],t},a.attack=function(t,o){var e=!1;this.bonusHitRolls.length=0,this.extraHitRolls.length=0,this.totalDamageRolls.length=0,console.log("combatWeapons:",this.combatWeapons);var a=this.combatWeapons[o],n=this.attackHitRoll;if(this.weaponProficiencyBonus=a.weaponProficiency,this.bonusHitRolls=a.hitBonus.slice(),this.extraHitRolls=a.hitExtraBonus.slice(),a.resultHitBonus(),a.hitCheck(n.roll,t.ac)){var i=a.damage,s=this.rollDamage(i);n.isFull&&(console.log("滿骰傷害值"),s+=this.rollDamage(i)),this.totalDamageRolls=[s],console.log("主手武器基本傷害:",s),this.totalDamageRolls=this.totalDamageRolls.concat(a.damageExtraBonus,a.damageBonus),t.receiveAttack(this.totalDamageRolls.reduce((function(t,o){return t+o}),0)),t.affixEffects.stun=a.stunEffect,t.affixEffects.stun>0&&t.intentContents.push("(暈眩)"),e=!0}return a.resetCombatBonus(),e||t.receiveAttack(0),e},a.counterattack=function(t){var o=this.counterattackDamageValue+this.dodgeCounterattackDamageValue;return console.log("反擊",t.name,o),t.receiveAttack(o),o>0},a.intent=function(t){var o=this,e=this.combatIntent.getModifiers();return console.log("modifiers:",e),e.forEach((function(e){var a=o.getApplicableWeapon(e);if(a){var n=o.rollDice(e.bonus);o.applyModifier(a,e.attribute,n)}var i=e.conditions,s=o.combatArmor,r=(s.isCasterArmor,s.isLightArmor);if(i.includes("Defense")){if(i.includes("LightArmor")&&!r)return void console.log("穿重甲時無法使身法靈活");o.temporaryArmor+=parseInt(e.bonus,10),t.acLabel.string="AC(+"+o.temporaryArmor+"): "+o.ac}i.includes("Hitpoints")&&(o.tempHP+=parseInt(e.bonus,10)),e.conditions.includes("Advantage")&&(o.isAdvantage=!0)})),this.combatWeapons[0].showAttackParams(),this.combatWeapons[1].showAttackParams(),this.combatIntent},a.getApplicableWeapon=function(t){var o=t.conditions;return this.actionPoints.Bonus>0&&o.includes("OffHand")&&this.checkWeaponConditions(o,this.combatWeapons[1])?this.combatWeapons[1]:this.actionPoints.Action>0&&this.checkWeaponConditions(o,this.combatWeapons[0])?this.combatWeapons[0]:(this.combatArmor.shielded&&console.log("是盾牌武器喔!!!!!!"),console.log("沒有武器適用條件"),null)},a.checkWeaponConditions=function(t,o){var e=o.range,a=o.damage,n=o.properties,i=o.weaponProficiency,s=this.combatArmor,r=s.isCasterArmor,c=s.isLightArmor,l=t.every((function(t){return a.type==t||(e==t||(!!n.some((function(o){return o==t}))||(i[t]>0||(!(!c||"LightArmor"!=t)||!(!r||"CasterArmor"!=t)))))}));return console.log("--- "+t+" Result: "+l),l},a.applyModifier=function(t,o,e){switch(console.log("Applying "+o+" bonus of "+e+" to "+t.name),o){case"HitBonus":t.hitBonusAdd(e);break;case"HitExtra":t.hitExtraAdd(e);break;case"DamageBonus":t.damageAdd(e);break;case"DamageExtra":t.extraDamageAdd(e);break;case"Stun":t.stunEffectAdd(e)}},a.reaction=function(){var t=this,o=!1,e=this.combatIntent.getReactionIntent();console.log("reactionModifiers length:",e.length);var a=this.combatArmor,n=(a.isCasterArmor,a.isLightArmor);return e.forEach((function(e){var a=e.conditions;if(a.includes("UnderDamage"))t.counterattackDamageValue=t.rollDice(e.bonus),console.log("反擊效果: 反擊傷害值: "+t.counterattackDamageValue),o=!0;else if(a.includes("Dodge")){if(a.includes("LightArmor")&&!n)return void console.log("穿重甲時無法閃避反擊");t.dodgeCounterattackDamageValue=t.rollDice(e.bonus),console.log("閃避後反擊效果: 反擊傷害值: "+t.dodgeCounterattackDamageValue),o=!0}else if(a.includes("Defense")){if(a.includes("LightArmor")&&!n)return void console.log("穿重甲時無法使身法靈活");o=!0}})),o},e}(a));e._RF.pop()}}}));

System.register("chunks:///_virtual/CombatController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatFormation.ts","./CombatVisualizer.ts","./EventManager.ts","./EventSystem.ts","./CombatOption.ts","./TipText.ts","./EnemySkill.ts","./UIManager.ts"],(function(t){var e,n,i,o,a,r,c,s,m,u,l,h,b,f,d,C,v,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.asyncToGenerator,r=t.regeneratorRuntime},function(t){c=t.cclegacy,s=t._decorator,m=t.Button,u=t.Component},function(t){l=t.CombatFormation},function(t){h=t.CombatVisualizer},function(t){b=t.EventManager},function(t){f=t.EventBus},function(t){d=t.CombatOption},function(t){C=t.TipType},function(t){v=t.EnemySkill},function(t){p=t.UIEvent}],execute:function(){var S,F,g,y,E,I,_,M,O,w,x;c._RF.push({},"61afb+V25xNe6d0eOXfpZsI","CombatController",void 0);var z=s.ccclass,k=s.property,T=t("CombatControllerEvent",function(t){return t.InitiativeOrder="combat_controller_event_initative_order",t.SelectCharacter="combat_controller_event_select_character",t.SelectMonster="combat_controller_event_select_monster",t.EndCombat="combat_controller_event_end_combat",t.ChoiceCard="combat_controller_event_choice_card",t}({}));t("CombatController",(S=z("CombatController"),F=k(l),g=k(h),y=k(d),E=k(m),S((M=e((_=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,i(e,"combatFormations",M,o(e)),i(e,"combatVisualizer",O,o(e)),i(e,"combatOption",w,o(e)),i(e,"attackButton",x,o(e)),e.eventBus=null,e.combatQueue=[],e.initiativeIndex=0,e.mainCharacter=null,e.currentAttacker=null,e.currentDefenders=[],e}n(e,t);var c=e.prototype;return c.onLoad=function(){b.instance.on(T.InitiativeOrder,this.onInitiativeOrder.bind(this)),b.instance.on(T.SelectCharacter,this.onSelectCharacter.bind(this)),b.instance.on(T.SelectMonster,this.onSelectMonster.bind(this)),b.instance.on(T.EndCombat,this.onEndCombat.bind(this)),b.instance.on("SubmitSelectedCards",this.onSubmitSelectedCards.bind(this)),this.eventBus=new f},c.onDestroy=function(){b.instance.off(T.InitiativeOrder,this.onInitiativeOrder),b.instance.off(T.SelectCharacter,this.onSelectCharacter),b.instance.off(T.SelectMonster,this.onSelectMonster),b.instance.off(T.EndCombat,this.onEndCombat),b.instance.off("SubmitSelectedCards",this.onSubmitSelectedCards)},c.joinCombat=function(t,e,n){console.log("joinCombat",t,e,n);var i=this.combatFormations[t];0===n?i.addFrontMemeber(e):i.addBackMember(e),0===n&&e.showCharacterInfo()},c.leaveCombat=function(t,e){this.combatFormations[t].removeMember(e)},c.startCombat=function(){var t=a(r().mark((function t(){var e,n,i;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.combatVisualizer.node.active=!0,e=this.combatFormations[0].fighters,n=this.combatFormations[1].fighters,i=0===this.currentAttacker.camp?1:-1,console.log("第一次"),t.next=7,this.combatVisualizer.showCombat(e,n,i,0);case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),c.combatRound=function(){this.attackButton.node.active=!1;var t=this.combatQueue[this.initiativeIndex];if(null!=t){if(this.currentAttacker=t,t===this.mainCharacter)b.instance.emit(C.Normal,"玩家回合"),this.combatFormations[0].pushFighter(t),this.onSelectCharacter(t);else{if(b.instance.emit(C.Normal,"怪物回合"),t.roundOver(),0===t.camp){var e=this.combatFormations[1].teamMembers[0][0];this.combatFormations[0].pushFighter(t),this.combatFormations[1].pushFighter(e),this.onEnemyExecuteIntent(t,e)}else{var n=this.combatFormations[0].teamMembers[0][0];this.combatFormations[0].pushFighter(n),this.combatFormations[1].pushFighter(t),this.onEnemyExecuteIntent(t,n)}this.scheduleOnce(this.startCombat.bind(this),1)}this.initiativeIndex=(this.initiativeIndex+1)%this.combatQueue.length}else console.error("Combat queue is empty",this.initiativeIndex)},c.onEnemyExecuteIntent=function(t,e){var n=new v("monsterkill","怪物技能",1,this.eventBus).getSkill1();console.log("playCard",n),t.combatCardsToIntent(n.sort((function(){return Math.random()-.5})).slice(0,2)),t.intent(),t.showIntent()},c.onEndCombat=function(){this.combatVisualizer.node.active=!1,this.onUpdateFormation(!0),this.endCombat()},c.endCombat=function(){var t=-1;this.combatFormations.forEach((function(e,n){e.isAllDead()&&(t=n)})),-1===t?this.combatRound():(b.instance.emit("ResultBattle"),0===t?b.instance.emit(C.Normal,"<color=#ff0000>失敗！<br/>玩家陣亡</color>"):(b.instance.emit(C.Normal,"<color=#00ff00>勝利！<br/>敵隊陣亡，請選擇一張卡牌加入你的牌庫</color>"),b.instance.emit("ChoiceCard")),this.combatFormations.forEach((function(t){return t.clear()}))),this.combatVisualizer.closeHitTips()},c.onUpdateFormation=function(t){void 0===t&&(t=!0),this.combatFormations.forEach((function(e){return e.rearrangeMembers(t)}))},c.onInitiativeOrder=function(t){var e=this;b.instance.emit(p.InventoryShowUI,!1);var n=t.mainCharacter,i=t.team,o=i[0],a=i[1];this.mainCharacter=n,this.combatOption.init(this.eventBus,n),o.sort((function(t,e){return t.initiative-e.initiative})).forEach((function(t,n){t.joinCombatTeam(),t.disableSelect(),e.joinCombat(0,t,n)})),a.sort((function(t,e){return t.initiative-e.initiative})).forEach((function(t,n){t.joinCombatTeam(),t.disableSelect(),e.joinCombat(1,t,n)})),this.combatQueue=[].concat(o,a).sort((function(t,e){return e.initiative-t.initiative})),this.initiativeIndex=0,this.combatRound()},c.onSelectCharacter=function(t){var e=this;this.scheduleOnce((function(){e.combatOption.show(t)}),1.5)},c.onCharacterSelected=function(){this.combatFormations[1].updateTeamStatus()},c.onSelectMonster=function(t){this.combatFormations[1].pushFighter(t),this.startCombat()},c.onSubmitSelectedCards=function(){this.mainCharacter.joinCombatTeam(),this.onUpdateFormation(!1),this.combatOption.close();var t=this.combatFormations[1],e=t.teamMembers.flat(1);1===e.length?this.onSelectMonster(e[0]):t.updateTeamStatus()},e}(u)).prototype,"combatFormations",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),O=e(_.prototype,"combatVisualizer",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(_.prototype,"combatOption",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(_.prototype,"attackButton",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=_))||I));c._RF.pop()}}}));

System.register("chunks:///_virtual/CombatEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Armor.ts","./Weapon.ts","./CombatArmor.ts","./CombatIntent.ts","./CombatWeapon.ts"],(function(t){var i,n,e,o,a,s,r,l,h;return{setters:[function(t){i=t.createClass},function(t){n=t.cclegacy,e=t.randomRangeInt},function(t){o=t.Armor},function(t){a=t.Weapon,s=t.WeaponStyle},function(t){r=t.CombatArmor},function(t){l=t.CombatIntent},function(t){h=t.CombatWeapon}],execute:function(){n._RF.push({},"4e13fNneedFd5X9ywtAW5KB","CombatEntity",void 0);t("CombatEntity",function(){function t(t,i,n,e){this.name=void 0,this.hitPoints=void 0,this.sanityPoints=void 0,this.moralePoints=void 0,this.isDead=!1,this.actionPoints=void 0,this.combatWeapons=[],this.combatArmor=null,this.affixEffects=void 0,this.naturalWeapon=void 0,this.attackHitRoll=void 0,this.hitCriticalPoint=20,this.weaponProficiencyBonus=0,this.weaponProficiencies=[],this.bonusHitRolls=[],this.extraHitRolls=[],this.totalDamageRolls=[],this.underAttackDamageValue=0,this.isAdvantage=!1,this.combatIntent=void 0,this.dodgeCounterattackDamageValue=0,this.counterattackDamageValue=0,this.intentContents=[],this.temporaryArmor=0,this.tempHP=0,this.name=t,this.hitPoints=i.constitution,this.sanityPoints=i.spirit,this.moralePoints=i.willpower,this.combatArmor=new r("",n,new o("","","0 gold",1,0,0,"None","Light")),this.naturalWeapon=e?{name:"天生武器",damage:e,range:"Melee"}:{name:"拳擊",damage:{dice:"1d4",type:"Unarmed"},range:"Melee"},this.unequipWeapon(),this.combatIntent=new l,this.resetBonuses()}var n=t.prototype;return n.applyEffect=function(t,i){void 0!==this.affixEffects[t]&&(this.affixEffects[t]+=i,console.log(this.name+"'s "+t+" changed by "+i+". Now: "+this.affixEffects[t]))},n.receiveAttack=function(t){this.underAttackDamageValue=t,console.log(this.name+" received "+t+" damage and now has "+this.hitPoints+" hit points.")},n.resultDamage=function(){var t=this.underAttackDamageValue;return this.underAttackDamageValue=0,0===t?0:(this.hitPoints-=t-this.tempHP,console.log("傷害執行完成 HP:",this.hitPoints,"(-",t,")"),this.isDead=this.hitPoints<=0,this.isDead&&console.log(this.name+" is dead."),t)},n.roll=function(t,i){return void 0===i&&(i=0),e(1,t)+i},n.rollHit=function(t){var i;return i=this.affixEffects.blind?this.rollHitWithDisadvantage():this.roll(20),console.log(this.name+" hit "+i+" + "+t),{roll:i+t,isFull:i>=this.hitCriticalPoint}},n.rollHitWithAdvantage=function(){return Math.max(this.roll(20),this.roll(20))},n.rollHitWithDisadvantage=function(){return Math.min(this.roll(20),this.roll(20))},n.rollDamage=function(t){return this.rollDice(t.dice)},n.rollDice=function(t){if(console.log(this.name+" rolled "+t),0===t.indexOf("-"))return parseInt(t,10);var i,n=t.split("+");if(""===n[0])return parseInt(n[1],10);i=2===n.length?n[0].split("d"):t.split("d");for(var o=parseInt(i[0],10),a=parseInt(i[1],10),s=0,r=0;r<o;r++)s+=e(1,a);return n.length>1&&(s+=parseInt(n[1],10)),s},n.resetBonuses=function(){this.affixEffects={hitBonus:0,damageBonus:0,poison:0,bleeding:0,frenzy:0,stun:0,blind:0,paralyze:0,confusion:0},this.actionPoints={Move:1,Reaction:1,Action:1,Bonus:1}},n.equipWeapon=function(t,i,n){var e=new h(i,n);this.combatWeapons[t]=e},n.unequipWeapon=function(t){var i=new a(this.naturalWeapon.name,"0 gold",0,s.Unarmed,"",this.naturalWeapon.damage,[],this.naturalWeapon.range);if(void 0===t)return this.combatWeapons=[new h(i),new h(i)],void console.log(this.name+" has unequipped all weapons.");t<this.combatWeapons.length?(console.log(this.name+" has unequipped "+this.combatWeapons[t].name+"."),this.combatWeapons[t]=new h(i)):console.log("Invalid weapon index.")},n.equipArmor=function(t){this.combatArmor.dress(t)},n.unequipArmor=function(){this.combatArmor.dress(null)},n.equipShield=function(t){this.combatArmor.shield(!0)},n.unequipShield=function(){this.combatArmor.shield(!1)},i(t,[{key:"ac",get:function(){var t=this.combatArmor.shielded?2:0;return console.log("shieldArmor:",t),this.combatArmor.armorClass+t+this.temporaryArmor}}]),t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/CombatFormation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,o,i,a,s,c,m,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,s=e.Prefab,c=e.Node,m=e.Vec3,f=e.Component}],execute:function(){var h,u,d,b,l,p,w,M,v,x,R;i._RF.push({},"7f9f64EH6dO3L/eG9tWsVmH","CombatFormation",void 0);var g=a.ccclass,I=a.property;e("CombatFormation",(h=g("CombatFormation"),u=I(s),d=I(c),b=I(c),h((w=t((p=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,r(t,"characterPrefab",w,o(t)),r(t,"frontRoot",M,o(t)),r(t,"backRoot",v,o(t)),r(t,"distanceBetweenRows",x,o(t)),r(t,"distanceBetweenMembers",R,o(t)),t.frontRow=[],t.backRow=[],t.teamMembers=[[],[]],t.fighters=[],t}n(t,e);var i=t.prototype;return i.onLoad=function(){this.frontRow=this.frontRoot.children,this.backRow=this.backRoot.children},i.addFrontMemeber=function(e){var t=this,n=this.teamMembers[0];n.push(e),n.forEach((function(e,n){e.teamIndex=n,e.node.parent=t.frontRow[n],e.node.setPosition(new m(0,0,0))}))},i.addBackMember=function(e){var t=this,n=this.frontRow.length,r=this.teamMembers[1];r.unshift(e),r.forEach((function(e,r){e.teamIndex=r+n,e.node.parent=t.backRow[r],e.node.setPosition(new m(0,0,0))}))},i.addMember=function(e){e.teamIndex<0?this.addFrontMemeber(e):e.teamIndex>=0&&this.addBackMember(e)},i.removeFrontMember=function(e){this.teamMembers[0].splice(this.teamMembers[0].indexOf(e),1)},i.removeBackMember=function(e){this.teamMembers[1].splice(this.teamMembers[1].indexOf(e),1)},i.removeMember=function(e){e.teamIndex<this.frontRow.length?this.removeFrontMember(e):this.removeBackMember(e)},i.moveFrontMember=function(e,t){var n=this,r=this.frontRow.length,o=e.teamIndex;if(o>=r)return this.removeBackMember(e),void this.addFrontMemeber(e);var i=this.teamMembers[0];o+t<=0?e.teamIndex=0:e.teamIndex+=t;var a=i[e.teamIndex];a&&(a.teamIndex+=.1*Math.sign(t)),i.sort((function(e,t){return e.teamIndex-t.teamIndex})),i.forEach((function(e,t){e.teamIndex=t,e.node.parent=n.frontRow[t],e.node.setPosition(new m(0,0,0))}))},i.moveBackMember=function(e,t){var n=this,r=this.frontRow.length,o=e.teamIndex;if(o<r)return this.removeFrontMember(e),void this.addBackMember(e);var i=this.teamMembers[1];o+t<=r?e.teamIndex=r:e.teamIndex+=t;var a=i[e.teamIndex];a&&(a.teamIndex+=.1*Math.sign(t)),i.sort((function(e,t){return e.teamIndex-t.teamIndex})),i.forEach((function(e,t){e.teamIndex=t+r,e.node.parent=n.backRow[t],e.node.setPosition(new m(0,0,0))}))},i.updateTeamStatus=function(){this.teamMembers.forEach((function(e){e.forEach((function(e){e.enableSelect()}))}))},i.pushFighter=function(e){this.fighters.push(e)},i.rearrangeMembers=function(e){var t=this,n=this.frontRow.length;this.fighters.forEach((function(e){e.teamIndex<n?e.node.parent=t.frontRow[e.teamIndex]:e.node.parent=t.backRow[e.teamIndex-n],e.endFight(),e.node.setPosition(new m(0,0,0))})),e&&(this.fighters.length=0)},i.isAllDead=function(){return this.teamMembers.every((function(e){return e.every((function(e){return e.isDead}))}))},i.clear=function(){this.backRow.forEach((function(e){return e.removeAllChildren()})),this.frontRow.forEach((function(e){return e.removeAllChildren()})),this.teamMembers=[[],[]],this.fighters.length=0},t}(f)).prototype,"characterPrefab",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(p.prototype,"frontRoot",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(p.prototype,"backRoot",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(p.prototype,"distanceBetweenRows",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),R=t(p.prototype,"distanceBetweenMembers",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),l=p))||l));i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatIntent.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"a7478VvwtVBn6bQSwOLGDnB","CombatIntent",void 0);t("CombatIntent",function(){function t(){this.modifiers=void 0,this.targetRestriction=void 0,this.reactionModifiers=[],this.modifiers=[],this.reactionModifiers=[],this.targetRestriction=null}var i=t.prototype;return i.clearIntents=function(){this.modifiers.length=0,this.reactionModifiers.length=0,this.targetRestriction=null},i.addIntent=function(t,i){return console.log("Adding intent with target type "+i+"."),null===this.targetRestriction?(this.targetRestriction=i,this.modifiers.push(t),!0):this.targetRestriction===i?(this.modifiers.push(t),!0):(console.log("Failed to add intent: target type "+i+" does not match current restriction "+this.targetRestriction+"."),!1)},i.setReactionIntent=function(t){console.log("設定反應的意圖"),this.reactionModifiers=t},i.getReactionIntent=function(){return this.reactionModifiers},i.getCurrentTargetRestriction=function(){return this.targetRestriction},i.getModifiers=function(){return this.modifiers},i.executeIntents=function(t){},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatMonster.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatEntity.ts"],(function(t){var n,e,o;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){o=t.CombatEntity}],execute:function(){e._RF.push({},"73712Al6IREEbBkckTU263x","CombatMonster",void 0);t("CombatMonster",function(t){function e(n,e,o,a,i){var s;return(s=t.call(this,n,e,o,i)||this).hitBonus=0,s.hitBonus=a,s}n(e,t);var o=e.prototype;return o.hit=function(){return this.rollHit(0)},o.advantageHit=function(){var t=[this.rollHit(0),this.rollHit(0)];return this.attackHitRoll=t.sort((function(t,n){return n.roll-t.roll}))[0],t},o.disadvantageHit=function(){var t=[this.rollHit(0),this.rollHit(0)];return this.attackHitRoll=t.sort((function(t,n){return t.roll-n.roll}))[0],t},o.attack=function(t){var n=!1;this.bonusHitRolls.length=0,this.extraHitRolls.length=0,this.totalDamageRolls.length=0;var e=this.combatWeapons[0],o=this.rollHit(0);if(this.attackHitRoll=o,console.log("combatWeapon:",this.combatWeapons),e.resultHitBonus(),this.bonusHitRolls=e.hitBonus.slice(),this.extraHitRolls=e.hitExtraBonus.slice(),e.resultHitBonus(),e.hitCheck(o.roll,t.ac)){var a=e.damage,i=this.rollDamage(a);o.isFull&&(console.log("滿骰傷害值"),i+=this.rollDamage(a)),this.totalDamageRolls=[i],console.log("主手武器基本傷害:",i),this.totalDamageRolls=this.totalDamageRolls.concat(e.damageExtraBonus,e.damageBonus),t.receiveAttack(this.totalDamageRolls.reduce((function(t,n){return t+n}),0)),n=!0}return e.resetCombatBonus(),n||(t.receiveAttack(0),console.log(this.name+" misses.")),n},o.counterattack=function(t){var n=this.counterattackDamageValue+this.dodgeCounterattackDamageValue;return console.log("反擊",t.name,n),t.receiveAttack(n),n>0},o.intent=function(t){var n=this,e=this.combatIntent.getModifiers();return console.log("modifiers:",e),e.forEach((function(e){var o=n.getApplicableWeapon(e);if(o){var a=n.rollDice(e.bonus);n.applyModifier(o,e.attribute,a)}e.conditions.includes("Defense")&&(n.temporaryArmor+=parseInt(e.bonus,10),t.acLabel.string="AC(+"+n.temporaryArmor+"): "+n.ac,n.intentContents.push("增加臨時AC: "+n.temporaryArmor)),e.conditions.includes("Hitpoints")&&(n.tempHP+=parseInt(e.bonus,10),n.intentContents.push("增加臨時HP: "+n.tempHP)),e.conditions.includes("Advantage")&&(n.isAdvantage=!0,n.intentContents.push("下一回合有優勢"))})),this.combatIntent},o.getApplicableWeapon=function(t){var n=t.conditions;return this.actionPoints.Bonus>0&&n.includes("OffHand")&&this.checkWeaponConditions(n,this.combatWeapons[1])?this.combatWeapons[1]:this.actionPoints.Action>0&&this.checkWeaponConditions(n,this.combatWeapons[0])?this.combatWeapons[0]:(this.combatArmor.shielded&&console.log("是盾牌武器喔!!!!!!"),console.log("沒有武器適用條件"),null)},o.checkWeaponConditions=function(t,n){var e=n.range,o=n.damage,a=n.properties,i=n.weaponProficiency,s=t.every((function(t){return console.log("Checking weapon condition: "+t+" - damageType: "+o.type+"("+(o.type==t)+") - "+e+"("+(e==t)+") - "+a+" ("+a.every((function(n){return n==t}))+")"),o.type==t||(e==t||(!!a.every((function(n){return n==t}))||i[t]>0))}));return console.log("Result: "+s),s},o.applyModifier=function(t,n,e){switch(console.log("Applying "+n+" bonus of "+e+" to "+t.name),n){case"HitBonus":t.hitBonusAdd(e),this.intentContents.push("增加命中: "+e);break;case"HitExtra":t.hitExtraAdd(e),this.intentContents.push("增加額外命中: "+e);break;case"DamageBonus":t.damageAdd(e),this.intentContents.push("增加傷害: "+e);break;case"DamageExtra":t.extraDamageAdd(e),this.intentContents.push("增加額外傷害: "+e)}},o.reaction=function(){var t=this,n=!1,e=this.combatIntent.getReactionIntent();return console.log("reactionModifiers length:",e.length),e.forEach((function(e){var o=e.conditions;o.includes("UnderDamage")?(t.counterattackDamageValue=t.rollDice(e.bonus),console.log("反擊效果: 反擊傷害值: "+t.counterattackDamageValue),t.intentContents.push("復仇反擊效果: 反擊傷害值: "+t.counterattackDamageValue),n=!0):o.includes("Dodge")?(t.dodgeCounterattackDamageValue=t.rollDice(e.bonus),console.log("閃避後反擊效果: 反擊傷害值: "+t.dodgeCounterattackDamageValue),t.intentContents.push("閃避後反擊效果: 反擊傷害值: "+t.dodgeCounterattackDamageValue),n=!0):o.includes("Defense")&&(n=!0)})),n},e}(o));e._RF.pop()}}}));

System.register("chunks:///_virtual/CombatOption.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CardMover.ts","./EventManager.ts","./GameEvents.ts","./CardReward.ts","./HitCheckCounter.ts","./UIManager.ts","./MeleeSkill.ts"],(function(e){var t,n,i,r,a,o,c,s,u,l,h,d,f,p,m,C,k,v,y,b,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){c=e.cclegacy,s=e._decorator,u=e.Node,l=e.randomRangeInt,h=e.Component,d=e.tween,f=e.Vec3,p=e.UIOpacity},function(e){m=e.CardMover},function(e){C=e.EventManager},function(e){k=e.DeckPileEvent},function(e){v=e.CardReward},function(e){y=e.HitCheckCounter},function(e){b=e.UIEvent},function(e){w=e.MeleeSkill}],execute:function(){var g,R,D,S,_,T,E,I,x,O,M,L,q;c._RF.push({},"6a99fkqaBFLvo9h4DAXxJT0","CombatOption",void 0);var z=s.ccclass,A=s.property;e("CombatOption",(g=z("CombatOption"),R=A(u),D=A(u),S=A(u),_=A(y),T=A(v),g((x=t((I=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"blocker",x,r(t)),i(t,"layout",O,r(t)),i(t,"hitLayout",M,r(t)),i(t,"counter",L,r(t)),i(t,"cardReward",q,r(t)),t.eventBus=null,t.myTeamCharacter=null,t.combatSkill=null,t._deck=[],t}n(t,e);var c=t.prototype;return c.onLoad=function(){C.instance.on("ExecuteIntent",this.onExecuteIntent.bind(this)),C.instance.on("ShuffleDeckRequest",this.shuffleDeckRequest.bind(this)),C.instance.on("ChoiceCard",this.onChoiceCard.bind(this)),C.instance.on("SelectedRewardCard",this.onSelectedRewardCard.bind(this))},c.onDestroy=function(){C.instance.off("ExecuteIntent",this.onExecuteIntent),C.instance.off("ShuffleDeckRequest",this.shuffleDeckRequest),C.instance.off("ChoiceCard",this.onChoiceCard),C.instance.off("SelectedRewardCard",this.onSelectedRewardCard)},c.start=function(){this.node.active=!1,this.combatSkill=new w(1,"近戰技能",this.eventBus),this.initDeck(1)},c.init=function(e,t){this.eventBus=e,this.myTeamCharacter=t,this.shuffleDeck(),C.instance.emit(k.ShowCards,this._deck.slice())},c.initDeck=function(e){this._deck.length=0;var t=this.combatSkill.getSkill(0);this._deck=t.slice()},c.shuffleDeckRequest=function(){this.shuffleDeck(),C.instance.emit(k.ShowCards,this._deck.slice()),this.scheduleOnce((function(){console.log("shuffleDeckRequest 後開始發牌，6張"),C.instance.emit(k.DealPlayerCards,6)}),1)},c.shuffleDeck=function(){for(var e=0;e<this._deck.length;e++){var t=l(0,e+1),n=[this._deck[t],this._deck[e]];this._deck[e]=n[0],this._deck[t]=n[1]}},c.show=function(){var e=a(o().mark((function e(t){var n,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.position=f.ZERO,this.node.active=!0,(n=this.blocker.getComponent(p)).opacity=0,e.next=6,m.moveCard(t.node,this.layout,f.ZERO);case 6:t.node.parent=this.layout,d(n).to(.25,{opacity:205},{easing:"linear"}).call((function(){if(C.instance.emit(k.DealPlayerCards,6),i.onRoundOver(),i.myTeamCharacter.isAdvantage()){var e=i.myTeamCharacter.hits("Advantage").map((function(e){return e.roll}));i.counter.node.parent=i.hitLayout,i.counter.checkType="Advantage",i.counter.count=e[0],i.counter.count=e[1]}else{var t=i.myTeamCharacter.hit();console.log("hitRoll",t),i.counter.node.parent=i.hitLayout,i.counter.count=t.roll,i.counter.counterEffect()}i.myTeamCharacter.leaveCombatTeam()})).start();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),c.close=function(){this.node.active=!1},c.onRoundOver=function(){this.myTeamCharacter.roundOver()},c.choiceCard=function(){var e=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cardReward.show(!0);case 2:t=this.combatSkill.getSkill(1),this.cardReward.init(t.sort((function(){return Math.random()-.5})).slice(0,5));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.onExecuteIntent=function(e){console.log("playCard",e),this.myTeamCharacter.combatCardsToIntent(e),this.myTeamCharacter.intent()},c.onSelectedRewardCard=function(e){var t=e;this._deck.push(t),console.log("卡片牌庫",this._deck),this.cardReward.show(!1),C.instance.emit(b.DescriptionScrollViewShowUI,!0)},c.onChoiceCard=function(){this.choiceCard()},t}(h)).prototype,"blocker",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(I.prototype,"layout",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(I.prototype,"hitLayout",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(I.prototype,"counter",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(I.prototype,"cardReward",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=I))||E));c._RF.pop()}}}));

System.register("chunks:///_virtual/CombatSkill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventSystem.ts","./Skill.ts"],(function(t){var e,i,n,f;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy},function(t){n=t.NotifyEvent},function(t){f=t.Skill}],execute:function(){i._RF.push({},"f7e8dqswFlIPpZLoBm4xBmY","CombatSkill",void 0);t("CombatSkill",function(t){function i(e,i,n,f){var l;return(l=t.call(this,e,i,n)||this).eventBus=void 0,l.eventBus=f,l}e(i,t);var f=i.prototype;return f.activateSkillEffect=function(t,e){this.eventBus.publish(new n("effectSkillApplied",{target:t,effect:e}))},f.activateAffixEffect=function(t,e){this.eventBus.publish(new n("affixEffectApplied",{target:t,effect:e}))},i}(f));i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatVisualizer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ParticleEffectComponent.ts","./TipClipsAnimation.ts","./EventManager.ts","./HitCheckCounter.ts","./CombatController.ts"],(function(e){var t,n,i,a,o,r,s,u,l,c,p,d,f,g,h,b,y,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,o=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){s=e.cclegacy,u=e._decorator,l=e.Node,c=e.Vec3,p=e.tween,d=e.Component,f=e.UIOpacity},function(e){g=e.ParticleEffectComponent},function(e){h=e.TipClipsAnimation},function(e){b=e.EventManager},function(e){y=e.HitCheckCounter},function(e){w=e.CombatControllerEvent}],execute:function(){var m,C,x,v,k,O,T,q,E,P,I,H,R,S,z;s._RF.push({},"0cdb7l2d8hPfrJX3uzWvMCY","CombatVisualizer",void 0);var A=u.ccclass,F=u.property;e("CombatVisualizer",(m=A("CombatVisualizer"),C=F(l),x=F(l),v=F(l),k=F(l),O=F(l),T=F(y),m((P=t((E=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,i(t,"blocker",P,a(t)),i(t,"layout",I,a(t)),i(t,"resultSuccessTip",H,a(t)),i(t,"resultFailTip",R,a(t)),i(t,"hitLayout",S,a(t)),i(t,"counter",z,a(t)),t}n(t,e);var s=t.prototype;return s.start=function(){this.node.position=c.ZERO,this.node.active=!1},s.delayAsync=function(){var e=o(r().mark((function e(t){var n=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.scheduleOnce((function(){e()}),t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.showCombat=function(){var e=o(r().mark((function e(t,n,i,a){var o,s,u,l,d,y,m,C,x,v,k,O,T,q,E,P,I,H,R,S,z,A=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i>0?(o=t[0],s=n[0]):(o=n[0],s=t[0]),o.startFight(),s.startFight(),this.blocker.active=!0,this.resultSuccessTip.active=!1,this.resultFailTip.active=!1,(u=this.blocker.getComponent(f)).opacity=0,p(u).to(.25,{opacity:185},{easing:"linear"}).start(),t.forEach((function(e){e.node.parent=A.layout,e.node.setPosition(new c(-200,0,0))})),n.forEach((function(e){e.node.parent=A.layout,e.node.setPosition(new c(200,0,0))})),l=o.attack(s,a),d=l.bonusHitRolls,y=l.extraHitRolls,m=l.totalDamageRolls,C=l.affixEffects,x=l.attackHitRoll,v=l.weaponProficiencyBonus,!(C.stun>0)){e.next=20;break}return console.log("要處理眩暈的特效"),C.stun--,p(o.node).to(.5,{position:new c(-220*i,0,0)},{easing:"bounceInOut"}).start(),e.next=18,new Promise((function(e){return A.scheduleOnce(e,1)}));case 18:return b.instance.emit(w.EndCombat),e.abrupt("return");case 20:if(x.isFull&&console.log("要處理爆骰的特效"),this.counter.node.parent=this.hitLayout,!(i<0)){e.next=28;break}return this.counter.checkType="Neutral",this.counter.count=x.roll,this.counter.counterEffect(),e.next=28,this.delayAsync(.25);case 28:if(!(v>0)){e.next=32;break}return this.counter.addCount(v,"武器熟練加值"),e.next=32,this.delayAsync(.5);case 32:if(!(d.length>0)){e.next=48;break}return p(o.node).to(.25,{position:c.ZERO},{easing:"quadOut"}).call((function(){var e=o.getComponentInChildren(g);null==e||e.setupEffect(),null==e||e.playEffect()})).start(),e.next=36,this.delayAsync(.25);case 36:k=0;case 37:if(!(k<d.length)){e.next=45;break}return console.log("bonusHitRolls[",k,"]:",d[k]),this.counter.addCount(d[k],"命中加值"),e.next=42,this.delayAsync(.25);case 42:k++,e.next=37;break;case 45:return e.next=47,this.delayAsync(1+.25*d.length);case 47:p(o.node).to(.15,{position:new c(-200*i,0,0)},{easing:"quadOut"}).start();case 48:O=new c(0,0,0),T=0;case 50:if(!(T<y.length)){e.next=58;break}return e.next=53,this.battle1(t[0],n[0],i,O);case 53:console.log("extraHitRolls[",T,"]:",y[T]),this.counter.addCount(y[T],"額外命中");case 55:T++,e.next=50;break;case 58:return y.length=0,e.next=61,this.delayAsync(.5);case 61:if(q=s.resultDamage(),console.log("damageResult:",q),E=s.reaction(o),P=E.dodgeCounterattackDamageValue,I=E.counterattackDamageValue,console.log("閃避反擊:",P,"復仇:",I),s.getTempHP(),!(q>0)){e.next=88;break}return this.resultSuccessTip.active=!0,p(this.resultSuccessTip).to(.25,{scale:new c(1.2,1.2,1)}).to(.25,{scale:c.ONE}).start(),H=null,console.log("totalDamageRolls:",m),m.length>0&&(R=s.getComponentInChildren(h),H=function(){return R.spreadCards(m.map((function(e){return e.toString()})))}),e.next=74,this.battleSuccess(t[0],n[0],i,O,H);case 74:return s.changeHpBar(-q),e.next=77,this.delayAsync(1.5);case 77:if(!I){e.next=86;break}return O=new c(0,0,0),S=function(){return o.getComponentInChildren(h).spreadCards([I.toString()])},e.next=82,this.battleSuccess(s,o,-i,O,S);case 82:return o.changeHpBar(-I),o.resultDamage(),e.next=86,this.delayAsync(1.5);case 86:e.next=101;break;case 88:return this.resultFailTip.active=!0,p(this.resultFailTip).to(.25,{scale:new c(1.2,1.2,1)}).to(.25,{scale:c.ONE}).start(),e.next=92,this.battleFail(t[0],n[0]);case 92:if(!P){e.next=101;break}return O=new c(0,0,0),z=function(){return o.getComponentInChildren(h).spreadCards([P.toString()])},e.next=97,this.battleSuccess(s,o,-i,O,z);case 97:return o.changeHpBar(-P),o.resultDamage(),e.next=101,this.delayAsync(1.5);case 101:return e.next=103,new Promise((function(e){return A.scheduleOnce(e,1)}));case 103:b.instance.emit(w.EndCombat);case 104:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),s.closeHitTips=function(){this.resultSuccessTip.active=!1,this.resultFailTip.active=!1},s.addHitBouns=function(e,t){return new Promise((function(t){p(e.node).to(.25,{position:c.ZERO},{easing:"quadOut"}).delay(1).to(.15,{position:new c(-200,0,0)},{easing:"quadOut"}).call((function(){t()})).start()}))},s.battle1=function(e,t,n,i){return void 0===n&&(n=1),void 0===i&&(i=new c(0,0,0)),new Promise((function(a){var o=i.clone(),r=i.clone();p(e.node).to(.25,{position:o.add(new c(-200,0,0))},{easing:"quadOut"}).delay(.05).by(.15,{position:new c(120,0,0)},{easing:"quadIn"}).by(.15,{position:o},{easing:"quadOut"}).call((function(){i.add(new c(10*n,0,0)),a()})).start(),p(t.node).to(.25,{position:r.add(new c(200,0,0))},{easing:"quadOut"}).delay(.05).by(.15,{position:new c(-120,0,0)},{easing:"quadIn"}).by(.15,{position:r},{easing:"quadOut"}).start()}))},s.battleFail=function(e,t){return new Promise((function(n){p(e.node).to(.15,{position:new c(0,0,0)},{easing:"linear"}).to(.25,{position:new c(-200,0,0)},{easing:"quadIn"}).call((function(){n()})).start(),p(t.node).to(.15,{position:new c(0,0,0)},{easing:"linear"}).to(.25,{position:new c(200,0,0)},{easing:"quadIn"}).start()}))},s.battleSuccess=function(e,t,n,i,a){return void 0===n&&(n=1),void 0===i&&(i=new c(0,0,0)),void 0===a&&(a=null),new Promise((function(o){i.clone();var r=i.clone();n>0?(p(e.node).to(.15,{position:new c(-200,0,0)},{easing:"linear"}).by(.15,{position:new c(220,0,0)},{easing:"quadIn"}).start(),p(t.node).to(.25,{position:r.add(new c(100,0,0))},{easing:"quadOut"}).parallel(p(t.node).by(.15,{position:new c(80,0,0)},{easing:"quadIn"}),p(t.node).to(.25,{angle:-45*n},{easing:"linear"})).call((function(){null==a||a()})).delay(1.25).to(.25,{angle:0},{easing:"linear"}).call((function(){o()})).start()):(p(e.node).to(.25,{position:r.add(new c(-100,0,0))},{easing:"quadOut"}).parallel(p(t.node).by(.15,{position:new c(-80,0,0)},{easing:"quadIn"}),p(t.node).to(.25,{angle:45},{easing:"linear"})).to(.25,{angle:0},{easing:"linear"}).call((function(){o()})).start(),p(t.node).to(.15,{position:new c(200,0,0)},{easing:"linear"}).by(.15,{position:new c(-220,0,0)},{easing:"quadIn"}).start())}))},t}(d)).prototype,"blocker",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(E.prototype,"layout",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(E.prototype,"resultSuccessTip",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(E.prototype,"resultFailTip",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(E.prototype,"hitLayout",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(E.prototype,"counter",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=E))||q));s._RF.pop()}}}));

System.register("chunks:///_virtual/CombatWeapon.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"93c86HlJdFEX6Ji+MXKRl1f","CombatWeapon",void 0);t("CombatWeapon",function(){function t(t,i){void 0===i&&(i=0),this.name=void 0,this.weaponProficiency=0,this.damage=void 0,this.properties=void 0,this.range=void 0,this.hitBonus=[],this.hitExtraBonus=[],this.totalHitRaise=0,this.damageBonus=[],this.damageExtraBonus=[],this.stunEffect=0,this.inBattle=!1;var s=t.name,n=t.damage,o=t.properties,e=t.range;this.name=s,this.weaponProficiency=i,this.damage=n,this.properties=o,this.range=e,this.resetCombatBonus()}var i=t.prototype;return i.resetCombatBonus=function(){this.hitBonus.length=0,this.hitExtraBonus.length=0,this.damageBonus.length=0,this.damageExtraBonus.length=0,this.stunEffect=0,this.totalHitRaise=0,this.inBattle=!1},i.hitBonusAdd=function(t){this.hitBonus.push(t),this.inBattle=!0},i.hitExtraAdd=function(t){this.hitExtraBonus.push(t),this.inBattle=!0},i.damageAdd=function(t){this.damageBonus.push(t),this.inBattle=!0},i.extraDamageAdd=function(t){this.damageExtraBonus.push(t),this.inBattle=!0},i.stunEffectAdd=function(t){this.stunEffect+=t,this.inBattle=!0},i.resultHitBonus=function(){return this.totalHitRaise=this.hitBonus.reduce((function(t,i){return t+i}),0)+this.hitExtraBonus.reduce((function(t,i){return t+i}),0),this.hitBonus.length=0,this.hitExtraBonus.length=0,this.totalHitRaise},i.hitCheck=function(t,i,s){return console.log("命中檢定: "+i+" vs "+t+" + "+this.weaponProficiency+" + "+this.totalHitRaise),i<=t+this.weaponProficiency+this.totalHitRaise},i.showAttackParams=function(){console.log("武器名稱: "+this.name),console.log("武器屬性: "+this.properties.join(", ")),console.log("武器傷害: "+JSON.stringify(this.damage)),console.log("武器射程: "+this.range.toString()),console.log("命中加值: "+this.totalHitRaise),console.log("hitExtra:",this.hitExtraBonus),console.log("hitBonus:",this.hitBonus),console.log("damageBonus:",this.damageBonus),console.log("damageExtra:",this.damageExtraBonus)},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/CommunityCards.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseCardDisplay.ts","./GameEvents.ts","./EventManager.ts","./CardMover.ts"],(function(n){var t,e,r,a,s,o,i,c,d;return{setters:[function(n){t=n.inheritsLoose,e=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){a=n.cclegacy,s=n._decorator},function(n){o=n.BaseCardDisplay},function(n){i=n.CommunityCardEvent},function(n){c=n.EventManager},function(n){d=n.CardMover}],execute:function(){var u;a._RF.push({},"90a78ICHwpA4pICKifRn8Oe","CommunityCards",void 0);var C=s.ccclass;s.property,n("default",C("CommunityCards")(u=function(n){function a(){return n.apply(this,arguments)||this}t(a,n);var s=a.prototype;return s.onLoad=function(){c.instance.on(i.DealCards,this.onDealCards.bind(this)),c.instance.on(i.ShowCards,this.onShowCards.bind(this)),c.instance.on(i.CompareCards,this.eventCompareCards.bind(this))},s.onDestroy=function(){c.instance.off(i.DealCards,this.onDealCards),c.instance.off(i.ShowCards,this.onShowCards),c.instance.off(i.CompareCards,this.eventCompareCards)},s.start=function(){this.initPositionNodes(5),this.node.active=!1},s.dealCards=function(n){this.updatePositionLayout()},s.moveDealCard=function(n,t){this.node.active=!0;return d.moveCard(t,this.cardContainer,this.positionContainer.children[n].position,.75,.15*(n+1))},s.dropCards=function(n){},s.clearCards=function(){this.cardContainer.removeAllChildren(),this.selected=[]},s.compareCards=function(n){var t=this,e=n[0];this.getCardNodes(e).forEach((function(n){t.toggleCardSelection(n)}))},s.onDealCards=function(){var n=e(r().mark((function n(t){var e;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.node.active=!0,n.next=3,this.unselectAllCards();case 3:e=t,this.dealCards(e);case 5:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),s.onShowCards=function(){var n=e(r().mark((function n(t){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.node.active=!0,n.next=3,this.unselectAllCards();case 3:this.showCards(t);case 4:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),s.eventCompareCards=function(n){this.compareCards(n)},a}(o))||u);a._RF.pop()}}}));

System.register("chunks:///_virtual/CommunityCardsTest.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ExplorationCard.ts","./EventManager.ts","./GameEvents.ts"],(function(t){var e,n,r,a,o,i,s,c,u,l,d;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose,r=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){o=t.cclegacy,i=t._decorator,s=t.Component},function(t){c=t.CardSuit},function(t){u=t.EventManager},function(t){l=t.GameLogicEvent,d=t.DeckPileEvent}],execute:function(){var h;o._RF.push({},"faad3On/mtH5KVc6qwVVcPK","CommunityCardsTest",void 0);var p=i.ccclass;i.property,t("default",p("CommunityCardsTest")(h=function(t){function o(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this)._deck=[],e}e(o,t);var i=o.prototype;return i.onLoad=function(){u.instance.on(l.GameRoundStartDealCards,this.onGameRoundStartDealCards.bind(this))},i.start=function(){this.initializeDeck(),u.instance.emit(d.ShowCards,this._deck)},i.initializeDeck=function(){for(var t=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],e=["stealth","power","wisdom","speed","luck"],r=0,a=[c.Prop,c.Clue,c.Doubt,c.Presage];r<a.length;r++)for(var o,i=a[r],s=n(t);!(o=s()).done;){for(var u=o.value,l=Math.floor(3*Math.random())+1,d=[],h=0;h<l;h++)d.push(e[Math.floor(Math.random()*e.length)]);this._deck.push({suit:i,rank:u,conditions:d})}},i.onGameRoundStartDealCards=function(){var t=r(a().mark((function t(){var e=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u.instance.emit(d.DealCommunityCards,this._deck.splice(0,5)),t.next=3,new Promise((function(t){return e.scheduleOnce(t,.5)}));case 3:u.instance.emit(d.DealPlayerCards,[this._deck.splice(0,2),this._deck.splice(0,2),this._deck.splice(0,2)]);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o}(s))||h);o._RF.pop()}}}));

System.register("chunks:///_virtual/CopingBehavior.ts",["cc"],(function(e){var i;return{setters:[function(e){i=e.cclegacy}],execute:function(){i._RF.push({},"ba66fs4FhpMLLRIOUK/YIXN","CopingBehavior",void 0);e("CopingBehavior",(function(e,i){this.behaviorName="",this.adventureName=void 0,this.linkedAttribute=void 0,this.behaviorName=e,this.adventureName=i.name,this.linkedAttribute=i.linkedAttribute}));i._RF.pop()}}}));

System.register("chunks:///_virtual/CopingSkillButton.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(n){var i,e,o,t,a,r,c,l,s,p;return{setters:[function(n){i=n.applyDecoratedDescriptor,e=n.inheritsLoose,o=n.initializerDefineProperty,t=n.assertThisInitialized,a=n.createClass},function(n){r=n.cclegacy,c=n._decorator,l=n.Label,s=n.Component},function(n){p=n.EventManager}],execute:function(){var u,h,v,g,f;r._RF.push({},"0695ao7Bt1ERrk196i3eJGK","CopingSkillButton",void 0);var C=c.ccclass,b=c.property;n("CopingSkillButton",(u=C("CopingSkillButton"),h=b(l),u((f=i((g=function(n){function i(){for(var i,e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return i=n.call.apply(n,[this].concat(a))||this,o(i,"nameLabel",f,t(i)),i._behavior=null,i._behaviorCoping=[],i}e(i,n);var r=i.prototype;return r.onLoad=function(){p.instance.on("CopingDramaBehavior",this.onCopingDramaBehavior.bind(this))},r.onDestroy=function(){p.instance.off("CopingDramaBehavior",this.onCopingDramaBehavior)},r.onCopingDramaBehavior=function(n){var i=this._behavior.adventureName,e=n.coping[i];this.dramaCoping(e)},r.dramaCoping=function(n){n&&n.length>0?(this._behaviorCoping=n,this.node.active=!0):this.node.active=!1},r.onClicked=function(){p.instance.emit("CopingSkillButtonClicked",{name:this._behavior.adventureName,coping:this._behaviorCoping})},a(i,[{key:"behavior",set:function(n){this._behavior=n,this.nameLabel.string=n.behaviorName}}]),i}(s)).prototype,"nameLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=g))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/CopingSkillCheck.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CounterComponent.ts","./EventManager.ts","./CopingSkillButton.ts","./CopingBehavior.ts","./AdventureSkill.ts","./DescriptionScrollView.ts","./FillBlanks.ts","./DescriptionCrossword.ts","./DataModal.ts"],(function(e){var t,n,i,o,r,a,s,c,l,p,u,d,h,w,f,g,v,S,b,C,k,D,y,V;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e._decorator,l=e.Node,p=e.Label,u=e.instantiate,d=e.Vec3,h=e.RichText,w=e.randomRangeInt,f=e.Component},function(e){g=e.CounterComponent},function(e){v=e.EventManager},function(e){S=e.CopingSkillButton},function(e){b=e.CopingBehavior},function(e){C=e.Adventure},function(e){k=e.DescriptionScrollView},function(e){D=e.FillBlanks},function(e){y=e.default},function(e){V=e.DataModal}],execute:function(){var m,B,L,_,E,N,x,A,z,I,P,W,M,R,T,F,K;s._RF.push({},"247caaPyyFNNI1WTnlyJBUy","CopingSkillCheck",void 0);var O=c.ccclass,Q=c.property;e("CopingSkillCheck",(m=O("CopingSkillCheck"),B=Q(g),L=Q(l),_=Q(S),E=Q(k),N=Q(p),x=Q(l),A=Q(y),m((P=t((I=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,i(t,"counter",P,o(t)),i(t,"copingLayout",W,o(t)),i(t,"copingSkillButtonPrefab",M,o(t)),i(t,"descriptionScrollView",R,o(t)),i(t,"titleLabel",T,o(t)),i(t,"responseButtonLayout",F,o(t)),i(t,"descriptionCrossword",K,o(t)),t._copingBehaviors=[],t._responseContent=[],t._keepWords=[],t.copingChance=0,t.data=void 0,t.linkid="",t}n(t,e);var s=t.prototype;return s.onLoad=function(){v.instance.on("DescriptionScrollViewEnd",this.onDescriptionScrollViewEnd.bind(this)),v.instance.on("DescriptionScrollViewAddSentence",this.onDescriptionScrollViewAddSentence.bind(this))},s.onDestroy=function(){v.instance.off("DescriptionScrollViewEnd",this.onDescriptionScrollViewEnd),v.instance.off("DescriptionScrollViewAddSentence",this.onDescriptionScrollViewAddSentence)},s.start=function(){this.counter.node.active=!1},s.setDramaData=function(e){this.data=e,this.descriptionScrollView.clear(),this._keepWords.length=0;var t=e.chance,n=e.descriptions,i=e.response;this.descriptionScrollView.node.active=!0,this.descriptionScrollView.setData(n),this.copingChance=t,this._responseContent=i},s.init=function(e){this._copingBehaviors=[new b("特技",e[C.Stunts]),new b("隱匿",e[C.Stealth]),new b("巧手",e[C.Dexterity]),new b("知識",e[C.Knowledge]),new b("閱歷",e[C.Experience]),new b("自然",e[C.Nature]),new b("宗教",e[C.Religion]),new b("探索",e[C.Explore]),new b("護理",e[C.Nursing]),new b("覺察",e[C.Awareness]),new b("馴服",e[C.Taming]),new b("生存",e[C.Survival]),new b("觀察",e[C.Observation]),new b("表演",e[C.Performance]),new b("說服",e[C.Persuasion]),new b("威嚇",e[C.Intimidation]),new b("推撞",e[C.Shove])],this.setCopingSkillButtons(this._copingBehaviors)},s.setCopingSkillButtons=function(e){var t=this.copingSkillButtonPrefab.node,n=this.copingLayout;n.removeAllChildren(),e.forEach((function(e){var i=u(t);i.parent=n,i.active=!0,i.name=e.behaviorName,i.position=d.ZERO,console.log("behavior:",e),i.getComponent(S).behavior=e})),n.active=!1},s.noChance=function(){var e=this,t=D.replaceMarkedWithKeywords(this._responseContent,this._keepWords),n=t.replacedTexts,i=t.newKeywords[0][0];console.log("tip:",i),null!=i&&i.response?this.descriptionScrollView.addNewData(this.data.behavior.response[i.response]):null!=i&&i.link?(this.descriptionScrollView.setData(n),this.descriptionScrollView.setChooseButtons([{text:i.string,callback:function(){return e.setDramaData(V.getInstance().storyData.dramas[i.link])}}])):this.closeDescriptionView()},s.performCheck=function(){var e=r(a().mark((function e(t,n,i,o){var r,s,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.counter.node.active=!0,this.counter.count=t,this.counter.counterEffect(),this.titleLabel.string=i,e.next=6,new Promise((function(e){c.scheduleOnce(e,1)}));case 6:if(this.counter.addCount(n,"技能熟練",20),r=t+n,s=o.filter((function(e){return e[0]<=r})),0!==this.copingChance){e.next=12;break}return this.noChance(),e.abrupt("return");case 12:this.copingChance--,console.log("copingList:",s),this.udpateDescriptionScrollView(s);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,i,o){return e.apply(this,arguments)}}(),s.closeDescriptionView=function(){var e=this;this.descriptionScrollView.setChooseButtons([{text:this._responseContent[0],callback:function(){e.copingLayout.active=!1,e.descriptionScrollView.close()}}])},s.udpateDescriptionScrollView=function(e){var t=this,n=this.responseButtonLayout.children;n.forEach((function(e){e.off("click"),e.active=!1})),e.forEach((function(e,i){e[0];var o=e[1],r=e[2],a=e[3];console.log("content:",o);var s=D.replaceMarkedWithKeywords([o],t._keepWords),c=s.replacedTexts,l=s.newKeywords;if(t._keepWords=t._keepWords.concat(l[0].map((function(e){return e.string}))),0!==l[0].length)switch(r){case"coping":t.descriptionScrollView.addNewData(o);break;case"response":t.responseButtonLayout.active=!0,console.log("response",o,a),t.copingLayout.active=!1;var p=t.data.behavior.response[a],d=n[i]||u(n[0]);d.parent=t.responseButtonLayout,d.active=!0,d.getComponentInChildren(h).string=o,d.on("click",(function(){t.descriptionScrollView.addNewData(p),t.responseButtonLayout.active=!1}));break;case"action to target":t.responseButtonLayout.active=!0,t.copingLayout.active=!1;var w=n[i]||u(n[0]);w.parent=t.responseButtonLayout,w.active=!0,w.getComponentInChildren(h).string=c[0],w.on("click",(function(){t.descriptionCrossword.showQuestion(c[0],l[0]),t.descriptionCrossword.showAnswer(t.descriptionScrollView.tipCards),t.linkid=a,t.responseButtonLayout.active=!1}))}}))},s.onDescriptionScrollViewEnd=function(e){var t=this;if(console.log("this.data:",this.data),0!==this.data.chance){var n=this.data.behavior,i=!0;this.descriptionScrollView.tipCards.forEach((function(e){if("combat"===e.action)i=!1,console.log("combat"),t.descriptionScrollView.setChooseButtons([{text:"戰鬥",callback:function(){t.descriptionScrollView.node.active=!1,e.response?t.descriptionScrollView.addNewData(t.data.behavior.response[e.response]):t.noChance(),v.instance.emit("battleStart")}}]);else if(e.dc){i=!1;var n=e.dc.split("-"),o=parseInt(n[0]),r=n[1],a=e.success,s=e.failure;console.log(o,r,a,s),console.log(t.data.behavior.response[a]),console.log(t.data.behavior.response[s]);var c=w(1,20);t.descriptionScrollView.addNewData("(骰子結果："+c+")"),c>=o?t.descriptionScrollView.addNewData(t.data.behavior.response[a]):t.descriptionScrollView.addNewData(t.data.behavior.response[s]),t.descriptionScrollView.deleteCard(e)}else e.link&&(console.log("link:",e.link),i=!1,t.descriptionScrollView.deleteCard(e),t.descriptionScrollView.setChooseButtons([{text:e.string,callback:function(){return t.setDramaData(V.getInstance().storyData.dramas[e.link])}}]))})),this.copingLayout.active=i,this.counter.node.active=i,i&&v.instance.emit("CopingDramaBehavior",n)}else this.closeDescriptionView()},s.onDescriptionScrollViewAddSentence=function(e){var t=e.answers,n=e.sentence,i=this.data.behavior.response[this.linkid],o=D.answerQuestion(i[0],t.map((function(e){return e.string})));this.descriptionScrollView.addNewData(n),this.descriptionScrollView.addNewData(o);var r=this.data.behavior;v.instance.emit("CopingDramaBehavior",r)},t}(f)).prototype,"counter",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(I.prototype,"copingLayout",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(I.prototype,"copingSkillButtonPrefab",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(I.prototype,"descriptionScrollView",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(I.prototype,"titleLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(I.prototype,"responseButtonLayout",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(I.prototype,"descriptionCrossword",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=I))||z));s._RF.pop()}}}));

System.register("chunks:///_virtual/CounterComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o,r,i,u,a,c,s,l,p,f,d;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,r=t.assertThisInitialized,i=t.createClass},function(t){u=t.cclegacy,a=t._decorator,c=t.Label,s=t.Node,l=t.Vec3,p=t.tween,f=t.UIOpacity,d=t.Component}],execute:function(){var C,h,b,v,m;u._RF.push({},"a4592V7k85I6Y4OVwBiWMQr","CounterComponent",void 0);var y=a.ccclass,g=a.property;t("CounterComponent",(C=y("CounterComponent"),h=g(c),C((m=n((v=function(t){function n(){for(var n,e=arguments.length,i=new Array(e),u=0;u<e;u++)i[u]=arguments[u];return n=t.call.apply(t,[this].concat(i))||this,o(n,"counterLabel",m,r(n)),n.minCount=1,n.currentCount=0,n.deprecatedCount=0,n}e(n,t);var u=n.prototype;return u.start=function(){this.count=this.currentCount},u.updateLabel=function(){this.counterLabel.string=this.currentCount.toString()},u.addCount=function(t,n,e){var o=this;void 0===n&&(n=""),void 0===e&&(e=30),this.currentCount=Math.max(this.currentCount+t,this.minCount);var r=new s;r.parent=this.node;var i=r.addComponent(c);t>0?(r.position=new l(0,-80,0),i.string="+"+t+"\n"+n,i.fontSize=e,p(r).to(.5,{position:new l(0,0,0)},{easing:"cubicOut"}).call((function(){o.updateLabel(),o.counterEffect()})).removeSelf().start()):(r.position=new l(0,0,0),i.string=t+"\n"+n,i.fontSize=e,this.counterEffect(),p(r).to(.5,{position:new l(0,-80,0)},{easing:"cubicOut"}).call((function(){o.updateLabel()})).removeSelf().start());var u=r.addComponent(f);p(u).to(.7,{opacity:120},{easing:"cubicOut"}).to(.1,{opacity:0}).start()},u.counterEffect=function(){p(this.counterLabel.node).to(.01,{scale:new l(1.5,1.5,1)}).to(.2,{scale:new l(1,1,1)}).start()},i(n,[{key:"count",set:function(t){this.currentCount=t,this.updateLabel()}}]),n}(d)).prototype,"counterLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=v))||b));u._RF.pop()}}}));

System.register("chunks:///_virtual/CrosswordController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(o){var r,s,e,n,t;return{setters:[function(o){r=o.inheritsLoose},function(o){s=o.cclegacy,e=o._decorator,n=o.Component},function(o){t=o.EventManager}],execute:function(){var d;s._RF.push({},"e759bUpeHdMQ728ij6qKovR","CrosswordController",void 0);var l=e.ccclass,c=(e.property,o("CrosswordEvent",function(o){return o.CrosswordSolved="crossword_event_crossword_solved",o.CrosswordFailed="crossword_event_crossword_failed",o.CrosswordCellCleared="crossword_event_crossword_cell_cleared",o}({})));o("CrosswordController",l("CrosswordController")(d=function(o){function s(){return o.apply(this,arguments)||this}r(s,o);var e=s.prototype;return e.onLoad=function(){t.instance.on(c.CrosswordSolved,this.onCrosswordSolved.bind(this)),t.instance.on(c.CrosswordCellCleared,this.onCrosswordCellCleared.bind(this))},e.onDestroy=function(){t.instance.off(c.CrosswordSolved,this.onCrosswordSolved),t.instance.off(c.CrosswordCellCleared,this.onCrosswordCellCleared)},e.onCrosswordSolved=function(o){},e.onCrosswordCellCleared=function(o){},s}(n))||d);s._RF.pop()}}}));

System.register("chunks:///_virtual/DataModal.ts",["cc","./StoryData.ts"],(function(t){var n,a;return{setters:[function(t){n=t.cclegacy},function(t){a=t.StoryData}],execute:function(){n._RF.push({},"ef40bRP1clLMaIn/nRX0fUM","DataModal",void 0),t("DataModal",function(){function t(){this.wordPuzzleData=void 0,this.storyData=void 0,this.storyData=new a}return t.getInstance=function(){return t.instance||(t.instance=new t)},t}()).instance=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/DeckCards.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseCardDisplay.ts","./CardComponent.ts"],(function(e){var t,n,r,o,c,s;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator,o=e.instantiate},function(e){c=e.BaseCardDisplay},function(e){s=e.CardComponent}],execute:function(){var a;n._RF.push({},"0e8f90i+8xITrVmsrBey4CN","DeckCards",void 0);var i=r.ccclass;r.property,e("default",i("DeckCards")(a=function(e){function n(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).discardLimit=3,t}t(n,e);var r=n.prototype;return r.doShowCard=function(e){this.showCards(e)},r.showCards=function(e){var t=this;this.positionContainer.children.length===e.length?(this.selectedCardNodes.length>0&&console.error("已經有選取的卡片，請先清除之前的選取"),this.cardContainer.removeAllChildren(),e.forEach((function(e,n){var r=o(t.cardPrefab);r.name="Card_"+n,r.getComponent(s).setup(e),r.parent=t.cardContainer}))):console.error("卡牌數量與定位節點數量不符")},r.toggleCardSelection=function(t){e.prototype.toggleCardSelection.call(this,t);var n=t.getComponent(s).card;this.selected.includes(n)},r.confirmSelection=function(){var e=this.selected.length>0;return e?console.log("Discarding cards:",this.selected):console.log("No card selected."),e},r.getSelectedCards=function(){return this.selected},r.getCardContentNodes=function(){return this.cardContainer.children},n}(c))||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/DeckCards2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseCardDisplay.ts","./GameEvents.ts","./EventManager.ts","./CardComponent2.ts"],(function(e){var t,n,r,c,o,a,s,i,l;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){c=e.cclegacy,o=e._decorator},function(e){a=e.BaseCardDisplay},function(e){s=e.GameUIEvent},function(e){i=e.EventManager},function(e){l=e.CardComponent}],execute:function(){var d;c._RF.push({},"a133dU/5xNPzr4FEm/RU8Jy","DeckCards",void 0);var u=o.ccclass;o.property,e("default",u("DeckCards")(d=function(e){function c(){for(var t,n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(t=e.call.apply(e,[this].concat(r))||this).discardLimit=3,t}t(c,e);var o=c.prototype;return o.toggleCardSelection=function(t){e.prototype.toggleCardSelection.call(this,t);var n=t.getComponent(l).card;this.selected.includes(n)?i.instance.emit(s.DeckCardUnselected,n):i.instance.emit(s.DeckCardSelected,n)},o.confirmSelection=function(){var e=this.selected.length>0;return e?console.log("Discarding cards:",this.selected):console.log("No card selected."),e},o.discardSelectedCards=function(){var e=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unselectAllCards();case 2:this.updatePositionLayout(),this.followPosition();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.getSelectedCards=function(){return this.selected},o.getCardContentNodes=function(){return this.cardContainer.children},c}(a))||d);c._RF.pop()}}}));

System.register("chunks:///_virtual/DeckCardsPile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameEvents.ts","./HandEvaluator.ts","./EventManager.ts","./CardMover.ts","./CardComponent2.ts","./DeckCards2.ts","./CommunityCards.ts","./PlayerHandCards2.ts"],(function(e){var n,t,r,a,i,s,c,o,d,u,l,h,f,C,p,m,v,k,y,D,g;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,i=e.asyncToGenerator,s=e.regeneratorRuntime,c=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,d=e._decorator,u=e.Node,l=e.Vec3,h=e.Component},function(e){f=e.DeckPileEvent,C=e.GameLogicEvent},function(e){p=e.HandEvaluator},function(e){m=e.EventManager},function(e){v=e.CardMover},function(e){k=e.CardComponent},function(e){y=e.default},function(e){D=e.default},function(e){g=e.default}],execute:function(){var b,x,w,P,G,E,S,H,R,A,z,O,N;o._RF.push({},"2412cS1sUJNnI5q2nUpqzA/","DeckCardsPile",void 0);var T=d.ccclass,L=d.property;e("default",(b=T("DeckCardsPile"),x=L(u),w=L(u),P=L(u),G=L(D),E=L(g),b((R=n((H=function(e){function n(){for(var n,t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return n=e.call.apply(e,[this].concat(i))||this,r(n,"deckPile",R,a(n)),n.deckCardsPile=void 0,r(n,"deckGatherings",A,a(n)),r(n,"deckDiscard",z,a(n)),r(n,"communityCards",O,a(n)),r(n,"playerHands",N,a(n)),n}t(n,e);var o=n.prototype;return o.onLoad=function(){m.instance.on(f.ShowCards,this.onShowCards.bind(this)),m.instance.on(f.DeckGatherings,this.onDeckGatherings.bind(this)),m.instance.on(f.DiscardCards,this.onDiscardCards.bind(this)),m.instance.on(f.DealCommunityCards,this.onDealCommunityCards.bind(this)),m.instance.on(f.DealPlayerCards,this.onDealPlayerCards.bind(this)),m.instance.on(f.HideCards,this.eventHideCards.bind(this)),this.deckCardsPile=this.deckPile.getComponentsInChildren(y)},o.onDestroy=function(){m.instance.off(f.ShowCards,this.onShowCards),m.instance.off(f.DeckGatherings,this.onDeckGatherings),m.instance.off(f.DiscardCards,this.onDiscardCards),m.instance.off(f.DealCommunityCards,this.onDealCommunityCards),m.instance.off(f.DealPlayerCards,this.onDealPlayerCards),m.instance.off(f.HideCards,this.eventHideCards)},o.start=function(){this.node.position=l.ZERO},o.showdDeckPile=function(e){this.deckCardsPile.forEach((function(e){return e.node.active=!0}));var n=p.groupBySuit(e);this.deckCardsPile.forEach((function(e,t){var r=n[t];e.initPositionNodes(r.length),e.showCards(r),e.followPosition(),e.setToggleSelection()}))},o.collectAllCardsToDeckGatherings=function(){var e=i(s().mark((function e(){var n,t,r,a,i,o,d,u=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=c(this.deckCardsPile);case 1:if((t=n()).done){e.next=16;break}return r=t.value,e.next=5,r.unselectAllCards();case 5:r.stopToggleSelection(),a=r.getCardContentNodes().slice(),i=c(a);case 8:if((o=i()).done){e.next=14;break}return d=o.value,e.next=12,v.moveCard(d,this.deckGatherings,l.ZERO);case 12:e.next=8;break;case 14:e.next=1;break;case 16:return e.next=18,new Promise((function(e){return u.scheduleOnce(e,.25)}));case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.onShowCards=function(e){this.node.active=!0,this.communityCards.clearCards(),this.playerHands.forEach((function(e){return e.clearCards()})),this.deckGatherings.removeAllChildren(),this.deckDiscard.removeAllChildren(),this.showdDeckPile(e)},o.onDeckGatherings=function(){var e=i(s().mark((function e(n){var t,r,a,i=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.node.active=!0,t=c(this.deckDiscard.children.slice());case 2:if((r=t()).done){e.next=8;break}return a=r.value,e.next=6,v.moveCard(a,this.deckGatherings,l.ZERO);case 6:e.next=2;break;case 8:return e.next=10,new Promise((function(e){return i.scheduleOnce(e,.25)}));case 10:console.log("重洗"),m.instance.emit(C.GameRoundNextPlayerTurn);case 12:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),o.onDiscardCards=function(){var e=i(s().mark((function e(n){var t,r,a,o,d,u=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.active=!0,t=n,e.next=4,this.communityCards.unselectAllCards();case 4:r=this.communityCards.getCardNodes(t).slice(),a=c(r);case 6:if((o=a()).done){e.next=12;break}return d=o.value,e.next=10,v.moveCard(d,this.deckDiscard,l.ZERO);case 10:e.next=6;break;case 12:return e.next=14,this.playerHands.forEach(i(s().mark((function e(n){var a,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.unselectAllCards();case 2:r=n.getCardNodes(t).slice(),a=c(r);case 4:if((i=a()).done){e.next=10;break}return o=i.value,e.next=8,v.moveCard(o,u.deckDiscard,l.ZERO);case 8:e.next=4;break;case 10:case"end":return e.stop()}}),e)}))));case 14:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),o.onDealCommunityCards=function(e){var n=this;this.node.active=!0;var t=this.deckGatherings.children,r=e;console.log(r);var a=0;r.forEach(i(s().mark((function e(r){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=t[t.length-1]).getComponent(k).setup(r),e.next=4,n.communityCards.moveDealCard(a++,i);case 4:case"end":return e.stop()}}),e)}))))},o.onDealPlayerCards=function(e){var n=this,t=this.deckGatherings.children;e.forEach((function(e,r){n.playerHands[r].dealCards(e,t)}))},o.eventHideCards=function(e){this.node.active=!1},o.onDiscardClicked=function(){var e=[];this.deckCardsPile.forEach((function(n){n.confirmSelection()&&(n.discardSelectedCards(),e=e.concat(n.getSelectedCards()))})),0!=e.length&&m.instance.emit(C.GameRoundStartDiscardCards,e)},o.onGameStartDealClicked=function(){var e=i(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collectAllCardsToDeckGatherings();case 2:this.deckCardsPile.forEach((function(e){return e.node.active=!1})),m.instance.emit(C.GameRoundStartDealCards);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n}(h)).prototype,"deckPile",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=n(H.prototype,"deckGatherings",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(H.prototype,"deckDiscard",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=n(H.prototype,"communityCards",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=n(H.prototype,"playerHands",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S=H))||S));o._RF.pop()}}}));

System.register("chunks:///_virtual/DeckCardsPile2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CardMover.ts","./EventManager.ts","./GameEvents.ts","./DeckCards.ts"],(function(e){var n,t,r,i,a,s,c,o,d,l,u,h,f,k,C,p,v;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,s=e.regeneratorRuntime,c=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,d=e._decorator,l=e.Node,u=e.Vec3,h=e.Component},function(e){f=e.CardMover},function(e){k=e.EventManager},function(e){C=e.DeckPileEvent,p=e.PlayerHandCardEvent},function(e){v=e.default}],execute:function(){var g,P,D,y,b,m,w,x,E;o._RF.push({},"a010fbX4oxEuZIxUUTL9QBb","DeckCardsPile",void 0);var G=d.ccclass,S=d.property;e("default",(g=G("DeckCardsPile"),P=S(l),D=S(l),y=S(l),g((w=n((m=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=e.call.apply(e,[this].concat(a))||this,r(n,"deckPile",w,i(n)),n.deckCardsPile=void 0,r(n,"deckGatherings",x,i(n)),r(n,"deckDiscard",E,i(n)),n.cards=[],n}t(n,e);var o=n.prototype;return o.onLoad=function(){k.instance.on(C.ShowCards,this.onShowCards.bind(this)),k.instance.on(C.DealPlayerCards,this.onDealPlayerCards.bind(this)),this.deckCardsPile=this.deckPile.getComponentsInChildren(v)},o.onDestroy=function(){k.instance.off(C.ShowCards,this.onShowCards),k.instance.off(C.DealPlayerCards,this.onDealPlayerCards)},o.start=function(){this.node.position=u.ZERO},o.showdDeckPile=function(e){this.cards=e,this.deckCardsPile.forEach((function(n,t){n.initPositionNodes(e.length),n.doShowCard(e),n.setToggleSelection(),n.followPosition()}))},o.collectAllCardsToDeckGatherings=function(){var e=a(s().mark((function e(){var n,t,r,i,a,o,d,l=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=c(this.deckCardsPile);case 1:if((t=n()).done){e.next=13;break}r=t.value,i=r.getCardContentNodes().slice(),a=c(i);case 5:if((o=a()).done){e.next=11;break}return d=o.value,e.next=9,f.moveCard(d,this.deckGatherings,u.ZERO);case 9:e.next=5;break;case 11:e.next=1;break;case 13:return e.next=15,new Promise((function(e){return l.scheduleOnce(e,.25)}));case 15:this.deckCardsPile.forEach((function(e){return e.node.active=!1}));case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.onShowCards=function(e){this.node.active=!0,this.deckGatherings.removeAllChildren(),this.deckDiscard.removeAllChildren();var n=e;this.showdDeckPile(n),this.collectAllCardsToDeckGatherings()},o.onDeckGatherings=function(){var e=a(s().mark((function e(){var n,t,r,i=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.node.active=!0,n=c(this.deckDiscard.children.slice());case 2:if((t=n()).done){e.next=8;break}return r=t.value,e.next=6,f.moveCard(r,this.deckGatherings,u.ZERO);case 6:e.next=2;break;case 8:return e.next=10,new Promise((function(e){return i.scheduleOnce(e,.25)}));case 10:console.log("重洗");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.onDealPlayerCards=function(e){var n=e;this.cards.length<n?k.instance.emit("ShuffleDeckRequest"):k.instance.emit(p.DealCards,{cards:this.cards.splice(0,n),deckGatherings:this.deckGatherings})},o.eventHideCards=function(e){this.node.active=!1},o.onDiscardClicked=function(){var e=[];this.deckCardsPile.forEach((function(n){n.confirmSelection()&&(n.discardSelectedCards(),e=e.concat(n.getSelectedCards()))})),e.length},n}(h)).prototype,"deckPile",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=n(m.prototype,"deckGatherings",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(m.prototype,"deckDiscard",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=m))||b));o._RF.pop()}}}));

System.register("chunks:///_virtual/DescriptionCrossword.ts",["./rollupPluginModLoBabelHelpers.js","cc","./HandCards.ts","./FillBlanks.ts","./EventManager.ts","./TipText.ts"],(function(n){var t,s,e,i,o,r,a,c,l,u,d,h,p;return{setters:[function(n){t=n.applyDecoratedDescriptor,s=n.inheritsLoose,e=n.initializerDefineProperty,i=n.assertThisInitialized},function(n){o=n.cclegacy,r=n._decorator,a=n.RichText,c=n.Vec3,l=n.Component},function(n){u=n.HandCards},function(n){d=n.FillBlanks},function(n){h=n.EventManager},function(n){p=n.TipType}],execute:function(){var w,f,C,b,g,v,y;o._RF.push({},"3b007pSbVhMyYZDcoIimcDH","DescriptionCrossword",void 0);var H=r.ccclass,m=r.property;n("default",(w=H("DescriptionCrossword"),f=m(a),C=m(u),w((v=t((g=function(n){function t(){for(var t,s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return t=n.call.apply(n,[this].concat(o))||this,e(t,"questionLabel",v,i(t)),e(t,"answerHandCards",y,i(t)),t.question="",t.solutions=[],t.isFirstRound=!0,t}s(t,n);var o=t.prototype;return o.start=function(){this.node.position=c.ZERO,this.node.active=!1},o.showQuestion=function(n,t){void 0===t&&(t=[]),this.questionLabel.string=this.question=n,this.solutions=t,this.answerHandCards.show(!1),this.answerHandCards.lock(!0),this.answerHandCards.selectMax=this.solutions.length,this.answerHandCards.eventSendCallback=this.sendAnswer.bind(this),this.isFirstRound=!1,this.node.active=!0},o.showAnswer=function(n){var t=this;this.answerHandCards.show(!0),this.answerHandCards.list(n,(function(n,s){t.questionLabel.string=d.answerQuestion(t.question,s.map((function(n){return n.string})))})),this.answerHandCards.lock(!1)},o.sendAnswer=function(n){var t=this.solutions.every((function(t,s){return t.type===n[s].type}));console.log("same type:",t),console.log("input:",n),console.log("solutions",this.solutions),t?(h.instance.emit("DescriptionScrollViewAddSentence",{answers:n,sentence:this.questionLabel.string}),this.questionLabel.string="",this.answerHandCards.show(!1),this.answerHandCards.clear(),this.node.active=!1):h.instance.emit(p.Error,"輸入的類型與填入內容不符合")},o.onCancelClicked=function(){},o.onSendClicked=function(){this.questionLabel.string="",this.isFirstRound=!0,this.node.parent.active=!0,h.instance.emit(p.Hide)},t}(l)).prototype,"questionLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(g.prototype,"answerHandCards",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=g))||b));o._RF.pop()}}}));

System.register("chunks:///_virtual/DescriptionScrollView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FillBlanks.ts","./TipClipsAnimation.ts","./EventManager.ts"],(function(t){var i,n,e,o,r,s,c,l,a,h,p,u,d,f,w,g,v,C,y;return{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,c=t.ScrollView,l=t.Node,a=t.UITransform,h=t.Vec3,p=t.RichText,u=t.instantiate,d=t.UIOpacity,f=t.tween,w=t.Label,g=t.Component},function(t){v=t.FillBlanks},function(t){C=t.TipClipsAnimation},function(t){y=t.EventManager}],execute:function(){var m,V,x,k,T,b,S,B,D;r._RF.push({},"d4350Skx8NN8IRsBjiAsG5J","DescriptionScrollView",void 0);var L=s.ccclass,M=s.property;t("DescriptionScrollView",(m=L("DescriptionScrollView"),V=M(c),x=M(C),k=M(l),m((S=i((b=function(t){function i(){for(var i,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return i=t.call.apply(t,[this].concat(r))||this,e(i,"scrollView",S,o(i)),e(i,"answerClipsAnimation",B,o(i)),e(i,"chooseButtonLayout",D,o(i)),i.centerPosition=void 0,i.quarterHeight=void 0,i.index=0,i.descriptions=[],i.tipCards=[],i}n(i,t);var r=i.prototype;return r.onLoad=function(){var t,i;this.scrollView?(this.quarterHeight=3*this.scrollView.getComponent(a).height/4,this.centerPosition=this.scrollView.content.getComponent(a).convertToWorldSpaceAR(new h(0,0,0)),null==(t=this.scrollView)||null==(i=t.node)||i.on("scrolling",this.onScrolling,this)):console.warn("ScrollView component is not assigned.")},r.onDestroy=function(){var t,i;null==(t=this.scrollView)||null==(i=t.node)||i.off("scrolling",this.onScrolling,this)},r.setData=function(t){this.descriptions=t,this.scrollView.scrollToTop();var i=this.scrollView.content.children;i.forEach((function(t){return t.active=!1})),this.index=0;var n=v.replaceMarkedWithKeywords([this.descriptions[this.index]],this.tipCards.map((function(t){return t.string}))),e=n.replacedTexts,o=n.newKeywords,r=i[this.index];r.getComponentInChildren(p).string=e[0],r.active=!0,this.showMarkedText(o[0]),this.chooseButtonLayout.active=!1},r.addNewData=function(t){if(t){console.log("descriptions:",t),this.descriptions=this.descriptions.concat(t);var i=this.scrollView.content.children,n=i[this.index]||u(i[0]);n.active=!0,n.parent=this.scrollView.content,n.position=h.ZERO;var e=this.tipCards.map((function(t){return t.string})),o=v.replaceMarkedWithKeywords([this.descriptions[this.index]],e),r=o.replacedTexts,s=o.newKeywords,c=n.getComponentInChildren(p);c.string=r[0],this.showMarkedText(s[0]);var l=c.getComponent(d);l.opacity=0,f(l).to(.5,{opacity:255}).start(),this.chooseButtonLayout.active=!1}else console.log("未正確輸入資料!!!")},r.deleteCard=function(t){this.tipCards.splice(this.tipCards.findIndex((function(i){return i===t})),1),console.log("tipCards:",this.tipCards)},r.setChooseButtons=function(t){var i=this;this.chooseButtonLayout.active=!0;var n=this.chooseButtonLayout.children;n.forEach((function(t){return t.active=!1})),t.forEach((function(t,e){var o=n[e]||u(n[0]);o.active=!0,o.parent=i.chooseButtonLayout;var r=o.getComponentInChildren(w);r.string=t.text,o.off("click"),o.on("click",(function(){r.string="--",o.off("click"),t.callback()}))}))},r.show=function(){this.node.active=!0},r.clear=function(){this.index=0,this.descriptions.length=0,this.tipCards.length=0},r.close=function(){this.scrollView.content.children.forEach((function(t){return t.active=!1})),this.scrollView.scrollToPercentVertical(0),this.node.active=!1,this.clear()},r.onScrolling=function(){for(var t=this.scrollView.content.children,i=this.scrollView.content.getComponent(a),n=0;n<t.length;n++){var e=t[n],o=i.convertToWorldSpaceAR(e.position);if(h.distance(o,this.centerPosition)<this.quarterHeight&&n===this.index){this.index++;var r=this.descriptions[this.index];if(void 0===r){y.instance.emit("DescriptionScrollViewEnd");break}var s=t[this.index]||u(e);s.active=!0,s.parent=this.scrollView.content,s.position=h.ZERO;var c=this.tipCards.map((function(t){return t.string})),l=v.replaceMarkedWithKeywords([r],c),w=l.replacedTexts,g=l.newKeywords,C=s.getComponentInChildren(p);C.string=w[0],this.showMarkedText(g[0]);var m=C.getComponent(d);m.opacity=0,f(m).to(.5,{opacity:255}).start();break}}},r.showMarkedText=function(t){var i=this,n=t.filter((function(t){return!i.tipCards.includes(t)}));n.length>0&&(this.answerClipsAnimation.spreadCards(n.map((function(t){return t.string}))),this.tipCards=this.tipCards.concat(n))},r.onClicked=function(t,i){this.close()},i}(g)).prototype,"scrollView",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(b.prototype,"answerClipsAnimation",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=i(b.prototype,"chooseButtonLayout",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=b))||T));r._RF.pop()}}}));

System.register("chunks:///_virtual/DiscardCardsPile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CardComponent2.ts"],(function(n){var t,r,e,i,a,o,s,c,u,l,p,f,d,m,h;return{setters:[function(n){t=n.applyDecoratedDescriptor,r=n.inheritsLoose,e=n.initializerDefineProperty,i=n.assertThisInitialized,a=n.asyncToGenerator,o=n.regeneratorRuntime},function(n){s=n.cclegacy,c=n._decorator,u=n.Prefab,l=n.Node,p=n.Vec3,f=n.tween,d=n.Component,m=n.instantiate},function(n){h=n.CardComponent}],execute:function(){var v,C,P,w,b,g,y;s._RF.push({},"62966EzVs5FsrwzsHD7VcvV","DiscardCardsPile",void 0);var D=c.ccclass,x=c.property;n("default",(v=D("DiscardCardsPile"),C=x(u),P=x(l),v((g=t((b=function(n){function t(){for(var t,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=n.call.apply(n,[this].concat(a))||this,e(t,"cardPrefab",g,i(t)),e(t,"discardPileContainer",y,i(t)),t.animating=!1,t}r(t,n);var s=t.prototype;return s.addCardToDiscardPile=function(){var n=a(o().mark((function n(t){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.animating){n.next=3;break}return n.next=3,this.waitForAnimation();case 3:return this.animating=!0,(r=m(this.cardPrefab)).getComponent(h).setup(t),r.parent=this.discardPileContainer,r.position=p.ZERO,n.next=10,this.animateCard(r);case 10:this.animating=!1;case 11:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),s.waitForAnimation=function(){var n=a(o().mark((function n(){var t=this;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){!function r(){t.animating?setTimeout(r,100):n(!0)}()})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),s.animateCard=function(n){return new Promise((function(t){var r=new p(200,100,0);f(n).to(1,{position:r}).call((function(){t(!0)})).start()}))},t}(d)).prototype,"cardPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(b.prototype,"discardPileContainer",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=b))||w));s._RF.pop()}}}));

System.register("chunks:///_virtual/Draggable.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DropZone.ts"],(function(o){var t,e,n,i,s,r,a,h,c,d,l,p,u;return{setters:[function(o){t=o.inheritsLoose,e=o.createForOfIteratorHelperLoose},function(o){n=o.cclegacy,i=o._decorator,s=o.Sprite,r=o.resources,a=o.SpriteFrame,h=o.Node,c=o.UITransform,d=o.director,l=o.Vec3,p=o.Component},function(o){u=o.DropZone}],execute:function(){var T;n._RF.push({},"249d3/MwIlD0L9q0+4YCk49","Draggable",void 0);var f=i.ccclass;i.property,o("Draggable",f("Draggable")(T=function(o){function n(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o.call.apply(o,[this].concat(n))||this).startParent=null,t.zone=null,t}t(n,o);var i=n.prototype;return i.start=function(){this.startParent=this.node.parent},i.setPhotoImage=function(o){var t=this.node.getComponent(s),e="maps/"+o+"/spriteFrame";r.load(e,a,(function(o,e){o?console.error("Failed to load image: "+o):t.spriteFrame=e}))},i.onEnable=function(){this.node.on(h.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(h.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(h.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(h.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},i.onDisable=function(){this.node.off(h.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(h.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(h.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(h.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},i.onTouchStart=function(o){var t=this.startParent.getComponent(c).convertToWorldSpaceAR(this.node.position),e=t.x,n=t.y;this.node.parent=d.getScene().children[0],this.node.setWorldPosition(new l(e,n,0))},i.onTouchMove=function(o){var t=o.getUIDelta();this.node.setPosition(this.node.position.x+t.x,this.node.position.y+t.y)},i.onTouchEnd=function(o){for(var t,n=this.node.scene.getComponentsInChildren(u),i=!1,s=e(n);!(t=s()).done;){var r=t.value;if(console.log("checking drop zone"),l.len(r.node.getWorldPosition().clone().subtract3f(this.node.getWorldPosition().x,this.node.getWorldPosition().y,0))<50){i=!0,this.zone=r,r.node.emit("drop",{draggableItem:this,dropZone:r});break}}i||(this.node.parent=this.startParent,this.node.setPosition(l.ZERO))},i.onTouchCancel=function(o){this.node.parent=this.startParent,this.node.setPosition(l.ZERO)},n}(p))||T);n._RF.pop()}}}));

System.register("chunks:///_virtual/DropZone.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Draggable.ts"],(function(e){var o,t,n,r,i,a,l,s,c,p;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,l=e.Node,s=e.Vec3,c=e.Component},function(e){p=e.Draggable}],execute:function(){var h,u,d,f,g;i._RF.push({},"ae71cnkrp1Nopo6XFRtfKkQ","DropZone",void 0);var D=a.ccclass,b=a.property;e("DropZone",(h=D("DropZone"),u=b(l),h((g=o((f=function(e){function o(){for(var o,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return o=e.call.apply(e,[this].concat(i))||this,n(o,"placeholder",g,r(o)),o}t(o,e);var i=o.prototype;return i.onEnable=function(){this.node.on("drop",this.onDrop,this)},i.onDisable=function(){this.node.off("drop",this.onDrop,this)},i.onDrop=function(e){var o=e.draggableItem;if(this.placeholder){var t=this.placeholder.children[0];t&&(console.log("道具已存在，交换位置"),t.parent=o.startParent,t.setPosition(new s(0,0,0)),t.getComponent(p).startParent=t.parent),o.node.parent=this.placeholder,o.node.setPosition(new s(0,0,0)),o.startParent=this.placeholder,console.log("道具已放置")}},o}(c)).prototype,"placeholder",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));i._RF.pop()}}}));

System.register("chunks:///_virtual/Dungeon.ts",["cc"],(function(t){var s;return{setters:[function(t){s=t.cclegacy}],execute:function(){s._RF.push({},"9b9b3IiH/9IjYT1OxoCsK5v","Dungeon",void 0);var o=t("Direction",function(t){return t[t.North=0]="North",t[t.South=1]="South",t[t.East=2]="East",t[t.West=3]="West",t}({})),i=t("Room",function(){function t(t,s){this.instanceNode=null,this.x=void 0,this.y=void 0,this.icon=void 0,this.name=void 0,this.descriptions=void 0,this.connections=void 0,this.question=void 0,this.cards=void 0,this.x=t,this.y=s,this.connections=[]}var s=t.prototype;return s.setInfo=function(t){this.icon=t.icon,this.name=t.name,this.descriptions=t.descriptions,this.question=t.question,this.cards=t.cards},s.connectWith=function(t){this.x<t.x?(this.connections.push(o.East),t.connections.push(o.West)):this.x>t.x?(this.connections.push(o.West),t.connections.push(o.East)):this.y<t.y?(this.connections.push(o.North),t.connections.push(o.South)):this.y>t.y&&(this.connections.push(o.South),t.connections.push(o.North))},t}());t("DungeonMaze",function(){function t(t,s){this.rooms=void 0,this.width=void 0,this.height=void 0,this.width=t,this.height=s,this.rooms=Array.from({length:s},(function(s,o){return Array.from({length:t},(function(t,s){return new i(s,o)}))}))}var s=t.prototype;return s.generateMaze=function(t,s){void 0===t&&(t=0),void 0===s&&(s=0);var o=[],i=this.rooms[t][s],n=new Set;for(n.add(i),o.push(i);o.length>0;){i=o.pop();var h=this.getUnvisitedNeighbors(i,n);if(h.length>0){o.push(i);var e=h[Math.floor(Math.random()*h.length)];i.connectWith(e),n.add(e),o.push(e)}}},s.getUnvisitedNeighbors=function(t,s){var o=[],i=t.x,n=t.y;return i>0&&!s.has(this.rooms[n][i-1])&&o.push(this.rooms[n][i-1]),i<this.width-1&&!s.has(this.rooms[n][i+1])&&o.push(this.rooms[n][i+1]),n>0&&!s.has(this.rooms[n-1][i])&&o.push(this.rooms[n-1][i]),n<this.height-1&&!s.has(this.rooms[n+1][i])&&o.push(this.rooms[n+1][i]),o},s.findExit=function(t,s){var o=[],i=new Set,n=this.rooms[s][t];for(i.add(n),o.push(n);o.length>0;){var h=o.shift();if(h!==n&&1===h.connections.length)return h;this.getNeighbors(h).forEach((function(t){i.has(t)||(i.add(t),o.push(t))})),console.log(o.length)}return null},s.getNeighbors=function(t){var s=[],i=t.x,n=t.y;return t.connections.includes(o.South)&&n>0&&s.push(this.rooms[n-1][i]),t.connections.includes(o.North)&&n<this.height-1&&s.push(this.rooms[n+1][i]),t.connections.includes(o.West)&&i>0&&s.push(this.rooms[n][i-1]),t.connections.includes(o.East)&&i<this.width-1&&s.push(this.rooms[n][i+1]),s},t}());s._RF.pop()}}}));

System.register("chunks:///_virtual/DungeonEscapeHandler.ts",["cc","./SocketBridge.ts","./DungeonEscapeRecord.ts"],(function(t){var i,e,n,s;return{setters:[function(t){i=t.cclegacy,e=t.randomRangeInt},function(t){n=t.SocketBridge},function(t){s=t.DungeonEscapeRecord}],execute:function(){i._RF.push({},"d68b09aVpdIe4fyzggjYLzz","DungeonEscapeHandler",void 0);t("DungeonEscapeHandler",function(){function t(t,i,e,n,s,o,a){this._honstGameRecord=void 0,this._roomID=void 0,this._isHonster=!1,this._masterID="",this._playerID="",this._myNickname="",this._players=void 0,this._gameView=void 0,this._communityCards=[],this._gameView=t,this._gameView.requestApplicate=this._applicate.bind(this),this._isHonster=i,i&&(this._players=a),this._gameView.init(e,n,s),this.startGame(e,o,a)}var i=t.prototype;return i._applicate=function(t,i){void 0===i&&(i=""),this._isHonster?(console.log("====== Applicate "+t+" 事件不透過連線發給自己:",i),this["notify_"+t](this._roomID,t,i)):n.Instance.applicate(t,i)},i._broadcast=function(t,i,e){if(void 0===i&&(i=""),this._isHonster){if(e===this._playerID)return console.log("====== Broadcast "+t+" 事件不透過連線發給自己:\n",i);n.Instance.broadcast(t,i,e)}},i.startGame=function(t,i,e){this._roomID=t,e&&(this._isHonster=!0,this._honstGameRecord=new s,i?this._honstGameRecord.readData():this._honstGameRecord.players=e),n.Instance.addDispatcher(t,this,{alert:this.notify_alert,update_game_step:this.notify_update_game_step,exploration:this.notify_exploration,reconnect:this.notify_reconnect}),this._isHonster,i&&this._applicate("reconnect",this._playerID)},i.endGame=function(t){n.Instance.removeDispatcher(t,this),this._isHonster&&(this._honstGameRecord.clearData(),this._honstGameRecord=null),this._masterID="",this._playerID="",this._myNickname=""},i.onExploration=function(t,i){e(1,20);return[]},i.notify_alert=function(t,i,e){this._gameView.onShowTip(e)},i.notify_update_game_step=function(t,i,e){},i.notify_quick_view=function(t,i,e){var n,s;if(this._isHonster){n=e.split(" ")[0];this.onExploration(n,6),e=n+" "+this._communityCards,this._broadcast(i,e)}var o=e.split(" ");n=o[0],s=o[1],this._gameView.onExplorationEvent(n,s)},i.notify_exploration=function(t,i,e){var n,s,o;if(this._isHonster){var a=e.split(" ");e=(n=a[0])+" "+(s=this.onExploration(n,60))+" "+this._communityCards,this._broadcast(i,e)}var r=e.split(" ");n=r[0],s=r[1],o=r[2],this._gameView.onExplorationEvent(n,o,s)},i.notify_reconnect=function(t,i,e){this._gameView.onShowTip("重連"+t)},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/DungeonEscapeRecord.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RandomString.ts"],(function(e){var r,t,n;return{setters:[function(e){r=e.createClass},function(e){t=e.cclegacy},function(e){n=e.RandomString}],execute:function(){t._RF.push({},"baba1oKE25Nga8ScDrOg25J","DungeonEscapeRecord",void 0);var a="DE_GAME_RECORD_INFO",s=e("Role",function(e){return e[e.PLAYER=0]="PLAYER",e[e.MASTER=1]="MASTER",e}({})),o=e("GameStatus",function(e){return e[e.GAMING=0]="GAMING",e}({})),i=e("AreaDirection",function(e){return e[e.UP=0]="UP",e[e.LEFT=1]="LEFT",e[e.DOWN=2]="DOWN",e[e.RIGHT=3]="RIGHT",e}({}));e("DungeonEscapeRecord",function(){function e(){this.masterID="",this._players={},this._roundPlayers=[],this._roundIndex=0,this._areaInfos={},this._doors={}}var t=e.prototype;return t.addPlayer=function(e,r,t){this._players[e]={nickname:r,gameStatus:t,role:s.PLAYER},this._roundPlayers=Object.keys(this._players)},t.delPlayer=function(e){delete this._players[e]},t.selectPlayer=function(e){return this._players[e]},t.nextPlayer=function(){this._roundIndex=(this._roundIndex+1)%this._roundPlayers.length},t.clearData=function(){this._players={},this._roundPlayers.length=0,this._roundIndex=0,localStorage.removeItem(a)},t.readData=function(){var e=JSON.parse(localStorage.getItem(a));console.log("Read data:",e),e&&(this.masterID=e.masterID,this._players=e.players,this._roundPlayers=e.roundPlayers)},t.writeData=function(){var e={masterID:this.masterID,players:this._players,roundPlayers:this._roundPlayers};localStorage.setItem(a,JSON.stringify(e))},t.dropAnswerHandCards=function(e,r){this.dropHandCard(this._players[e].answerHandCards,r)},t.dropHandCard=function(e,r){return r.every((function(r){return e.find((function(e,t,n){if(e===r)return n.splice(t,1),!0}))}))},t.createArea=function(e){var r;this._areaInfos[e]={doors:(r={},r[i.UP]="",r[i.LEFT]="",r[i.DOWN]="",r[i.RIGHT]="",r)}},t.linkDoor=function(e,r,t){var a,s,o,u,c=r.split("-"),l=parseInt(c[0]),d=parseInt(c[1]);switch(a=l+"-"+d,o=this._areaInfos[a],e){case i.UP:d++;break;case i.LEFT:l--;break;case i.DOWN:d--;break;case i.RIGHT:l++}s=l+"-"+d;var h=n.generate();t?(u=this._areaInfos[s],o.doors[e]=h,u.doors[(e+2)%4]=h):(this.createArea(s),this._areaInfos[s].doors[e]=h),this._doors[h]={rooms:[a,s]}},r(e,[{key:"players",set:function(e){var r=this;this._roundPlayers=Object.keys(e),this._roundPlayers.forEach((function(t){r.addPlayer(t,e[t],o.GAMING)}))}},{key:"roundPlayers",get:function(){return this._roundPlayers}}]),e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/DungeonEscapeView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./HandCards.ts","./EventManager.ts","./TipText.ts"],(function(e){var n,t,i,r,o,a,u,l,c,s,p,d,f;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,u=e.Label,l=e.Node,c=e.Vec3,s=e.Component},function(e){p=e.HandCards},function(e){d=e.EventManager},function(e){f=e.TipType}],execute:function(){var b,g,y,w,v,h,m,C,D,H,E;o._RF.push({},"86bf6dCbFdKo7HRujQDV1To","DungeonEscapeView",void 0);var z=a.ccclass,L=a.property;e("DungeonEscapeView",(b=z("DungeonEscapeView"),g=L(p),y=L(p),w=L(u),v=L(l),b((C=n((m=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,i(n,"questionHandCards",C,r(n)),i(n,"answerHandCards",D,r(n)),i(n,"infoLabel",H,r(n)),i(n,"blockNode",E,r(n)),n}t(n,e);var o=n.prototype;return o.onLoad=function(){this.node.setPosition(c.ZERO)},o.sendMessage=function(e){d.instance.emit(f.Normal,e)},n}(s)).prototype,"questionHandCards",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(m.prototype,"answerHandCards",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=n(m.prototype,"infoLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(m.prototype,"blockNode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=m))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/DungeonTest.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Rogue.ts","./CopingSkillCheck.ts","./Ability.ts","./Character.ts","./CharacterInfo.ts","./ClassFeatureImplementation.ts","./EventManager.ts","./UIManager.ts","./DataModal.ts","./Weapon.ts","./Inventory.ts","./Armor.ts","./Shield.ts","./TeamMember.ts","./CombatController.ts"],(function(e){var t,n,i,r,a,o,l,s,c,u,h,m,d,g,f,y,p,v,b,I,C,w,D,S,M;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,l=e.instantiate,s=e.randomRangeInt,c=e.Component},function(e){u=e.default},function(e){h=e.CopingSkillCheck},function(e){m=e.Attribute},function(e){d=e.Character},function(e){g=e.CharacterInfo},function(e){f=e.warriorFeatures},function(e){y=e.EventManager},function(e){p=e.UIEvent},function(e){v=e.DataModal},function(e){b=e.Weapon,I=e.WeaponStyle},function(e){C=e.Inventory},function(e){w=e.Armor},function(e){D=e.Shield},function(e){S=e.TeamMember},function(e){M=e.CombatControllerEvent}],execute:function(){var A,E,k,L,T,P,z,R,x,F,H;a._RF.push({},"f4526RX+5hPcLHQlE2ZMXV7","DungeonTest",void 0);var _=o.ccclass,W=o.property;e("DungeonTest",(A=_("DungeonTest"),E=W(u),k=W(h),L=W(g),T=W(C),A((R=t((z=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"rogue",R,r(t)),i(t,"copingSkillCheck",x,r(t)),i(t,"characterInfo",F,r(t)),i(t,"inventory",H,r(t)),t.monsterEmeny=null,t.emenyParam={constitution:5,spirit:20,willpower:15},t.emenyAC=10,t}n(t,e);var a=t.prototype;return a.onLoad=function(){y.instance.on("battleStart",this.battleStart.bind(this))},a.onDestroy=function(){y.instance.off("battleStart",this.battleStart)},a.start=function(){var e,t=v.getInstance().storyData.dramas.hdse11589;this.copingSkillCheck.setDramaData(t);var n=((e={})[m.Strength]=15,e[m.Dexterity]=14,e[m.Intelligence]=13,e[m.Wisdom]=12,e[m.Charisma]=10,e[m.Resilience]=8,e);this.characterInfo.character=new d("warrior",1,n,f),y.instance.emit(p.BaseAbilityAllocation,{allocatePoints:0,baseAbilities:n});var i=l(this.characterInfo.member.node);this.monsterEmeny=i.getComponent(S),this.setInventory()},a.setInventory=function(){var e=this;[new b("長劍","15 gold",3,I.Longsword,"long_swood",{dice:"1d8",dice2:"1d10",type:"Slashing"},["Versatile"],"Melee"),new b("銅錘","2 gold",2,I.LightHammer,"hammer",{dice:"1d4",type:"Bludgeoning"},["Light","Thrown"],"Melee"),new b("匕首","2 gold",1,I.Dagger,"dagger",{dice:"1d4",type:"Piercing"},["Finesse","Light","Thrown"],"Melee"),new b("手斧","5 gold",2,I.Handaxe,"axe",{dice:"1d6",type:"Slashing"},["Light","Thrown"],"Melee")].forEach((function(t){return e.inventory.addItem(t)})),[new w("綿甲","padded","5 gold",8,11,0,"Disadvantage","Light"),new w("生皮甲","rawhide","10 gold",12,12,0,"None","Medium"),new w("鎖子甲","chainmail","75 gold",55,16,13,"Disadvantage","Heavy")].forEach((function(t){return e.inventory.addItem(t)})),this.inventory.addItem(new D("盾牌","shield","5 gold",9,2))},a.battleStart=function(){this.characterInfo.rollInitiativeOrder(),this.emenyParam.constitution+=s(1,10),this.emenyAC=Math.min(18,Math.max(this.emenyAC,this.emenyAC+s(-1,2))),this.monsterEmeny.monsterInitial("monster",this.emenyParam,this.emenyAC),this.monsterEmeny.rollInitiativeOrder(1);var e=this.characterInfo.member;y.instance.emit(M.InitiativeOrder,{mainCharacter:e,team:[[e],[this.monsterEmeny]]})},t}(c)).prototype,"rogue",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(z.prototype,"copingSkillCheck",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(z.prototype,"characterInfo",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(z.prototype,"inventory",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=z))||P));a._RF.pop()}}}));

System.register("chunks:///_virtual/DynamicWidthScrollView.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var t,n,e,o,r,l,c,a,s,h,u,p;return{setters:[function(i){t=i.applyDecoratedDescriptor,n=i.inheritsLoose,e=i.initializerDefineProperty,o=i.assertThisInitialized,r=i.createForOfIteratorHelperLoose},function(i){l=i.cclegacy,c=i._decorator,a=i.ScrollView,s=i.UITransform,h=i.Vec3,u=i.v3,p=i.Component}],execute:function(){var d,m,f,w,g,v,W,y;l._RF.push({},"97f47FpcPJIjKbS1g4ndve0","DynamicWidthScrollView",void 0);var V=c.ccclass,b=c.property;i("DynamicWidthScrollView",(d=V("DynamicWidthScrollView"),m=b(a),d((g=t((w=function(i){function t(){for(var t,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=i.call.apply(i,[this].concat(r))||this,e(t,"scrollView",g,o(t)),e(t,"maxWidth",v,o(t)),e(t,"minWidth",W,o(t)),e(t,"spacingX",y,o(t)),t.centerPosition=void 0,t}n(t,i);var l=t.prototype;return l.onLoad=function(){var i,t;this.scrollView?(this.centerPosition=this.scrollView.getComponent(s).convertToWorldSpaceAR(new h(0,0,0)),null==(i=this.scrollView)||null==(t=i.node)||t.on("scrolling",this.onScrolling,this)):console.warn("ScrollView component is not assigned.")},l.onDestroy=function(){var i,t;null==(i=this.scrollView)||null==(t=i.node)||t.off("scrolling",this.onScrolling,this)},l.onScrolling=function(){for(var i,t=this.scrollView.content.children,n=this.scrollView.content.getComponent(s),e=r(t);!(i=e()).done;){var o=i.value,l=n.convertToWorldSpaceAR(o.position),c=h.distance(l,this.centerPosition),a=this.calculateWidth(c);o.getComponent(s).width=a;var p=Math.min(1+a/this.maxWidth,1.3);o.scale=u(p,p,1)}},l.calculateWidth=function(i){var t=this.scrollView.node.getComponent(s).width/2,n=this.minWidth+(this.maxWidth-this.minWidth)*(1-i/t);return n=Math.max(this.minWidth,Math.min(this.maxWidth,n))},t}(p)).prototype,"scrollView",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(w.prototype,"maxWidth",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),W=t(w.prototype,"minWidth",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),y=t(w.prototype,"spacingX",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),f=w))||f));l._RF.pop()}}}));

System.register("chunks:///_virtual/EffectManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,f;return{setters:[function(e){t=e.createClass},function(e){f=e.cclegacy}],execute:function(){f._RF.push({},"b2f1eX9FQRE4L/7VMvooGDE","EffectManager",void 0),e("EffectManager",function(){function e(){this.effects=new Map}var f=e.prototype;return f.addEffect=function(e,t){var f=this.effects.get(e)||[];f.push(t),this.effects.set(e,f),console.log("this.effects:",JSON.stringify(this.effects))},f.removeEffect=function(e,t){var f=this.effects.get(e)||[],n=f.indexOf(t);-1!==n&&f.splice(n,1),0===f.length&&this.effects.delete(e),console.log("Effect removed from "+e.name)},f.applySkillEffects=function(e,t){},f.updateEffects=function(){var e=this;console.log("updateEffects",this.effects),this.effects.forEach((function(t,f){f.resetBonuses(),e.effects.set(f,t.filter((function(t){return t.duration>0&&(t.duration--,!(t.duration<=0)||(e.removeEffect(f,t),!1))}))),0===t.length&&e.clearEffects(f)}))},f.clearEffects=function(e){this.effects.delete(e),console.log("All effects cleared from "+e.name)},t(e,null,[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}())._instance=void 0,f._RF.pop()}}}));

System.register("chunks:///_virtual/EnemySkill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatSkill.ts"],(function(e){var t,i,n,a;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,n=e.randomRangeInt},function(e){a=e.CombatSkill}],execute:function(){i._RF.push({},"3fc85sLUQZJ1aKlSIc/AZ84","EnemySkill",void 0);e("EnemySkill",function(e){function i(){return e.apply(this,arguments)||this}t(i,e);var a=i.prototype;return a.getAffix=function(){return[{name:"射擊:配合呼吸",description:"「冷靜，配合呼吸再放弓…」",effect:{affix:"inspiration",value:1,duration:2}},{name:"射擊:穩定姿態",description:"「讓手指保持穩定…」",effect:{affix:"inspiration",value:n(2,3),duration:2}},{name:"射擊:瞄定再發",description:"「先瞄準，再發射…」",effect:{affix:"precision",value:1,duration:2}},{name:"射擊:預測準星",description:"「我看見了…能命中！」",effect:{affix:"precision",value:n(2,3),duration:2}}]},a.applySkillEffects=function(e,t,i){var a=this;if(i>this.level)console.log("等級不足");else switch(i){case 1:console.log("弱點射擊");var o={affix:"inspiration",value:n(3,6),duration:2};this.activateSkillEffect(e,o);break;case 2:console.log("精準射擊");o={affix:"precision",value:n(1,6),duration:2};this.activateSkillEffect(e,o);break;case 3:console.log("分裂箭");break;case 4:console.log("突襲射擊");break;case 5:t.forEach((function(e){console.log("光眩射擊"),Math.random()<.25&&(console.log(e.name+" is blid."),a.activateSkillEffect(e,{affix:"eye",value:1,duration:3}))}));break;case 6:console.log("末日之雨"),t.forEach((function(e){}))}},a.getSkill1=function(){return[{serialId:"skill1",level:1,name:"攻擊",description:"攻擊6點。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"DamageBonus",bonus:"+6",duration:1,conditions:["Melee"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"精準",description:"命中提升4點。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+4",duration:1,conditions:["Melee"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"防禦",description:"專注防禦，+4臨時護甲值。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"Defense",bonus:"+4",duration:1,conditions:["Defense"]}],target:"self",range:"Melee",type:"damage",animation:"attack"}]},i}(a));i._RF.pop()}}}));

System.register("chunks:///_virtual/EquipmentDropZone.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DropZone.ts","./WeaponDraggable.ts","./EventManager.ts","./ArmorDraggable.ts","./ShieldDraggable.ts"],(function(e){var n,t,i,o,r,a,p,l,u,s,c,d;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,p=e.Enum},function(e){l=e.DropZone},function(e){u=e.WeaponDraggable},function(e){s=e.EventManager},function(e){c=e.ArmorDraggable},function(e){d=e.ShieldDraggable}],execute:function(){var m,h,g,f,x,D;r._RF.push({},"a3adfkKUFhPtb2tHmzEtFBZ","EquipmentDropZone",void 0);var q=a.ccclass,I=a.property,b=e("EquipmentDropZoneIndex",function(e){return e[e.None=0]="None",e[e.WeaponOrShield=1]="WeaponOrShield",e[e.Armor=2]="Armor",e}({}));p(b);e("EquipmentDropZone",(m=q("EquipmentDropZone"),h=I({type:b}),m((x=n((f=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=e.call.apply(e,[this].concat(r))||this,i(n,"equipmentIndex",x,o(n)),i(n,"serialIndex",D,o(n)),n}return t(n,e),n.prototype.onDrop=function(t){var i=t.draggableItem,o=t.dropZone;return console.log("Drop Zone",o instanceof n,this.equipmentIndex),this.equipmentIndex===b.WeaponOrShield&&i instanceof u?(e.prototype.onDrop.call(this,t),console.log("Weapon dropped",i.item),i.equipmentIndex=this.equipmentIndex,void s.instance.emit("CharacterEquipWeapon",{index:this.serialIndex,item:i.item})):this.equipmentIndex===b.Armor&&i instanceof c?(e.prototype.onDrop.call(this,t),console.log("Armor dropped",i.item),i.equipmentIndex=this.equipmentIndex,void s.instance.emit("CharacterEquipArmor",{index:this.serialIndex,item:i.item})):this.equipmentIndex===b.WeaponOrShield&&i instanceof d?(e.prototype.onDrop.call(this,t),console.log("Armor dropped",i.item),i.equipmentIndex=this.equipmentIndex,void s.instance.emit("CharacterEquipShield",{index:this.serialIndex,item:i.item})):void i.onTouchCancel()},n}(l)).prototype,"equipmentIndex",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return b.WeaponOrShield}}),D=n(f.prototype,"serialIndex",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),g=f))||g));r._RF.pop()}}}));

System.register("chunks:///_virtual/EventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t;return{setters:[function(e){n=e.createClass},function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"65c67rVRUBMuLluwFwAgOe1","EventManager",void 0),e("EventManager",function(){function e(){this._listeners=new Map}var t=e.prototype;return t.on=function(e,n){this._listeners.has(e)||this._listeners.set(e,[]),this._listeners.get(e).push(n)},t.emit=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),s=1;s<n;s++)t[s-1]=arguments[s];this._listeners.has(e)&&this._listeners.get(e).forEach((function(e){return e.apply(void 0,t)}))},t.off=function(e,n){if(this._listeners.has(e)){var t=this._listeners.get(e),s=t.indexOf(n);s>-1&&t.splice(s,1)}},n(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}())._instance=void 0,t._RF.pop()}}}));

System.register("chunks:///_virtual/EventSystem.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"211fa4FmRNN/rOqFXMgfjsU","EventSystem",void 0);t("NotifyEvent",(function(t,e){this.type=void 0,this.detail=void 0,this.type=t,this.detail=e})),t("EventBus",function(){function t(){this.listeners={}}var e=t.prototype;return e.subscribe=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e.unsubscribe=function(t,e){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter((function(t){return t!==e})))},e.publish=function(t){(this.listeners[t.type]||[]).forEach((function(e){return e(t.detail)}))},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/ExplorationCard.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Card.ts"],(function(e){var r,t,o,u,n;return{setters:[function(e){r=e.inheritsLoose,t=e.createClass},function(e){o=e.cclegacy,u=e.randomRangeInt},function(e){n=e.Card}],execute:function(){o._RF.push({},"0d421D24X1A45qQ4UMTsZR2","ExplorationCard",void 0);var s=e("CardSuit",function(e){return e[e.Prop=0]="Prop",e[e.Clue=1]="Clue",e[e.Doubt=2]="Doubt",e[e.Presage=3]="Presage",e}({}));e("ExplorationCard",function(e){function o(){for(var r,t=arguments.length,o=new Array(t),u=0;u<t;u++)o[u]=arguments[u];return(r=e.call.apply(e,[this].concat(o))||this)._intro="",r}r(o,e);var n=o.prototype;return n.getPropSetting=function(){var e=["夾層","書頁","文字","藏匿點","密道","機關"];return e[u(0,e.length-1)]},n.getClueSetting=function(){var e=["刻痕","沾染","燒焦","足跡","排序","留言","紀錄","手感"];return e[u(0,e.length-1)]},n.getDoubtSetting=function(){var e=["滅跡","缺失","短少","矛盾","陌生","異樣"];return e[u(0,e.length-1)]},n.getPresageSetting=function(){var e=["記憶","好奇","違和","不安","導引","聯想"];return e[u(0,e.length-1)]},n.getReasoning=function(e){var r=[this.test0(),this.test00(),this.test1(),this.test2(),this.test3(),this.test4(),this.test5()];return r[e%r.length]},n.test0=function(){var e,r;return{question:"這一道門上鎖了，找出[鑰匙]後即可<color=#ffcc00>開門</color>。",cards:[(e={},e[s.Prop]="[鑰匙]掛在牆壁上。",e[s.Presage]="牆上閃著銀色光芒，是一把[鑰匙]",e[s.Clue]="牆上有一把[鑰匙]，似乎可以用來開門。",e[s.Doubt]="[鑰匙]？看來這個難題太過容易。",e),(r={},r[s.Prop]="房間空盪盪，沒有其他東西。",r[s.Presage]="地板上似乎有些腐朽。",r[s.Clue]="牆上掛著一個小物件。",r[s.Doubt]="門真的鎖上了嗎？",r)]}},n.test00=function(){var e,r,t;return{question:"對應著上鎖的紅色門，找出[紅鑰匙]後即可<color=#ffcc00>開門</color>。",cards:[(e={},e[s.Prop]="[綠鑰匙]掛在牆壁上。",e[s.Presage]="牆上閃著銀色光芒，是一把[綠鑰匙]",e[s.Clue]="牆上有一把[綠鑰匙]，似乎可以用來開門。",e[s.Doubt]="[綠鑰匙]？看來這個難題太過容易。",e),(r={},r[s.Prop]="桌子上有一串鑰匙。",r[s.Presage]="藍色的[藍鑰匙]在桌子上很顯眼。",r[s.Clue]="桌上有一把[藍鑰匙]，似乎可以用來開門。",r[s.Doubt]="[藍鑰匙]？看來這個難題太過容易。",r),(t={},t[s.Prop]="枯死的盆栽在角落有些可憐。",t[s.Presage]="似乎在盆栽的深些有個紅色的東西",t[s.Clue]="探索盆栽後，有一個紅色的[紅鑰匙]。",t[s.Doubt]="盆栽是紅色的，是否跟紅色的門與鑰匙有關？",t)]}},n.test1=function(){var e,r,t;return{question:"輸入[三碼數字]的密碼解鎖[密碼鎖]後，順利打開[盒子]後從裡面取出一把精美的<color=#ffcc00>寶石匕首</color>。",cards:[(e={},e[s.Prop]="牆角邊有一個普通的木桶。",e[s.Presage]="木桶似乎有些新的小洞口。",e[s.Clue]="木桶的裡面有一個小小的洞，透過洞望進去可以看到一張寫著[三碼數字]的小紙條。",e[s.Doubt]="木桶的洞似乎被不斷挖開過，也許有些人想從中掏出什麼？",e),(r={},r[s.Prop]="[盒子]用[密碼鎖]上鎖了。",r[s.Presage]="[盒子]有些沉重，裡面裝著什麼。",r[s.Clue]="[盒子]上的鎖，是個三位數的[密碼鎖]。",r[s.Doubt]="[盒子]有個鎖，裡面的東西似乎很重要？",r),(t={},t[s.Prop]="一扇被破壞過的窗戶。",t[s.Presage]="窗戶上的窗簾看起來很破舊。",t[s.Clue]="窗簾似乎被巨大的爪子抓過…",t[s.Doubt]="窗戶的玻璃全被敲破，因此釘上許多木板，也許曾經有人想突破進來？",t)]}},n.test2=function(){var e,r,t,o;return{question:"透過寫在[照片]背面的開啟方法，打開[密封罐]後從中掏出一卷<color=#ffcc00>紅印文件</color>。",cards:[(e={},e[s.Prop]="展示櫃內部陳列著各式各樣的收藏品。",e[s.Presage]="當靠近展示櫃時，可以聽到微弱的機械運作聲。",e[s.Clue]="展示櫃的一個[密封罐]的位置發現了被頻繁觸碰或移動的磨損痕跡。",e[s.Doubt]="展示櫃中一件展品標籤與其他似乎略有不同",e),(r={},r[s.Prop]="展示櫃的[密封罐]中裝有一卷羊皮紙。",r[s.Presage]="[密封罐]外觀與它應有的重量還來得輕。",r[s.Clue]="[密封罐]的蓋子有特殊的旋轉機制，需按照特定順序旋轉才能打開。",r[s.Doubt]="罐內的物品看起來與展示櫃中其它展示物毫無關聯。",r),(t={},t[s.Prop]="[文書匣]內部分類細緻，但其中一個隔層異常緊固。",t[s.Presage]="打開[文書匣]時，一股陳年的紙張氣味撲面而來，中間卻夾帶著一絲[新墨水]的氣味。",t[s.Clue]="文書匣中一份文件因[紅色印記]而十分顯眼，但明顯是偽造的，用來掩蓋真實文件的存在。",t[s.Doubt]="[文書匣]中某些文件顯示出被重新放置的痕跡，似乎有人試圖隱藏或更改某些信息。",t),(o={},o[s.Prop]="相框是普通的裝飾品，背板可以拆卸取出[照片]",o[s.Presage]="觀察相框時，可以發現框架的某部分略有色差。",o[s.Clue]="相框中的[照片]的背面寫上如何開啟[密封罐]的方法。",o[s.Doubt]="照片中的人物與房間內其他照片的人物不同",o)]}},n.test3=function(){var e,r,t,o;return{question:"在[矮櫃]裡發現了一本[記事本]，用[鑰匙]開啟小鎖後從書頁中抽出一張<color=#ffcc00>邀請卡</color>。",cards:[(e={},e[s.Prop]="一張精緻的[茶几]，表面雕刻複雜，似乎能夠滑動，隱藏著一個[秘密抽屜]。",e[s.Presage]="靠近[茶几]時，你注意到桌面略有灰塵，但一個區域異常潔净，似乎有物體經常被放置在此。",e[s.Clue]="[茶几]上有明顯的刮痕，好像有重物被頻繁拖動過。",e[s.Doubt]="[茶几]的一個角落經常被某物撞擊，使得那裡的木材顯得略微凹陷。",e),(r={},r[s.Prop]="[矮櫃]裡藏有多個抽屜和小隔間，一個隔間似乎比其他的更難打開。",r[s.Presage]="打開[矮櫃]的時候，摸索後發現[木夾板]是用一本[記事本]偽裝而成的。",r[s.Clue]="[矮櫃]的背板有輕微的移動痕跡，暗示背後可能有[隱藏空間]。",r[s.Doubt]="[矮櫃]頂面有一塊顏色不匹配的[木夾板]，看起來是後來更換的。",r),(t={},t[s.Prop]="一本木制封面的記事本，皮革書封用[小鎖]鎖住無法打開這本記事，似乎藏有重要的秘密。",t[s.Presage]="輕撫記事本的書緣時，感覺到某些頁面比其他頁厚重。",t[s.Clue]="記事本的邊緣有奇怪的磨損，顯示經常被翻到某幾頁。",t[s.Doubt]="木製的封面將記事本偽裝成木夾板，是否意味著記事本的內容十分重要？",t),(o={},o[s.Prop]="這支筆外形奢華，裝有特殊的墨水，似乎只有特定的光線下才能看見其書寫的內容。",o[s.Presage]="拿起筆寫字時較沉重，且筆身搖動時有異音，讓人感覺它不只是用來寫字。",o[s.Clue]="筆桿被精心設計，可以轉動中間的金環，變成一支[鑰匙]。",o[s.Doubt]="筆的一端略顯磨損，不符合其整體保存狀態，似乎常被用於非正常用途？",o)]}},n.test4=function(){var e,r,t;return{question:"掀開[紅地毯]後發現下面有個方形[卡槽]，將[八音盒]放入其中後開始運作並奏著美妙的旋律，隨之在中心發現<color=#ffcc00>源質核心</color>。",cards:[(e={},e[s.Prop]="一幅描繪古典音樂家的[畫作]。",e[s.Presage]="畫框略顯老舊，但特定角度下會發現一個簽名。",e[s.Clue]="[畫作]的一個角落藏有微小的文字，提供了開啟[木盒]的線索。",e[s.Doubt]="[畫作]的繪製日期與畫框打印的日期相差很遠。",e),(r={},r[s.Prop]="精緻的小[木盒]，從[畫作]中的文字破解後發現這是一個[八音盒]。",r[s.Presage]="觸摸[木盒]時，你感受到一絲不尋常的震動，似乎內部裝有機械裝置，並繪著[音符]。",r[s.Clue]="[木盒]的側面雕刻著[音符]，與[紅地毯]上的圖案驚人地相似。",r[s.Doubt]="[木盒]的鎖看上去新近更換，與盒子的整體古老感覺不符。",r),(t={},t[s.Prop]="厚重的[紅地毯]，其圖案精美。",t[s.Presage]="踩上[紅地毯]後有個區塊有些凹陷，掀開後發現下面有個方形[卡槽]，與[木盒]的底部符合",t[s.Clue]="[紅地毯]的邊緣繪製的圖形與[木盒]底部的方形雕刻相似。",t[s.Doubt]="[紅地毯]有塊凹陷，掀開後發現下面有個方形[卡槽]",t)]}},n.test5=function(){var e,r,t,o,u,n,a;return{question:"跟隨著[箭頭花紋]發現到牆壁上的[畫作]後方的空間，並發現其中的[保險箱]，用薄片狀的[鐵片鑰匙]來開啟，獲得了<color=#ffcc00>金色鑰匙</color>。",cards:[(e={},e[s.Prop]="桌子上放置一個[花瓶]",e[s.Presage]="調整長短不一的桌腳使桌子穩定後，發現桌子底部貼有一本[日記]。",e[s.Clue]="轉動桌面讓符號相呼應後，一個[隱藏抽屜]被啟動，藏有一封[書信]。",e[s.Doubt]="試著解釋桌角磨損的原因後發現桌腳是可以旋轉的，擰開後掉出一張[紙條]。",e),(r={},r[s.Prop]="拉動特定的[書籍]可啟動機關。",r[s.Presage]="將錯位的[書籍]調整正確位置後，[書櫃]的一個[暗格]彈開，裡面有一把鑰匙。",r[s.Clue]="書脊上的隱喻指向[箭頭花紋]引導提示到[書櫃]後方，摸索後發現背後有一把薄片狀的[鐵片鑰匙]。",r[s.Doubt]="填補遺失[書籍]的空位後，觸發一陣機關轉動的聲音後，書櫃旁邊的[隱藏抽屜]打開，裡面有一把鑰匙。",r),(t={},t[s.Prop]="從桌子底下發現一本[日記]，提及[書櫃]的角落藏有某些秘密。",t[s.Presage]="好奇查找[日記]提及的[書櫃]上方角落，找到藏著的一把薄片狀的[鐵片鑰匙]。",t[s.Clue]="日記中提到一個特定日期，按照日期順序排列[書櫃]上的書，彈出[暗格]，發現一個[箭頭花紋]。",t[s.Doubt]="發現並解決[日記]中日期的矛盾後，從日記的暗號中獲得[隱藏抽屜]的提示。",t),(o={},o[s.Prop]="信中提到的秘密會面地點，實際上是指[羊毛毯]下的藏匿著重要的東西。",o[s.Presage]="地點相關聯的線索引導到一個秘密的[隱藏抽屜]，鑰匙孔適用一種薄片狀的鑰匙來開啟。",o[s.Clue]="信件邊緣的撕裂部分藏有一把薄片狀的[鐵片鑰匙]。",o[s.Doubt]="解開時間矛盾後，發現[羊毛毯]下方的[隱藏抽屜]，鑰匙孔適用一種薄片狀的鑰匙來開啟。",o),(u={},u[s.Prop]="移動[畫作]發現牆壁中的[保險箱]，鑰匙孔適用一種薄片狀的鑰匙來開啟。",u[s.Presage]="機械運作的聲音來源是牆後的一個隱藏門，移動[畫作]後可以發現牆壁中的[保險箱]。",u[s.Clue]="探索裂縫延伸而去的方向，意外發現隱藏牆後隱藏著一個放置[保險箱]的空間。",u[s.Doubt]="調查後發現[畫作]與房間的空間細節不符合後，找到畫背後的[保險箱]。",u),(n={},n[s.Prop]="掀開[羊毛毯]後，發現下方的[隱藏抽屜]。",n[s.Presage]="感到[羊毛毯]下的空洞迴響，發現下方的[隱藏抽屜]，使用薄片狀的鑰匙開啟後發現了[箭頭花紋]。",n[s.Clue]="地板符號是一個方向導引，使用薄片狀的鑰匙開啟後發現了[箭頭花紋]。感到[羊毛毯]下的空洞迴響，發現下方的[隱藏抽屜]，使用薄片狀的鑰匙開啟後發現了[箭頭花紋]。",n[s.Doubt]="日記的圖案與地板符號匹配後，使用薄片狀的鑰匙開啟後發現了[箭頭花紋]。",n),(a={},a[s.Prop]="花瓶的底部轉動後，發現藏有一把薄片狀的[鐵片鑰匙]。",a[s.Presage]="花瓶被移動的痕跡指向底座下的秘密抽屜，裡面有一把薄片狀的[鐵片鑰匙]。",a[s.Clue]="花瓶內部的隱藏底部打開，裡面藏有一把薄片狀的[鐵片鑰匙]。",a[s.Doubt]="花的新鮮度異常指引檢查花瓶水的底部，找到一把薄片狀的[鐵片鑰匙]。",a)]}},t(o,[{key:"intro",set:function(e){this._intro=e}}]),o}(n));o._RF.pop()}}}));

System.register("chunks:///_virtual/FillBlanks.ts",["cc","./Card.ts"],(function(e){var r,t;return{setters:[function(e){r=e.cclegacy},function(e){t=e.TipCard}],execute:function(){r._RF.push({},"29ba5DJel5CtJ7/DFwmBiNL","FillBlanks",void 0);e("FillBlanks",function(){function e(){}return e.answerQuestion=function(e,r,t){void 0===t&&(t="#FFFF00");var n=r.slice();return e.replace(/_/g,(function(e){return"<color="+t+"><u>"+(n.shift()||"_")+"</u></c>"}))},e.replaceAndStore=function(e,r,t){var n=[];return{replacedText:e.replace(r,(function(e,r){return n.push(r),t})),storedTexts:n}},e.replaceKeywordsWidthBlanks=function(e){for(var r=[],t=[],n=0;n<e.length;n++){var s=this.replaceAndStore(e[n],/\[(.*?)\]/g,"_"),i=s.replacedText,c=s.storedTexts;r.push(i),t.push(c)}return{replacedTexts:r,storedTexts:t}},e.replaceMarkedWithKeywords=function(r,n){for(var s=[],i=[],c=0;c<r.length;c++){var u=r[c],a=this.markedWithKeywords(u,n),o=a.replacedText,l=a.storedTexts,p=l.map((function(e){return e.split(" | ")[0]}));s.push(e.answerQuestion(o,p));var d=l.map((function(e){var r=e.split(" | "),n=new t;return n.string=r.shift(),r.forEach((function(e,r){var t=e.split(":");n[t[0]]=t[1]})),n}));i.push(d)}return{replacedTexts:s,newKeywords:i}},e.markedWithKeywords=function(e,r){var t=/\[(.*?)\]/g;return r.forEach((function(r){e.indexOf(r)>-1&&(e=e.replace(t,(function(e,t){return t===r?r:e})))})),this.replaceAndStore(e,t,"_")},e}());r._RF.pop()}}}));

System.register("chunks:///_virtual/FirebaseBridge.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.esm.js","./index-77658911.js","./index.esm2017.js","./index.esm20173.js","./tslib.es6.mjs","./index.esm20172.js"],(function(e){var n,t,o,r,i,a,c,s,u,l,f,p,d,v;return{setters:[function(e){n=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){o=e.cclegacy},null,function(e){r=e.ab,i=e.o},function(e){a=e.initializeApp},null,null,function(e){c=e.onValue,s=e.ref,u=e.off,l=e.set,f=e.get,p=e.child,d=e.push,v=e.getDatabase}],execute:function(){o._RF.push({},"486ceOYX8JNTqCqKaRQagmq","FirebaseBridge",void 0);var h,g="DungeonEscape",m={},b=(e("default",function(){function e(){var e=a({apiKey:"AIzaSyAc5PRwmE14gBH5az8TSoqs9aBrQ8YWa4o",authDomain:"fir-test-756e1.firebaseapp.com",databaseURL:"https://fir-test-756e1.firebaseio.com",projectId:"fir-test-756e1",storageBucket:"fir-test-756e1.appspot.com",messagingSenderId:"182531440628"});h=v(e)}var o=e.prototype;return o.signInWithGoogleEmail=function(){var e=n(t().mark((function e(n,o){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r(i(),n,o);case 3:return a=e.sent,e.abrupt("return",a.user.uid);case 7:throw e.prev=7,e.t0=e.catch(0),new Error("登入失敗: "+e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,t){return e.apply(this,arguments)}}(),o._onReceive=function(e,n){var t,o=n,r="",i=n.indexOf(" ");i>0&&(o=n.slice(0,i),r=n.slice(i+1)),null==(t=m[e])||t.forEach((function(n){return n.onReceive(e,o,r)}))},o.addDispatcher=function(e,n,t){if(""===e)throw new Error("connectID 不能為空白");var o=m[e]||[];o.some((function(e){if(e.scope===n)return Object.keys(t).forEach((function(n){return e.callbackMap[n]=t[n]})),!0}))||o.push(new b(n,t)),m[e]=o},o.removeDispatcher=function(e,n){var t=m[e];if(t){var o=t.findIndex((function(e){return e.scope===n}));-1!==o&&t.splice(o,1),0===t.length&&delete m[e]}},o.addConnection=function(e,n,t){var o=this;void 0===t&&(t="");var r=g+"/C/"+e+"/"+n+"/"+t;c(s(h,r),(function(r){var i=r.val();console.log("[NOTIFY]",n,t,":",i),i&&function(n){o._onReceive(e,n)}(i)})),console.log("加入監聽:",r)},o.delConnection=function(e,n,t){void 0===t&&(t="");var o=g+"/C/"+e+"/"+n+"/"+t;u(s(h,o)),console.log("移除監聽:",o)},o.uploadInfo=function(e,n,t,o,r){void 0===r&&(r="");var i=t?n+" "+t:n;l(s(h,g+"/C/"+e+"/"+o+"/"+r),i)},o.loadAsync=function(e,n){var t=g+"/D/"+e+"/";return new Promise((function(o){f(n?p(s(h,t),n):s(h,t)).then((function(t){var r=t.val();o(r),console.log(e,n,"::::",r)}))}))},o.addDataLabel=function(e,n){void 0===n&&(n=-1);var t=g+"/D";return e?console.log(e+"刷新資料:"+JSON.stringify(n)):e=d(s(h,t)).key||"",l(s(h,t+"/"+e+"/"),n),e},o.delDataLabel=function(e){l(s(h,"DungeonEscape/D/"+e+"/"),null)},e}()),function(){function e(e,n){this.scope=void 0,this.callbackMap=void 0,this.scope=e,this.callbackMap=n}return e.prototype.onReceive=function(e,n,t){var o=this.callbackMap[n];if(o)try{o.call(this.scope,e,n,t)}catch(e){console.error("執行回調時錯誤: "+e.message)}},e}());o._RF.pop()}}}));

System.register("chunks:///_virtual/FloatingTextComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,a,l,s,u,c,p,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,l=t.Color,s=t.Vec3,u=t.Label,c=t.instantiate,p=t.tween,b=t.Component}],execute:function(){var f,g,m,v,h,y,d,C,w,P,z,L,x;r._RF.push({},"6e930lNmNxI/bj5j7OKSnzK","FloatingTextComponent",void 0);var F=a.ccclass,T=a.property;t("FloatingTextComponent",(f=F("FloatingTextComponent"),g=T(l),m=T(l),v=T(s),h=T(s),y=T(u),f((w=e((C=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"positiveColor",w,o(e)),i(e,"negativeColor",P,o(e)),i(e,"startPoint",z,o(e)),i(e,"endPoint",L,o(e)),i(e,"templateLabel",x,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){this.templateLabel.node.active=!1},r.showNumber=function(t,e){var n=c(this.templateLabel.node);n.setParent(this.node),n.active=!0;var i=n.getComponent(u);i.string=(t>0?"+":"")+t.toString(),i.color=t>0?this.positiveColor:this.negativeColor,n.setPosition(this.startPoint),p(n).to(1.5,{position:this.endPoint},{easing:"elasticOut"}).call((function(){n.destroy(),null==e||e()})).start()},e}(b)).prototype,"positiveColor",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(0,255,0)}}),P=e(C.prototype,"negativeColor",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(255,0,0)}}),z=e(C.prototype,"startPoint",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s(0,0,0)}}),L=e(C.prototype,"endPoint",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s(0,100,0)}}),x=e(C.prototype,"templateLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=C))||d));r._RF.pop()}}}));

System.register("chunks:///_virtual/FoldCards.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,o,n,r,i,l,c,s,a,d,u,h,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,l=e._decorator,c=e.Node,s=e.Button,a=e.Sprite,d=e.Color,u=e.instantiate,h=e.Label,C=e.Component}],execute:function(){var p,f,_,g,v,b,y;i._RF.push({},"a78ae3xgKlLYqn9+yGYTQTS","FoldCards",void 0);var m=l.ccclass,R=l.property;e("FoldCards",(p=m("FoldCards"),f=R(c),_=R(s),p((b=t((v=function(e){function t(){for(var t,o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return t=e.call.apply(e,[this].concat(i))||this,n(t,"cardRoot",b,r(t)),n(t,"sendButton",y,r(t)),t.eventSendCallback=null,t._secletedCards=[],t.selectMax=0,t._oriColor=void 0,t}o(t,e);var i=t.prototype;return i.show=function(e){this.node.active=e,this.sendButton.node.active=!1,this._secletedCards.length=0},i.list=function(e,t){var o=this,n=this.cardRoot.children;n.forEach((function(e){return e.active=!1}));var r=n[0].getComponent(a).color;this._oriColor=new d(r.r,r.g,r.b,r.a),e.forEach((function(e,r){var i=n[r];i||((i=u(n[0])).parent=o.cardRoot),i.active=!0,i.getComponentInChildren(h).string=e,i.off("click"),i.on("click",(function(){null==t||t(e),-1===o._secletedCards.indexOf(e)?(o._secletedCards.push(e),i.getComponent(a).color=d.RED):(o._secletedCards.splice(o._secletedCards.findIndex((function(t){return t===e})),1),i.getComponent(a).color=o._oriColor),console.log("this._secletedCards:",o._secletedCards),o.sendButton.node.active=o._secletedCards.length===o.selectMax}),o)}))},i.onSendButtonClicked=function(){var e,t=this;console.log("this._secletedCards:",this._secletedCards),this.cardRoot.children.forEach((function(e){return e.getComponent(a).color=t._oriColor})),null==(e=this.eventSendCallback)||e.call(this,this._secletedCards.slice()),this._secletedCards.length=0},t}(C)).prototype,"cardRoot",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(v.prototype,"sendButton",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=v))||g));i._RF.pop()}}}));

System.register("chunks:///_virtual/GameEvents.ts",["cc"],(function(a){var e;return{setters:[function(a){e=a.cclegacy}],execute:function(){e._RF.push({},"1950a+JJJlGvJeGTM+lZbMJ","GameEvents",void 0);a("GameLogicEvent",function(a){return a.GameStart="game-logic-game-start",a.GameEnd="game-logic-game-end",a.GameResume="game-logic-game-resume",a.GamePause="game-logic-game-pause",a.GameRoundStart="game-logic-game-round-start",a.GameRoundStartShowCards="game-logic-game-round-start-show-cards",a.GameRoundStartConfirmSelection="game-logic-game-round-start-confirm-selection",a.GameRoundPlayerDiscardCards="game-logic-game-round-player-discard-cards",a.GameRoundStartDiscardCards="game-logic-game-round-start-discard-cards",a.GameRoundStartDealCards="game-logic-game-round-start-deal-cards",a.GameRoundStartShowCommunityCards="game-logic-game-round-start-show-community-cards",a.GameRoundStartShowPlayerHands="game-logic-game-round-start-show-player-hands",a.GameRoundStartShowDiscardPile="game-logic-game-round-start-show-discard-pile",a.GameRoundNextPlayerTurn="game-logic-game-round-next-player-turn",a.GameRoundEndShowCards="game-logic-game-round-end-show-cards",a}({})),a("GameUIEvent",function(a){return a.GameStart="game-ui-game-start",a.GameEnd="game-ui-game-end",a.DeckCardSelected="game-ui-card-selected",a.DeckCardUnselected="game-ui-card-unselected",a.DeckCardDiscard="game-ui-card-discard",a.ShowCardConditions="game-ui-show-card-conditions",a.ShowCardConditions2="game-ui-show-card-conditions2",a}({})),a("DeckPileEvent",function(a){return a.ShowCards="deck-card-show-cards",a.DiscardCards="deck-card-discard-cards",a.DealCommunityCards="deck-card-deal-cards",a.DealPlayerCards="deck-card-deal-player-cards",a.DeckGatherings="deck-card-gatherings",a.HideCards="deck-card-hide-cards",a}({})),a("CommunityCardEvent",function(a){return a.DealCards="community-card-deal-cards",a.ShowCards="community-card-show-cards",a.CompareCards="community-card-campare-cards",a}({})),a("PlayerHandCardEvent",function(a){return a.DealCards="player-hand-card-deal-cards",a.ShowCards="player-hand-card-show-cards",a.CompareCards="player-hand-card-compare-cards",a.SendCards="player-hand-card-send-cards",a.ReceiveCards="player-hand-card-receive-cards",a}({})),a("WordPuzzleGameLogicEvent",function(a){return a.WordPuzzleGameStart="word-puzzle-game-start",a.WordPuzzleGameEnd="word-puzzle-game-end",a.ShowQuestion="word-puzzle-game-logic-show-question",a.ShowAnswer="word-puzzle-game-logic-show-answer",a.ShowHint="word-puzzle-game-logic-show-hint",a.TexasGameStart="word-puzzle-game-logic-texas-game-start",a.TexasGameResume="word-puzzle-game-logic-texas-game-resume",a}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/HandCards.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DynamicWidthScrollView.ts"],(function(e){var t,n,o,i,r,l,s,c,a,d,u,h,p,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,s=e.Node,c=e.Button,a=e.Color,d=e.Sprite,u=e.instantiate,h=e.Label,p=e.Component},function(e){C=e.DynamicWidthScrollView}],execute:function(){var f,_,b,g,v,m,w,y,P,x,S;r._RF.push({},"880f34hHldLa4t21nW2dLUl","HandCards",void 0);var k=l.ccclass,B=l.property;e("HandCards",(f=k("HandCards"),_=B(s),b=B(c),g=B(C),v=B(a),f((y=t((w=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,o(t,"cardRoot",y,i(t)),o(t,"sendButton",P,i(t)),o(t,"dwScrollView",x,i(t)),o(t,"selectedColor",S,i(t)),t.eventSendCallback=null,t.selectMax=0,t._secletedCards=[],t._buttonTemps=[],t._oriColor=void 0,t._oriPositionY=void 0,t}n(t,e);var r=t.prototype;return r.show=function(e){console.log(e?"顯示":"隱藏",this.node.name),this.node.active=e,this.sendButton.node.active=!1},r.list=function(e,t){var n,o=this,i=this.cardRoot.children,r=i[0].getComponentInChildren(d).color;this._oriColor=new a(r.r,r.g,r.b,r.a),this._oriPositionY=i[0].position.y,i.forEach((function(e){e.setPosition(e.position.x,o._oriPositionY),e.active=!1})),this._buttonTemps.length=0,e.forEach((function(e,n){var r=i[n];r||((r=u(i[0])).parent=o.cardRoot),r.active=!0;var l=r.getComponentInChildren(c);l&&(l.enabled=!1,r.getComponentInChildren(h).string=e.string,l.node.off("click"),l.node.on("click",(function(){-1===o._secletedCards.indexOf(e)?(o._secletedCards.push(e),r.setPosition(r.position.x,r.position.y+50),r.getComponentInChildren(d).color=o.selectedColor):(o._secletedCards.splice(o._secletedCards.findIndex((function(t){return t===e})),1),r.setPosition(r.position.x,o._oriPositionY),r.getComponentInChildren(d).color=o._oriColor),null==t||t(e,o._secletedCards),o.sendButton.node.active=o._secletedCards.length===o.selectMax}),o),o._buttonTemps.push(l))})),null==(n=this.dwScrollView)||n.scrollView.scrollToPercentHorizontal(.5,.1,!0)},r.lock=function(e){this._buttonTemps.forEach((function(t){return t.enabled=!e}))},r.clear=function(){this._secletedCards.length=0,this.selectMax=0,this.eventSendCallback=null,this.sendButton.node.active=!1,this.lock(!1)},r.onSendButtonClicked=function(){var e,t=this;this.selectMax===this._secletedCards.length&&(this.cardRoot.children.forEach((function(e){e.getComponentInChildren(d).color=t._oriColor,e.setPosition(e.position.x,t._oriPositionY)})),null==(e=this.eventSendCallback)||e.call(this,this._secletedCards.slice()),this._secletedCards.length=0)},t}(p)).prototype,"cardRoot",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(w.prototype,"sendButton",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(w.prototype,"dwScrollView",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(w.prototype,"selectedColor",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=w))||m));r._RF.pop()}}}));

System.register("chunks:///_virtual/HandEvaluator.ts",["cc","./ExplorationCard.ts"],(function(t){var r,n;return{setters:[function(t){r=t.cclegacy},function(t){n=t.CardSuit}],execute:function(){r._RF.push({},"63e51xG2fRFbK79cjtJZBqy","HandEvaluator",void 0);var u=t("CardEvaluations",function(t){return t.HighCard="High Card",t.OnePair="One Pair",t.TwoPairs="Two Pairs",t.ThreeOfAKind="Three of a Kind",t.Straight="Straight",t.Flush="Flush",t.FullHouse="Full House",t.FourOfAKind="Four of a Kind",t.StraightFlush="Straight Flush",t.RoyalFlush="Royal Flush",t}({}));t("HandEvaluator",function(){function t(){}return t.evaluateHand=function(t){if(5!==t.length)throw new Error("Must evaluate exactly 5 cards.");var r=this.countRanks(t),n=this.groupBySuit(t);return this.isRoyalFlush(n)?u.RoyalFlush:this.isStraightFlush(n)?u.StraightFlush:this.isFourOfAKind(r)?u.FourOfAKind:this.isFullHouse(r)?u.FullHouse:this.isFlush(n)?u.Flush:this.isStraight(t)?u.Straight:this.isThreeOfAKind(r)?u.ThreeOfAKind:this.isTwoPairs(r)?u.TwoPairs:this.isOnePair(r)?u.OnePair:u.HighCard},t.countRanks=function(t){var r={};return t.forEach((function(t){r[t.rank]=(r[t.rank]||0)+1})),r},t.groupBySuit=function(t){var r,u=((r={})[n.Prop]=[],r[n.Clue]=[],r[n.Doubt]=[],r[n.Presage]=[],r);return t.forEach((function(t){return u[t.suit].push(t)})),u},t.isRoyalFlush=function(t){return this.isStraightFlush(t)&&Object.values(t).some((function(t){return t.some((function(t){return"10"===t.rank}))}))},t.isStraightFlush=function(t){var r=this;return Object.values(t).some((function(t){return t.length>=5&&r.isStraight(t)}))},t.isFourOfAKind=function(t){return Object.values(t).some((function(t){return 4===t}))},t.isFullHouse=function(t){var r=Object.values(t).filter((function(t){return 3===t})).length,n=Object.values(t).filter((function(t){return 2===t})).length;return r>0&&(n>0||r>1)},t.isFlush=function(t){return Object.values(t).some((function(t){return t.length>=5}))},t.isStraight=function(t){var r=this;if(t.length<5)return!1;var n=[].concat(new Set(t.map((function(t){return r.getCardValue(t.rank)}))));n.sort((function(t,r){return t-r}));for(var u=0;u<n.length-4;u++){for(var i=!0,e=u;e<u+4;e++)if(n[e+1]!==n[e]+1){i=!1;break}if(i)return!0}return!1},t.isThreeOfAKind=function(t){return Object.values(t).some((function(t){return 3===t}))},t.isTwoPairs=function(t){return Object.values(t).filter((function(t){return 2===t})).length>=2},t.isOnePair=function(t){return Object.values(t).some((function(t){return 2===t}))},t.getCardValue=function(t){var r={2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13,A:14};if(r.hasOwnProperty(t))return r[t];throw new Error("Invalid card rank specified: "+t)},t}());r._RF.pop()}}}));

System.register("chunks:///_virtual/HitCheckCounter.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CounterComponent.ts"],(function(t){var e,n,r,i,o,u,s,c,a;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized,o=t.createClass},function(t){u=t.cclegacy,s=t._decorator,c=t.Label},function(t){a=t.CounterComponent}],execute:function(){var h,l,p,C,d;u._RF.push({},"40236Owx4NFZqNazj3+SPk2","HitCheckCounter",void 0);var y=s.ccclass,f=s.property;t("HitCheckCounter",(h=y("HitCheckCounter"),l=f(c),h((d=e((C=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return e=t.call.apply(t,[this].concat(o))||this,r(e,"titleLabel",d,i(e)),e.type="Neutral",e}n(e,t);var u=e.prototype;return u.start=function(){},u.updateLabel=function(){"Neutral"===this.type?this.counterLabel.string=this.currentCount.toString():this.counterLabel.string=this.deprecatedCount+" | "+this.currentCount},o(e,[{key:"checkType",set:function(t){this.type=t}},{key:"count",set:function(t){console.log("CounterComponent: set count to "+t,this.currentCount,this.deprecatedCount),"Neutral"===this.type?(this.currentCount=t,this.titleLabel.string="命中檢定值"):"Advantage"===this.type?(t>this.currentCount?(this.deprecatedCount=this.currentCount,0!==t&&(this.currentCount=t)):t>this.deprecatedCount&&0!==t&&(this.deprecatedCount=t),this.titleLabel.string="(優勢)\n命中檢定值"):"Disadvantage"===this.type&&(t<this.currentCount?(this.deprecatedCount=this.currentCount,0!==t&&(this.currentCount=t)):0===this.currentCount?this.currentCount=t:0!==t&&(this.deprecatedCount=t),this.titleLabel.string="(劣勢)\n命中檢定值"),this.updateLabel()}}]),e}(a)).prototype,"titleLabel",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=C))||p));u._RF.pop()}}}));

System.register("chunks:///_virtual/HitPointsBarComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FloatingTextComponent.ts"],(function(t){var e,n,i,o,r,a,p,s,u,l,c,h,m,H;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){a=t.cclegacy,p=t._decorator,s=t.ProgressBar,u=t.Node,l=t.Label,c=t.Vec3,h=t.tween,m=t.Component},function(t){H=t.FloatingTextComponent}],execute:function(){var f,b,g,d,x,P,y,B,w,C,L;a._RF.push({},"975d2k7B9dAQ7imcn3+VIGb","HitPointsBarComponent",void 0);var _=p.ccclass,v=p.property;t("HitPointsBarComponent",(f=_("HitPointsBarComponent"),b=v(s),g=v(H),d=v(u),x=v(l),f((B=e((y=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"hpBar",B,o(e)),i(e,"floatingTextComponent",w,o(e)),i(e,"textSpawnPoint",C,o(e)),i(e,"hpLabel",L,o(e)),e.curHp=100,e.maxHp=100,e._tempHp=0,e}n(e,t);var a=e.prototype;return a.changeHp=function(t){var e=this,n=Math.min(Math.max(this.curHp+t,0),this.maxHp),i=this.textSpawnPoint.position.clone(),o=t<=0?i.add(new c(0,40,0)):i.add(new c(0,-40,0));this.floatingTextComponent.startPoint=o,this.floatingTextComponent.endPoint=this.textSpawnPoint.position,this.floatingTextComponent.showNumber(t,(function(){e.updateBar(n),e.updateHpLabel()}))},a.updateBar=function(t){this.hpBar.progress;var e=(t+this._tempHp)/this.maxHp;h(this.hpBar).to(.25,{progress:e}).start(),this.curHp=t},a.updateHpLabel=function(){this._tempHp?this.hpLabel.string="HP: "+(this.curHp+this._tempHp)+" (+"+this._tempHp+") / "+this.maxHp:this.hpLabel.string="HP: "+this.curHp+" / "+this.maxHp},r(e,[{key:"defaultHp",set:function(t){this.maxHp=t,this.curHp=t,this.updateBar(this.curHp),this.updateHpLabel()}},{key:"tempHp",get:function(){return this._tempHp},set:function(t){this._tempHp=t,this.updateHpLabel()}}]),e}(m)).prototype,"hpBar",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(y.prototype,"floatingTextComponent",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=e(y.prototype,"textSpawnPoint",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(y.prototype,"hpLabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=y))||P));a._RF.pop()}}}));

System.register("chunks:///_virtual/Inventory.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Weapon.ts","./Armor.ts","./Shield.ts","./WeaponDraggable.ts","./DropZone.ts","./ArmorDraggable.ts","./ShieldDraggable.ts"],(function(e){var t,n,o,r,i,a,s,l,u,c,d,h,m,f,p,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,s=e.Node,l=e.instantiate,u=e.Component},function(e){c=e.Weapon},function(e){d=e.Armor},function(e){h=e.Shield},function(e){m=e.WeaponDraggable},function(e){f=e.DropZone},function(e){p=e.ArmorDraggable},function(e){g=e.ShieldDraggable}],execute:function(){var v,b,y,I,w,S,W,D,x;i._RF.push({},"78b630aLRxGKZeZgGyoku7u","Inventory",void 0);var z=a.ccclass,C=a.property;e("Inventory",(v=z("Inventory"),b=C(s),y=C(s),v((S=t((w=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,o(t,"layout",S,r(t)),o(t,"itemPrefab",W,r(t)),o(t,"maxWeight",D,r(t)),o(t,"maxSlots",x,r(t)),t.items=[],t.currentWeight=0,t.currentSlots=0,t}n(t,e);var i=t.prototype;return i.onLoad=function(){this.show(!0)},i.show=function(e){this.node.active=e},i.instantiate=function(e,t){var n=l(this.itemPrefab);if(n.active=!0,e instanceof c){console.log("Weapon "+e.name+" added to inventory.");var o=n.addComponent(m);o.weapon=e,t.node.emit("drop",{draggableItem:o,dropZone:t})}else if(e instanceof d){console.log("Armor "+e.name+" added to inventory.");var r=n.addComponent(p);r.armor=e,t.node.emit("drop",{draggableItem:r,dropZone:t})}else if(e instanceof h){console.log("Shield "+e.name+" added to inventory.");var i=n.addComponent(g);i.shield=e,t.node.emit("drop",{draggableItem:i,dropZone:t})}return n},i.addItem=function(e){if(this.currentWeight+e.weight>this.maxWeight||this.currentSlots+e.size>this.maxSlots)return console.error("Cannot add item: exceeds weight or slot limit."),!1;var t=this.layout.getComponentsInChildren(f).find((function(e){return 0===e.placeholder.children.length}));if(t){this.items.push(e),this.currentWeight+=e.weight,this.currentSlots+=e.size;this.instantiate(e,t);return!0}return!1},i.removeItem=function(e){var t=this.items.findIndex((function(t){return t.name===e}));if(-1===t)return console.error("Item not found in inventory."),!1;var n=this.items[t];return this.items.splice(t,1),this.currentWeight-=n.weight,this.currentSlots-=n.size,console.log(n.name+" removed from inventory."),!0},i.listItems=function(){return this.items},i.onInventoryButtonClicked=function(){this.show(!this.node.active)},t}(u)).prototype,"layout",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(w.prototype,"itemPrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(w.prototype,"maxWeight",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),x=t(w.prototype,"maxSlots",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),I=w))||I));i._RF.pop()}}}));

System.register("chunks:///_virtual/Item.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"416ffYg1JhNjqhpWtayJR5g","Item",void 0);t("Item",(function(t,i,e,s){this.name="",this.cost=void 0,this.weight=0,this.size=1,this.name=t,this.cost=i,this.weight=e,this.size=s}));i._RF.pop()}}}));

System.register("chunks:///_virtual/Logging.ts",["cc"],(function(){var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"24ad5yJ7FJOMqUWSZiPBSUY","Logging",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./MainScene.ts","./BaseCardDisplay.ts","./Card.ts","./CardComponent2.ts","./DungeonEscapeHandler.ts","./DungeonEscapeRecord.ts","./DungeonEscapeView.ts","./ExplorationCard.ts","./FoldCards.ts","./HandCards.ts","./HandEvaluator.ts","./NotifyHandler.ts","./StoryCardStack.ts","./StoryDescribeStack.ts","./YellowCardHandler.ts","./YellowCardPanel.ts","./YellowCardRecord.ts","./FirebaseBridge.ts","./SocketBridge.ts","./RoomHandler.ts","./DataModal.ts","./StoryData.ts","./WordPuzzleData.ts","./Ability.ts","./Character.ts","./ClassFeatureImplementation.ts","./Dungeon.ts","./MazeDisplay.ts","./NetworkGraph.ts","./Rogue.ts","./Skill.ts","./AdventureSkill.ts","./AttributeAllocation.ts","./AttributeComponent.ts","./CopingBehavior.ts","./CopingSkillButton.ts","./DescriptionCrossword.ts","./ArcherySkill.ts","./CombatArmor.ts","./CombatCharacter.ts","./CombatEntity.ts","./CombatIntent.ts","./CombatMonster.ts","./CombatSkill.ts","./CombatWeapon.ts","./EnemySkill.ts","./MeleeSkill.ts","./ArmorDraggable.ts","./EquipmentDropZone.ts","./Inventory.ts","./ShieldDraggable.ts","./WeaponDraggable.ts","./Armor.ts","./Item.ts","./Shield.ts","./Weapon.ts","./CopingSkillCheck.ts","./CrosswordController.ts","./EffectManager.ts","./EventManager.ts","./EventSystem.ts","./GameEvents.ts","./TipClipsAnimation.ts","./UIManager.ts","./CardCombatTest.ts","./CommunityCardsTest.ts","./DungeonTest.ts","./ParticleEffectComponent.ts","./CommunityCards.ts","./DeckCards2.ts","./DeckCardsPile.ts","./DiscardCardsPile.ts","./PlayerHandCards2.ts","./TexasGameLogic.ts","./TexasGamePlayer.ts","./TexasGameUI.ts","./AudioController.ts","./CardMover.ts","./CounterComponent.ts","./DescriptionScrollView.ts","./Draggable.ts","./DropZone.ts","./DynamicWidthScrollView.ts","./FillBlanks.ts","./FloatingTextComponent.ts","./HitCheckCounter.ts","./Logging.ts","./RandomString.ts","./TipText.ts","./CharacterInfo.ts","./HitPointsBarComponent.ts","./CardComponent.ts","./CombatController.ts","./CombatFormation.ts","./CombatOption.ts","./CombatVisualizer.ts","./DeckCards.ts","./DeckCardsPile2.ts","./PlayerHandCards.ts","./TeamMember.ts","./CardReward.ts","./RewardCards.ts","./WordPuzzleGameLogic.ts","./WordPuzzleGameUI.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainScene.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DungeonEscapeHandler.ts","./DungeonEscapeView.ts"],(function(e){var t,o,n,i,a,r,c,l,s,u,m,d,h,R;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,c=e.Node,l=e.Button,s=e.EditBox,u=e.instantiate,m=e.Label,d=e.Component},function(e){h=e.DungeonEscapeHandler},function(e){R=e.DungeonEscapeView}],execute:function(){var f,v,p,b,y,B,g,w,_,G,H,E,C,x,k,z,S,D,L,M,j,N,O;a._RF.push({},"dc7a4oGyFRBH7m1+WQMgD4/","MainScene",void 0);var V=r.ccclass,I=r.property;e("MainScene",(f=V("MainScene"),v=I(c),p=I(c),b=I(l),y=I(l),B=I(l),g=I(l),w=I(l),_=I(s),G=I(R),H=I(c),f((x=t((C=function(e){function t(){for(var t,o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,n(t,"roomRoot",x,i(t)),n(t,"tableRoot",k,i(t)),n(t,"refreshRoomButton",z,i(t)),n(t,"newRoomButton",S,i(t)),n(t,"leaveRoomButton",D,i(t)),n(t,"readyGameButton",L,i(t)),n(t,"startGameButton",M,i(t)),n(t,"nameEditBox",j,i(t)),n(t,"gameView",N,i(t)),n(t,"spreadCardRoot",O,i(t)),t._roomHandler=null,t._gameHandler=null,t._indexGameReady=0,t._playerLocalCacheName="",t}o(t,e);var a=t.prototype;return a.start=function(){},a.onRenameEndEdit=function(){var e=this.nameEditBox.string;this._roomHandler.nickname=e,localStorage.setItem(this._playerLocalCacheName,JSON.stringify({nickname:e}))},a.onNewRoomClicked=function(){this._roomHandler.newRoom("YC-"+Math.round(1e5*Math.random())),this.roomRoot.active=!1,this.refreshRoomButton.node.active=!1,this.newRoomButton.node.active=!1,this.tableRoot.active=!0,this.readyGameButton.node.active=!1,this.startGameButton.node.active=!0,this.leaveRoomButton.node.active=!0},a.onJoinRoom=function(e,t,o){this.roomRoot.active=!1,this.refreshRoomButton.node.active=!1,this.newRoomButton.node.active=!1,this.nameEditBox.node.active=!1,this.tableRoot.active=!0,this.readyGameButton.node.active=!0,this.startGameButton.node.active=!1,this.leaveRoomButton.node.active=!0,this._roomHandler.joinRoom(e,t,o)},a.onUpdateTableList=function(e){var t=this;this.nameEditBox.node.active=!1;var o=this.tableRoot.children;o.forEach((function(e){return e.active=!1})),Object.keys(e).forEach((function(n,i){var a=e[n],r=o[i];r||((r=u(o[0])).parent=t.tableRoot),r.active=!0,r.getComponentInChildren(m).string=a}))},a.onExitRoomClicked=function(){this._roomHandler.leaveRoom(),this.onUpdateRoomList()},a.onUpdateRoomList=function(){var e=this,t=this.roomRoot.children;t.forEach((function(e){return e.active=!1})),this.roomRoot.active=!0,this.refreshRoomButton.node.active=!0,this.newRoomButton.node.active=!0,this.tableRoot.active=!1,this.readyGameButton.node.active=!1,this.startGameButton.node.active=!1,this.leaveRoomButton.node.active=!1,this.nameEditBox.node.active=!0,this._indexGameReady=0,this._roomHandler.loadRoomsAsync().then((function(o){o&&Object.keys(o).forEach((function(n,i){var a=o[n],r=t[i];r||((r=u(t[0])).parent=e.roomRoot),r.active=!0,r.getComponentInChildren(m).string=n,r.getComponent(l).node.off("click"),r.getComponent(l).node.once("click",(function(){return e.onJoinRoom(n,a)}),e)}))}))},a.onGameReady=function(e,t){console.log("onGameReady:",e,t);var o=this.tableRoot.children;Object.keys(t).forEach((function(n,i){var a=t[n],r=e[n];o[i].getComponentInChildren(m).string=a+" "+["","[READY]","[HONST]"][r]}))},a.onGameStart=function(e,t,o){console.log("開始遊戲",this._roomHandler.isHonster),this.roomRoot.active=!1,this.refreshRoomButton.node.active=!1,this.newRoomButton.node.active=!1,this.tableRoot.active=!1,this.readyGameButton.node.active=!1,this.startGameButton.node.active=!1;this._gameHandler=new h(this.gameView,this._roomHandler.isHonster,e,t,o,!1,this._roomHandler.players),this.leaveRoomButton.node.active=this._roomHandler.isHonster},a.onGameReconnect=function(e,t,o,n){console.log("遊戲重連!!");var i=n&&Object.keys(n).length>0;this._gameHandler=new h(this.gameView,i,e,t,o,!0,this._roomHandler.players),this.roomRoot.active=!1,this.refreshRoomButton.node.active=!1,this.newRoomButton.node.active=!1,this.nameEditBox.node.active=!1,this.leaveRoomButton.node.active=i},a.onRefreshRoomClicked=function(){this.onUpdateRoomList()},a.onGameReadyClicked=function(){this._indexGameReady=(this._indexGameReady+1)%2,this._roomHandler.gameReady(this._indexGameReady)},a.onGameStartClicked=function(){this._roomHandler.tryGameStart()},t}(d)).prototype,"roomRoot",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(C.prototype,"tableRoot",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(C.prototype,"refreshRoomButton",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(C.prototype,"newRoomButton",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(C.prototype,"leaveRoomButton",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(C.prototype,"readyGameButton",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(C.prototype,"startGameButton",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(C.prototype,"nameEditBox",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(C.prototype,"gameView",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(C.prototype,"spreadCardRoot",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=C))||E));a._RF.pop()}}}));

System.register("chunks:///_virtual/MazeDisplay.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n,t,o,i,a,c,l,s,u,p,f;return{setters:[function(e){r=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,c=e.Node,l=e.SpriteFrame,s=e.Sprite,u=e.UITransform,p=e.Color,f=e.Component}],execute:function(){var m,h,d,C,g,y,w,z,v;i._RF.push({},"160b41K30VI/rZHmbk/rqjk","MazeDisplay",void 0);var b=a.ccclass,F=a.property;e("MazeDisplay",(m=b("MazeDisplay"),h=F(c),d=F(l),C=F(l),m((w=r((y=function(e){function r(){for(var r,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=e.call.apply(e,[this].concat(i))||this,t(r,"mazeContainer",w,o(r)),t(r,"wallSpriteFrame",z,o(r)),t(r,"floorSpriteFrame",v,o(r)),r.currX=0,r.currY=0,r}n(r,e);var i=r.prototype;return i.start=function(){},i.showDungeon=function(e,r,n,t){var o=this;e.rooms.forEach((function(e,r){e.forEach((function(e,n){var t=new c("Tile-"+n+"-"+r);o.mazeContainer.addChild(t),t.setPosition(62*n,62*r),e.instanceNode=t,t.addComponent(s).spriteFrame=o.floorSpriteFrame;e.connections.forEach((function(e){var i=new c("Passage-"+n+"-"+r);t.addChild(i),i.addComponent(s).spriteFrame=o.wallSpriteFrame;var a=[[0,24],[0,-24],[24,0],[-24,0]][e];i.getComponent(u).setContentSize(16,16),i.setPosition(a[0],a[1])}))}))})),this.currX=r,this.currY=n,e.rooms.forEach((function(e,o){e.forEach((function(e,i){i===r&&o===n?e.instanceNode.getComponent(s).color=new p(0,255,0):e==t&&(e.instanceNode.getComponent(s).color=new p(255,0,0))}))})),this.mazeContainer.getComponent(u).setContentSize(62*(e.width-1),62*(e.height-1))},i.movePlayer=function(e,r,n){var t=this;e.rooms.forEach((function(e,o){e.forEach((function(e,i){i===t.currX&&o===t.currY&&(e.instanceNode.getComponent(s).color=new p(255,255,255)),i===r&&o===n&&(e.instanceNode.getComponent(s).color=new p(0,255,0))}))})),this.currX=r,this.currY=n},r}(f)).prototype,"mazeContainer",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=r(y.prototype,"wallSpriteFrame",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=r(y.prototype,"floorSpriteFrame",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=y))||g));i._RF.pop()}}}));

System.register("chunks:///_virtual/MeleeSkill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Skill.ts","./CombatSkill.ts"],(function(e){var t,i,n,o,s;return{setters:[function(e){t=e.inheritsLoose,i=e.createClass},function(e){n=e.cclegacy},function(e){o=e.SkillProficiency},function(e){s=e.CombatSkill}],execute:function(){n._RF.push({},"0c53f/evoBBNaN5OiJW18ha","MeleeSkill",void 0);e("MeleeSkill",function(e){function n(t,i,n){return e.call(this,"近戰",i,t,n)||this}t(n,e);var s=n.prototype;return s.getAffix=function(){return[{name:"射擊:配合呼吸",description:"「冷靜，配合呼吸再放弓…」",effect:{affix:"inspiration",value:1,duration:2}}]},s.applySkillEffects=function(e,t,i){},s.getSkill=function(e){switch(e){case o.Novice:return this.getSkill1();case o.Proficient:return this.getSkill2();case o.Expert:return this.getSkill3();default:return this.getSkill1()}},s.getSkill1=function(){return[this.bludgeoning,this.bludgeoning,this.bludgeoning,this.slashing,this.slashing,this.slashing,this.piercing,this.piercing,this.piercing,this.parry,this.parry,this.parry,this.block,this.block,this.block]},s.getSkill2=function(){return[this.punch,this.bludgeoning,this.slashing,this.piercing,this.parry,this.block,this.dodge,this.dodgeCounterattack,this.prejudgment,this.relieveForce,this.revenge,this.raid,this.crafty]},s.getSkill3=function(){return[this.punch,this.bludgeoning,this.slashing,this.piercing,this.parry,this.block,this.dodge]},i(n,[{key:"punch",get:function(){return{name:"拳擊",cost:{type:"Intent",fee:1},description:"使用拳擊動作助攻，+2命中。徒手時傷害+1。",modifiers:[{attribute:"HitBonus",bonus:"+2",description:"",conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+1",description:"",conditions:["Melee","Unarmed"]}],target:"enemy"}}},{key:"bludgeoning",get:function(){return{name:"猛擊",cost:{type:"Intent",fee:1},description:"使用敲擊動作助攻，-2命中，+2傷害。武器有鈍器屬性時造成暈眩效果。",modifiers:[{attribute:"HitBonus",bonus:"-2",description:"提高命中，以猛烈的攻擊動作使主攻擊的命中機會提升。",conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+2",description:"",conditions:["Melee"]},{attribute:"Stun",bonus:"+1",description:"武器有鈍器的特性時目標受暈眩效果。",conditions:["Melee","Bludgeoning"]}],target:"enemy"}}},{key:"slashing",get:function(){return{name:"斬擊",cost:{type:"Intent",fee:1},description:"使用揮砍動作助攻，+1命中。武器有揮砍屬性時+1點傷害。",modifiers:[{attribute:"HitBonus",bonus:"+1",description:"",conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+1",description:"",conditions:["Melee","Slashing"]}],target:"enemy"}}},{key:"piercing",get:function(){return{name:"突刺",cost:{type:"Intent",fee:1},description:"使用穿刺動作助攻，+1命中。若武器有穿刺屬性時+1點傷害。",modifiers:[{attribute:"HitBonus",bonus:"+1",description:"",conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+1",description:"",conditions:["Melee","Piercing"]}],target:"enemy"}}},{key:"parry",get:function(){return{name:"反手格擋",cost:{type:"Intent",fee:1},description:"攻守合一，+1命中、+1臨時護甲值。",modifiers:[{attribute:"HitBonus",bonus:"+1",description:"",conditions:["Melee"]},{attribute:"Defense",bonus:"+1",description:"",conditions:["Defense"]}],target:"enemy"}}},{key:"block",get:function(){return{name:"專注防禦",cost:{type:"Intent",fee:1},description:"-4命中為代價提高防禦，+4臨時護甲值。",modifiers:[{attribute:"HitBonus",bonus:"-4",description:"",conditions:["Melee"]},{attribute:"Defense",bonus:"+4",description:"",conditions:["Defense"]}],target:"enemy"}}},{key:"dodge",get:function(){return{name:"靈活步伐",cost:{type:"Intent",fee:1},description:"攻擊時讓腳步靈動，+1命中，+2臨時護甲值。但你穿著重甲時無法靈活行動而失敗。",modifiers:[{attribute:"HitBonus",bonus:"+1",description:"",conditions:["Melee"]},{attribute:"Defense",bonus:"+2",description:"",conditions:["Defense","LightArmor"]}],target:"enemy"}}},{key:"dodgeCounterattack",get:function(){return{name:"閃避反擊",description:"閃避攻擊後進行反擊4點。但在穿著重甲時無法靈活地反擊。",cost:{type:"Reaction",fee:1},modifiers:[{attribute:"DamageBonus",bonus:"+4",description:"",conditions:["Melee","Dodge","LightArmor"]}],target:"enemy"}}},{key:"prejudgment",get:function(){return{name:"預判",description:"察覺敵人動向，提前行動。下一輪攻擊有優勢",cost:{type:"Intent",fee:1},modifiers:[{attribute:"Attack",bonus:"+6",description:"",conditions:["Advantage"]}],target:"enemy"}}},{key:"relieveForce",get:function(){return{name:"卸力",description:"在承受傷害時減緩衝擊，以臨時生命6點作為可承受的傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"Defense",bonus:"+6",description:"",conditions:["Hitpoints"]}],target:"enemy"}}},{key:"revenge",get:function(){return{name:"復仇",description:"承受攻擊時進行反擊6點。",cost:{type:"Reaction",fee:1},modifiers:[{attribute:"DamageBonus",bonus:"+6",description:"",conditions:["Melee","UnderDamage"]}],target:"enemy"}}},{key:"raid",get:function(){return{name:"突襲",description:"靈活的攻擊攻擊技能直逼敵人要害，造成額外傷害2d4。使用靈活武器時傷害+2",cost:{type:"Intent",fee:1},modifiers:[{attribute:"DamageExtra",bonus:"2d4",description:"",conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+2",description:"",conditions:["Melee","Finesse"]}],target:"enemy"}}},{key:"crafty",get:function(){return{name:"狡詐",description:"使用假動作誘導敵人，額外造成1d4命中。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitExtra",bonus:"1d4",description:"",conditions:["Melee"]}],target:"enemy"}}}]),n}(s));n._RF.pop()}}}));

System.register("chunks:///_virtual/NetworkGraph.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var o,i,t,r,n,a,s,l,d,p,c,y,u,h,f;return{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inheritsLoose,t=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,s=e.Node,l=e.Vec3,d=e.Button,p=e.Sprite,c=e.resources,y=e.SpriteFrame,u=e.Label,h=e.tween,f=e.Component}],execute:function(){var N,v,m,w,L,g,C;n._RF.push({},"6734eYxrDdCyKvfzNSOwyjw","NetworkGraph",void 0);var b=a.ccclass,D=a.property;e("NetworkGraph",(N=b("NetworkGraph"),v=D(s),m=D(s),N((g=o((L=function(e){function o(){for(var o,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return o=e.call.apply(e,[this].concat(n))||this,t(o,"positionLayer",g,r(o)),t(o,"displayLayer",C,r(o)),o}i(o,e);var n=o.prototype;return n.createInitialNode=function(e,o,i){void 0===i&&(i=null);var t=new s(e);t.setPosition(new l(0,0,0)),this.positionLayer.addChild(t),this.createDisplayNode(t,e,o,i)},n.addNode=function(e,o,i,t,r,n){void 0===n&&(n=null);var a=this.positionLayer.getChildByName(e);if(a){var d=new s("NewNode");d.setPosition(new l(a.position.x+o,a.position.y+i,0)),this.positionLayer.addChild(d),this.createDisplayNode(d,t,r,n)}else console.error("Related node not found")},n.createDisplayNode=function(e,o,i,t){var r=new s("DisplayNode");this.displayLayer.addChild(r),r.setPosition(new l(e.position.x,e.position.y,0)),r.addComponent(d),r.on("click",(function(){console.log("Touch start on "+o),null==t||t(o)}));var n=r.addComponent(p),a="maps/"+o+"/spriteFrame";c.load(a,y,(function(e,o){e?console.error("Failed to load image: "+e):n.spriteFrame=o}));var f=new s("LabelNode");f.parent=r,f.setPosition(new l(0,0,0));var N=f.addComponent(u);N.string=i,N.fontSize=24,h(r).stop().to(.25,{scale:new l(1,1,1)}).start()},n.positionNodes=function(){for(var e=this.positionLayer.children,o=0;o<e.length;o++)for(var i=o+1;i<e.length;i++){var t=e[o].position.subtract(e[i].position).length();if(t<100){var r=100-t,n=e[i].position.subtract(e[o].position).normalize(),a=e[i].position.add(n.multiplyScalar(r));e[i].setPosition(a);var s=this.displayLayer.getChildByName(e[i].name.replace("Node","DisplayNode"));h(s).to(.25,{position:a}).start()}}},n.removeNode=function(e){var o=this.positionLayer.getChildByName(e);if(o){var i=this.displayLayer.getChildByName(e.replace("Node","DisplayNode"));i?(i.destroy(),o.destroy()):console.error("Display node not found")}else console.error("Node not found")},n.removeAllNodes=function(){this.positionLayer.children.forEach((function(e){return e.destroy()})),this.displayLayer.children.forEach((function(e){return e.destroy()}))},o}(f)).prototype,"positionLayer",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=o(L.prototype,"displayLayer",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=L))||w));n._RF.pop()}}}));

System.register("chunks:///_virtual/NotifyHandler.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"1132caDfNVPAIjfLTH87NX7","NotifyHandler",void 0),t("NotifyHandler",function(){function t(){this._isHonster=!1,this._masterID=void 0,this._playerID=void 0}return t.destroy=function(){this._instance=null},t.prototype.notify=function(t,e,n){var i;void 0===e&&(e=""),this._isHonster&&(i=t(),e&&e!=this._playerID)||null==n||n(undefined,i)},e(t,[{key:"isHonster",set:function(t){this._isHonster=t}},{key:"master",set:function(t){this._masterID?console.error("重複設定 master id:",t,"，請置 NotifyHandler"):this._masterID=t}},{key:"player",set:function(t){this._playerID?this._playerID=t:console.error("重複設定 player id:",t,"，請置 NotifyHandler")}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}())._instance=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/ParticleEffectComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,r,n,s,c,o,a,l,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,c=t._decorator,o=t.ParticleSystem2D,a=t.Vec2,l=t.Color,p=t.Component}],execute:function(){var y,u,f,m,h;s._RF.push({},"2ab372XCe1K05/29U+TyMEP","ParticleEffectComponent",void 0);var S=c.ccclass,d=c.property;t("ParticleEffectComponent",(y=S("ParticleEffectComponent"),u=d(o),y((h=e((m=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return e=t.call.apply(t,[this].concat(s))||this,r(e,"particleSystem",h,n(e)),e}i(e,t);var s=e.prototype;return s.playEffect=function(){var t=this;if(this.particleSystem){this.particleSystem.resetSystem();var e=this.particleSystem.duration+this.particleSystem.life;console.log("totalDuration",e),this.scheduleOnce((function(){t.particleSystem.stopSystem()}),e)}},s.setupEffect=function(){this.particleSystem.gravity=new a(0,-100),this.particleSystem.speed=50,this.particleSystem.startColor=new l(255,255,255,255),this.particleSystem.endColor=new l(255,255,255,0),this.particleSystem.startSize=10,this.particleSystem.endSize=0,this.particleSystem.duration=1},e}(p)).prototype,"particleSystem",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=m))||f));s._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerHandCards.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./CardMover.ts","./GameEvents.ts","./CardComponent.ts","./BaseCardDisplay.ts","./TipText.ts"],(function(e){var t,n,r,a,s,i,c,o,d,u,l,h,p,f,C,v,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,s=e.asyncToGenerator,i=e.regeneratorRuntime,c=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,d=e._decorator,u=e.Node,l=e.Vec3},function(e){h=e.EventManager},function(e){p=e.CardMover},function(e){f=e.PlayerHandCardEvent},function(e){C=e.CardComponent},function(e){v=e.BaseCardDisplay},function(e){m=e.TipType}],execute:function(){var g,x,y,P,b;o._RF.push({},"88570XPZuFEV5Sd/gF8v4Xx","PlayerHandCards",void 0);var k=d.ccclass,w=d.property;e("default",(g=k("PlayerHandCards"),x=w(u),g((b=t((P=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return t=e.call.apply(e,[this].concat(s))||this,r(t,"discardPile",b,a(t)),t.selectMax=2,t.selectNum=0,t}n(t,e);var o=t.prototype;return o.onLoad=function(){h.instance.on(f.DealCards,this.onDealCards.bind(this))},o.onDestroy=function(){h.instance.off(f.DealCards,this.onDealCards)},o.start=function(){this.node.active=!1},o.dealCard=function(e,t){var n=this.positionContainer.children[e].position;return p.moveCard(t,this.cardContainer,n,.3,.15*(e+1))},o.dealCards=function(e,t){var n=this;this.node.active=!0,this.updatePositionLayout();var r=t.children;e.forEach(s(i().mark((function e(t,a){var s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=r[r.length-1]).getComponent(C).setup(t),e.next=4,n.dealCard(a,s);case 4:case"end":return e.stop()}}),e)})))),this.stopToggleSelection(),this.setToggleSelection(this.checkCardSelected.bind(this)),this.selectNum=this.selectMax},o.checkCardSelected=function(){this.selectedCardNodes.length>this.selectNum?h.instance.emit(m.Warning,"玩家回合\n您最多只能選擇"+this.selectMax+"張卡牌出牌"):h.instance.emit(m.Normal,"玩家回合")},o.sendCards=function(){var e=s(i().mark((function e(){var t,n,r,a,o,d=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=c(this.selectedCardNodes);case 2:if((r=n()).done){e.next=11;break}return a=r.value,o=a.getComponent(C).card,console.log("card",o),t.push(o),e.next=9,p.moveCard(a,this.discardPile,l.ZERO,.05,.15);case 9:e.next=2;break;case 11:return e.next=13,new Promise((function(e){return d.scheduleOnce(e,.1)}));case 13:return this.cardContainer.children.slice().forEach(s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.moveCard(t,d.discardPile,l.ZERO,.05,.15);case 2:case"end":return e.stop()}}),e)})))),e.next=17,new Promise((function(e){return d.scheduleOnce(e,.5)}));case 17:h.instance.emit("ExecuteIntent",t),this.selected.length=0,this.selectedCardNodes.length=0,this.stopToggleSelection();case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.onDealCards=function(e){var t=e.cards,n=e.deckGatherings;this.initPositionNodes(t.length),this.dealCards(t,n)},o.onSendCards=function(){this.sendCards()},o.onSubmitSelectedClicked=function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.selectedCardNodes.length){e.next=3;break}return h.instance.emit(m.Warning,"玩家回合\n請選擇卡牌"),e.abrupt("return");case 3:if(!(this.selectedCardNodes.length>this.selectNum)){e.next=6;break}return h.instance.emit(m.Error,"玩家回合\n能量不足，最多只能選擇"+this.selectMax+"張卡牌"),e.abrupt("return");case 6:return e.next=8,this.sendCards();case 8:console.log("提交選擇"),h.instance.emit("SubmitSelectedCards");case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(v)).prototype,"discardPile",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=P))||y));o._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerHandCards2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseCardDisplay.ts","./GameEvents.ts","./EventManager.ts","./CardComponent2.ts","./CardMover.ts"],(function(n){var t,e,r,a,o,s,i,c,d,u;return{setters:[function(n){t=n.inheritsLoose,e=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){a=n.cclegacy,o=n._decorator},function(n){s=n.BaseCardDisplay},function(n){i=n.PlayerHandCardEvent},function(n){c=n.EventManager},function(n){d=n.CardComponent},function(n){u=n.CardMover}],execute:function(){var h;a._RF.push({},"962817kJY9H+LYU1/VczLnC","PlayerHandCards",void 0);var C=o.ccclass;o.property,n("default",C("PlayerHandCards")(h=function(n){function a(){return n.apply(this,arguments)||this}t(a,n);var o=a.prototype;return o.onLoad=function(){c.instance.on(i.DealCards,this.onDealCards.bind(this)),c.instance.on(i.ShowCards,this.onShowCards.bind(this)),c.instance.on(i.CompareCards,this.onCompareCards.bind(this))},o.onDestroy=function(){c.instance.off(i.DealCards,this.onDealCards),c.instance.off(i.ShowCards,this.onShowCards),c.instance.off(i.CompareCards,this.onCompareCards)},o.start=function(){this.node.active=!1},o.compareCards=function(n){var t=this,e=n[0];this.getCardNodes(e).forEach((function(n){t.toggleCardSelection(n)}))},o.dealCard=function(n,t){this.node.active=!0;console.log("this.positionContainer.children");var e=this.positionContainer.children[n].position;return u.moveCard(t,this.cardContainer,e,.3,.15*(n+1))},o.dealCards=function(n,t){var a=this;this.initPositionNodes(n.length),this.followPosition(),n.forEach(e(r().mark((function n(e,o){var s;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(s=t[t.length-1]).getComponent(d).setup(e),n.next=4,a.dealCard(o,s);case 4:case"end":return n.stop()}}),n)}))))},o.clearCards=function(){this.cardContainer.removeAllChildren(),this.selected=[]},o.onDealCards=function(){var n=e(r().mark((function n(t){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.node.active=!0,n.next=3,this.unselectAllCards();case 3:case 4:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),o.onShowCards=function(){var n=e(r().mark((function n(t){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.node.active=!0,n.next=3,this.unselectAllCards();case 3:this.showCards(t);case 4:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),o.onCompareCards=function(n){this.compareCards(n)},a}(s))||h);a._RF.pop()}}}));

System.register("chunks:///_virtual/RandomString.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"dcab9+inZ5O3o+MXXMDy66u","RandomString",void 0);n("RandomString",function(){function n(){}return n.generate=function(n){void 0===n&&(n=10);for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="",o=0;o<n;o++){r+=t[Math.floor(Math.random()*t.length)]}return r},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/RewardCards.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./GameEvents.ts","./BaseCardDisplay.ts","./CardComponent.ts"],(function(n){var e,o,t,s,r,a,i,d;return{setters:[function(n){e=n.inheritsLoose},function(n){o=n.cclegacy,t=n._decorator,s=n.instantiate},function(n){r=n.EventManager},function(n){a=n.PlayerHandCardEvent},function(n){i=n.BaseCardDisplay},function(n){d=n.CardComponent}],execute:function(){var c;o._RF.push({},"d26baYibyJBtJbXQPaH2Y1k","RewardCards",void 0);var l=t.ccclass;t.property,n("RewardCards",l("RewardCards")(c=function(n){function o(){return n.apply(this,arguments)||this}e(o,n);var t=o.prototype;return t.onLoad=function(){r.instance.on(a.ShowCards,this.onShowCards.bind(this)),r.instance.on(a.DealCards,this.onDealCards.bind(this))},t.onDestroy=function(){r.instance.off(a.ShowCards,this.onShowCards),r.instance.off(a.DealCards,this.onDealCards)},t.start=function(){this.node.active=!1},t.showCards=function(n){var e=this;this.positionContainer.children.length===n.length?(this.selectedCardNodes.length>0&&console.error("已經有選取的卡片，請先清除之前的選取"),this.cardContainer.removeAllChildren(),n.forEach((function(n,o){var t=s(e.cardPrefab);t.name="Card_"+o,t.getComponent(d).setup(n),t.parent=e.cardContainer}))):console.error("卡牌數量與定位節點數量不符")},t.onShowCards=function(n){this.node.active=!0;var e=n;console.log("show cards",e),this.initPositionNodes(e.length),this.showCards(e),this.followPosition(),this.setToggleSelection()},t.onDealCards=function(){},t.onChoosedCardClicked=function(){var n=this.selectedCardNodes;if(0!==n.length){var e=n[0].getComponent(d);if(e){var o=e.card;console.log("選取卡片",o),r.instance.emit("SelectedRewardCard",o),this.stopToggleSelection(),this.unselectAllCards()}else console.error("卡片物件沒有CardComponent")}else console.error("沒有選取任何卡片")},o}(i))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Rogue.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Dungeon.ts","./MazeDisplay.ts","./DescriptionScrollView.ts","./NetworkGraph.ts","./EventManager.ts","./GameEvents.ts","./CharacterInfo.ts"],(function(o){var n,t,e,i,r,c,s,a,u,l,h,p,d,f,g;return{setters:[function(o){n=o.applyDecoratedDescriptor,t=o.inheritsLoose,e=o.initializerDefineProperty,i=o.assertThisInitialized},function(o){r=o.cclegacy,c=o._decorator,s=o.Component},function(o){a=o.Direction,u=o.DungeonMaze},function(o){l=o.MazeDisplay},function(o){h=o.DescriptionScrollView},function(o){p=o.NetworkGraph},function(o){d=o.EventManager},function(o){f=o.WordPuzzleGameLogicEvent},function(o){g=o.CharacterInfo}],execute:function(){var m,v,D,w,y,z,k,R,b,C,S;r._RF.push({},"a9cf4ELFqtNM7zats1RDWJ0","Rogue",void 0);var I=c.ccclass,E=c.property;o("default",(m=I("Rogue"),v=E(p),D=E(h),w=E(l),y=E(g),m((R=n((k=function(o){function n(){for(var n,t=arguments.length,r=new Array(t),c=0;c<t;c++)r[c]=arguments[c];return n=o.call.apply(o,[this].concat(r))||this,e(n,"networkGraph",R,i(n)),e(n,"descriptionScrollView",b,i(n)),e(n,"mazeDisplay",C,i(n)),e(n,"characterInfo",S,i(n)),n.dungeon=null,n.currX=0,n.currY=0,n.data=void 0,n}t(n,o);var r=n.prototype;return r.onLoad=function(){this.networkGraph.node.active=!1,this.descriptionScrollView.node.active=!1,this.mazeDisplay.node.active=!1},r.setDungeonData=function(o){this.data=o;o.roomType;var n=o.icon,t=o.name,e=o.descriptions;o.connectIn,o.locations;this.networkGraph.node.active=!0,this.networkGraph.createInitialNode(n,t,this.enterDungeon.bind(this)),this.descriptionScrollView.node.active=!0,this.descriptionScrollView.setData(e)},r.enterDungeon=function(o){console.log(o);var n=this.data.locations[0],t=(n.roomType,n.icon,n.name,n.size),e=n.position,i=n.rooms;this.descriptionScrollView.clear(),this.mazeDisplay.node.active=!0;var r=this.createDungeon(t[0],t[1],e[0],e[1]),c=this.getCurrentRoom();this.dungeon.rooms.forEach((function(o){var n=i[1];o.forEach((function(o){o.setInfo(n)}))}));var s=i[0];c.setInfo(s);var a=i[i.length-1];r.setInfo(a),this.setDungeonRoom(c)},r.setDungeonRoom=function(o){var n=this;console.log(o),o.descriptions.length>0&&(this.descriptionScrollView.node.active=!0,this.descriptionScrollView.setData(o.descriptions));this.networkGraph.removeAllNodes(),this.networkGraph.createInitialNode(o.icon,o.name,(function(){return d.instance.emit(f.WordPuzzleGameStart,o)})),o.connections.forEach((function(t){var e,i,r;switch(t){case a.North:e=0,i=200,r=function(){n.onNorthDoorClick()};break;case a.East:e=200,i=0,r=function(){n.onEastDoorClick()};break;case a.South:e=0,i=-200,r=function(){n.onSouthDoorClick()};break;case a.West:e=-200,i=0,r=function(){n.onWestDoorClick()}}n.networkGraph.addNode(o.icon,e,i,"creation1","門",r)}))},r.createDungeon=function(o,n,t,e){if(!(o<0||n<0||o<=t||n<=e||t<0||e<0)){this.dungeon=new u(o,n),this.dungeon.generateMaze(t,e);var i=this.dungeon.findExit(t,e);return console.log("exit:",i),this.mazeDisplay.showDungeon(this.dungeon,t,e,i),this.currX=t,this.currY=e,i}console.error("Invalid dungeon size or start position")},r.moveToRoom=function(o,n){if(o<0||n<0||o>=this.dungeon.width||n>=this.dungeon.height)console.error("Invalid room position");else{var t=this.dungeon.rooms[n][o];t?(this.currX=o,this.currY=n,this.mazeDisplay.movePlayer(this.dungeon,o,n),this.setDungeonRoom(t)):console.error("Invalid room")}},r.getCurrentRoom=function(){return this.dungeon.rooms[this.currY][this.currX]},r.onSouthDoorClick=function(){var o=this.getCurrentRoom();o&&o.connections.includes(a.South)&&this.moveToRoom(this.currX,this.currY-1)},r.onEastDoorClick=function(){var o=this.getCurrentRoom();o&&o.connections.includes(a.East)&&this.moveToRoom(this.currX+1,this.currY)},r.onNorthDoorClick=function(){var o=this.getCurrentRoom();o&&o.connections.includes(a.North)&&this.moveToRoom(this.currX,this.currY+1)},r.onWestDoorClick=function(){var o=this.getCurrentRoom();o&&o.connections.includes(a.West)&&this.moveToRoom(this.currX-1,this.currY)},n}(s)).prototype,"networkGraph",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=n(k.prototype,"descriptionScrollView",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=n(k.prototype,"mazeDisplay",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=n(k.prototype,"characterInfo",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=k))||z));r._RF.pop()}}}));

System.register("chunks:///_virtual/RoomHandler.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SocketBridge.ts","./RandomString.ts"],(function(e){var t,o,s,i,n,a;return{setters:[function(e){t=e.createClass,o=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){i=e.cclegacy},function(e){n=e.SocketBridge},function(e){a=e.RandomString}],execute:function(){i._RF.push({},"bdac1KaEi9OoL28aGCdUil/","RoomHandler",void 0);e("RoomHandler",function(){function e(e,t){this.roomInfo=void 0,this.eventHandlers={},this._roomLocalCacheName="",this._needReconnect=!1,this.isHonster=!1,this.players={},this._readyPlayers={},this._roomList=[],this._roomID="",this._roomKey="",this._roomLockKey="",this._joinRoomInterval=void 0,this._isRoomJoining=!1,this._playerID="",this._nickname="",this.eventUpdateTableList=null,this.eventUpdateRoomList=null,this.eventGameReady=null,this.eventGameStart=null,this.eventGameReconnect=null,this._roomLocalCacheName="DE_ROOM_TEMP_"+e,this.roomInfo={id:"",key:"",lockKey:""},this._playerID=a.generate(),this._nickname=t}var i=e.prototype;return i.getEventHandlers=function(){return{join_room:this.notify_join_room.bind(this),take_seat:this.notify_take_seat.bind(this),leave_room:this.notify_leave_room.bind(this),kicked_out:this.notify_kicked_out.bind(this),game_ready:this.notify_game_ready.bind(this),game_start:this.notify_game_start.bind(this)}},i.handleRoomTimeout=function(e){var t=this;this._isRoomJoining=!0,this._joinRoomInterval&&clearTimeout(this._joinRoomInterval),this._joinRoomInterval=setTimeout((function(){var o;t._isRoomJoining&&(console.log("沒有對應的 Honster 回應"),n.Instance.clientDisconnect(t._playerID),console.log("只能把自己的 Broadcast 欄位移除"),n.Instance.delDataLabel("ROOMS/"+e),console.log("代替斷線的 Honster 把"+e+"從房間清單移除"),n.Instance.removeDispatcher(t._roomID,t),t._clearRoomInfo(),null==(o=t.eventUpdateRoomList)||o.call(t))}),1e3)},i._applicate=function(e,t){void 0===t&&(t=""),this.isHonster?this["notify_"+e](this._roomID,e,t):n.Instance.applicate(e,t)},i._broadcast=function(e,t,o){if(void 0===t&&(t=""),this.isHonster){if(console.log(e,t,"clientID?:",o),o===this._playerID)return console.log("不會發給自己");n.Instance.broadcast(e,t,o)}},i.loadRoomsAsync=function(){var e=this;return n.Instance.loadAsync("ROOMS").then((function(t){return e._roomList=t}))},i.newRoom=function(e,t){void 0===t&&(t="0");var o=a.generate();this._roomID=e,this._roomKey=o,n.Instance.addDataLabel("ROOMS/"+e,o),this._roomLockKey=t,this.isHonster=!0,this.joinRoom(this._roomID,this._roomKey,this._roomLockKey)},i.joinRoom=function(){var e=o(s().mark((function e(t,o,i){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===i&&(i="0"),e.prev=1,console.log("Joining room:",t),a={id:t,key:o,lockKey:i},e.next=6,n.Instance.addDispatcher(t,this,this.getEventHandlers());case 6:if(!this.isHonster){e.next=11;break}return e.next=9,n.Instance.addHonsterConnection(t);case 9:e.next=14;break;case 11:return e.next=13,n.Instance.addClientConnection(t,this._playerID);case 13:this.handleRoomTimeout(t);case 14:this.roomInfo=a,this._applicate("join_room",this._playerID+" "+o+" "+i),console.log("Player [",this._playerID,"] send joinRoom: id/roomkey:[",o,"] & roomLockKey:[",i,"]"),e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(1),console.error("Failed to join room:",e.t0),e.t0;case 23:case"end":return e.stop()}}),e,this,[[1,19]])})));return function(t,o,s){return e.apply(this,arguments)}}(),i.tryReconnect=function(){var e=o(s().mark((function e(){var t,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem(this._roomLocalCacheName))){e.next=14;break}return this._needReconnect=!0,o=JSON.parse(t),console.log("斷線重連:",o),this.isHonster=o.isHonster,o.playerID&&(console.log("重連後修改自己的playerID:",this._playerID,"->",o.playerID),this._playerID=o.playerID),this._roomID=o.roomID,this._roomKey=o.roomKey,this._roomLockKey=o.roomLockKey,this.players=o.players,e.next=13,this.joinRoom(this._roomID,this._roomKey);case 13:return e.abrupt("return",!0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.leaveRoom=function(){var e;console.log("leave room this._isHonster:",this.isHonster),this.isHonster?(console.log("發出 kicked_out!!! 然後斷線"),this._broadcast("kicked_out"),n.Instance.honsterDisconnect(),n.Instance.delBroadcastList(),n.Instance.delDataLabel("ROOMS/"+this._roomID)):(n.Instance.applicate("leave_room",this._playerID),n.Instance.clientDisconnect(this._playerID)),n.Instance.removeDispatcher(this._roomID,this),null==(e=this.eventUpdateRoomList)||e.call(this),this._clearRoomInfo()},i._clearRoomInfo=function(){localStorage.removeItem(this._roomLocalCacheName),this._roomID="",this._roomKey="",this._roomLockKey="0",this.isHonster=!1,this.players={},this._readyPlayers={}},i.notify_join_room=function(e,t,o){var s;if(this.isHonster){var i=o.split(" ");s=i[0];var a=i[1],r=i[2];if(console.log("this._roomKey:",this._roomKey,"---room key:",a),this._roomKey!=a){var l="不符合的 room key";console.log(l),o=s+" 0 "+l,this._broadcast(t,o,s)}else if(this._roomLockKey!=r){var c="輸入錯誤的密碼: "+r;console.log(c),o=s+" 0 "+c,this._broadcast(t,o,s)}else this._playerID!=s&&n.Instance.addToBroadcastList(s),o=s+" 1",this._broadcast(t,o,s)}var h=o.split(" ");if((s=h[0])==this._playerID){var _,m="1"===h[1];if(this._needReconnect)m?(null==(_=this.eventGameReconnect)||_.call(this,e,s,this._nickname,this.players),this._joinRoomInterval&&clearTimeout(this._joinRoomInterval),console.log("重連成功")):console.log("重連失敗: 已失去房間連結"),this._needReconnect=!1;else if(m)this._roomID=e,this._isRoomJoining=!1,console.log(this._nickname,"成功加入房間!!"),this._applicate("take_seat",s+" "+this._nickname);else{var y=h[2];console.log(t,"error:",y),this.leaveRoom()}}else console.log("playerID 不同",s,this._playerID)},i.notify_take_seat=function(e,t,o){var s,i,n;if(this.isHonster){var a=o.split(" ");i=a[0],n=a[1],console.log(n,i,"進行入桌"),this.players[i]=n,o=i+" "+JSON.stringify(this.players),this._broadcast(t,o)}var r=o.split(" ");i=r[0];var l=JSON.parse(r[1]);null==(s=this.eventUpdateTableList)||s.call(this,l),this._playerID===i&&this.gameReady(0)},i.notify_leave_room=function(e,t,o){var s,i,a=o;this.isHonster&&(i=this.players[a],delete this.players[a],delete this._readyPlayers[a],n.Instance.delBroadcastList(a),n.Instance.clientDisconnect(a),console.log("離開房間斷線:",a),o=JSON.stringify(this.players)+" "+i,this._broadcast(t,o));var r=o.split(" "),l=JSON.parse(r[0]),c=r[1];console.log("players:",l),null==(s=this.eventUpdateTableList)||s.call(this,l),console.log(c,"離開房間了")},i.notify_kicked_out=function(e,t,o){var s;this.isHonster?n.Instance.clientDisconnect():(n.Instance.removeDispatcher(e,this),null==(s=this.eventUpdateRoomList)||s.call(this),this._clearRoomInfo());console.log("有收到 kicked out哦!!")},i.notify_game_ready=function(e,t,o){var s,i;if(console.log("收到 notify_game_ready"),this.isHonster){var n=o.split(" ");i=n[0];var a=n[1];this._readyPlayers[i]=a,console.log("ready player:",this._readyPlayers),o=JSON.stringify(this._readyPlayers)+" "+JSON.stringify(this.players),this._broadcast(t,o)}var r=o.split(" "),l=JSON.parse(r[0]),c=JSON.parse(r[1]);null==(s=this.eventGameReady)||s.call(this,l,c)},i.notify_game_start=function(e,t,o){console.log("收到 notify_game_start",this.isHonster),this.isHonster&&(this._broadcast(t),n.Instance.delDataLabel("ROOMS/"+this._roomID)),this.eventGameStart(e,this._playerID,this._nickname);var s={roomID:this._roomID,roomKey:this._roomKey,roomLockKey:this._roomLockKey,playerID:this._playerID,isHonster:this.isHonster,players:this.players};localStorage.setItem(this._roomLocalCacheName,JSON.stringify(s)),console.log("\n\n存檔",s,"\n\n")},i.gameReady=function(e){this.isHonster&&(e="2"),this._applicate("game_ready",this._playerID+" "+e)},i.tryGameStart=function(){var e=this,t=Object.keys(this._readyPlayers),o=t.length&&t.every((function(t){return parseInt(e._readyPlayers[t],10)>0}));console.log("準備清單:",this._readyPlayers),o?this._applicate("game_start"):console.log("尚有人未準備好")},t(e,[{key:"nickname",set:function(e){this._nickname=e}}]),e}());i._RF.pop()}}}));

System.register("chunks:///_virtual/Shield.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Item.ts"],(function(e){var n,t,i;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy},function(e){i=e.Item}],execute:function(){t._RF.push({},"b9e88pzps9K1KP4kQQJlPKP","Shield",void 0);e("Shield",function(e){function t(n,t,i,o,u){var c;return(c=e.call(this,n,i,o,1)||this).bonusAC=void 0,c.iconName=void 0,c.iconName=t,c.bonusAC=u,c}return n(t,e),t}(i));t._RF.pop()}}}));

System.register("chunks:///_virtual/ShieldDraggable.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Draggable.ts","./EventManager.ts","./EquipmentDropZone.ts"],(function(e){var n,t,i,a,o,r,l,s;return{setters:[function(e){n=e.inheritsLoose,t=e.createClass},function(e){i=e.cclegacy,a=e._decorator,o=e.Label},function(e){r=e.Draggable},function(e){l=e.EventManager},function(e){s=e.EquipmentDropZoneIndex}],execute:function(){var c;i._RF.push({},"8cc60sE/3xEf4NjdFJug/NW","ShieldDraggable",void 0);var u=a.ccclass;a.property,e("ShieldDraggable",u("ShieldDraggable")(c=function(e){function i(){for(var n,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return(n=e.call.apply(e,[this].concat(i))||this).nameLabel=null,n._shield=null,n.equipmentIndex=s.None,n}return n(i,e),i.prototype.onTouchStart=function(n){if(e.prototype.onTouchStart.call(this,n),this.equipmentIndex!==s.None){var t=this.zone;l.instance.emit("CharacterEquipShield",{index:t.serialIndex,item:null}),this.equipmentIndex=s.None}},t(i,[{key:"shield",set:function(e){this._shield=e,console.log("Shield = ",e),this.nameLabel=this.node.getComponentInChildren(o),this.nameLabel.string=e.name,this.setPhotoImage(e.iconName)}},{key:"item",get:function(){return this._shield}}]),i}(r))||c);i._RF.pop()}}}));

System.register("chunks:///_virtual/Skill.ts",["cc"],(function(i){var e;return{setters:[function(i){e=i.cclegacy}],execute:function(){e._RF.push({},"5af80/LSJVPJo3J7v5GCx6a","Skill",void 0);i("Skill",(function(i,e,c){void 0===c&&(c=t.Novice),this.name=void 0,this.level=void 0,this.description=void 0,this.name=i,this.description=e,this.level=c}));var t=i("SkillProficiency",function(i){return i[i.Novice=0]="Novice",i[i.Proficient=1]="Proficient",i[i.Expert=2]="Expert",i}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/SocketBridge.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FirebaseBridge.ts"],(function(t){var n,i,e,o,c;return{setters:[function(t){n=t.createClass,i=t.asyncToGenerator,e=t.regeneratorRuntime},function(t){o=t.cclegacy},function(t){c=t.default}],execute:function(){o._RF.push({},"2d4a25YPn1Bho37tEGXpZjX","SocketBridge",void 0),t("SocketBridge",function(){function t(){this._bridge=new c,this._connectID="",this._broadcastList=[]}var o=t.prototype;return o.connect=function(){var t=i(e().mark((function t(n){var i;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._bridge.signInWithGoogleEmail("xxfox"+n[0]+"@gmail.com",n[1]);case 3:return i=t.sent,t.abrupt("return",i);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));return function(n){return t.apply(this,arguments)}}(),o.addDispatcher=function(t,n,i){this._bridge.addDispatcher(t,n,i)},o.removeDispatcher=function(t,n){this._bridge.removeDispatcher(t,n)},o.loadAsync=function(t,n){return this._bridge.loadAsync(t,n)},o.addHonsterConnection=function(t){this._connectID=t,this._bridge.addConnection(t,"Applicate")},o.addClientConnection=function(t,n){this._connectID=t,this._bridge.addConnection(t,"Broadcast",n)},o.honsterDisconnect=function(){this._bridge.delConnection(this._connectID,"Applicate"),this._bridge.uploadInfo(this._connectID,"","","Applicate"),this._connectID=""},o.clientDisconnect=function(t){var n=this;t?(this._bridge.delConnection(this._connectID,"Broadcast",t),this._bridge.uploadInfo(this._connectID,"","","Broadcast",t)):this._broadcastList.forEach((function(t){n._bridge.delConnection(n._connectID,"Broadcast",t),n._bridge.uploadInfo(n._connectID,"","","Broadcast",t)})),this.delBroadcastList(t)},o.addToBroadcastList=function(t){this._broadcastList.push(t),console.log("新增",t,this._broadcastList)},o.delBroadcastList=function(t){t?this._broadcastList.indexOf(t)>-1&&(this._broadcastList.splice(this._broadcastList.findIndex((function(n){return n===t})),1),console.log("刪除",t,this._broadcastList)):(console.log("刪除",this._broadcastList,this._broadcastList),this._broadcastList.length=0)},o.applicate=function(t,n){this._bridge.uploadInfo(this._connectID,t,n,"Applicate")},o.broadcast=function(t,n,i){var e=this;if(!this._connectID)return console.log("Honster 已斷線");i?(console.log(t,"廣播對象:",i),this._bridge.uploadInfo(this._connectID,t,n,"Broadcast",i)):(console.log(t,"廣播對象:",this._broadcastList),this._broadcastList.forEach((function(i){return e._bridge.uploadInfo(e._connectID,t,n,"Broadcast",i)})))},o.addDataLabel=function(t,n){this._bridge.addDataLabel(t,n)},o.delDataLabel=function(t){this._bridge.delDataLabel(t)},n(t,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}())._instance=void 0,o._RF.pop()}}}));

System.register("chunks:///_virtual/StoryCardStack.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,r,i,n,o,a,c,s,g,l,u,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,c=t.Prefab,s=t.Node,g=t.instantiate,l=t.Vec3,u=t.UITransform,d=t.Component}],execute:function(){var h,p,f,v,C,y,b,m;o._RF.push({},"6dfabiwBrdFgJ5Dd54Bj6/C","StoryCardStack",void 0);var S=a.ccclass,k=a.property;t("StoryCardStack",(h=S("StoryCardStack"),p=k(c),f=k(s),h((y=e((C=function(t){function e(){for(var e,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"cardPrefab",y,n(e)),i(e,"stackNode",b,n(e)),i(e,"triggerHeight",m,n(e)),e.movingCard=null,e}r(e,t);var o=e.prototype;return o.onLoad=function(){this.generateCardStack()},o.generateCardStack=function(){for(var t=0;t<10;t++){var e=g(this.cardPrefab);e.setParent(this.stackNode),e.position=new l(0,5*-t,0),e.scale=new l(.2,.2,.2),this.registerCardEvents(e)}},o.registerCardEvents=function(t){t.on(s.EventType.TOUCH_MOVE,this.onCardMove,this),t.on(s.EventType.TOUCH_END,this.onCardRelease,this)},o.onCardMove=function(t){this.movingCard||(this.movingCard=t.currentTarget);var e=t.getUILocation(),r=this.node.getComponent(u).convertToNodeSpaceAR(new l(e.x,e.y,0));this.movingCard.position=r;var i=Math.min(1,(r.y-this.stackNode.position.y)/this.triggerHeight);this.movingCard.scale=new l(.2+.8*i,.2+.8*i,1)},o.onCardRelease=function(t){t.currentTarget.position.y>=this.triggerHeight&&this.triggerAction(),this.movingCard=null},o.triggerAction=function(){console.log("Triggered Action at Height!")},e}(d)).prototype,"cardPrefab",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(C.prototype,"stackNode",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=e(C.prototype,"triggerHeight",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),v=C))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/StoryData.ts",["cc","./ExplorationCard.ts"],(function(e){var s,o;return{setters:[function(e){s=e.cclegacy},function(e){o=e.CardSuit}],execute:function(){s._RF.push({},"47ed9Jj46dABa9sNHc8UxTB","StoryData",void 0);e("StoryData",(function(){var e,s,t,n,i,r,c,a;this.chapters=[],this.dungeons=void 0,this.dramas=void 0,this.dramas={hdse11589:{descriptions:["當夕陽的餘暉逐漸縮小，直至沒入地平線下，天空也從滿天的紅霞漸漸被上滿是星光的暗藍色薄幕。","一隻枯瘦墨黑的手破開黃砂緩緩伸出，隨之掩藏在砂土下的深黑色身軀爬起。","隨著砂子的滑落，如同枯枝般的[黑死屍 | type:monster]，一下就發現你的位置。","彷彿是刻意潛伏在地下等待身為獵物的你。","但你明白，那是白天時砂漠的炎熱，才讓枯乾的黑死屍動彈不得，這種時候如果能趁機解決它們就省事多了。","漸漸地，一具具從砂土中爬出的黑死屍也越來越多。","很顯然，安穩地躲在塔城裡的人們，根本不在乎外頭聚集多少黑死屍。","黑死屍們一個個轉身向你緩步走來，體力用盡就快虛脫的你只能咬牙拖著腳步離開。","「喂！這還能再用個幾發火球，之後再好好地感謝我吧！」","[貴婦 | type:npc]的聲音從上面傳來，你抬頭看著她扔下一個[袋子 | type:thing]，落在屍群的後方。","「這用來對付黑死屍，也實在是太浪費了…」","一旁的[守衛 | type:npc]抱怨著，即使在三層樓高，他的婉惜仍然傳入你的耳裡。","(你瞧了一眼掉落在附近的袋子)"],chance:3,response:["面對黑死屍的來襲，手足無措的你在本能的驅動下而[逃跑 | response:ddac112]了。"],behavior:{coping:{observation:[[1,"[逃跑]吧！不斷有更多的黑死屍緩緩地爬起，思緒混亂的你心裡這麼想著。(生存技能)","coping"],[5,"但你感覺袋子中的東西能幫助你應付眼前的情況。只要有機會能[推開]眼前那具黑死屍，便能很輕易地拾取袋子。(推撞技能)","coping"]],intimidation:[[1,"「給我滾開！」你威嚇著[_ | type:monster]。","action to target","abc123"],[20,"你做出浮誇的攻擊姿勢想嚇退[_ | type:monster]","action to target","abb223"],[5,"「快讓我進城！否則我就把戒指扔了！」你對[_ | type:npc]吼著。","action to target","bbd11"]],survival:[[1,"[逃跑1]你轉身就直接逃離屍群。","response","dii32"],[12,"[逃跑2]你逃走前注意著屍群的動向。","response","abnopd31"]],shove:[[1,"[推撞]不顧一切地用盡全力推撞眼前的黑死屍","response","diwen1290"],[12,"[絆摔]你掌握敵人的重心後發力推倒它。","response","bnidk3623"]]},response:{combat:["你失敗了，因而被迫[戰鬥 | action:combat | response:edh03sd9]"],abc123:["_並沒有停下腳步, 仍然朝你走來。"],abb223:["眼前的_安靜下來並凝視著你一會兒，但還是繼續朝你走來。"],bbd11:["但是你的威脅沒有得到_的回應。等你注意到時，塔城上早已沒有任何人影。"],dii32:["你慌亂地逃跑，但讓更多的黑死屍注意到你。","有如無頭蒼蠅一般不斷地在尋找安全的地點，但屍群們卻沒有放棄跟著你。","無數個枯瘦的黑影開始追了上來，因為氣喘噓噓的你幾乎快要累倒了。","你知道如果不想成為它們的一份子，就不能停下腳步。","你試著穩定呼吸讓自己堅持下去。(進行DC13[韌性檢定 | dc:13-resilience | success:igpek532 | failure:combat]，失敗進入戰鬥))"],abnopd31:["你一邊注意著屍群的動向，一邊向後奔跑，直到找到安全的藏匿處。","直到天亮，你才[返回 | link:gkddd1234]塔城。"],igpek532:["你成功地遠離了屍群，直到有個暫時的躲藏之處才停下來休息。","直到天亮，你才[返回 | link:gkddd1234]塔城。"],diwen1290:["你用力推撞黑死屍，卻一時失去準頭跌倒在屍群之中。","你慌亂起身並打算遠離它們。(進行DC15[敏捷檢定 | dc:15-dexterity | success:igpek532 | failure:combat]，失敗進入戰鬥)"],bnidk3623:["你使勁推開擋在眼前的黑死屍，並避開它們的啃咬，快速撿起袋子並遠離原地。","如果炎熱能夠讓黑死屍動彈不得，那火炎就能有效制止它們的行動。","往袋子裡看一眼，你立刻知道袋子裡裝的是火球項鍊。","即使項鍊上只剩3顆珠子。","你可以用一個動作取下一顆珠子並投擲到至多 60 尺遠的地方。它將在移動軌跡的終點爆炸，效果等同於 3 環的火球術。","火球術的有效範圍為20 尺，以爆炸中心球體內的每一名生物都要進行一次敏捷豁免。失敗的生物受到8d6火焰傷害，成功的話受到一半傷害。","這時候只要能好好地將黑死屍聚集起來，也許這個數量真的能夠一次解決。","伴著深沉的嗚響爆出火焰，緩慢的黑死屍根本無法閃避。","「總算全解決了…」","你成功清除了所有的黑死屍，但塔城上並沒有任何歡呼，甚至連對你的作為毫無回應。","再怎麼喊也沒有回應，你只能到附近的安全點休息，就這樣等到天亮。","你直到天亮才[返回塔城 | link:gkddd1234]"],ddac112:["你覺得不值得為了一個袋子裡的東西冒險，轉身便逃離屍群。","耳邊傳來自己的腳步聲，每一步踏在鬆軟的砂土上，都會不斷消耗你的體力，但對那些追著你的屍群來說，卻幾乎沒什麼影響。","無數個枯瘦的黑影開始追了上來，而氣喘噓噓的你卻幾乎要累倒了。","你知道如果不想成為它們的一份子，就不能停下腳步。","你被絆了一下，有一具你沒發現的黑死屍，突然從你的腳下爬出撲上了你。","你必須在屍群追上你之前，[擺脫 | dc:12-dexterity | success:igpek532 | failure:combat]這名阻礙你移動的敵人(進行DC12敏捷檢定，失敗進入戰鬥)。"],edh03sd9:["砸碎這具黑死屍的頭後，你起身繼續逃跑。","你不斷地向前奔跑，但屍群卻越來越多，你越來越難以前進。","你逐漸被追上，只能試著加快速度[擺脫 | dc:8-dexterity | success:igpek532 | failure:combat]它們(進行DC8敏捷檢定，失敗進入戰鬥)。"]}}},gkddd1234:{descriptions:["天亮後，你在塔城下還沒開口，守衛便已拋下一個帶著細繩的小竹簍。","「能讓我進城了嗎？」","你問著，其實只撇了一眼你就已經明白，這樣的細繩絕對不會有歡迎你攀上去的意思。","事實上，你連怎麼進城都不知道。","無論你繞著塔城走了無數次，仍舊沒辦法找到進城的方法。","「把戒指放進竹簍，我們有好消息告訴你。」","從守衛的戲謔的語氣，你覺得會是個壞消息。","「你們還是沒打算讓我進去吧？」","「別這麼說嘛，我們是能讓你進來，但要進來塔城是必須有條件的。」","「你們…明明做了承諾，只要我去找那條狗，就讓我進城的！」","「噢不不不…你說錯了，我們是要你找到那條狗並帶回來，但你不是連根狗毛都沒找到嗎？」","「但是…」","你咬了咬牙。","事實上，你在前一天已經找到婦人她那化為黑死屍的丈夫、還有她叨唸著的家傳寶戒。","因為她不斷抱怨著丈夫拿走家傳的紅寶石戒指去找小三，連她的愛犬都追隨著丈夫與小三而去。","在她的故事裡，她留戀著戒指的價值，以及對狗的愛。你忍受到天氣的炎熱，只為了聽她不斷抱怨著無關緊要的事。","你原以為，沒有找到狗，就算把家傳寶戒帶回來也能交差。","但是並沒有。","而且，你也不能說他們反悔。","「說吧，你們還有什麼條件？」"],chance:0,response:["確認"],behavior:{coping:{observation:[[1,"「給我滾開！」你威嚇著[_ | type:monster]。","action to target","abc123"]]},response:{}}}};this.chapters[0]=[],this.chapters[0]=["滾燙的黑色血液順著你的手臂緩緩流下來，滴落在砂土之前就已經凝結成一小片黑鐵。","你在灼熱的砂漠裡不斷前行，過往同伴的請託讓你無法停下腳步，而心中狂燥的慾望卻又讓你渴求戰鬥。","狂風肆虐的砂丘下，無數被砂土掩埋的漆黑屍骨。砂土隨意地覆蓋著它們，露出像是枯乾木乃伊的外表，卻又泛著金屬質感的黑鐵外殼。","黑死屍，你和你的同伴是這麼稱呼這些早就死了，卻又沒死透的傢伙們。","呢喃的聲音隨著黑死屍的掙扎而不斷傳來，你巴不得停下腳步殺光它們，但使命感讓你持續前行，直到遠離這場災難。","這一場災難的開頭，在一座名為馬里布的大城市裡，是一場飛空艇墜落意外之後。","從墜毀的飛空艇中湧出了無數的黑死屍，它們幾乎殺光所有馬里布的生命，在付出一切後你與你的同伴們僥倖地逃離那座城市。","強大的城防與經驗豐富的冒險者都無法抵抗它們，反抗的結果也只是增加它們的數量。","無人對付過這種像是殭屍，卻無法以神聖魔法驅散的不死生物；亦無人對付過這種外殼比魔偶更加堅硬，卻不存在魔核的殺人機器。","更無人對付過這種只需要透過傷害其他生物，就能夠不斷製造伙伴的怪物。","你們最後只能不斷地從這群怪物的威脅下逃離，不知不覺間變為沒有盡頭的旅程。","「我走不動了啦…」","你頭也不回，無視一路跟隨在你身後的小女孩的請求。","直到她開始哀求著你停下來休息。","「再堅持一下，我們就快到塔城了。」","其實你並不知道塔城究竟還有多遠，但你知道天黑之前你必須找到一個安全的地方。","因為你無法肯定在黑死屍的圍攻之下，這個女孩還能夠再撐過下一個夜晚。"],this.dungeons={abcd234:{roomType:"Dungeon",icon:"creation2",name:"幽深地城",descriptions:this.chapters[0],connectIn:["def765"],locations:[{position:[2,0],size:[5,5],rooms:[{name:"入口",icon:"creation2",descriptions:["剛進入地下城，充滿了著霉味與腐朽的氣味，令人鼻子不禁癢了起來。"],question:"輸入[三碼數字]的密碼解鎖[密碼鎖]後，順利打開[盒子]後從裡面取出一把精美的<color=#ffcc00>寶石匕首</color>。",cards:[(e={},e[o.Prop]="牆角邊有一個普通的木桶。",e[o.Presage]="木桶似乎有些新的小洞口。",e[o.Clue]="木桶的裡面有一個小小的洞，透過洞望進去可以看到一張寫著[三碼數字]的小紙條。",e[o.Doubt]="木桶的洞似乎被不斷挖開過，也許有些人想從中掏出什麼？",e),(s={},s[o.Prop]="[盒子]用[密碼鎖]上鎖了。",s[o.Presage]="[盒子]有些沉重，裡面裝著什麼。",s[o.Clue]="[盒子]上的鎖，是個三位數的[密碼鎖]。",s[o.Doubt]="[盒子]有個鎖，裡面的東西似乎很重要？",s),(t={},t[o.Prop]="一扇被破壞過的窗戶。",t[o.Presage]="窗戶上的窗簾看起來很破舊。",t[o.Clue]="窗簾似乎被巨大的爪子抓過…",t[o.Doubt]="窗戶的玻璃全被敲破，因此釘上許多木板，也許曾經有人想突破進來？",t)]},{name:"某個房間",icon:"creation2",descriptions:[],question:"有<color=#ffcc00>寶石匕首</color>。",cards:[(n={},n[o.Prop]="牆角邊有一個普通的木桶。",n[o.Presage]="木桶似乎有些新的小洞口。",n[o.Clue]="木桶的裡面有一個小小的洞，透過洞望進去可以看到一張寫著[三碼數字]的小紙條。",n[o.Doubt]="木桶的洞似乎被不斷挖開過，也許有些人想從中掏出什麼？",n)]},{name:"出口",icon:"creation2",descriptions:[],question:"透過寫在[照片]背面的開啟方法，打開[密封罐]後從中掏出一卷<color=#ffcc00>紅印文件</color>。",cards:[(i={},i[o.Prop]="展示櫃內部陳列著各式各樣的收藏品。",i[o.Presage]="當靠近展示櫃時，可以聽到微弱的機械運作聲。",i[o.Clue]="展示櫃的一個[密封罐]的位置發現了被頻繁觸碰或移動的磨損痕跡。",i[o.Doubt]="展示櫃中一件展品標籤與其他似乎略有不同",i),(r={},r[o.Prop]="展示櫃的[密封罐]中裝有一卷羊皮紙。",r[o.Presage]="[密封罐]外觀與它應有的重量還來得輕。",r[o.Clue]="[密封罐]的蓋子有特殊的旋轉機制，需按照特定順序旋轉才能打開。",r[o.Doubt]="罐內的物品看起來與展示櫃中其它展示物毫無關聯。",r),(c={},c[o.Prop]="[文書匣]內部分類細緻，但其中一個隔層異常緊固。",c[o.Presage]="打開[文書匣]時，一股陳年的紙張氣味撲面而來，中間卻夾帶著一絲[新墨水]的氣味。",c[o.Clue]="文書匣中一份文件因[紅色印記]而十分顯眼，但明顯是偽造的，用來掩蓋真實文件的存在。",c[o.Doubt]="[文書匣]中某些文件顯示出被重新放置的痕跡，似乎有人試圖隱藏或更改某些信息。",c),(a={},a[o.Prop]="相框是普通的裝飾品，背板可以拆卸取出[照片]",a[o.Presage]="觀察相框時，可以發現框架的某部分略有色差。",a[o.Clue]="相框中的[照片]的背面寫上如何開啟[密封罐]的方法。",a[o.Doubt]="照片中的人物與房間內其他照片的人物不同",a)]}]}]},"蠻獸荒野":{RoomType:"Dungeon",name:"蠻獸荒野",description:"一個充滿了怪獸的荒野，充滿了恐怖的氣息。",locations:["蠻獸之穴","幽靈之穴","遺忘之穴"],items:["古老的神器","古老的魔杖","古老的長劍"],monsters:["古老的食人魔","古老的食屍鬼","古老的食人族","古老的食人魔獸"],npcs:["古老的神官","古老的魔法師","古老的法師","古老的神父"],quests:["古老的神器","古老的魔杖","古老的長劍"],skills:["古老的神器","古老的魔杖","古老的長劍"],spells:["古老的神器","古老的魔杖","古老的長劍"],weapons:["古老的神器","古老的魔杖","古老的長劍"],armors:["古老的神器","古老的魔杖","古老的長劍"],potions:["古老的神器","古老的魔杖","古老的長劍"],scrolls:["古老的神器","古老的魔杖","古老的長劍"],keys:["古老的神器","古老的魔杖","古老的長劍"]},"幽深地城":{name:"幽深地城",description:"一個充滿了神秘力量的城市，充滿了神秘的魔法。",locations:["遺忘之城","幽靈之城","古老之城"],items:["古老的神器","古老的魔杖","古老的長劍"],monsters:["古老的食人魔","古老的食屍鬼","古老的食人族","古老的食人魔獸"],npcs:["古老的神官","古老的魔法師","古老的法師","古老的神父"],quests:["古老的神器","古老的魔杖","古老的長劍"],skills:["古老的神器","古老的魔杖","古老的長劍"],spells:["古老的神器","古老的魔杖","古老的長劍"],weapons:["古老的神器","古老的魔杖","古老的長劍"],armors:["古老的神器","古老的魔杖","古老的長劍"],potions:["古老的神器","古老的魔杖","古老的長劍"],scrolls:["古老的神器","古老的魔杖","古老的長劍"],keys:["古老的神器","古老的魔杖","古老的長劍"]},"遺忘聖殿":{name:"遺忘聖殿",description:"一個充滿了神秘力量的城市，充滿了神秘的魔法。",locations:["遺忘之城","幽靈之城","古老之城"],items:["古老的神器","古老的魔杖","古老的長劍"],monsters:["古老的食人魔","古老的食屍鬼","古老的食人族","古老的食人魔獸"],npcs:["古老的神官","古老的魔法師","古老的法師","古老的神父"],quests:["古老的神器","古老的魔杖","古老的長劍"],skills:["古老的神器","古老的魔杖","古老的長劍"],spells:["古老的神器","古老的魔杖","古老的長劍"],weapons:["古老的神器","古老的魔杖","古老的長劍"],armors:["古老的神器","古老的魔杖","古老的長劍"],potions:["古老的神器","古老的魔杖","古老的長劍"],scrolls:["古老的神器","古老的魔杖","古老的長劍"],keys:["古老的神器","古老的魔杖","古老的長劍"]}}}));s._RF.pop()}}}));

System.register("chunks:///_virtual/StoryDescribeStack.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"da3e1QNrIJI+ZVHoaQZA5i2","StoryDescribeStack",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/TeamMember.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatCharacter.ts","./CombatMonster.ts","./EventManager.ts","./Ability.ts","./HitPointsBarComponent.ts","./CombatController.ts"],(function(t){var e,i,n,a,o,r,c,s,l,h,u,m,b,f,p,g,y,d,v,E;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized,o=t.createClass},function(t){r=t.cclegacy,c=t._decorator,s=t.Node,l=t.Label,h=t.Sprite,u=t.randomRangeInt,m=t.resources,b=t.SpriteFrame,f=t.Component},function(t){p=t.CombatCharacter},function(t){g=t.CombatMonster},function(t){y=t.EventManager},function(t){d=t.Attribute},function(t){v=t.HitPointsBarComponent},function(t){E=t.CombatControllerEvent}],execute:function(){var L,C,I,k,A,P,B,w,S,H,D,M,z,T,q,F,V,R,W,j,x,_,N,O,Z;r._RF.push({},"20c84cTBANNhLVZZjAVC3YR","TeamMember",void 0);var Y=c.ccclass,G=c.property;t("TeamMember",(L=Y("TeamMember"),C=G(v),I=G(s),k=G(l),A=G(l),P=G(l),B=G(l),w=G(l),S=G(l),H=G(s),D=G(s),M=G(h),L((q=e((T=function(t){function e(){for(var e,i,o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return i=t.call.apply(t,[this].concat(r))||this,n(i,"hitPointsBar",q,a(i)),n(i,"selectButton",F,a(i)),n(i,"nameLabel",V,a(i)),n(i,"acLabel",R,a(i)),n(i,"atLabel",W,a(i)),n(i,"initiativeLabel",j,a(i)),n(i,"intentLabel",x,a(i)),n(i,"characterInfoLabel",_,a(i)),n(i,"weaponLayout",N,a(i)),n(i,"equipmentLayout",O,a(i)),n(i,"photo",Z,a(i)),i.combatEntity=void 0,i.movement=void 0,i.teamIndex=void 0,i.initiative=0,i.camp=0,i.weaponProficiencyAbilities=((e={})[d.Strength]=0,e[d.Dexterity]=0,e[d.Intelligence]=0,e[d.Wisdom]=0,e[d.Charisma]=0,e[d.Resilience]=0,e),i}i(e,t);var r=e.prototype;return r.onLoad=function(){},r.joinCombatTeam=function(){this.weaponLayout.active=!1,this.equipmentLayout.active=!1},r.leaveCombatTeam=function(){this.weaponLayout.active=!0,this.equipmentLayout.active=!0},r.characterInitial=function(t){this.movement=[t.movement,t.movement];var e=t.calculateProficienciesBonus(),i=t.calculateCompositeAbilities();console.log("計算所有能力的熟練加值:",e),console.log("計算各能力屬性對應的綜合屬性:",i);var n=t.name;this.combatEntity=new p(n,i,e,t.weaponProficiencies),this.setInfos(n,i),this.selectButton.off("click"),this.selectButton.on("click",this.onSelectCharacterClicked,this),this.camp=0},r.monsterInitial=function(t,e,i){this.combatEntity=new g(t,e,i,1),this.setInfos(t,e),this.selectButton.off("click"),this.selectButton.on("click",this.onSelectMonsterClicked,this),this.camp=1},r.setInfos=function(t,e){this.nameLabel.string=t,this.acLabel.string="AC "+this.combatEntity.ac,this.atLabel[0].string="",this.atLabel[1].string="",this.setPhotoImage(t),this.hitPointsBar.defaultHp=e.constitution},r.rollInitiativeOrder=function(t){this.combatEntity.resetBonuses(),this.initiative=t+u(1,20),this.initiativeLabel.string="先攻:"+this.initiative},r.enableSelect=function(){this.selectButton.active=!0},r.disableSelect=function(){this.selectButton.active=!1},r.setPhotoImage=function(t){var e=this.photo.getComponent(h),i="maps/"+t+"/spriteFrame";m.load(i,b,(function(t,i){t?console.error("Failed to load image: "+t):e.spriteFrame=i}))},r.setWeapon=function(t,e,i){var n;if(void 0===i&&(i=0),null==e)return console.log("清除武器"+t,this.combatEntity),null==(n=this.combatEntity)||n.unequipWeapon(t),void(this.atLabel[t].string="");var a=0;0===t&&this.combatEntity.weaponProficiencies.includes(e.style)&&(a=i),console.log("獲得武器"+t+"熟練加值:",a,"/",i),this.combatEntity.equipWeapon(t,e,a),this.atLabel[t].string=e.damage.dice},r.setArmor=function(t,e){e?this.combatEntity.equipArmor(e):this.combatEntity.unequipArmor(),this.acLabel.string="AC "+this.combatEntity.ac},r.setShield=function(t,e){e?this.combatEntity.equipShield(e):this.combatEntity.unequipShield(),this.acLabel.string="AC "+this.combatEntity.ac},r.startFight=function(){this.initiativeLabel.string="",console.log("開始戰鬥"),this.hitPointsBar.node.active=!1},r.endFight=function(){console.log("結束戰鬥"),this.hitPointsBar.node.active=!0},r.isAdvantage=function(){return this.combatEntity.isAdvantage},r.combatCardsToIntent=function(t){var e=this;console.log("執行卡牌轉意圖combatCards:",t);var i=this.combatEntity.combatIntent;i.clearIntents(),t.forEach((function(t){console.log("combatCard.modifiers length:",t.modifiers.length),t.modifiers.forEach((function(e){i.addIntent(e,t.target)}));var n=t.cost,a=n.type;n.fee;console.log("this.combatEntity.actionPoints:",e.combatEntity.actionPoints),"Reaction"===a&&e.combatEntity.actionPoints[a]>0&&(console.log("反應卡"),i.setReactionIntent(t.modifiers.slice())),"Bonus"===a&&e.combatEntity.actionPoints[a]}))},r.intent=function(){this.combatEntity.intent(this),this.hitPointsBar.tempHp=this.combatEntity.tempHP},r.hit=function(){return this.combatEntity.hit()},r.hits=function(t){return this.combatEntity.isAdvantage=!1,"Advantage"===t?this.combatEntity.advantageHit():"Disadvantage"===t?this.combatEntity.disadvantageHit():[this.hit()]},r.attack=function(t,e){return this.combatEntity.affixEffects.stun>0?(console.log("受到眩暈效果，無法攻擊"),this.combatEntity):(this.combatEntity.attack(t.combatEntity,e),this.combatEntity)},r.resultDamage=function(){return this.intentLabel&&(console.log("this.combatEntity.intentContents:",this.combatEntity.intentContents),this.intentLabel.string=this.combatEntity.intentContents.join("\n")),this.combatEntity.resultDamage()},r.getTempHP=function(){return this.combatEntity.tempHP},r.changeHpBar=function(t){this.hitPointsBar.node.active=!0;var e=t+this.hitPointsBar.tempHp;this.hitPointsBar.tempHp=Math.max(0,e),this.hitPointsBar.changeHp(Math.min(0,e))},r.reaction=function(t){var e=this.combatEntity.reaction();if(console.log(this.combatEntity.name,"反應成功:",e),e){var i=this.combatEntity.counterattack(t.combatEntity);console.log("反擊成功:",i)}var n=this.combatEntity,a=n.dodgeCounterattackDamageValue,o=n.counterattackDamageValue;return this.combatEntity.dodgeCounterattackDamageValue=0,this.combatEntity.counterattackDamageValue=0,{dodgeCounterattackDamageValue:a,counterattackDamageValue:o}},r.showIntent=function(){console.log("顯示意圖");var t=this.combatEntity;0!==t.intentContents.length?(this.intentLabel&&(this.intentLabel.string=t.intentContents.join("\n")),t.intentContents.length=0):this.intentLabel.string=""},r.showCharacterInfo=function(){var t=this,e=this.combatEntity;e&&this.characterInfoLabel&&(this.characterInfoLabel.string="",console.log("character.combatWeapons:",e.combatWeapons),e.combatWeapons.forEach((function(e,i){var n=[];switch(e.properties.forEach((function(t){switch(t){case"Light":n.push("輕型武器小而易用，適合被用於雙武器戰鬥。");break;case"Finesse":n.push("靈巧武器可以選擇在該次攻擊檢定和傷害骰中使用你的力量或敏捷調整值。這兩次擲骰必須使用相同的調整值。");break;case"Thrown":n.push("投擲武器。投擲武器的攻擊力與命中值都較小型生物的攻擊力低。");break;case"Two-Handed":n.push("雙手. 此武器需要雙手使用。這個屬性只關聯於你使用此武器攻擊時，而非單純持握它的時候。");break;case"Reach":n.push("觸及. 當你使用此武器攻擊時，此武器讓你的觸及距離增加5呎。這個屬性也影響你使用觸及武器進行藉機攻擊的觸及距離。");break;case"Heavy":n.push("小型生物在使用重型武器進行攻擊時會承受劣勢。重型武器的尺寸和重量使它對小型生物而言太過龐大而無法有效使用。");break;case"Ammunition":n.push("彈藥. 你只能在擁有該武器射擊所需要的彈藥時，才能使用具有彈藥屬性的武器進行一次遠程攻擊。每次你使用該武器攻擊，你消耗一發彈藥。從箭袋、盒子、或其他容器抽出彈藥被視為該攻擊的一部份。裝填單手武器需要一隻空手。在戰鬥結束後，你可以藉由花費一分鐘的時間搜索戰場，以拿回一半你所消耗掉的彈藥量。");break;case"Loading":n.push("裝填. 由於裝填此武器所需的時間，當你使用動作、附贈動作、或反應以該武器射擊時，無論你原本可以進行幾次攻擊，你都只能用其射出一發彈藥。");break;case"Special":n.push("特殊. 具有特殊屬性的武器有著獨特的規則以處理其使用，詳情請參閱該武器的描述（參見本段落中後述的「特殊武器」）。");break;case"Versatile":n.push("可雙手. 此武器可以被單手或雙手使用。這個屬性後方所顯示括號內的傷害數值，代表著以雙手使用此武器進行一次近戰攻擊時的傷害。")}})),"拳擊"!==e.name&&(t.characterInfoLabel.string+="\n"+e.name+"： "+n.join("\n")),e.damage.type){case"Bludgeoning":t.characterInfoLabel.string+="\n此武器為鈍器攻擊";break;case"Piercing":t.characterInfoLabel.string+="\n此武器為穿刺攻擊";break;case"Slashing":t.characterInfoLabel.string+="\n此武器為揮砍攻擊"}})),e.combatArmor.isCasterArmor?this.characterInfoLabel.string+="\n身著法衣，便於施法。AC 為敏捷加值。":e.combatArmor.isLightArmor?this.characterInfoLabel.string+="\n身著輕甲，可靈活動作。AC 為敏捷加值，但上限為2。":e.combatArmor.armorClass>10&&(this.characterInfoLabel.string+="\n身著重甲，防禦力強，但在需要靈活動作時會直接失敗。"),e.combatArmor.shielded&&(this.characterInfoLabel.string+="\n裝備盾牌可獲的2點AC(Armor Class)。"))},r.move=function(t){return this.movement[0]>=t&&(this.movement[0]-=t,!0)},r.roundOver=function(){this.combatEntity.temporaryArmor=0,this.combatEntity.tempHP=0,this.hitPointsBar.tempHp=0,this.acLabel.string="AC: "+this.combatEntity.ac},r.onSelectCharacterClicked=function(){console.log("選擇角色"),this.disableSelect(),y.instance.emit(E.SelectCharacter,this)},r.onSelectMonsterClicked=function(){console.log("選擇怪物"),this.disableSelect(),y.instance.emit(E.SelectMonster,this)},o(e,[{key:"isDead",get:function(){return this.combatEntity.isDead}}]),e}(f)).prototype,"hitPointsBar",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(T.prototype,"selectButton",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(T.prototype,"nameLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(T.prototype,"acLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(T.prototype,"atLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=e(T.prototype,"initiativeLabel",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(T.prototype,"intentLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(T.prototype,"characterInfoLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(T.prototype,"weaponLayout",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(T.prototype,"equipmentLayout",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(T.prototype,"photo",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=T))||z));r._RF.pop()}}}));

System.register("chunks:///_virtual/TexasGameLogic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ExplorationCard.ts","./GameEvents.ts","./HandEvaluator.ts","./EventManager.ts","./FillBlanks.ts"],(function(n){var e,t,a,i,s,r,o,c,d,u,h,l,f,m,p,v,_,y,C;return{setters:[function(n){e=n.inheritsLoose,t=n.createForOfIteratorHelperLoose,a=n.asyncToGenerator,i=n.regeneratorRuntime},function(n){s=n.cclegacy,r=n._decorator,o=n.Vec3,c=n.Component},function(n){d=n.CardSuit},function(n){u=n.GameLogicEvent,h=n.DeckPileEvent,l=n.CommunityCardEvent,f=n.PlayerHandCardEvent,m=n.GameUIEvent,p=n.WordPuzzleGameLogicEvent},function(n){v=n.CardEvaluations,_=n.HandEvaluator},function(n){y=n.EventManager},function(n){C=n.FillBlanks}],execute:function(){var g;s._RF.push({},"f06dbHBlopIvqT3D6bZcdTU","TexasGameLogic",void 0);var G=r.ccclass;r.property,n("default",G("TexasGameLogic")(g=function(n){function s(){for(var e,t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];return(e=n.call.apply(n,[this].concat(a))||this)._deck=[],e._community=[],e._players=[],e._discarded=[],e._gamePlayers=[],e._answerTipCards=[],e._intros=void 0,e}e(s,n);var r=s.prototype;return r.onLoad=function(){y.instance.on(u.GameStart,this.eventGameStart.bind(this)),y.instance.on(u.GameEnd,this.eventGameEnd.bind(this)),y.instance.on(u.GameResume,this.eventGameResume.bind(this)),y.instance.on(u.GameRoundStartDiscardCards,this.eventDiscardCards.bind(this)),y.instance.on(u.GameRoundStartDealCards,this.onGameRoundStartDealCards.bind(this)),y.instance.on(u.GameRoundNextPlayerTurn,this.playerNextTurn.bind(this)),y.instance.on(u.GameRoundEndShowCards,this.endShowCards.bind(this))},r.onDestroy=function(){y.instance.off(u.GameStart,this.eventGameStart),y.instance.off(u.GameEnd,this.eventGameEnd),y.instance.off(u.GameResume,this.eventGameResume),y.instance.off(u.GameRoundStartDiscardCards,this.eventDiscardCards),y.instance.off(u.GameRoundStartDealCards,this.onGameRoundStartDealCards),y.instance.off(u.GameRoundNextPlayerTurn,this.playerNextTurn),y.instance.off(u.GameRoundEndShowCards,this.endShowCards)},r.start=function(){this.node.position=o.ZERO,this.node.active=!1},r.initGame=function(n,e){this.node.active=!0,this._gamePlayers=n,this._intros=e,this.initializeDeck(),y.instance.emit(h.ShowCards,this._deck)},r.initializeDeck=function(){var n=this._intros;console.log("intros:",n);var e=[d.Prop,d.Clue,d.Doubt,d.Presage],a=["2","3","4","5","6","7","8","9","10","J","Q","K","A"].slice(13-n.length),i=["stealth","power","wisdom","speed","luck"];this._deck.length=0;for(var s=0,r=e;s<r.length;s++)for(var o,c=r[s],u=t(a);!(o=u()).done;){var h=o.value,l=a.indexOf(h),f=[];if(l<n.length)f=[n[l][c]];else{var m=Math.floor(3*Math.random())+1;f=[];for(var p=0;p<m;p++)f.push(i[Math.floor(Math.random()*i.length)])}this._deck.push({suit:c,rank:h,conditions:f})}},r.shuffleDeck=function(){for(var n=0;n<this._deck.length;n++){var e=Math.floor(Math.random()*(n+1)),t=[this._deck[e],this._deck[n]];this._deck[n]=t[0],this._deck[e]=t[1]}},r.startGame=function(){var n=a(i().mark((function n(){var e=this;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.shuffleDeck(),console.log("deck:",this._deck),n.next=4,this.dealCards();case 4:return n.next=6,new Promise((function(n){return e.scheduleOnce(n,.5)}));case 6:this.compareCards();case 7:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),r.dealCards=function(){var n=a(i().mark((function n(){var e,t,a=this;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(this._deck.length<7)){n.next=2;break}throw new Error("Not enough cards in the deck.");case 2:for(1,this._players.forEach((function(n){n.length=0})),e=0;e<1;e++)this._players[e]=[this._deck.pop(),this._deck.pop()];for(this._community.length=0,t=0;t<5;t++)this._community.push(this._deck.pop());return y.instance.emit(f.ShowCards,this._players[0]),y.instance.emit(h.DealCommunityCards,this._community),n.next=11,new Promise((function(n){return a.scheduleOnce(n,.5)}));case 11:y.instance.emit(h.DealPlayerCards,this._players);case 12:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),r.compareCards=function(){var n=this._players[0].concat(this._community),e=this.findBestHand(n),t=this.findCombinationsForSpecificHandType(n,e);y.instance.emit(l.CompareCards,t),y.instance.emit(f.CompareCards,t);var a=t[0].map((function(n){return n.conditions[0]})),i=C.replaceMarkedWithKeywords(a,this._answerTipCards.map((function(n){return n.string}))),s=(i.replacedTexts,i.newKeywords),r=Array.from(new Map(s.flat().map((function(n){return[n.string,n]}))).values());y.instance.emit(m.ShowCardConditions2,{conditions:a}),this._answerTipCards=this._answerTipCards.concat(r),y.instance.emit(p.ShowAnswer,{answers:this._answerTipCards})},r.determineWinner=function(){var n=this;this._players.map((function(e,t){return{score:n.evaluateHand(e.concat(n._community)),conditions:e.reduce((function(n,e){return n.concat(e.conditions)}),[]),index:t}})).forEach((function(n){console.log("Player "+(n.index+1)+" score: "+n.score+", conditions: "+n.conditions.join(", "))}))},r.evaluateHand=function(n){var e=0,t={};for(var a in n.forEach((function(n){n.conditions.forEach((function(n){t[n]=(t[n]||0)+1}))})),t)e+=t[a];return e},r.nextRound=function(){var n=a(i().mark((function n(){var e=this;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return y.instance.emit(h.DiscardCards,this._community.concat(this._players[0])),n.next=3,new Promise((function(n){return e.scheduleOnce(n,.5)}));case 3:this._deck.length<7?(y.instance.emit(h.DeckGatherings),this.initializeDeck()):this.startGame();case 4:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),r.updateGameState=function(n){},r.playerMakesMove=function(n,e){},r.selectOrDiscardCard=function(n,e,t){t?console.log("Player "+(n+1)+" keeps card: "+this._players[n][e].rank+" of "+this._players[n][e].suit):(this._players[n][e]=this._deck.pop(),console.log("Player "+(n+1)+" discards and draws a new card: "+this._players[n][e].rank+" of "+this._players[n][e].suit))},r.getCombinations=function(n,e){var t=[],a=[];return function i(s,r){for(var o=r;o<n.length-(e-s)+1;o++)a[s]=n[o],s<e-1?i(s+1,o+1):t.push(a.slice())}(0,0),t},r.findBestHand=function(n){var e=this;if(7!==n.length)throw new Error("Must evaluate exactly 7 cards.");var t=this.getCombinations(n,5),a=v.HighCard;return t.forEach((function(n){var t=_.evaluateHand(n);e.compareHands(t,a)>0&&(a=t)})),console.log("Best hand:",a),a},r.compareHands=function(n,e){var t=Object.values(v);return t.indexOf(n)-t.indexOf(e)},r.findCombinationsForSpecificHandType=function(n,e){if(n.length<5)throw new Error("Not enough cards to evaluate.");var t=this.getCombinations(n,5),a=[];return t.forEach((function(n){_.evaluateHand(n)===e&&a.push(n)})),a},r.handleDiscardCards=function(n){this._discarded=this._discarded.concat(n),console.log("Updated discard pile:",this._discarded),y.instance.emit(m.DeckCardDiscard,this._discarded)},r.eventDiscardCards=function(n){var e=n;this.handleDiscardCards(e)},r.playerNextTurn=function(n){this.nextRound()},r.endShowCards=function(n){console.log("End show cards:",n),this.findBestHand(n)},r.eventGameStart=function(n){console.log("Game start");var e=n.playersInfo,t=n.intros;this.initGame(e,t),y.instance.emit(m.GameStart)},r.eventGameResume=function(n){console.log("Game resume")},r.eventGameEnd=function(n){this._community.length=0,y.instance.emit(l.ShowCards,this._community),this._players.forEach((function(n){n.length=0})),y.instance.emit(f.ShowCards,this._players[0]),this._answerTipCards.length=0,y.instance.emit(m.GameEnd),y.instance.emit(p.WordPuzzleGameEnd),this.node.active=!1},r.onGameRoundStartDealCards=function(){console.log("Deal cards"),this.startGame()},s}(c))||g);s._RF.pop()}}}));

System.register("chunks:///_virtual/TexasGamePlayer.ts",["cc"],(function(e){var a,c;return{setters:[function(e){a=e.cclegacy,c=e._decorator}],execute:function(){var r;a._RF.push({},"bafc4UZqdFPnLGB1xBEv82A","TexasGamePlayer",void 0);var t=c.ccclass;c.property,e("TexasGamePlayer",t(r=function(){})||r);a._RF.pop()}}}));

System.register("chunks:///_virtual/TexasGameUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameEvents.ts","./EventManager.ts","./FillBlanks.ts","./HandCards.ts","./TipClipsAnimation.ts","./DescriptionScrollView.ts"],(function(e){var t,n,i,a,r,o,c,s,d,l,u,h,v,p,C,f,w,D,B;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){r=e.cclegacy,o=e._decorator,c=e.RichText,s=e.Node,d=e.Vec3,l=e.tween,u=e.Component},function(e){h=e.GameUIEvent,v=e.GameLogicEvent,p=e.WordPuzzleGameLogicEvent},function(e){C=e.EventManager},function(e){f=e.FillBlanks},function(e){w=e.HandCards},function(e){D=e.TipClipsAnimation},function(e){B=e.DescriptionScrollView}],execute:function(){var b,m,k,S,z,g,G,y,x,E,P,R,V,I,L,N,T,U,H;r._RF.push({},"9c23d2tFDNBnq8i9+EAEypr","TexasGameUI",void 0);var A=o.ccclass,F=o.property;e("default",(b=A("TexasGameUI"),m=F(w),k=F(c),S=F(B),z=F(s),g=F(s),G=F(s),y=F(s),x=F(D),b((R=t((P=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,i(t,"answerHandCards",R,a(t)),i(t,"cardIntroLabel",V,a(t)),i(t,"descriptionScrollView",I,a(t)),i(t,"BackPuzzleBtn",L,a(t)),i(t,"NextRoundBtn",N,a(t)),i(t,"DiscardCardBtn",T,a(t)),i(t,"DeckGatheringBtn",U,a(t)),i(t,"answerClipsAnimation",H,a(t)),t}n(t,e);var r=t.prototype;return r.onLoad=function(){C.instance.on(h.GameStart,this.eventGameStart.bind(this)),C.instance.on(h.GameEnd,this.eventGameEnd.bind(this)),C.instance.on(h.DeckCardSelected,this.eventDeckCardSelected.bind(this)),C.instance.on(h.DeckCardUnselected,this.eventDeckCardUnselected.bind(this)),C.instance.on(h.DeckCardDiscard,this.eventDeckCardDiscard.bind(this)),C.instance.on(h.ShowCardConditions,this.eventShowCardConditions.bind(this)),C.instance.on(h.ShowCardConditions2,this.eventShowCardConditions2.bind(this))},r.onDestroy=function(){C.instance.off(h.GameStart,this.eventGameStart),C.instance.off(h.GameEnd,this.eventGameEnd),C.instance.off(h.DeckCardSelected,this.eventDeckCardSelected),C.instance.off(h.DeckCardUnselected,this.eventDeckCardUnselected),C.instance.off(h.DeckCardDiscard,this.eventDeckCardDiscard),C.instance.off(h.ShowCardConditions,this.eventShowCardConditions),C.instance.off(h.ShowCardConditions2,this.eventShowCardConditions2)},r.start=function(){this.node.position=d.ZERO,this.answerHandCards.show(!1)},r.updateCardIntroLabel=function(e){void 0===e&&(e=""),this.cardIntroLabel.string=e},r.eventGameStart=function(e){this.BackPuzzleBtn.active=!1,this.NextRoundBtn.active=!1,this.DiscardCardBtn.active=!1,this.DeckGatheringBtn.active=!0},r.eventGameEnd=function(e){this.BackPuzzleBtn.active=!1,this.NextRoundBtn.active=!1,this.DiscardCardBtn.active=!1,this.DeckGatheringBtn.active=!1,console.log("關!!"),this.answerHandCards.show(!1),this.descriptionScrollView.clear(),this.descriptionScrollView.close()},r.eventDeckCardSelected=function(e){var t=e.conditions,n=f.replaceKeywordsWidthBlanks(t).replacedTexts;this.updateCardIntroLabel(n.join("\n"))},r.eventDeckCardUnselected=function(e){this.descriptionScrollView.clear()},r.eventDeckCardDiscard=function(e){this.descriptionScrollView.clear()},r.eventShowCardConditions=function(e){var t=e.conditions;this.updateCardIntroLabel(t.join("\n"));var n=e.answers;this.answerClipsAnimation.spreadCards(n),this.BackPuzzleBtn.active=!0,this.NextRoundBtn.active=!0,this.DiscardCardBtn.active=!1,this.DeckGatheringBtn.active=!1},r.eventShowCardConditions2=function(e){console.log("event.conditions:",e.conditions),this.descriptionScrollView.show(),this.descriptionScrollView.setData(e.conditions),this.BackPuzzleBtn.active=!0,this.NextRoundBtn.active=!0,this.DiscardCardBtn.active=!1,this.DeckGatheringBtn.active=!1},r.animateCardDeal=function(e,t,n){void 0===n&&(n=.25),l(t).delay(n).to(.5,{position:e.position}).start()},r.onNextPlayerTurn=function(){this.descriptionScrollView.close(),this.BackPuzzleBtn.active=!1,this.NextRoundBtn.active=!1,this.DiscardCardBtn.active=!1,this.DeckGatheringBtn.active=!1,C.instance.emit(v.GameRoundNextPlayerTurn)},r.onWordPuzzleClicked=function(){C.instance.emit(p.ShowHint,{active:!0})},t}(u)).prototype,"answerHandCards",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(P.prototype,"cardIntroLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(P.prototype,"descriptionScrollView",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(P.prototype,"BackPuzzleBtn",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(P.prototype,"NextRoundBtn",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(P.prototype,"DiscardCardBtn",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(P.prototype,"DeckGatheringBtn",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(P.prototype,"answerClipsAnimation",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=P))||E));r._RF.pop()}}}));

System.register("chunks:///_virtual/TipClipsAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CardMover.ts"],(function(e){var n,t,r,i,a,o,s,c,u,l,p,d,f,h,v,C,b,m;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e._decorator,u=e.Node,l=e.Prefab,p=e.Component,d=e.tween,f=e.v3,h=e.Vec3,v=e.instantiate,C=e.Label,b=e.randomRange},function(e){m=e.CardMover}],execute:function(){var y,w,g,L,N,P,T;s._RF.push({},"d0876fZtKdLFoba69Le1bNQ","TipClipsAnimation",void 0);var x=c.ccclass,A=c.property;e("TipClipsAnimation",(y=x("TipClipsAnimation"),w=A(u),g=A(l),y((P=n((N=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,r(n,"destinationNode",P,i(n)),r(n,"answerClipPrefab",T,i(n)),n}t(n,e);var s=n.prototype;return s.onLoad=function(){},s.spreadCards=function(){var e=a(o().mark((function e(n){var t,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n.forEach((function(e){var n=v(r.answerClipPrefab);n.getComponentInChildren(C).string=e,r.node.addChild(n),t.push(n)})),e.next=4,m.scatterCards(t,this.node,[60,100],b(.75,1.25));case 4:t.forEach(a(o().mark((function e(n,t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.moveCard(n,r.destinationNode,h.ZERO,.25,.25);case 2:d(r.destinationNode).to(.1,{scale:f(1.2,1.2,1)}).call((function(){return n.destroy()})).to(.1,{scale:f(1,1,1)}).start();case 3:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),n}(p)).prototype,"destinationNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=n(N.prototype,"answerClipPrefab",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=N))||L));s._RF.pop()}}}));

System.register("chunks:///_virtual/TipText.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(i){var t,n,o,e,r,a,T,s,h;return{setters:[function(i){t=i.applyDecoratedDescriptor,n=i.inheritsLoose,o=i.initializerDefineProperty,e=i.assertThisInitialized},function(i){r=i.cclegacy,a=i._decorator,T=i.RichText,s=i.Component},function(i){h=i.EventManager}],execute:function(){var c,p,l,f,x;r._RF.push({},"aa1f8eOUGlFa4eC3sr3+wN3","TipText",void 0);var u=a.ccclass,w=a.property,d=i("TipType",function(i){return i.Normal="ShowTipText",i.NormalDelay="ShowTipTextDelay",i.Warning="ShowWarningText",i.Error="ShowErrorText",i.Hide="HideTipText",i}({}));i("TipText",(c=u("TipText"),p=w(T),c((x=t((f=function(i){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=i.call.apply(i,[this].concat(r))||this,o(t,"tipText",x,e(t)),t}n(t,i);var r=t.prototype;return r.onLoad=function(){this.node.active=!1,h.instance.on(d.Normal,this.onShowTipText.bind(this)),h.instance.on(d.NormalDelay,this.onShowDelayTipText.bind(this)),h.instance.on(d.Warning,this.onShowWarrningTipText.bind(this)),h.instance.on(d.Error,this.onShowErrorTipText.bind(this)),h.instance.on(d.Hide,this.onHideTipText.bind(this))},r.onDestroy=function(){h.instance.off(d.Normal,this.onShowTipText),h.instance.off(d.Normal,this.onShowDelayTipText),h.instance.off(d.Normal,this.onShowWarrningTipText),h.instance.off(d.Normal,this.onShowErrorTipText),h.instance.off(d.Normal,this.onHideTipText)},r.showTipText=function(i){this.tipText.string=i,this.node.active=!0},r.onShowTipText=function(i){var t=i;this.showTipText(t)},r.onShowDelayTipText=function(i){var t=i;this.showTipText(t)},r.onShowWarrningTipText=function(i){var t="<color=#ffff00>"+i+"</color>";this.showTipText(t)},r.onShowErrorTipText=function(i){var t="<color=#ff0000>"+i+"</color>";this.showTipText(t)},r.onHideTipText=function(){this.node.active=!1,this.tipText.string=""},t}(s)).prototype,"tipText",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=f))||l));r._RF.pop()}}}));

System.register("chunks:///_virtual/UIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AttributeAllocation.ts","./AttributeComponent.ts","./EventManager.ts","./CharacterInfo.ts","./Inventory.ts"],(function(i){var n,t,e,o,a,r,l,s,c,h,u,f,b,I,p;return{setters:[function(i){n=i.applyDecoratedDescriptor,t=i.inheritsLoose,e=i.initializerDefineProperty,o=i.assertThisInitialized},function(i){a=i.cclegacy,r=i._decorator,l=i.Node,s=i.Vec3,c=i.instantiate,h=i.Component},function(i){u=i.AttributeAllocation},function(i){f=i.AttributeComponent},function(i){b=i.EventManager},function(i){I=i.CharacterInfo},function(i){p=i.Inventory}],execute:function(){var v,y,C,w,A,S,d,U,g,m,_,B,D;a._RF.push({},"39d66FlqqhOgIS0LTNa2cx0","UIManager",void 0);var V=r.ccclass,z=r.property,M=i("UIEvent",function(i){return i.BaseAbilitiesShowUI="ui_event_base_abilities_show_ui",i.BaseAbilityAllocation="ui_event_base_ability_allocation",i.InventoryShowUI="ui_event_inventory_show_ui",i.DescriptionScrollViewShowUI="ui_event_description_scroll_view_show_ui",i}({}));i("UIManager",(v=V("UIManager"),y=z(l),C=z(l),w=z(l),A=z(l),S=z(l),v((g=n((U=function(i){function n(){for(var n,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=i.call.apply(i,[this].concat(a))||this,e(n,"abilitiesInfoContainer",g,o(n)),e(n,"abilitiesContainer",m,o(n)),e(n,"characterInfoContainer",_,o(n)),e(n,"inventoryContainer",B,o(n)),e(n,"descriptionScrollContainer",D,o(n)),n}t(n,i);var a=n.prototype;return a.onLoad=function(){b.instance.on(M.BaseAbilitiesShowUI,this.onBaseAbilitiesShowUI.bind(this)),b.instance.on(M.BaseAbilityAllocation,this.onBaseAbilityAllocation.bind(this)),b.instance.on(M.InventoryShowUI,this.onInventoryShowUI.bind(this)),b.instance.on(M.DescriptionScrollViewShowUI,this.onDescriptionScrollViewShowUI.bind(this))},a.onDestroy=function(){b.instance.off(M.BaseAbilitiesShowUI,this.onBaseAbilitiesShowUI),b.instance.off(M.BaseAbilityAllocation,this.onBaseAbilityAllocation),b.instance.off(M.InventoryShowUI,this.onInventoryShowUI),b.instance.off(M.DescriptionScrollViewShowUI,this.onDescriptionScrollViewShowUI)},a.start=function(){this.node.position=s.ZERO},a.updateBaseAbilityByComponents=function(){var i=this.abilitiesContainer.getComponentsInChildren(f);if(i){var n={};i.forEach((function(i){console.log("component.Name:",i.Name,i.Value),n[i.Name]=i.Value})),this.characterInfoUpdate(n)}},a.baseAbilityAllocation=function(i,n){var t=this,e=this.abilitiesContainer.getComponent(u),o=this.abilitiesContainer.getComponentsInChildren(f);if(e&&o){var a=0;Object.values(n).forEach((function(i,e){var r=o[e];if(!r){var l=c(o[0].node);l.parent=t.abilitiesContainer,l.active=!0,r=l.getComponent(f)}r.Name=Object.keys(n)[e],r.Value=i,a+=i})),e.pointsUsed=a,e.totalPoints=i+a}this.abilitiesContainer.active=!0},a.characterInfoUpdate=function(i){var n=this.characterInfoContainer.getComponent(I);console.log("characterInfoUpdate",n,i),n&&(console.log("characterInfo.character:",n.character),n.character.abilities=i,n.refreshCharacterInfo(),n.refreshItemInfo())},a.onBaseAbilitiesShowUI=function(i){this.abilitiesContainer.active=i,this.abilitiesInfoContainer.active=i,i||this.updateBaseAbilityByComponents()},a.onBaseAbilityAllocation=function(i){var n=i.allocatePoints,t=i.baseAbilities;console.log("onBaseAbilityAllocation",n,t),this.baseAbilityAllocation(n,t)},a.onInventoryShowUI=function(i){var n=this.inventoryContainer.getComponent(p);n&&n.show(i);var t=this.characterInfoContainer.getComponent(I);t&&(t.member.characterInfoLabel.node.active=i)},a.onDescriptionScrollViewShowUI=function(i){this.descriptionScrollContainer.active=i},a.onAbilitiesCloseClicked=function(){this.onBaseAbilitiesShowUI(!1)},a.onAbilityInfoClicked=function(){this.onBaseAbilitiesShowUI(!this.abilitiesContainer.active)},a.onInventoryButtonClicked=function(){this.onInventoryShowUI(!this.inventoryContainer.active)},n}(h)).prototype,"abilitiesInfoContainer",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=n(U.prototype,"abilitiesContainer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=n(U.prototype,"characterInfoContainer",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(U.prototype,"inventoryContainer",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(U.prototype,"descriptionScrollContainer",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=U))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Item.ts"],(function(e){var a,r,o;return{setters:[function(e){a=e.inheritsLoose},function(e){r=e.cclegacy},function(e){o=e.Item}],execute:function(){r._RF.push({},"ed784fy1SFNlou/nwbz53fp","Weapon",void 0);e("WeaponStyle",function(e){return e.Unarmed="Unarmed",e.AllSimpleWeapons="AllSimpleWeapons",e.Club="Club",e.Dagger="Dagger",e.Greatclub="Greatclub",e.Handaxe="Handaxe",e.Javelin="Javelin",e.LightHammer="Light Hammer",e.Mace="Mace",e.Quarterstaff="Quarterstaff",e.Sickle="Sickle",e.Spear="Spear",e.LightCrossbow="Light Crossbow",e.Dart="Dart",e.Shortbow="Shortbow",e.Sling="Sling",e.AllMartialWeapons="AllMartialWeapons",e.Battleaxe="Battleaxe",e.Flail="Flail",e.Glaive="Glaive",e.Greataxe="Greataxe",e.Greatsword="Greatsword",e.Halberd="Halberd",e.Lance="Lance",e.Longsword="Longsword",e.Maul="Maul",e.Morningstar="Morningstar",e.Pike="Pike",e.Rapier="Rapier",e.Scimitar="Scimitar",e.ShortSword="Shortsword",e.Trident="Trident",e.WarPick="War Pick",e.Warhammer="Warhammer",e.Whip="Whip",e.Blowgun="Blowgun",e.HandCrossbow="Hand Crossbow",e.HeavyCrossbow="Heavy Crossbow",e.Longbow="Longbow",e.Net="Net",e}({})),e("Weapon",function(e){function r(a,r,o,t,n,i,l,s){var c;return(c=e.call(this,a,r,o,1)||this).style=void 0,c.icon=void 0,c.damage=void 0,c.properties=void 0,c.range=void 0,c.style=t,c.icon=n,c.damage=i,c.properties=l,c.range=s,c}return a(r,e),r}(o));r._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponDraggable.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Draggable.ts","./EventManager.ts","./EquipmentDropZone.ts"],(function(e){var n,t,a,o,r,i,s,c;return{setters:[function(e){n=e.inheritsLoose,t=e.createClass},function(e){a=e.cclegacy,o=e._decorator,r=e.Label},function(e){i=e.Draggable},function(e){s=e.EventManager},function(e){c=e.EquipmentDropZoneIndex}],execute:function(){var l;a._RF.push({},"15f7a4o9/hARp+gzHtYMOx6","WeaponDraggable",void 0);var p=o.ccclass;o.property,e("WeaponDraggable",p("WeaponDraggable")(l=function(e){function a(){for(var n,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return(n=e.call.apply(e,[this].concat(a))||this).nameLabel=null,n._weapon=null,n.equipmentIndex=c.None,n}return n(a,e),a.prototype.onTouchStart=function(n){if(e.prototype.onTouchStart.call(this,n),this.equipmentIndex!==c.None){var t=this.zone;s.instance.emit("CharacterUnequip",{index:t.serialIndex}),this.equipmentIndex=c.None}},t(a,[{key:"weapon",set:function(e){this._weapon=e,console.log("WeaponDraggable.weapon = ",e),this.nameLabel=this.node.getComponentInChildren(r),this.nameLabel.string=e.name,this.setPhotoImage(e.icon)}},{key:"item",get:function(){return this._weapon}}]),a}(i))||l);a._RF.pop()}}}));

System.register("chunks:///_virtual/WordPuzzleData.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"081e8hHWYtO0oke+7yDlL6q","WordPuzzleData",void 0);t("WordPuzzleData",(function(){}));e._RF.pop()}}}));

System.register("chunks:///_virtual/WordPuzzleGameLogic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./GameEvents.ts","./FillBlanks.ts","./WordPuzzleGameUI.ts"],(function(e){var n,t,o,i,s,a,r,c,u,h,l,d,m;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){s=e.cclegacy,a=e._decorator,r=e.Vec3,c=e.Component},function(e){u=e.EventManager},function(e){h=e.WordPuzzleGameLogicEvent,l=e.GameLogicEvent},function(e){d=e.FillBlanks},function(e){m=e.default}],execute:function(){var f,z,w,G,p;s._RF.push({},"f79c6JenbpK/pT47NpbhBEI","WordPuzzleGameLogic",void 0);var v=a.ccclass,S=a.property;e("default",(f=v("WordPuzzleGameLogic"),z=S(m),f((p=n((G=function(e){function n(){for(var n,t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s))||this,o(n,"gameUI",p,i(n)),n._data=void 0,n}t(n,e);var s=n.prototype;return s.onLoad=function(){this.node.setPosition(r.ZERO),u.instance.on(h.WordPuzzleGameStart,this.startWordPuzzleGame.bind(this)),u.instance.on(h.WordPuzzleGameEnd,this.endWordPuzzleGame.bind(this)),u.instance.on(h.ShowAnswer,this.onShowAnswer.bind(this)),u.instance.on(h.ShowHint,this.onShowHint.bind(this)),u.instance.on(h.TexasGameStart,this.onTexasGameStart.bind(this)),u.instance.on(h.TexasGameResume,this.onTexasGameResume.bind(this))},s.onDestroy=function(){u.instance.off(h.WordPuzzleGameStart,this.startWordPuzzleGame),u.instance.off(h.WordPuzzleGameEnd,this.endWordPuzzleGame),u.instance.off(h.ShowAnswer,this.onShowAnswer),u.instance.off(h.ShowHint,this.onShowHint),u.instance.off(h.TexasGameStart,this.onTexasGameStart),u.instance.off(h.TexasGameResume,this.onTexasGameResume)},s.start=function(){this.node.position=r.ZERO,this.node.active=!1},s.startWordPuzzleGame=function(e){this.node.active=!0,this._data=e,e.cards.sort((function(){return Math.random()-.5}));var n=[e.question];this.onShowQuestion(n)},s.endWordPuzzleGame=function(){this.node.active=!1},s.showQuestion=function(e,n){console.log("Question: "+e+", Answer: "+n),this.gameUI.showQuestion(e,n)},s.showAnswer=function(e){this.gameUI.showAnswer(e)},s.onShowQuestion=function(e){var n=d.replaceKeywordsWidthBlanks(e),t=n.replacedTexts,o=n.storedTexts,i=t[0],s=o[0];this.showQuestion(i,s)},s.onShowAnswer=function(e){var n=e.answers;console.log("Answer: "+n.map((function(e){return e.string}))),this.showAnswer(n)},s.onShowHint=function(e){this.node.active=e.active},s.onTexasGameStart=function(e){u.instance.emit(l.GameStart,{plyaerInfo:null,intros:this._data.cards}),this.node.active=!1},s.onTexasGameResume=function(e){u.instance.emit(l.GameResume),this.node.active=!1},n}(c)).prototype,"gameUI",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=G))||w));s._RF.pop()}}}));

System.register("chunks:///_virtual/WordPuzzleGameUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./GameEvents.ts","./HandCards.ts","./FillBlanks.ts","./TipText.ts","./ExplorationCard.ts"],(function(t){var e,n,i,s,r,a,o,u,c,l,d,h,m,f,p,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,o=t.RichText,u=t.Node,c=t.Component},function(t){l=t.EventManager},function(t){d=t.WordPuzzleGameLogicEvent,h=t.GameLogicEvent},function(t){m=t.HandCards},function(t){f=t.FillBlanks},function(t){p=t.TipType},function(t){v=t.ExplorationCard}],execute:function(){var w,b,g,B,C,z,y,H,R,x,G,T,k;r._RF.push({},"1ed87ddISpPK7ueRW4/h8TV","WordPuzzleGameUI",void 0);var F=a.ccclass,L=a.property;t("default",(w=F("WordPuzzleGameUI"),b=L(o),g=L(m),B=L(u),C=L(u),z=L(u),w((R=e((H=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"questionLabel",R,s(e)),i(e,"answerHandCards",x,s(e)),i(e,"restartBtn",G,s(e)),i(e,"startBtn",T,s(e)),i(e,"resumeBtn",k,s(e)),e.question="",e.solutions=[],e.isFirstRound=!0,e.index=-1,e}n(e,t);var r=e.prototype;return r.showQuestion=function(t,e){this.questionLabel.string=this.question=t,this.solutions=e,this.answerHandCards.show(!1),this.answerHandCards.lock(!0),this.answerHandCards.selectMax=e.length,this.answerHandCards.eventSendCallback=this.sendAnswer.bind(this),this.restartBtn.active=!1,this.startBtn.active=this.isFirstRound,this.resumeBtn.active=!this.isFirstRound,this.isFirstRound=!1},r.showAnswer=function(t){var e=this;this.answerHandCards.show(!0),this.answerHandCards.list(t,(function(t,n){e.questionLabel.string=f.answerQuestion(e.question,n)})),this.answerHandCards.lock(!1)},r.sendAnswer=function(t){this.checkQuestionAnswer(t)?(l.instance.emit(p.Normal,"回答正確！"),this.questionLabel.string="",this.answerHandCards.show(!1),this.answerHandCards.clear(),this.restartBtn.active=!0,this.startBtn.active=!1,this.resumeBtn.active=!1):l.instance.emit(p.Error,"回答錯誤！")},r.checkQuestionAnswer=function(t){return this.solutions.every((function(e,n){return e===t[n]}))},r.onTexasGameStartClicked=function(){this.restartBtn.active=!1,this.startBtn.active=!1,this.resumeBtn.active=!0,this.isFirstRound=!1,l.instance.emit(d.TexasGameStart)},r.onTexasGameResumeClicked=function(){l.instance.emit(d.TexasGameResume)},r.onTexasGameRestartClicked=function(){this.questionLabel.string="",this.restartBtn.active=!1,this.startBtn.active=!1,this.resumeBtn.active=!1,this.isFirstRound=!0,this.node.parent.active=!0,l.instance.emit(p.Hide),l.instance.emit(h.GameEnd)},r.onrReasoningTest=function(){var t=(new v).getReasoning(++this.index);l.instance.emit(d.WordPuzzleGameStart,t)},e}(c)).prototype,"questionLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(H.prototype,"answerHandCards",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(H.prototype,"restartBtn",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(H.prototype,"startBtn",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(H.prototype,"resumeBtn",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=H))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/YellowCardHandler.ts",["cc","./SocketBridge.ts","./YellowCardRecord.ts"],(function(t){var e,s,n,o,a;return{setters:[function(t){e=t.cclegacy},function(t){s=t.SocketBridge},function(t){n=t.YellowCardRecord,o=t.GameStatus,a=t.Role}],execute:function(){e._RF.push({},"de129SoJGFNgrAtVVueT/S0","YellowCardHandler",void 0);t("YellowCardHandler",function(){function t(t,e){this._isHonster=!1,this._roomID="",this._honstCardMax={q:2,a:13},this._honstRoundPlayers=[],this._honstRoundIndex=0,this._honstQuestionAnswers={},this._honstWorstList=[],this._masterID="",this._playerID="",this._myNickname="",this._loseNum=5,this._honstGameRecord=null,this.eventUpdateQuestionCards=null,this.eventUpdateAnswerCards=null,this.eventShowQuestion=null,this.eventLockQuestionSelection=null,this.eventLockAnswerSelection=null,this.eventShowQuestionAnswer=null,this.eventShowAllQuestionAnswer=null,this.eventChooseQuestionAnswer=null,this.eventVoted=null,this.eventAnswerCardFold=null,this.eventShowBestAnswer=null,this.eventShowTip=null,this.eventClearPrevRound=null,this.eventRecordLose=null,this.eventGameEnd=null,this._playerID=t,this._myNickname=e}var e=t.prototype;return e.applicate=function(t,e){void 0===e&&(e=""),console.log("===== applicate:",t,e),this._isHonster?(console.log(t,"Applicate 事件不透過連線發給自己:",e),this["notify_"+t](this._roomID,t,e)):s.Instance.applicate(t,e)},e._broadcast=function(t,e,n){if(void 0===e&&(e=""),console.log("===== broadcast:",t,e),this._isHonster){if(n===this._playerID)return console.log(t,"Broadcast 事件不透過連線發給自己:",e);s.Instance.broadcast(t,e,n)}},e.startGame=function(t,e,a){var i=this;if(this._roomID=t,a){this._isHonster=!0,this._honstGameRecord=new n,this._honstRoundPlayers=Object.keys(a);var r=this._honstRoundPlayers.length;this._loseNum=r<6?6:r<8?5:4,e?this._honstGameRecord.readData():this._honstRoundPlayers.forEach((function(t){i._honstGameRecord.add(t,a[t],o.GAMING)}))}s.Instance.addDispatcher(t,this,{update_game_step:this.notify_update_game_step,game_round:this.notify_game_round,draw_question_cards:this.notify_draw_question_cards,draw_answer_cards:this.notify_draw_answer_cards,licensing:this.notify_licensing,fold_answer_card:this.notify_fold_answer_card,question:this.notify_question,answer:this.notify_answer,question_answers_result:this.notify_question_answers_result,choose_best_answer:this.notify_choose_best_answer,vote:this.notify_vote,vote_result:this.notify_vote_result,alert:this.notify_alert,next_round:this.notify_next_round,game_over:this.notify_game_over,reconnect:this.notify_reconnect}),this._isHonster?(console.log("HONSTER 連線!!"),e?this.applicate("reconnect",this._playerID):this.updateQuestionAsync().then((function(){return console.log("已下載問題卡牌庫")})).then((function(){return i.updateAnswerAsync()})).then((function(){return console.log("已下載答案卡牌庫")})).then((function(){return i.applicate("game_round")}))):(console.log("CLIENT 連線!!"),e&&this.applicate("reconnect",this._playerID))},e.endGame=function(t){s.Instance.removeDispatcher(t,this),this._isHonster&&(this._honstGameRecord.clear(),this._honstGameRecord=null,this._honstRoundPlayers.length=0,this._honstRoundIndex=0),this._masterID="",this._playerID="",this._myNickname=""},e.updateQuestionAsync=function(){var t=this,e=Math.round(3*Math.random());return s.Instance.loadAsync("Question",e.toString()).then((function(e){return t._honstGameRecord.questions=e.sort((function(){return Math.random()-.5}))}))},e.updateAnswerAsync=function(){var t=this,e=Math.round(1e3*Math.random()%2);return s.Instance.loadAsync("Answer",e.toString()).then((function(e){return t._honstGameRecord.answers=e.sort((function(){return Math.random()-.5}))}))},e.tryAllAnswered=function(){var t=this,e=this._honstRoundPlayers.every((function(e){return t._masterID===e||t._honstGameRecord.get(e).gameStatus===o.ANSWERED}));return e&&(console.log("全部都答題了，開始投票"),this._honstRoundPlayers.forEach((function(e){t._masterID!==e&&(t._honstGameRecord.get(e).gameStatus=o.VOTING)}))),this._honstGameRecord.writeData(),e},e.notify_update_game_step=function(t,e,s){var n,a;if(this._isHonster){switch(n=s.split(" ")[0],a=this._honstGameRecord.get(n),this._masterID=this._honstGameRecord.masterID,this._honstGameRecord.get(this._masterID).gameStatus){case o.REVIEW:if(this.tryAllAnswered())return void this.applicate("question_answers_result")}if(s=this._masterID+" "+n+" "+JSON.stringify(a),this._broadcast(e,s,n),this._playerID!=n)return}var i=s.split(" ");this._masterID=i[0],n=i[1],a=JSON.parse(i[2]),console.log(e,"GAME STATUS:",a.gameStatus);var r=a,h=r.gameStatus,c=r.nickname;switch(h){case o.ASKING:console.log("我是"+c+", 正在擔任裁判並發問",a),this.eventUpdateQuestionCards(a.questionHandCards),this.eventLockQuestionSelection(!1),this.eventShowTip("選擇題目並送出");break;case o.ASKED:console.log("UI 禁止選擇問題卡"),this.eventLockQuestionSelection(!0),this.eventShowTip("等待答案中...");break;case o.ANSWER:console.log("我是"+c+", 是一般玩家",a),this.eventUpdateAnswerCards(a.answerHandCards),this.eventShowTip("等待裁判出題");break;case o.ANSWERING:console.log("UI 進行選擇答案卡"),this.eventLockAnswerSelection(!1),this.eventShowTip("填空並送出");break;case o.FOLD:var l=a.answerCards.length-1,_=a.answerHandCards;this.eventAnswerCardFold(_,l),this.eventShowTip("請棄掉牌"+l+"張牌");break;case o.ANSWERED:this.eventShowTip("等待其他人…")}},e.notify_game_round=function(t,e,s){var n=this;if(this._isHonster){var i=this._honstRoundPlayers[this._honstRoundIndex];this._honstGameRecord.masterID=i;var r=this._honstGameRecord.get(i);r.role=a.MASTER,r.gameStatus=o.ASKING,console.log("裁判人選:",i,"master:",r),this.applicate("draw_question_cards",i),this._honstRoundPlayers.forEach((function(t){if(i!==t){var e=n._honstGameRecord.get(t);e.role=a.PLAYER,e.gameStatus=o.ANSWER,n.applicate("draw_answer_cards",t)}})),this._honstGameRecord.writeData(),s=""+i,this._broadcast(e,s)}var h=s.split(" ");this._masterID=h[0]},e.notify_draw_question_cards=function(t,e,s){var n=this;if(this._isHonster){var o=s.split(" ")[0],a=this._honstGameRecord.questions,i=this._honstGameRecord.get(o).questionHandCards,r=this._honstCardMax.q-i.length;console.log("抽",r,"張"),console.log("問題卡牌庫張數(應有"+this._honstCardMax.q+"), Honster 目前張數::",a.length);var h=function(){n._honstGameRecord.questions.splice(0,r).forEach((function(t){return i.push(t)})),console.log("獲得手牌:",i),n._honstGameRecord.writeData(),n.applicate("licensing",o)};r>a.length?this.updateQuestionAsync().then((function(){return h()})):h()}},e.notify_draw_answer_cards=function(t,e,s){var n=this;if(this._isHonster){var o=s.split(" ")[0],a=this._honstGameRecord.answers,i=this._honstGameRecord.get(o).answerHandCards,r=this._honstCardMax.a-i.length;console.log("抽",r,"張"),console.log("答案卡牌庫張數(應有"+this._honstCardMax.a+"), Honster 目前張數:",a.length);var h=function(){n._honstGameRecord.answers.splice(0,r).forEach((function(t){return i.push(t)})),console.log("獲得手牌:",i),n._honstGameRecord.writeData(),n.applicate("licensing",o)};r>a.length?this.updateAnswerAsync().then((function(){return h()})):h()}},e.notify_licensing=function(t,e,s){var n,o;if(this._isHonster&&(n=s.split(" ")[0],o=this._honstGameRecord.get(n),s=n+" "+JSON.stringify(o),this._broadcast(e,s,n),this._playerID!=n))return;var a=s.split(" ");if(n=a[0],this._playerID!=n)return console.error("playerID 不符合",n,"應該在honster 階段return");console.log("clientData[1]::::::",a[1]),o=JSON.parse(a[1]),this.applicate("update_game_step",n+" "+Math.random())},e.notify_question=function(t,e,s){var n,i=this;if(this._isHonster){n=s,this._honstGameRecord.askingQuestion=s,console.log("裁判送出的問題卡:",n);var r=this._honstGameRecord.get(this._masterID);if(r.role!==a.MASTER)return this._broadcast("alert","自己不是裁判，不應該問問題",this._masterID),console.log(this._masterID,"不是裁判，不應該問問題");if(r.gameStatus!==o.ASKING)return this._broadcast("alert","自己還不是問問題的狀態",this._masterID),console.log(this._masterID,"還不是問問題的狀態:",r.gameStatus);r.gameStatus=o.ASKED,this._honstGameRecord.get(this._masterID).questionHandCards.length=0,this._honstRoundPlayers.forEach((function(t){if(t!==i._masterID){var e=i._honstGameRecord.get(t);e.gameStatus===o.ANSWER?(e.gameStatus=o.ANSWERING,console.log("玩家"+t+"改為"+o.ANSWERING+"狀態")):console.error("玩家應該是"+o.ANSWER+"狀態，但現在卻是"+e.gameStatus)}})),this._honstGameRecord.writeData(),s=""+n,this._broadcast(e,s)}n=s.split(" ")[0],this.eventShowQuestion(n),console.log("題目顯示後，請 Honster 指引下一步該做的事",this._playerID),this.applicate("update_game_step",this._playerID+" "+Math.random())},e.notify_answer=function(t,e,s){var n,i;if(this._isHonster){var r=s.split(" ");n=r[0],i=JSON.parse(r[1]),console.log("玩家送出的答案卡:",i);var h=this._honstGameRecord.get(n);if(h.role!==a.PLAYER)return this._broadcast("alert","自己不是玩家，不應該回答問題",n),console.log(n,"不是玩家，不應該回答問題");if(h.gameStatus!==o.ANSWERING)return this._broadcast("alert","自己還不是回答問題的狀態",n),console.log(n,"還不是回答問題的狀態:",h.gameStatus);h.gameStatus=i.length>1?o.FOLD:o.ANSWERED,this._honstQuestionAnswers[n]=i,h.answerCards=i,console.log("this._honstQuestionAnswers:",this._honstQuestionAnswers);var c=h.answerHandCards;console.log("手牌整理前:",c),i.forEach((function(t){var e=c.findIndex((function(e){return e===t}));e>-1?c.splice(e,1):console.log("玩家手牌無此張卡片:",t)})),console.log("手牌整理後:",c);var l=this._honstGameRecord.get(this._masterID);if(l.gameStatus===o.ASKED&&(l.gameStatus=o.REVIEW),this._honstGameRecord.writeData(),s=n+" "+JSON.stringify(i),this._broadcast(e,s,n),this._broadcast(e,s,this._masterID),console.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! this._playerID != answerPlayerID",this._playerID!=n,"&& this._masterID != this._playerID",this._masterID!=this._playerID),this._playerID!=n&&this._masterID!=this._playerID)return}var _=s.split(" ");n=_[0],i=JSON.parse(_[1]),this._playerID===this._masterID?(this.eventShowQuestionAnswer(n,i),this.eventShowTip("收到玩家的答案")):this.eventShowTip("已送出你的答案"),this.applicate("update_game_step",this._playerID)},e.notify_fold_answer_card=function(t,e,s){var n,a;if(this._isHonster){var i=s.split(" ");n=i[0],a=JSON.parse(i[1]),console.log("玩家",n,"進行棄牌:",a);var r=this._honstGameRecord.get(n),h=r.answerHandCards;a.forEach((function(t){h.splice(h.findIndex((function(e){return e===t})),1)})),console.log("棄完牌後:",h),r.gameStatus===o.FOLD?r.gameStatus=o.ANSWERED:console.error(r.gameStatus,"狀態不是",o.FOLD,"，但正在進行棄牌"),this._honstGameRecord.writeData(),this.applicate("update_game_step",n),this.applicate("update_game_step",this._masterID)}},e.notify_question_answers_result=function(t,e,s){this._isHonster&&(s=""+JSON.stringify(this._honstQuestionAnswers),this._broadcast(e,s));var n=s.split(" "),o=JSON.parse(n[0]),a=this._playerID===this._masterID;a||(console.log("全員的答題清單:",o),this.eventShowAllQuestionAnswer(o)),this.eventChooseQuestionAnswer(a)},e.notify_vote=function(t,e,s){var n;if(this._isHonster){var a=s.split(" ");n=a[0];var i=a[1];this._honstWorstList.push(i),this._honstGameRecord.get(i).voted++;var r=this._honstGameRecord.get(n);r.gameStatus===o.VOTING?(console.log("玩家"+r.nickname+"已完成投票，並修改標記"),r.gameStatus=o.VOTED):console.error("玩家"+r.nickname+"再次完成投票，標記為"+o.VOTED.toString()),console.log("糟糕清單:",this._honstWorstList);var h=1;if(this._honstWorstList.length===this._honstRoundPlayers.length-1&&(h=0,this.applicate("vote_result")),this._honstGameRecord.writeData(),s=n+" "+h,this._broadcast(e,s,n),this._playerID!=n)return}var c="1"===s.split(" ")[1];this.eventVoted(!c),c&&this.eventShowTip("完成投票，請等候其他人投完票")},e.notify_vote_result=function(t,e,s){var n=this,o=[],a={};if(this._isHonster){var i={};this._honstWorstList.forEach((function(t){i[t]=i[t]||0,console.log(t,":",i[t]),i[t]++}));var r=Math.max.apply(Math,Object.keys(i).map((function(t){return i[t]})));console.log("voteResult:",i,r),Object.keys(i).forEach((function(t){i[t]===r&&(o.push(t),n._honstGameRecord.get(t).lose++)})),console.log("最糟的幾個人:",o),this._honstWorstList.length=0,this._honstRoundPlayers.forEach((function(t){var e=n._honstGameRecord.get(t);a[t]=e.lose})),this._honstGameRecord.writeData(),s=JSON.stringify(o)+" "+JSON.stringify(a),this._broadcast(e,s)}var h=s.split(" ");o=JSON.parse(h[0]),a=JSON.parse(h[1]),o.some((function(t){return n._playerID===t}))?(this.eventShowTip("恭喜，大家覺得你的問答組合是最爛的！"),this.eventRecordLose(a[this._playerID])):this._playerID!=this._masterID&&this.eventShowTip("很遺憾你的答案未獲選為最爛的問答組合…")},e.notify_choose_best_answer=function(t,e,s){var n,a,i=this,r=!0;if(this._isHonster){n=s.split(" ")[0],console.log("bestPlayerID:",n);var h=[];this._honstRoundPlayers.forEach((function(t){if(i._masterID!==t){var e=i._honstGameRecord.get(t);e.gameStatus===o.VOTING&&(h.push(t),r=!1),e.gameStatus===o.VOTED&&(e.gameStatus=o.GAMING)}})),r?(console.log("全員完成投票"),this._honstGameRecord.get(n).win++,a=this._honstQuestionAnswers[n],s="1 "+JSON.stringify(a)):(console.log("提醒未投票玩家進行投票"),s="0 "+JSON.stringify(h)),this._honstGameRecord.writeData(),this._broadcast(e,s)}var c=s.split(" ");(r="1"===c[0])?(a=JSON.parse(c[1]),this.eventShowBestAnswer(a,this._playerID===this._masterID),this.eventShowTip("裁判選出的最佳組合：")):JSON.parse(c[1]).some((function(t){return i._playerID===t}))?this.eventShowTip("快投票哦!!!大家都在等你!!!"):this._masterID===this._playerID&&this.eventShowTip("等待玩家完成最差組合投票")},e.notify_next_round=function(t,e,s){var n=this,o=!1;if(this._isHonster){if(this._honstRoundIndex=(this._honstRoundIndex+1)%this._honstRoundPlayers.length,this._honstQuestionAnswers={},this._honstGameRecord.clearAnswerCards(),this._honstGameRecord.clearWorstVote(),this._honstRoundPlayers.forEach((function(t){var e=n._honstGameRecord.get(t),s=-e.lose;s<=-n._loseNum&&(o=!0),console.log(e.nickname,"score:",s)})),console.log("檢查，還沒結束就下一輪"),o)return void this.applicate("game_over");this._broadcast(e,s)}var a=this._playerID===this._masterID;this.eventClearPrevRound(),a&&this.applicate("game_round")},e.notify_game_over=function(t,e,s){var n=this,o=[];if(this._isHonster){var a=Math.max.apply(Math,this._honstRoundPlayers.map((function(t){return n._honstGameRecord.get(t).win})));this._honstRoundPlayers.forEach((function(t){a===n._honstGameRecord.get(t).win&&o.push(n._honstGameRecord.get(t).nickname)})),s=""+JSON.stringify(o),this._broadcast(e,s)}var i=s.split(" ");o=JSON.parse(i[0]),this.eventShowTip("遊戲結束，最終大贏家是"+o.join("、")),this.eventGameEnd(),this.eventRecordLose(0)},e.notify_alert=function(t,e,s){this.eventShowTip(s)},e.notify_reconnect=function(t,e,s){var n,a,i,r,h,c=this;if(this._isHonster){n=s.split(" ")[0],this._masterID=this._honstGameRecord.masterID,this._honstRoundPlayers.forEach((function(t){var e=c._honstGameRecord.get(t).answerCards;e.length&&(c._honstQuestionAnswers[t]=e);for(var s=0;s<c._honstGameRecord.get(t).voted;s++)c._honstWorstList.push(t)})),console.log("notify_reconnect 答題:",this._honstQuestionAnswers),console.log("notify_reconnect 最糟投票:",this._honstWorstList),i=this._honstQuestionAnswers;var l=this._honstGameRecord.get(n),_=l.gameStatus;switch(_){case o.GAMING:return void this.applicate("licensing",n);case o.ASKING:return void this.applicate("update_game_step",n);case o.ASKED:a=this._honstGameRecord.askingQuestion,s=_+" "+this._masterID+" "+a,this._broadcast(e,s,n);break;case o.REVIEW:this._masterID===n&&(a=this._honstGameRecord.askingQuestion,s=_+" "+this._masterID+" "+a+" "+JSON.stringify(i),this._broadcast(e,s,n));break;case o.ANSWER:return void this.applicate("update_game_step",n);case o.ANSWERING:r=l.answerHandCards,a=this._honstGameRecord.askingQuestion,s=_+" "+this._masterID+" "+JSON.stringify(r)+" "+a,this._broadcast(e,s,n);break;case o.FOLD:r=l.answerHandCards,h=l.answerCards,a=this._honstGameRecord.askingQuestion,s=_+" "+this._masterID+" "+JSON.stringify(r)+" "+JSON.stringify(h)+" "+a,this._broadcast(e,s,n);break;case o.ANSWERED:return void this.applicate("update_game_step",n);case o.VOTING:a=this._honstGameRecord.askingQuestion,s=_+" "+this._masterID+" "+a+" "+JSON.stringify(i),this._broadcast(e,s,n);break;case o.VOTED:s=_+" "+this._masterID+" "+JSON.stringify(i),this._broadcast(e,s,n)}if(console.log("gameStatusgameStatusgameStatusgameStatus:",_),this._playerID!=n)return}var u=s.split(" "),d=parseInt(u[0]);switch(this._masterID=u[1],d){case o.ASKED:console.log("GameStatus.ASKED"),a=u[2],console.log("UI 禁止選擇問題卡"),this.eventLockQuestionSelection(!0),this.eventShowQuestion(a),this.eventShowTip("等待答案中...");break;case o.ANSWERING:console.log("GameStatus.ANSWERING"),r=JSON.parse(u[2]),a=u[3],this.eventUpdateAnswerCards(r),this.eventShowQuestion(a),console.log("UI 進行選擇答案卡"),this.eventLockAnswerSelection(!1),this.eventShowTip("填空並送出");break;case o.FOLD:r=JSON.parse(u[2]),h=JSON.parse(u[3]),a=u[4],this.eventShowQuestion(a);var m=h.length-1;this.eventAnswerCardFold(r,m),this.eventShowTip("請棄掉牌"+m+"張牌");break;case o.ANSWERED:this.eventShowTip("等待其他人…");break;case o.REVIEW:console.log("GameStatus.REVIEW"),a=u[2],this.eventShowQuestion(a),i=JSON.parse(u[3]),this.eventShowAllQuestionAnswer(i);break;case o.VOTING:console.log("GameStatus.VOTING"),a=u[2],this.eventShowQuestion(a),i=JSON.parse(u[3]),this.eventShowAllQuestionAnswer(i);var p=this._playerID===this._masterID;this.eventChooseQuestionAnswer(p);break;case o.VOTED:console.log("GameStatus.VOTED"),i=JSON.parse(u[2]),this.eventShowAllQuestionAnswer(i);var g=this._playerID===this._masterID;this.eventChooseQuestionAnswer(g);break;default:console.log("未設定 reconnet 該做的事")}},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/YellowCardPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./YellowCardHandler.ts","./HandCards.ts","./FoldCards.ts"],(function(e){var n,t,i,s,o,a,r,l,d,h,u,c,w,C,f,_;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,s=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,r=e.Node,l=e.Button,d=e.Label,h=e.Vec3,u=e.RichText,c=e.instantiate,w=e.Component},function(e){C=e.YellowCardHandler},function(e){f=e.HandCards},function(e){_=e.FoldCards}],execute:function(){var g,p,v,b,m,H,Q,A,S,y,q,L,B,k,F,x,V,R,I,M,D,z,E;o._RF.push({},"7a536XvrlROxY0P5Wdjctoi","YellowCardPanel",void 0);var P=a.ccclass,T=a.property;e("YellowCardPanel",(g=P("YellowCardPanel"),p=T(f),v=T(f),b=T(r),m=T(_),H=T(r),Q=T(r),A=T(l),S=T(d),y=T(d),q=T(r),g((k=n((B=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,i(n,"questionHandCards",k,s(n)),i(n,"answerHandCards",F,s(n)),i(n,"questionBoard",x,s(n)),i(n,"foldCards",V,s(n)),i(n,"answerQuestionListView",R,s(n)),i(n,"answerQuestionViewContent",I,s(n)),i(n,"nextRoundButton",M,s(n)),i(n,"infoLabel",D,s(n)),i(n,"tipLabel",z,s(n)),i(n,"yellowCardLayout",E,s(n)),n.eventMainSceneGameEnd=null,n._playerID="",n._roomID="",n._gameHandler=null,n._questionCardButtons=[],n._answerCardButtons=[],n._answerMax=0,n._selectedQuestion="",n._selectedAnswers=[],n._questionAnswers={},n._isFolding=!1,n._selectFoldMax=0,n._selectFoldNum=0,n._selectedFloadCards=[],n}t(n,e);var o=n.prototype;return o.start=function(){this.node.setPosition(h.ZERO),this.foldCards.node.setPosition(h.ZERO),this.close()},o.close=function(){this.node.active=!1,this.questionHandCards.show(!1),this.answerHandCards.show(!1),this.questionBoard.active=!1,this.answerQuestionListView.active=!1,this.nextRoundButton.node.active=!1,this._roomID&&(this._gameHandler.endGame(this._roomID),this._gameHandler=null),this.tipLabel.string="",this._roomID="",this._playerID="",this._questionAnswers={},this._questionCardButtons.length=0,this._answerCardButtons.length=0,this._selectedAnswers.length=0,this._selectedQuestion="",this._answerMax=0,this._isFolding=!1,this._selectFoldMax=0,this._selectFoldNum=0,this._selectedFloadCards.length=0},o.init=function(e,n,t,i,s){this.node.active=!0,this._gameHandler=new C(n,t),this._gameHandler.eventUpdateQuestionCards=this.onUpdateQuestionCards.bind(this),this._gameHandler.eventLockQuestionSelection=this.onLockQuestionSelection.bind(this),this._gameHandler.eventUpdateAnswerCards=this.onUpdateAnswerCards.bind(this),this._gameHandler.eventLockAnswerSelection=this.onLockAnswerSelection.bind(this),this._gameHandler.eventShowQuestion=this.onShowQuestion.bind(this),this._gameHandler.eventShowAllQuestionAnswer=this.onShowAllQuestionAnswer.bind(this),this._gameHandler.eventShowQuestionAnswer=this.onShowQuestionAnswer.bind(this),this._gameHandler.eventChooseQuestionAnswer=this.onChooseQuestionAnswer.bind(this),this._gameHandler.eventAnswerCardFold=this.onAnswerCardFold.bind(this),this._gameHandler.eventShowBestAnswer=this.onShowBestAnswer.bind(this),this._gameHandler.eventVoted=this.onVoted.bind(this),this._gameHandler.eventShowTip=this.onShowTip.bind(this),this._gameHandler.eventClearPrevRound=this.onClearPrevRound.bind(this),this._gameHandler.eventRecordLose=this.onRecordLose.bind(this),this._gameHandler.eventGameEnd=this.onGameEnd.bind(this),this._gameHandler.startGame(e,i,s),this._roomID=e,this.infoLabel.string=e+"\n"+t+"\n("+n+")",this._playerID=n,this.questionHandCards.eventSendCallback=this.onSendQuestionClicked.bind(this),this.answerHandCards.eventSendCallback=this.onSendAnswerClicked.bind(this)},o.fillBlanks=function(e,n){var t=n.slice();return console.log("fill question:",e,n),e.replace(/_/g,(function(e){return"<color=#FFFF00><u>"+(t.shift()||"_")+"</u></c>"}))},o.onUpdateQuestionCards=function(e){var n=this;this.questionHandCards.show(!0),this.questionHandCards.selectMax=1,this.questionHandCards.list(e,(function(e,t){n._selectedQuestion=e}))},o.onLockQuestionSelection=function(e){this.questionHandCards.lock(e),this.answerHandCards.show(!1)},o.onSendQuestionClicked=function(e){this.questionHandCards.show(!1),this.questionHandCards.lock(!0),this._gameHandler.applicate("question",e[0])},o.onUpdateAnswerCards=function(e){var n=this;this.answerHandCards.show(!0),this.answerHandCards.list(e,(function(e,t){n.questionBoard.active=!0;var i=n.fillBlanks(n._selectedQuestion,t);n.questionBoard.getComponentInChildren(u).string=i}))},o.onLockAnswerSelection=function(e){this.answerHandCards.lock(e),this.questionHandCards.show(!1)},o.onSendAnswerClicked=function(e){this.answerHandCards.show(!1),this._gameHandler.applicate("answer",this._playerID+" "+JSON.stringify(e))},o.onShowQuestion=function(e){console.log("UI 顯示問題:",e);var n=e.split("_");this._answerMax=Math.max(1,n.length-1),this.answerHandCards.selectMax=this._answerMax,this._selectedQuestion=e,this.questionBoard.active=!0,this.questionBoard.getComponentInChildren(u).string=e},o.onShowQuestionAnswer=function(e,n){console.log("玩家"+e+"送入答案:",n,typeof n),this._questionAnswers[e]=n,this.onShowAllQuestionAnswer(this._questionAnswers)},o.onShowAllQuestionAnswer=function(e){var n=this;this._questionAnswers=e,console.log("顯示所有的答案卡片:",this._questionAnswers),this.answerQuestionListView.active=!0;var t=this.answerQuestionViewContent.children;t.forEach((function(e){return e.active=!1})),Object.keys(e).forEach((function(i,s){var o=t[s];o||((o=c(t[0])).parent=n.answerQuestionViewContent),o.active=!0;var a=n.fillBlanks(n._selectedQuestion,e[i]);console.log("content:",a),o.getComponentInChildren(u).string=a,console.log("\t",o.getComponentInChildren(u).string),o.getComponent(l).node.off("click")})),console.log("顯示答案送出內容，移除 answerQuestionViewContent 的按鈕事件")},o.onChooseQuestionAnswer=function(e){var n=this,t=this.answerQuestionViewContent.children,i=e?this.sendBestQuestionAnswer.bind(this):this.sendWorstQuestionAnswer.bind(this);Object.keys(this._questionAnswers).forEach((function(e,s){t[s].getComponent(l).node.on("click",(function(){return i(e)}),n)})),console.log("設定選擇問答組合，設定觸發 answerQuestionViewContent 的按鈕事件"),this.answerQuestionListView.active=!this._isFolding,this._isFolding?e?this.onShowTip("選擇最符合你提出條件的組合"):(this.onShowTip("選擇不符裁判要求的組合(請先棄完牌)"),this.foldCards.show(!0)):this.onShowTip(e?"選擇最符合你提出條件的組合":"選擇不符裁判要求的組合")},o.onVoted=function(e){this.answerQuestionViewContent.children.forEach((function(e){return e.off("click")})),console.log("已投票，移除 answerQuestionViewContent 的按鈕事件"),this.answerQuestionListView.active=!1},o.onShowBestAnswer=function(e,n){this.questionBoard.active=!0;var t=this.fillBlanks(this._selectedQuestion,e);this.questionBoard.getComponentInChildren(u).string=t,this.answerQuestionListView.active=!1,this._questionAnswers={},this._answerMax=0,this._selectedQuestion="",this.nextRoundButton.node.active=n},o.sendBestQuestionAnswer=function(e){console.log("最佳組合的玩家:",e),this._gameHandler.applicate("choose_best_answer",e+" "+Math.round(1e6*Math.random()))},o.sendWorstQuestionAnswer=function(e){console.log("最差組合的玩家:",e),this._gameHandler.applicate("vote",this._playerID+" "+e)},o.onAnswerCardFold=function(e,n){this._isFolding=!0,console.log("進入棄牌流程"),this.foldCards.show(!0),this.foldCards.selectMax=n,this.foldCards.list(e),this.foldCards.eventSendCallback=this.onSendFoldAnswerClicked.bind(this)},o.onSendFoldAnswerClicked=function(e){this.answerHandCards.show(!1),this.foldCards.show(!1),this._isFolding=!1,this._gameHandler.applicate("fold_answer_card",this._playerID+" "+JSON.stringify(e))},o.onShowTip=function(e){this.tipLabel.string=e},o.onRecordLose=function(e){var n=this.yellowCardLayout.children;n.forEach((function(e){return e.active=!1}));for(var t=0;t<e;t++){var i=n[t];i||((i=c(n[0])).parent=this.yellowCardLayout),i.active=!0}},o.onClearPrevRound=function(){this.questionHandCards.show(!1),this.answerHandCards.show(!1),this.questionBoard.active=!1,this.answerQuestionListView.active=!1,this.nextRoundButton.node.active=!1,this._questionAnswers={},this._answerMax=0,this._selectedQuestion=""},o.onGameEnd=function(){var e;null==(e=this.eventMainSceneGameEnd)||e.call(this),this.nextRoundButton.node.active=!1,this.infoLabel.string=""},o.onNextRoundClicked=function(){this._gameHandler.applicate("next_round")},n}(w)).prototype,"questionHandCards",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=n(B.prototype,"answerHandCards",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=n(B.prototype,"questionBoard",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=n(B.prototype,"foldCards",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=n(B.prototype,"answerQuestionListView",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(B.prototype,"answerQuestionViewContent",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=n(B.prototype,"nextRoundButton",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(B.prototype,"infoLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(B.prototype,"tipLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(B.prototype,"yellowCardLayout",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=B))||L));o._RF.pop()}}}));

System.register("chunks:///_virtual/YellowCardRecord.ts",["cc"],(function(s){var e;return{setters:[function(s){e=s.cclegacy}],execute:function(){e._RF.push({},"962bfAm9SxBtKUI3CbrHESq","YellowCardRecord",void 0);var r=s("Role",function(s){return s[s.PLAYER=0]="PLAYER",s[s.MASTER=1]="MASTER",s}({})),t="YC_GAME_RECORD_INFO";s("GameStatus",function(s){return s[s.GAMING=0]="GAMING",s[s.ASKING=1]="ASKING",s[s.ASKED=2]="ASKED",s[s.REVIEW=3]="REVIEW",s[s.ANSWER=4]="ANSWER",s[s.ANSWERING=5]="ANSWERING",s[s.FOLD=6]="FOLD",s[s.ANSWERED=7]="ANSWERED",s[s.VOTING=8]="VOTING",s[s.VOTED=9]="VOTED",s[s.PICK=10]="PICK",s}({})),s("YellowCardRecord",function(){function s(){this.masterID="",this._players={},this._roundPlayers=[],this.questions=[],this.answers=[],this.askingQuestion=""}var e=s.prototype;return e.add=function(s,e,t){this._players[s]={nickname:e,gameStatus:t,win:0,lose:0,answerCards:[],answerHandCards:[],questionHandCards:[],voted:0,role:r.PLAYER},this._roundPlayers=Object.keys(this._players)},e.del=function(s){delete this._players[s]},e.get=function(s){return this._players[s]},e.clear=function(){this._players={},this._roundPlayers=[],this.questions=[],this.answers=[],this.askingQuestion="",localStorage.removeItem(t)},e.clearAnswerCards=function(){var s=this;this._roundPlayers.forEach((function(e){return s._players[e].answerCards.length=0}))},e.clearWorstVote=function(){var s=this;this._roundPlayers.forEach((function(e){return s._players[e].voted=0}))},e.readData=function(){var s=JSON.parse(localStorage.getItem(t));console.log("YellowCardRecord read localData:",s),this.masterID=s.masterID,this._players=s.players,this._roundPlayers=s.roundPlayers,this.questions=s.questions,this.answers=s.answers,this.askingQuestion=s.askingQuestion},e.writeData=function(){var s={masterID:this.masterID,players:this._players,roundPlayers:this._roundPlayers,questions:this.questions,answers:this.answers,askingQuestion:this.askingQuestion};localStorage.setItem(t,JSON.stringify(s))},e.dropAnswerHandCards=function(s,e){this.dropHandCard(this._players[s].answerHandCards,e)},e.dropHandCard=function(s,e){return e.every((function(e){return s.find((function(s,r,t){if(s===e)return t.splice(r,1),!0}))}))},s}());e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});