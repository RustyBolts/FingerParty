System.register("chunks:///_virtual/Ability.ts",["cc"],(function(i){var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"84f08yPe8ZDgIR8CzYwL3b1","Ability",void 0);i("AbilityName",function(i){return i.Strength="strength",i.Agility="agility",i.Acuity="acuity",i.Wisdom="wisdom",i.Charisma="charisma",i.Resilience="resilience",i}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/AnswerClipsAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CardMover.ts"],(function(e){var n,r,t,i,a,o,s,c,u,l,p,d,f,h,v,C,w,b;return{setters:[function(e){n=e.applyDecoratedDescriptor,r=e.inheritsLoose,t=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e._decorator,u=e.Node,l=e.Prefab,p=e.Component,d=e.tween,f=e.v3,h=e.Vec3,v=e.instantiate,C=e.Label,w=e.randomRange},function(e){b=e.CardMover}],execute:function(){var m,y,g,A,L,N,P;s._RF.push({},"d0876fZtKdLFoba69Le1bNQ","AnswerClipsAnimation",void 0);var x=c.ccclass,R=c.property;e("AnswerClipsAnimation",(m=x("AnswerClipsAnimation"),y=R(u),g=R(l),m((N=n((L=function(e){function n(){for(var n,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,t(n,"destinationNode",N,i(n)),t(n,"answerClipPrefab",P,i(n)),n}r(n,e);var s=n.prototype;return s.onLoad=function(){},s.spreadCards=function(){var e=a(o().mark((function e(n){var r,t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],n.forEach((function(e){var n=v(t.answerClipPrefab);n.getComponentInChildren(C).string=e,t.node.addChild(n),r.push(n)})),e.next=4,b.scatterCards(r,this.node,[60,100],w(.75,1.25));case 4:r.forEach(a(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.moveCard(n,t.destinationNode,h.ZERO,.25,.25);case 2:d(t.destinationNode).to(.1,{scale:f(1.2,1.2,1)}).call((function(){return n.destroy()})).to(.1,{scale:f(1,1,1)}).start();case 3:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),n}(p)).prototype,"destinationNode",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=n(L.prototype,"answerClipPrefab",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=L))||A));s._RF.pop()}}}));

System.register("chunks:///_virtual/ArcherySkill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatSkill.ts"],(function(e){var t,i,n,a;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,n=e.randomRangeInt},function(e){a=e.CombatSkill}],execute:function(){i._RF.push({},"5dd90xf3B1PEpf98SkrtKgN","ArcherySkill",void 0);e("ArcherySkill",function(e){function i(){return e.apply(this,arguments)||this}t(i,e);var a=i.prototype;return a.getAffix=function(){return[{name:"射擊:配合呼吸",description:"「冷靜，配合呼吸再放弓…」",effect:{affix:"inspiration",value:1,duration:2}},{name:"射擊:穩定姿態",description:"「讓手指保持穩定…」",effect:{affix:"inspiration",value:n(2,3),duration:2}},{name:"射擊:瞄定再發",description:"「先瞄準，再發射…」",effect:{affix:"precision",value:1,duration:2}},{name:"射擊:預測準星",description:"「我看見了…能命中！」",effect:{affix:"precision",value:n(2,3),duration:2}}]},a.getSkill=function(){return[{name:"xx1",description:"「射擊技能1」",skillType:"DamageExtra",hits:"",damage:"1d4"},{name:"xx2",description:"「射擊技能2」",skillType:"HitExtra",hits:"1d4",damage:""},{name:"xx3",description:"「射擊技能3」",skillType:"HitBonus",hits:"+1",damage:""},{name:"xx4",description:"「射擊技能4」",skillType:"DamageBonus",hits:"",damage:"+1"}]},a.applySkillEffects=function(e,t,i){var a=this;if(i>this.level)console.log("等級不足");else switch(i){case 1:console.log("弱點射擊");var o={affix:"inspiration",value:n(3,6),duration:2};this.activateSkillEffect(e,o);break;case 2:console.log("精準射擊");o={affix:"precision",value:n(1,6),duration:2};this.activateSkillEffect(e,o);break;case 3:console.log("分裂箭");break;case 4:console.log("突襲射擊");break;case 5:t.forEach((function(e){console.log("光眩射擊"),Math.random()<.25&&(console.log(e.name+" is blid."),a.activateSkillEffect(e,{affix:"eye",value:1,duration:3}))}));break;case 6:console.log("末日之雨"),t.forEach((function(t){e.attack(t)}))}},a.getSkill2=function(){return[{serialId:"skill1",level:1,name:"鬥毆技巧",description:"使用拳擊動作助攻，+1命中。徒手時傷害1d4。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+1",duration:1,conditions:["Melee"]},{attribute:"HitBonus",bonus:"1d4",duration:1,conditions:["Melee","Unarmed"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"敲擊技巧",description:"使用敲擊動作助攻，+1命中。武器有鈍器屬性時+1點傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+1",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+1",duration:1,conditions:["Melee","Bludgeoning"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"揮砍技巧",description:"使用揮砍動作助攻，+1命中。武器有揮砍屬性時+1點傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+1",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+1",duration:1,conditions:["Melee","Slashing"]}],target:"self",range:"Melee",type:"damage",animation:"attack"},{serialId:"skill1",level:1,name:"穿刺技巧",description:"使用穿刺動作助攻，+1命中。若武器有穿刺屬性時+1點傷害。",cost:{type:"Intent",fee:1},modifiers:[{attribute:"HitBonus",bonus:"+1",duration:1,conditions:["Melee"]},{attribute:"DamageBonus",bonus:"+1",duration:1,conditions:["Melee","Piercing"]}],target:"self",range:"Melee",type:"damage",animation:"attack"}]},i}(a));i._RF.pop()}}}));

System.register("chunks:///_virtual/AudioController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var e,t,r,n,i,u,c,a,l;return{setters:[function(o){e=o.applyDecoratedDescriptor,t=o.inheritsLoose,r=o.initializerDefineProperty,n=o.assertThisInitialized},function(o){i=o.cclegacy,u=o._decorator,c=o.AudioSource,a=o.assert,l=o.Component}],execute:function(){var s,p,d,f,y;i._RF.push({},"c714bqcI0FN4Y+9uQVoTRJe","AudioController",void 0);var h=u.ccclass,v=u.property;o("AudioController",(s=h("AudioController"),p=v(c),s((y=e((f=function(o){function e(){for(var e,t=arguments.length,i=new Array(t),u=0;u<t;u++)i[u]=arguments[u];return e=o.call.apply(o,[this].concat(i))||this,r(e,"_audioSource",y,n(e)),e}t(e,o);var i=e.prototype;return i.onLoad=function(){var o=this.node.getComponent(c);a(o),this._audioSource=o},i.start=function(){var o=this,e=document.querySelector("video");if(e){var t=e.play();void 0!==t&&t.then((function(e){o.play()})).catch((function(o){console.log("Autoplay prevented")}))}},i.play=function(){this._audioSource.play()},i.pause=function(){this._audioSource.pause()},e}(l)).prototype,"_audioSource",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));i._RF.pop()}}}));

System.register("chunks:///_virtual/BaseCardDisplay.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CardComponent2.ts"],(function(e){var n,t,i,o,r,a,s,l,c,d,u,h,p,f,C,g,v,m,b;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,s=e.Prefab,l=e.Node,c=e.CCInteger,d=e.Sprite,u=e.Color,h=e.UITransform,p=e.instantiate,f=e.Layout,C=e.Button,g=e.Vec3,v=e.tween,m=e.Component},function(e){b=e.CardComponent}],execute:function(){var y,P,S,N,w,I,x,M,z,D,L;r._RF.push({},"bf0beYLhbxN67m5aSRVMCJL","BaseCardDisplay",void 0);var B=a.ccclass,E=a.property;e("BaseCardDisplay",(y=B("BaseCardDisplay"),P=E(s),S=E(l),N=E(l),w=E(c),y((M=n((x=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=e.call.apply(e,[this].concat(r))||this,i(n,"cardPrefab",M,o(n)),i(n,"positionContainer",z,o(n)),i(n,"cardContainer",D,o(n)),i(n,"selectedPositionY",L,o(n)),n.oriPositionY=0,n.selected=[],n.selectedCardNodes=[],n.originalIndexMap=new Map,n}t(n,e);var r=n.prototype;return r.initPositionNodes=function(e){this.positionContainer.removeAllChildren();for(var n=0;n<e;n++){var t=new l;t.name="Position_"+n,t.parent=this.positionContainer,t.addComponent(d).color=u.RED,t.getComponent(h).setContentSize(100,100)}},r.followPosition=function(){this.node.active=!0,this.updatePositionLayout();var e=this.cardContainer.children;this.positionContainer.children.forEach((function(n,t){e[t].setPosition(n.position)}))},r.showCards=function(e){var n=this;this.positionContainer.children.length===e.length?(this.selectedCardNodes.length>0&&console.error("已經有選取的卡片，請先清除之前的選取"),this.cardContainer.removeAllChildren(),e.forEach((function(e,t){var i=p(n.cardPrefab);i.name="Card_"+t,i.getComponent(b).setup(e),i.parent=n.cardContainer}))):console.error("卡牌數量與定位節點數量不符")},r.setToggleSelection=function(){var e=this;this.cardContainer.children.forEach((function(n){n.on("click",(function(){return e.toggleCardSelection(n)}),e)}))},r.stopToggleSelection=function(){this.cardContainer.children.forEach((function(e){e.off("click")}))},r.toggleCardSelection=function(e,n){var t=this;void 0===n&&(n=null);var i=this.selectedCardNodes.includes(e);if(i){this.selectedCardNodes=this.selectedCardNodes.filter((function(n){return n!==e}));var o=this.originalIndexMap.get(e)||0;e.setSiblingIndex(o)}else this.selectedCardNodes.push(e),this.originalIndexMap.set(e,e.getSiblingIndex()),e.setSiblingIndex(this.cardContainer.children.length-1);var r=i?0:this.selectedPositionY;this.animateSelectCardMovement(e,r).then((function(){null==n||n(i),console.log("toggleCardSelection selectedCardNodes:",t.selectedCardNodes)}))},r.updatePositionLayout=function(){var e=this.positionContainer.getComponent(f);e.enabled=!0,e.updateLayout(),e.enabled=!1},r.unselectAllCards=function(){var e=this;return console.log("取消所有共",this.selected.length,"張卡牌選取"),this.selected.length=0,Promise.all(this.selectedCardNodes.map((function(n){return e.animateSelectCardMovement(n,0).then((function(){e.selectedCardNodes=e.selectedCardNodes.filter((function(e){return e!==n}));var t=e.originalIndexMap.get(n)||0;n.setSiblingIndex(t)}))})))},r.getCardNodes=function(e){var n=[];return this.cardContainer.children.forEach((function(t){var i=t.getComponent(b);e.find((function(e){i&&i.card===e&&n.push(t)}))})),n},r.animateSelectCardMovement=function(e,n){var t=this,i=e.getComponent(C);return i.interactable=!1,new Promise((function(o){var r=t.oriPositionY+n,a=new g(e.position.x,r,e.position.z);v(e).to(.25,{position:a},{easing:"quadInOut"}).call((function(){i.interactable=!0,o()})).start()}))},n}(m)).prototype,"cardPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(x.prototype,"positionContainer",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(x.prototype,"cardContainer",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=n(x.prototype,"selectedPositionY",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),I=x))||I));r._RF.pop()}}}));

System.register("chunks:///_virtual/Card.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var o,t;return{setters:[function(i){o=i.inheritsLoose},function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"b67e4ftXxNI+IGCQiVuo91W","Card",void 0);var n=i("Card",(function(){this.suit=void 0,this.rank=void 0,this.conditions=void 0}));i("CombatCard",function(i){function t(){for(var o,t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return(o=i.call.apply(i,[this].concat(n))||this).serialId=void 0,o.level=void 0,o.name=void 0,o.description=void 0,o.cost=void 0,o.modifiers=void 0,o.target=void 0,o.range=void 0,o.type=void 0,o.animation=void 0,o}return o(t,i),t}(n));t._RF.pop()}}}));

System.register("chunks:///_virtual/CardCombatTest.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TeamMember.ts","./Ability.ts","./Character.ts","./CombatController.ts","./EventManager.ts","./CharacterInfo.ts","./Weapon.ts","./ParticleEffectComponent.ts"],(function(t){var e,r,n,a,i,o,c,l,s,u,f,m,p,h,b,C,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){i=t.cclegacy,o=t._decorator,c=t.Prefab,l=t.instantiate,s=t.Component},function(t){u=t.TeamMember},function(t){f=t.AbilityName},function(t){m=t.Character},function(t){p=t.CombatController},function(t){h=t.EventManager},function(t){b=t.CharacterInfo},function(t){C=t.Weapon},function(t){y=t.ParticleEffectComponent}],execute:function(){var d,g,v,w,E,I,z,M,P,A,T;i._RF.push({},"67cf2gqfz5JJKd+peoFZl++","CardCombatTest",void 0);var S=o.ccclass,_=o.property;t("default",(d=S("CardCombatCheckTest"),g=_(c),v=_(p),w=_(b),E=_(y),d((M=e((z=function(t){function e(){for(var e,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i))||this,n(e,"characterPrefab",M,a(e)),n(e,"combatController",P,a(e)),n(e,"characterInfo",A,a(e)),n(e,"particleEffect",T,a(e)),e.monsterEmeny=null,e}r(e,t);var i=e.prototype;return i.start=function(){var t,e=((t={})[f.Strength]=15,t[f.Agility]=14,t[f.Acuity]=13,t[f.Wisdom]=12,t[f.Charisma]=10,t[f.Resilience]=8,t),r=new m(1,e,[f.Strength,f.Acuity]),n=[new C("Longsword","15 gold",{dice:"1d8",dice2:"1d10",type:"Slashing"},3,["Versatile"],"Melee")];this.characterInfo.setInfo(r,n);var a=l(this.characterInfo.mainCharacter.node);this.monsterEmeny=a.getComponent(u),this.monsterEmeny.initMonster({constitution:35,spirit:20,willpower:15})},i.onBattleStartClicked=function(t){t.target.active=!1;var e=this.characterInfo.mainCharacter;h.instance.emit("Initiative",{mainCharacter:e,team:[[e],[this.monsterEmeny]]})},e}(s)).prototype,"characterPrefab",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(z.prototype,"combatController",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(z.prototype,"characterInfo",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(z.prototype,"particleEffect",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=z))||I));i._RF.pop()}}}));

System.register("chunks:///_virtual/CardComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var t,n,e,i,a,o,c,u;return{setters:[function(r){t=r.applyDecoratedDescriptor,n=r.inheritsLoose,e=r.initializerDefineProperty,i=r.assertThisInitialized},function(r){a=r.cclegacy,o=r._decorator,c=r.Label,u=r.Component}],execute:function(){var l,s,p,d,f,h,y;a._RF.push({},"398eaEOcg5IPKuVXD3G9D9s","CardComponent",void 0);var g=o.ccclass,m=o.property;r("CardComponent",(l=g("CardComponent"),s=m(c),p=m(c),l((h=t((f=function(r){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=r.call.apply(r,[this].concat(a))||this,e(t,"cardSuit",h,i(t)),e(t,"cardRank",y,i(t)),t.card=null,t}return n(t,r),t.prototype.setup=function(r){this.card=r,this.cardSuit.string=r.name,this.cardRank.string=r.description},t}(u)).prototype,"cardSuit",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(f.prototype,"cardRank",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/CardComponent2.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var t,n,e,i,a,o,c,u;return{setters:[function(r){t=r.applyDecoratedDescriptor,n=r.inheritsLoose,e=r.initializerDefineProperty,i=r.assertThisInitialized},function(r){a=r.cclegacy,o=r._decorator,c=r.Label,u=r.Component}],execute:function(){var l,s,p,d,f,h,y;a._RF.push({},"a2c30irv0FH6YP5VA6kIv7h","CardComponent",void 0);var v=o.ccclass,C=o.property;r("CardComponent",(l=v("CardComponent"),s=C(c),p=C(c),l((h=t((f=function(r){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=r.call.apply(r,[this].concat(a))||this,e(t,"cardSuit",h,i(t)),e(t,"cardRank",y,i(t)),t.card=void 0,t}return n(t,r),t.prototype.setup=function(r){this.card=r,this.cardSuit.string=["♠","♥","♦","♣"][r.suit],this.cardRank.string=r.rank},t}(u)).prototype,"cardSuit",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(f.prototype,"cardRank",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/CardMover.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e,o,r,a,i,c;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator,r=n.UITransform,a=n.tween,i=n.Vec3,c=n.Component}],execute:function(){var s;e._RF.push({},"84f9242HqlIxoYCUsq4N1ow","CardMover",void 0);var u=o.ccclass;n("CardMover",u("CardMover")(s=function(n){function e(){return n.apply(this,arguments)||this}return t(e,n),e.moveCard=function(n,t,e,o,a){void 0===o&&(o=.02),void 0===a&&(a=.25);var i=n.parent;if(i===t)return this.animateCardMovement(n,e,o,a);var c=i.getComponent(r).convertToWorldSpaceAR(n.position);n.removeFromParent(),n.parent=t;var s=t.getComponent(r).convertToNodeSpaceAR(c);return n.setPosition(s),this.animateCardMovement(n,e,o,a)},e.animateCardMovement=function(n,t,e,o){return new Promise((function(r){var i=a().delay(e).call((function(){return r()})),c=a(n).to(o,{position:t},{easing:"quadInOut"});a(n).parallel(c,i).start()}))},e.scatterCards=function(n,t,e,o){return new Promise((function(r){n.forEach((function(n){var c=e[0],s=e[1],u=2*Math.random()*Math.PI,d=c+Math.random()*(s-c),v=new i(Math.cos(u),Math.sin(u),0),l=i.scaleAndAdd(new i,t.position,v,d);a(n).to(o,{position:l},{easing:"cubicOut"}).call((function(){return r()})).start()}))}))},e}(c))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/Character.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Ability.ts"],(function(i){var e,t,c,s;return{setters:[function(i){e=i.extends,t=i.createForOfIteratorHelperLoose},function(i){c=i.cclegacy},function(i){s=i.AbilityName}],execute:function(){c._RF.push({},"0514f2WZqhIVoc4soO6O7Rc","Character",void 0);i("Character",function(){function i(i,e,t){this.level=void 0,this.abilities=void 0,this.proficiencyExpertise=void 0,this.movement=void 0,this.level=i,this.abilities=e,this.proficiencyExpertise=t,this.movement=25}var c=i.prototype;return c.calculateProficiencyBonus=function(){return this.level>=17?6:this.level>=13?5:this.level>=9?4:this.level>=5?3:2},c.calculateBaseProficiency=function(i){return Math.floor(i/2)-5},c.calculateProficiencies=function(){for(var i,c,a=((i={})[s.Strength]=this.calculateBaseProficiency(this.abilities.strength),i[s.Agility]=this.calculateBaseProficiency(this.abilities.agility),i[s.Acuity]=this.calculateBaseProficiency(this.abilities.acuity),i[s.Wisdom]=this.calculateBaseProficiency(this.abilities.wisdom),i[s.Charisma]=this.calculateBaseProficiency(this.abilities.charisma),i[s.Resilience]=this.calculateBaseProficiency(this.abilities.resilience),i),l=this.calculateProficiencyBonus(),r=e({},a),o=t(this.proficiencyExpertise);!(c=o()).done;){r[c.value]+=l}return r},c.calculateCompositeAbilities=function(){var i=this.abilities,e=i.strength,t=i.agility,c=i.acuity,s=i.wisdom,a=i.charisma,l=i.resilience;return{constitution:Math.floor((e+t)/2)+10,spirit:Math.floor((c+s)/2)+10,willpower:Math.floor((a+l)/2)+10}},i}());c._RF.pop()}}}));

System.register("chunks:///_virtual/CharacterInfo.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TeamMember.ts"],(function(e){var r,t,a,n,i,c,o,s;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){i=e.cclegacy,c=e._decorator,o=e.Component},function(e){s=e.TeamMember}],execute:function(){var l,u,h,f,p;i._RF.push({},"82acfU+CGFNcJsOleMa9nq0","CharacterInfo",void 0);var C=c.ccclass,d=c.property;e("CharacterInfo",(l=C("CharacterInfo"),u=d(s),l((p=r((f=function(e){function r(){for(var r,t=arguments.length,i=new Array(t),c=0;c<t;c++)i[c]=arguments[c];return r=e.call.apply(e,[this].concat(i))||this,a(r,"mainCharacter",p,n(r)),r.eventBus=null,r._deck=[],r}t(r,e);var i=r.prototype;return i.setInfo=function(e,r){this.mainCharacter.initCharacter(e,r),this.mainCharacter.disableSelect()},i.addCard=function(e){this._deck.push(e)},r}(o)).prototype,"mainCharacter",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=f))||h));i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatCharacter.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatEntity.ts"],(function(t){var o,a,e;return{setters:[function(t){o=t.inheritsLoose},function(t){a=t.cclegacy},function(t){e=t.CombatEntity}],execute:function(){a._RF.push({},"54634mJR51DG5Lnnb/s3y99","CombatCharacter",void 0);t("CombatCharacter",function(t){function a(o,a,e,n,i){var s;return(s=t.call(this,o,a,e,i)||this).proficiencyBonus=void 0,s.proficiencyBonus=n,s}o(a,t);var e=a.prototype;return e.hit=function(){return this.rollHit(0)},e.attack=function(t){var o=!1;this.bonusHitRolls.length=0,this.extraHitRolls.length=0,this.totalDamageRolls.length=0;var a=this.combatWeapons[0],e=this.rollHit(0);if(this.attackHitRoll=e,console.log("combatWeapon:",this.combatWeapons),a.calculateTotalCombatBonus(),this.bonusHitRolls=a.hitBonus.slice(),this.extraHitRolls=a.hitExtra.slice(),this.totalHitRoll=a.totalHitBonus,a.hitCheck(e.roll,t.armorClass)){var n=a.damage||this.defaultDamage,i=this.rollDamage(n);this.totalDamageRolls=[i],e.isFull&&(console.log("滿骰傷害值"),this.totalDamageRolls.push(this.rollDamage(n))),this.totalDamageRolls=this.totalDamageRolls.concat(a.damageExtra,a.damageBonus),t.receiveAttack(this.totalDamageRolls.reduce((function(t,o){return t+o}),0)),o=!0}return a.resetCombatBonus(),o||(t.receiveAttack(0),console.log(this.name+" misses.")),o},e.intent=function(){var t=this,o=this.combatIntent.getModifiers();return console.log("modifiers:",o),o.forEach((function(o){console.log("modifier:",o);var a=t.getApplicableWeapon(o);if(a){var e=t.rollDice(o.bonus);t.applyModifier(a,o.attribute,e)}})),this.combatWeapons[0].showAttackParams(),this.combatWeapons[1].showAttackParams(),this.combatIntent},e.getApplicableWeapon=function(t){var o=t.conditions;return o.includes("OffHand")&&this.checkWeaponConditions(o,this.combatWeapons[1])?this.combatWeapons[1]:this.checkWeaponConditions(o,this.combatWeapons[0])?this.combatWeapons[0]:(console.log("沒有武器適用條件"),null)},e.checkWeaponConditions=function(t,o){var a=o.range,e=o.damage,n=o.properties,i=t.every((function(t){return console.log("Checking weapon condition: "+t+" - damageType: "+e.type+"("+(e.type==t)+") - "+a+"("+(a==t)+") - "+n+" ("+n.every((function(o){return o==t}))+")"),e.type==t||(a==t||!!n.every((function(o){return o==t})))}));return console.log("Result: "+i),i},e.applyModifier=function(t,o,a){switch(console.log("Applying "+o+" bonus of "+a+" to "+t.name),o){case"HitBonus":t.hitBonusAdd(a);break;case"HitExtra":t.hitExtraAdd(a);break;case"DamageBonus":t.damageAdd(a);break;case"DamageExtra":t.extraDamageAdd(a)}},a}(e));a._RF.pop()}}}));

System.register("chunks:///_virtual/CombatController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatFormation.ts","./CombatVisualizer.ts","./EventManager.ts","./EventSystem.ts","./CombatOption.ts","./TipText.ts"],(function(t){var n,i,e,o,a,r,c,s,u,m,h,l,b,f,C,d;return{setters:[function(t){n=t.applyDecoratedDescriptor,i=t.inheritsLoose,e=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.asyncToGenerator,r=t.regeneratorRuntime},function(t){c=t.cclegacy,s=t._decorator,u=t.Button,m=t.Component},function(t){h=t.CombatFormation},function(t){l=t.CombatVisualizer},function(t){b=t.EventManager},function(t){f=t.EventBus},function(t){C=t.CombatOption},function(t){d=t.TipType}],execute:function(){var p,v,F,S,g,k,y,z,I,x,M;c._RF.push({},"61afb+V25xNe6d0eOXfpZsI","CombatController",void 0);var w=s.ccclass,B=s.property;t("CombatController",(p=w("CombatController"),v=B(h),F=B(l),S=B(C),g=B(u),p((z=n((y=function(t){function n(){for(var n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return n=t.call.apply(t,[this].concat(a))||this,e(n,"combatFormations",z,o(n)),e(n,"combatVisualizer",I,o(n)),e(n,"combatOption",x,o(n)),e(n,"attackButton",M,o(n)),n.eventBus=null,n.combatQueue=[],n.initiativeIndex=0,n.mainCharacter=null,n.currentAttacker=null,n.currentDefenders=[],n}i(n,t);var c=n.prototype;return c.onLoad=function(){b.instance.on("Initiative",this.onInitiative.bind(this)),b.instance.on("SelectCharacter",this.onSelectCharacter.bind(this)),b.instance.on("CharacterSelected",this.onCharacterSelected.bind(this)),b.instance.on("SelectMonster",this.onSelectMonster.bind(this)),b.instance.on("startCombat",this.startCombat.bind(this)),b.instance.on("CombatCheck",this.onCombatCheck.bind(this)),b.instance.on("updateFormation",this.updateFormation.bind(this))},c.onDestroy=function(){b.instance.off("onInitiative",this.onInitiative),b.instance.off("SelectCharacter",this.onSelectCharacter),b.instance.off("CharacterSelected",this.onCharacterSelected),b.instance.off("SelectMonster",this.onSelectMonster),b.instance.off("startCombat",this.startCombat),b.instance.off("CombatCheck",this.onCombatCheck),b.instance.off("updateFormation",this.updateFormation)},c.start=function(){},c.joinCombat=function(t,n,i){var e=this.combatFormations[t];0===i?e.addFrontMemeber(n):e.addBackMember(n)},c.leaveCombat=function(t,n){this.combatFormations[t].removeMember(n)},c.startCombat=function(){var t=a(r().mark((function t(){var n,i,e,o=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.combatVisualizer.node.active=!0,console.log("this.currentAttacker.camp:",this.currentAttacker.camp),console.log("combatFormations:",this.combatFormations),n=this.combatFormations[0].fighters,i=this.combatFormations[1].fighters,e=0===this.currentAttacker.camp?1:-1,t.next=8,this.combatVisualizer.showCombat(n,i,e);case 8:return t.next=10,new Promise((function(t){return o.scheduleOnce(t,1)}));case 10:this.endCombat();case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),c.combatRound=function(){this.attackButton.node.active=!1;var t=this.combatQueue[this.initiativeIndex];null!=t?(this.currentAttacker=t,t===this.mainCharacter?(this.onSelectCharacter(this.mainCharacter),b.instance.emit(d.Normal,"玩家回合")):(t.camp,this.combatFormations[0].pushFighter(this.mainCharacter),this.combatFormations[1].pushFighter(t),b.instance.emit(d.Normal,"怪物回合"),this.scheduleOnce(this.startCombat.bind(this),1)),this.initiativeIndex=(this.initiativeIndex+1)%this.combatQueue.length):console.error("Combat queue is empty",this.initiativeIndex)},c.endCombat=function(){this.updateFormation(),this.combatVisualizer.node.active=!1;var t=-1;this.combatFormations.forEach((function(n,i){n.isAllDead()&&(t=i)})),-1===t?this.combatRound():0===t?b.instance.emit(d.Normal,"<color=#ff0000>失敗！<br/>玩家陣亡</color>"):b.instance.emit(d.Normal,"<color=#00ff00>勝利！<br/>敵隊陣亡</color>")},c.updateFormation=function(t){void 0===t&&(t=!0),this.combatFormations.forEach((function(n){return n.rearrangeMembers(t)}))},c.onInitiative=function(t){var n=this,i=t.mainCharacter,e=t.team,o=e[0],a=e[1];this.eventBus=new f,this.mainCharacter=i,this.combatOption.init(this.eventBus,i),o.sort((function(t,n){return t.initiative-n.initiative})).forEach((function(t,i){t.joinTeam(),t.disableSelect(),n.joinCombat(0,t,i)})),a.sort((function(t,n){return t.initiative-n.initiative})).forEach((function(t,i){t.joinTeam(),t.disableSelect(),n.joinCombat(1,t,i)})),this.combatQueue=[].concat(o,a).sort((function(t,n){return t.initiative-n.initiative})),this.initiativeIndex=0,this.combatRound()},c.onSelectCharacter=function(t){var n=this;this.combatFormations[0].pushFighter(t),this.scheduleOnce((function(){n.combatOption.show(t),n.onCharacterSelected()}),1.5)},c.onCharacterSelected=function(){this.combatFormations[1].updateTeamStatus()},c.onSelectMonster=function(t){this.combatFormations[1].pushFighter(t),this.onCombatAttackClicked()},c.onCombatCheck=function(t,n){},c.onCombatAttackClicked=function(){this.startCombat()},n}(m)).prototype,"combatFormations",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=n(y.prototype,"combatVisualizer",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=n(y.prototype,"combatOption",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=n(y.prototype,"attackButton",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=y))||k));c._RF.pop()}}}));

System.register("chunks:///_virtual/CombatEntity.ts",["cc","./Ability.ts","./CombatIntent.ts","./CombatWeapon.ts"],(function(t){var i,n,o,a;return{setters:[function(t){i=t.cclegacy},function(t){n=t.AbilityName},function(t){o=t.CombatIntent},function(t){a=t.CombatWeapon}],execute:function(){i._RF.push({},"4e13fNneedFd5X9ywtAW5KB","CombatEntity",void 0);t("CombatEntity",function(){function t(t,i,e,s){this.name=void 0,this.hitPoints=void 0,this.sanityPoints=void 0,this.moralePoints=void 0,this.armorClass=void 0,this.combatWeapons=[],this.isDead=!1,this.affixEffects=void 0,this.defaultDamage=void 0,this.naturalWeapon=void 0,this.hitCriticalPoint=20,this.bonusHitRolls=[],this.extraHitRolls=[],this.totalHitRoll=0,this.totalDamageRolls=[],this.underAttackDamageValue=0,this.actionPoints=void 0,this.attackHitRoll=void 0,this.hitExtras=[],this.hitBonuses=[],this.damages=[],this.extraDamageValue=0,this.combatIntent=void 0,this.name=t,this.hitPoints=i.constitution,this.armorClass=e,this.defaultDamage=s||{dice:"1d4",type:"Unarmed"},this.naturalWeapon=new a("拳擊",n.Strength,{dice:"1d4",type:"Unarmed"},[],"Melee"),this.unequipWeapon(),this.combatIntent=new o,this.resetBonuses()}var i=t.prototype;return i.applyEffect=function(t,i){void 0!==this.affixEffects[t]&&(this.affixEffects[t]+=i,console.log(this.name+"'s "+t+" changed by "+i+". Now: "+this.affixEffects[t]))},i.receiveAttack=function(t){this.underAttackDamageValue=t,console.log(this.name+" received "+t+" damage and now has "+this.hitPoints+" hit points.")},i.resultDamage=function(){var t=this.underAttackDamageValue;return this.underAttackDamageValue=0,0===t?0:(this.hitPoints-=t,console.log("傷害執行完成 HP:",this.hitPoints,"(-",t,")"),this.isDead=this.hitPoints<=0,this.isDead&&console.log(this.name+" is dead."),t)},i.roll=function(t,i){return void 0===i&&(i=1),Math.floor(Math.random()*t)+i},i.rollHit=function(t){var i;return i=this.affixEffects.blind?this.rollHitWithDisadvantage():this.roll(20),console.log(this.name+" hit "+i+" + "+t),{roll:i+t,isFull:i>=this.hitCriticalPoint}},i.rollHitWithAdvantage=function(){return Math.max(this.roll(20),this.roll(20))},i.rollHitWithDisadvantage=function(){return Math.min(this.roll(20),this.roll(20))},i.rollDamage=function(t){return this.rollDice(t.dice)},i.rollDice=function(t){console.log(this.name+" rolled "+t);var i,n=t.split("+");if(""===n[0])return parseInt(n[1],10);i=2===n.length?n[0].split("d"):t.split("d");for(var o=parseInt(i[0],10),a=parseInt(i[1],10),e=0,s=0;s<o;s++)e+=Math.floor(Math.random()*a)+1;return n.length>1&&(e+=parseInt(n[1],10)),e},i.resetBonuses=function(){this.affixEffects={hitBonus:0,damageBonus:0,poison:0,bleeding:0,frenzy:0,stun:0,blind:0,paralyze:0,confusion:0}},i.equipWeapons=function(t){var i=this;t.forEach((function(t,n){t&&i.equipWeapon(t,n)}))},i.equipWeapon=function(t,i){this.combatWeapons[i]=t,console.log(this.name+" has equipped "+t.name+".")},i.unequipWeapon=function(t){if(void 0===t)return this.combatWeapons=[this.naturalWeapon,this.naturalWeapon],void console.log(this.name+" has unequipped all weapons.");t<this.combatWeapons.length?(console.log(this.name+" has unequipped "+this.combatWeapons[t].name+"."),this.combatWeapons[t].hitProficiencyBonus=0,this.combatWeapons[t].damageProficiencyBonus=0,this.combatWeapons[t]=this.naturalWeapon):console.log("Invalid weapon index.")},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatFormation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,o,i,a,s,c,m,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,s=e.Prefab,c=e.Node,m=e.Vec3,f=e.Component}],execute:function(){var u,d,h,b,l,p,M,w,v,x,I;i._RF.push({},"7f9f64EH6dO3L/eG9tWsVmH","CombatFormation",void 0);var R=a.ccclass,g=a.property;e("CombatFormation",(u=R("CombatFormation"),d=g(s),h=g(c),b=g(c),u((M=t((p=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,r(t,"characterPrefab",M,o(t)),r(t,"frontRoot",w,o(t)),r(t,"backRoot",v,o(t)),r(t,"distanceBetweenRows",x,o(t)),r(t,"distanceBetweenMembers",I,o(t)),t.frontRow=[],t.backRow=[],t.teamMembers=[[],[]],t.fighters=[],t}n(t,e);var i=t.prototype;return i.onLoad=function(){this.frontRow=this.frontRoot.children,this.backRow=this.backRoot.children},i.addFrontMemeber=function(e){var t=this,n=this.teamMembers[0];n.push(e),n.forEach((function(e,n){e.teamIndex=n,e.node.parent=t.frontRow[n],e.node.setPosition(new m(0,0,0))}))},i.addBackMember=function(e){var t=this,n=this.frontRow.length,r=this.teamMembers[1];r.unshift(e),r.forEach((function(e,r){e.teamIndex=r+n,e.node.parent=t.backRow[r],e.node.setPosition(new m(0,0,0))}))},i.addMember=function(e){e.teamIndex<0?this.addFrontMemeber(e):e.teamIndex>=0&&this.addBackMember(e)},i.removeFrontMember=function(e){this.teamMembers[0].splice(this.teamMembers[0].indexOf(e),1)},i.removeBackMember=function(e){this.teamMembers[1].splice(this.teamMembers[1].indexOf(e),1)},i.removeMember=function(e){e.teamIndex<this.frontRow.length?this.removeFrontMember(e):this.removeBackMember(e)},i.moveFrontMember=function(e,t){var n=this,r=this.frontRow.length,o=e.teamIndex;if(o>=r)return this.removeBackMember(e),void this.addFrontMemeber(e);var i=this.teamMembers[0];o+t<=0?e.teamIndex=0:e.teamIndex+=t;var a=i[e.teamIndex];a&&(a.teamIndex+=.1*Math.sign(t)),i.sort((function(e,t){return e.teamIndex-t.teamIndex})),i.forEach((function(e,t){e.teamIndex=t,e.node.parent=n.frontRow[t],e.node.setPosition(new m(0,0,0))}))},i.moveBackMember=function(e,t){var n=this,r=this.frontRow.length,o=e.teamIndex;if(o<r)return this.removeFrontMember(e),void this.addBackMember(e);var i=this.teamMembers[1];o+t<=r?e.teamIndex=r:e.teamIndex+=t;var a=i[e.teamIndex];a&&(a.teamIndex+=.1*Math.sign(t)),i.sort((function(e,t){return e.teamIndex-t.teamIndex})),i.forEach((function(e,t){e.teamIndex=t+r,e.node.parent=n.backRow[t],e.node.setPosition(new m(0,0,0))}))},i.updateTeamStatus=function(){this.teamMembers.forEach((function(e){e.forEach((function(e){e.enableSelect()}))}))},i.pushFighter=function(e){this.fighters.push(e)},i.rearrangeMembers=function(e){var t=this,n=this.frontRow.length;this.fighters.forEach((function(e){e.teamIndex<n?e.node.parent=t.frontRow[e.teamIndex]:e.node.parent=t.backRow[e.teamIndex-n],e.endFight(),e.node.setPosition(new m(0,0,0))})),e&&(this.fighters.length=0)},i.isAllDead=function(){return this.teamMembers.every((function(e){return e.every((function(e){return e.isDead}))}))},t}(f)).prototype,"characterPrefab",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(p.prototype,"frontRoot",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(p.prototype,"backRoot",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(p.prototype,"distanceBetweenRows",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),I=t(p.prototype,"distanceBetweenMembers",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),l=p))||l));i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatIntent.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"a7478VvwtVBn6bQSwOLGDnB","CombatIntent",void 0);t("CombatIntent",function(){function t(){this.modifiers=void 0,this.targetRestriction=void 0,this.modifiers=[],this.targetRestriction=null}var e=t.prototype;return e.clearIntents=function(){this.modifiers.length=0,this.targetRestriction=null},e.addIntent=function(t,e){return console.log("Adding intent with target type "+e+"."),null===this.targetRestriction?(this.targetRestriction=e,this.modifiers.push(t),console.log("Intent added with target type "+e+"."),!0):this.targetRestriction===e?(this.modifiers.push(t),console.log("Intent added with target type "+e+"."),!0):(console.log("Failed to add intent: target type "+e+" does not match current restriction "+this.targetRestriction+"."),!1)},e.getCurrentTargetRestriction=function(){return this.targetRestriction},e.getModifiers=function(){return this.modifiers},e.executeIntents=function(t){},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/CombatMonster.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatEntity.ts"],(function(t){var o,a,e,n;return{setters:[function(t){o=t.inheritsLoose},function(t){a=t.cclegacy,e=t.randomRangeInt},function(t){n=t.CombatEntity}],execute:function(){a._RF.push({},"73712Al6IREEbBkckTU263x","CombatMonster",void 0);t("CombatMonster",function(t){function a(o,a,e,n,s){var i;return(i=t.call(this,o,a,e,s)||this).hitBonus=0,i.hitBonus=n,i}o(a,t);var n=a.prototype;return n.hit=function(){return this.rollHit(0)},n.attack=function(t){var o=!1,a=this.combatWeapons[0],e=this.rollHit(0);if(this.attackHitRoll=e,console.log("combatWeapon:",this.combatWeapons),a.calculateTotalCombatBonus(),this.bonusHitRolls=a.hitBonus.slice(),this.extraHitRolls=a.hitExtra.slice(),this.totalHitRoll=a.totalHitBonus,a.hitCheck(e.roll,t.armorClass)){var n=a.damage||this.defaultDamage,s=this.rollDamage(n);this.totalDamageRolls=[s],e.isFull&&(console.log("滿骰傷害值"),this.totalDamageRolls.push(this.rollDamage(n))),this.totalDamageRolls=this.totalDamageRolls.concat(a.damageExtra,a.damageBonus),t.receiveAttack(this.totalDamageRolls.reduce((function(t,o){return t+o}),0)),o=!0}return a.resetCombatBonus(),o||(t.receiveAttack(0),console.log(this.name+" misses.")),o},n.intent=function(){return this.combatIntent.addIntent([{attribute:"HitExtra",bonus:"1d4",conditions:["Meele"]},{attribute:"DamageBonus",bonus:"+2",conditions:["Meele"]}][e(0,1)],"emeny"),this.combatIntent},a}(n));a._RF.pop()}}}));

System.register("chunks:///_virtual/CombatOption.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PlayerHandCards2.ts","./CardMover.ts","./ArcherySkill.ts","./EventManager.ts","./GameEvents.ts","./CounterComponent.ts"],(function(e){var t,n,i,a,r,o,s,c,l,u,h,f,d,p,y,C,m,k,b,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,r=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e._decorator,l=e.Node,u=e.Component,h=e.tween,f=e.Vec3,d=e.UIOpacity},function(e){p=e.default},function(e){y=e.CardMover},function(e){C=e.ArcherySkill},function(e){m=e.EventManager},function(e){k=e.DeckPileEvent,b=e.PlayerHandCardEvent},function(e){v=e.CounterComponent}],execute:function(){var g,D,S,_,w,R,E,P,O,q,z,M,x;s._RF.push({},"6a99fkqaBFLvo9h4DAXxJT0","CombatOption",void 0);var L=c.ccclass,T=c.property;e("CombatOption",(g=L("CombatOption"),D=T(p),S=T(l),_=T(l),w=T(l),R=T(v),g((O=t((P=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,i(t,"playerHandCards",O,a(t)),i(t,"blocker",q,a(t)),i(t,"layout",z,a(t)),i(t,"hitLayout",M,a(t)),i(t,"counter",x,a(t)),t.eventBus=null,t.myTeamCharacter=null,t._deck=[],t}n(t,e);var s=t.prototype;return s.onLoad=function(){m.instance.on("ExecuteSkill",this.playCard.bind(this)),m.instance.on("ShuffleDeckRequest",this.shuffleDeckRequest.bind(this)),m.instance.on("StartDealCards",this.dealCards.bind(this))},s.onDestroy=function(){m.instance.off("ExecuteSkill",this.playCard),m.instance.off("ShuffleDeckRequest",this.shuffleDeckRequest),m.instance.off("StartDealCards",this.dealCards)},s.start=function(){this.node.active=!1},s.init=function(e,t){this.eventBus=e,this.myTeamCharacter=t;var n=new C(2,this.eventBus);this._deck.length=0;var i=n.getSkill2();i.length;this._deck=i.slice(),this.shuffleDeck(),m.instance.emit(k.ShowCards,this._deck.slice())},s.shuffleDeckRequest=function(){this.shuffleDeck(),m.instance.emit(k.ShowCards,this._deck.slice()),this.scheduleOnce((function(){console.log("shuffleDeckRequest 後開始發牌，4張"),m.instance.emit(k.DealPlayerCards,4)}),1)},s.dealCards=function(){m.instance.emit(k.DealPlayerCards,4)},s.shuffleDeck=function(){for(var e=0;e<this._deck.length;e++){var t=Math.floor(Math.random()*(e+1)),n=[this._deck[t],this._deck[e]];this._deck[e]=n[0],this._deck[t]=n[1]}},s.show=function(){var e=r(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.position=f.ZERO,this.node.active=!0,this.blocker.active=!0,(n=this.blocker.getComponent(d)).opacity=0,e.next=7,y.moveCard(t.node,this.layout,f.ZERO);case 7:t.node.parent=this.layout,h(n).to(.25,{opacity:205},{easing:"linear"}).call((function(){m.instance.emit(k.DealPlayerCards,4)})).start();case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.close=function(){this.node.active=!1},s.submitSelectedCards=function(){m.instance.emit(b.PlayCards),m.instance.emit("updateFormation",!1)},s.playCard=function(e){console.log("playCard",e),this.myTeamCharacter.intent(e)},s.onSubmitSelectedClicked=function(){this.submitSelectedCards(),console.log("提交選擇"),this.close()},t}(u)).prototype,"playerHandCards",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(P.prototype,"blocker",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(P.prototype,"layout",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(P.prototype,"hitLayout",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(P.prototype,"counter",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=P))||E));s._RF.pop()}}}));

System.register("chunks:///_virtual/CombatSkill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventSystem.ts","./Skill.ts"],(function(t){var e,i,n,f;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy},function(t){n=t.NotifyEvent},function(t){f=t.Skill}],execute:function(){i._RF.push({},"f7e8dqswFlIPpZLoBm4xBmY","CombatSkill",void 0);t("CombatSkill",function(t){function i(e,i){var n;return void 0===e&&(e=0),(n=t.call(this,e)||this).eventBus=void 0,n.eventBus=i,n}e(i,t);var f=i.prototype;return f.activateSkillEffect=function(t,e){this.eventBus.publish(new n("effectSkillApplied",{target:t,effect:e}))},f.activateAffixEffect=function(t,e){this.eventBus.publish(new n("affixEffectApplied",{target:t,effect:e}))},i}(f));i._RF.pop()}}}));

System.register("chunks:///_virtual/CombatVisualizer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CounterComponent.ts","./ParticleEffectComponent.ts","./AnswerClipsAnimation.ts"],(function(t){var e,n,i,o,a,r,s,l,u,c,p,d,f,g,h,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.asyncToGenerator,r=t.regeneratorRuntime},function(t){s=t.cclegacy,l=t._decorator,u=t.Node,c=t.Vec3,p=t.tween,d=t.Component,f=t.UIOpacity},function(t){g=t.CounterComponent},function(t){h=t.ParticleEffectComponent},function(t){b=t.AnswerClipsAnimation}],execute:function(){var y,w,m,v,C,x,q,O,E,R,k,z,A,F,P,T,H;s._RF.push({},"0cdb7l2d8hPfrJX3uzWvMCY","CombatVisualizer",void 0);var I=l.ccclass,S=l.property;t("CombatVisualizer",(y=I("CombatVisualizer"),w=S(u),m=S(u),v=S(u),C=S(u),x=S(u),q=S(g),O=S(h),y((k=e((R=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,i(e,"blocker",k,o(e)),i(e,"layout",z,o(e)),i(e,"resultSuccessTip",A,o(e)),i(e,"resultFailTip",F,o(e)),i(e,"hitLayout",P,o(e)),i(e,"counter",T,o(e)),i(e,"particleEffect",H,o(e)),e}n(e,t);var s=e.prototype;return s.start=function(){this.node.position=c.ZERO,this.node.active=!1},s.delayAsync=function(){var t=a(r().mark((function t(e){var n=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){n.scheduleOnce((function(){t()}),e)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),s.showCombat=function(){var t=a(r().mark((function t(e,n,i){var o,a,s,l,u,d,g,h,y,w,m,v,C,x,q,O,E,R=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i>0?(o=e[0],a=n[0]):(o=n[0],a=e[0]),o.startFight(),a.startFight(),this.blocker.active=!0,this.resultSuccessTip.active=!1,this.resultFailTip.active=!1,(s=this.blocker.getComponent(f)).opacity=0,p(s).to(.25,{opacity:185},{easing:"linear"}).start(),e.forEach((function(t){t.node.parent=R.layout,t.node.setPosition(new c(-200,0,0))})),n.forEach((function(t){t.node.parent=R.layout,t.node.setPosition(new c(200,0,0))})),l=o.attack([a]),u=l.bonusHitRolls,d=l.extraHitRolls,g=l.totalHitRoll,h=l.totalDamageRolls,l.affixEffects,y=l.hitBonuses,w=l.attackHitRoll,console.log("comboHitRolls:",d),console.log("totalHitRoll:",g),console.log("hitBonuses:",JSON.stringify(y)),w.isFull&&console.log("要處理爆骰的特效"),this.counter.count=w.roll,this.counter.counterEffect(),t.next=20,this.delayAsync(.25);case 20:if(!(y.length>0)){t.next=25;break}return m=y.shift(),this.counter.addCount(m.value,m.name),t.next=25,this.delayAsync(.5);case 25:if(v=u.reduce((function(t,e){return t+e}),0),console.log("totalBonusHitRoll:",v),!(v>0)){t.next=35;break}return p(o.node).to(.25,{position:c.ZERO},{easing:"quadOut"}).call((function(){R.particleEffect.setupEffect(),R.particleEffect.playEffect()})).start(),t.next=31,this.delayAsync(1.25);case 31:return this.counter.addCount(v),t.next=34,this.delayAsync(1);case 34:p(o.node).to(.15,{position:new c(-200*i,0,0)},{easing:"quadOut"}).start();case 35:C=new c(0,0,0),x=0;case 37:if(!(x<y.length)){t.next=45;break}return t.next=40,this.battle1(e,n,i,C);case 40:console.log("hits[",x,"]:",y[x]),this.counter.addCount(y[x].value,y[x].name);case 42:x++,t.next=37;break;case 45:return d.length=0,console.log("comboHitRolls:",d),t.next=49,this.delayAsync(.5);case 49:if(q=a.resultDamage(),console.log("damageResult:",q),!(q>0)){t.next=64;break}return this.resultSuccessTip.active=!0,p(this.resultSuccessTip).to(.25,{scale:new c(1.2,1.2,1)}).to(.25,{scale:c.ONE}).start(),O=null,console.log("totalDamageRolls:",h),h.length>0&&(E=a.getComponentInChildren(b),O=function(){return E.spreadCards(h.map((function(t){return t.toString()})))}),t.next=59,this.battleSuccess(e,n,i,C,O);case 59:return a.changeHpBar(-q),t.next=62,this.delayAsync(1.5);case 62:t.next=68;break;case 64:return this.resultFailTip.active=!0,p(this.resultFailTip).to(.25,{scale:new c(1.2,1.2,1)}).to(.25,{scale:c.ONE}).start(),t.next=68,this.battleFail(e,n);case 68:case"end":return t.stop()}}),t,this)})));return function(e,n,i){return t.apply(this,arguments)}}(),s.addHitBouns=function(t,e){return new Promise((function(e){p(t.node).to(.25,{position:c.ZERO},{easing:"quadOut"}).delay(1).to(.15,{position:new c(-200,0,0)},{easing:"quadOut"}).call((function(){e()})).start()}))},s.battle1=function(t,e,n,i){return void 0===n&&(n=1),void 0===i&&(i=new c(0,0,0)),new Promise((function(o){var a=i.clone(),r=i.clone();p(t[0].node).to(.25,{position:a.add(new c(-200,0,0))},{easing:"quadOut"}).delay(.05).by(.15,{position:new c(120,0,0)},{easing:"quadIn"}).by(.15,{position:a},{easing:"quadOut"}).call((function(){i.add(new c(10*n,0,0)),o()})).start(),p(e[0].node).to(.25,{position:r.add(new c(200,0,0))},{easing:"quadOut"}).delay(.05).by(.15,{position:new c(-120,0,0)},{easing:"quadIn"}).by(.15,{position:r},{easing:"quadOut"}).start()}))},s.battleFail=function(t,e){return new Promise((function(n){p(t[0].node).to(.15,{position:new c(0,0,0)},{easing:"linear"}).to(.25,{position:new c(-200,0,0)},{easing:"quadIn"}).call((function(){n()})).start(),p(e[0].node).to(.15,{position:new c(0,0,0)},{easing:"linear"}).to(.25,{position:new c(200,0,0)},{easing:"quadIn"}).start()}))},s.battleSuccess=function(t,e,n,i,o){return void 0===n&&(n=1),void 0===i&&(i=new c(0,0,0)),void 0===o&&(o=null),new Promise((function(a){i.clone();var r=i.clone();n>0?(p(t[0].node).to(.15,{position:new c(-200,0,0)},{easing:"linear"}).by(.15,{position:new c(220,0,0)},{easing:"quadIn"}).start(),p(e[0].node).to(.25,{position:r.add(new c(100,0,0))},{easing:"quadOut"}).parallel(p(e[0].node).by(.15,{position:new c(80,0,0)},{easing:"quadIn"}),p(e[0].node).to(.25,{angle:-45*n},{easing:"linear"})).call((function(){null==o||o()})).delay(1.25).to(.25,{angle:0},{easing:"linear"}).call((function(){a()})).start()):(p(t[0].node).to(.25,{position:r.add(new c(-100,0,0))},{easing:"quadOut"}).parallel(p(e[0].node).by(.15,{position:new c(-80,0,0)},{easing:"quadIn"}),p(e[0].node).to(.25,{angle:45},{easing:"linear"})).to(.25,{angle:0},{easing:"linear"}).call((function(){a()})).start(),p(e[0].node).to(.15,{position:new c(200,0,0)},{easing:"linear"}).by(.15,{position:new c(-220,0,0)},{easing:"quadIn"}).start())}))},e}(d)).prototype,"blocker",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(R.prototype,"layout",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(R.prototype,"resultSuccessTip",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(R.prototype,"resultFailTip",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(R.prototype,"hitLayout",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(R.prototype,"counter",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(R.prototype,"particleEffect",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=R))||E));s._RF.pop()}}}));

System.register("chunks:///_virtual/CombatWeapon.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"93c86HlJdFEX6Ji+MXKRl1f","CombatWeapon",void 0);t("CombatWeapon",function(){function t(t,i,o,s,n){this.name=void 0,this.abilityName=void 0,this.damage=void 0,this.properties=void 0,this.range=void 0,this.hitProficiencyBonus=0,this.damageProficiencyBonus=0,this.hitBonus=[],this.hitExtra=[],this.totalHitBonus=0,this.damageBonus=[],this.damageExtra=[],this.skillDamageDices=[],this.inCombat=!1,this.name=t,this.abilityName=i,this.damage=o,this.properties=s,this.range=n,this.resetCombatBonus()}var i=t.prototype;return i.resetCombatBonus=function(){this.hitBonus.length=0,this.hitExtra.length=0,this.damageBonus.length=0,this.damageExtra.length=0,this.totalHitBonus=0,this.inCombat=!1},i.hitBonusAdd=function(t){this.hitBonus.push(t)},i.hitExtraAdd=function(t){this.hitExtra.push(t)},i.damageAdd=function(t){this.damageBonus.push(t)},i.extraDamageAdd=function(t){this.damageExtra.push(t)},i.calculateTotalCombatBonus=function(){this.totalHitBonus=this.hitBonus.reduce((function(t,i){return t+i}),0),this.inCombat=!0},i.hitCheck=function(t,i){return i<=t+this.totalHitBonus},i.showAttackParams=function(){console.log("武器名稱: "+this.name),console.log("武器屬性: "+this.properties.join(", ")),console.log("武器傷害: "+JSON.stringify(this.damage)),console.log("武器射程: "+this.range.toString()),console.log("命中加值: "+this.totalHitBonus),console.log("技能傷害: "+this.skillDamageDices.map((function(t){return t.toString()})).join(", ")),console.log("hitExtra:",this.hitExtra),console.log("hitBonus:",this.hitBonus),console.log("damageBonus:",this.damageBonus),console.log("damageExtra:",this.damageExtra)},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/CommunityCards.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseCardDisplay.ts","./GameEvents.ts","./EventManager.ts","./CardMover.ts"],(function(n){var t,e,r,a,s,o,i,c,d;return{setters:[function(n){t=n.inheritsLoose,e=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){a=n.cclegacy,s=n._decorator},function(n){o=n.BaseCardDisplay},function(n){i=n.CommunityCardEvent},function(n){c=n.EventManager},function(n){d=n.CardMover}],execute:function(){var u;a._RF.push({},"90a78ICHwpA4pICKifRn8Oe","CommunityCards",void 0);var C=s.ccclass;s.property,n("default",C("CommunityCards")(u=function(n){function a(){return n.apply(this,arguments)||this}t(a,n);var s=a.prototype;return s.onLoad=function(){c.instance.on(i.DealCards,this.onDealCards.bind(this)),c.instance.on(i.ShowCards,this.onShowCards.bind(this)),c.instance.on(i.CompareCards,this.eventCompareCards.bind(this))},s.onDestroy=function(){c.instance.off(i.DealCards,this.onDealCards),c.instance.off(i.ShowCards,this.onShowCards),c.instance.off(i.CompareCards,this.eventCompareCards)},s.start=function(){this.initPositionNodes(5),this.node.active=!1},s.dealCards=function(n){this.updatePositionLayout()},s.moveDealCard=function(n,t){this.node.active=!0;return d.moveCard(t,this.cardContainer,this.positionContainer.children[n].position,.75,.15*(n+1))},s.dropCards=function(n){},s.clearCards=function(){this.cardContainer.removeAllChildren(),this.selected=[]},s.compareCards=function(n){var t=this,e=n[0];this.getCardNodes(e).forEach((function(n){t.toggleCardSelection(n)}))},s.onDealCards=function(){var n=e(r().mark((function n(t){var e;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.node.active=!0,n.next=3,this.unselectAllCards();case 3:e=t,this.dealCards(e);case 5:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),s.onShowCards=function(){var n=e(r().mark((function n(t){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.node.active=!0,n.next=3,this.unselectAllCards();case 3:this.showCards(t);case 4:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),s.eventCompareCards=function(n){this.compareCards(n)},a}(o))||u);a._RF.pop()}}}));

System.register("chunks:///_virtual/CommunityCardsTest.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ExplorationCard.ts","./EventManager.ts","./GameEvents.ts"],(function(t){var e,n,r,a,o,i,s,c,u,l,d;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose,r=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){o=t.cclegacy,i=t._decorator,s=t.Component},function(t){c=t.CardSuit},function(t){u=t.EventManager},function(t){l=t.GameLogicEvent,d=t.DeckPileEvent}],execute:function(){var h;o._RF.push({},"faad3On/mtH5KVc6qwVVcPK","CommunityCardsTest",void 0);var p=i.ccclass;i.property,t("default",p("CommunityCardsTest")(h=function(t){function o(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this)._deck=[],e}e(o,t);var i=o.prototype;return i.onLoad=function(){u.instance.on(l.GameRoundStartDealCards,this.onGameRoundStartDealCards.bind(this))},i.start=function(){this.initializeDeck(),u.instance.emit(d.ShowCards,this._deck)},i.initializeDeck=function(){for(var t=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],e=["stealth","power","wisdom","speed","luck"],r=0,a=[c.Prop,c.Clue,c.Doubt,c.Presage];r<a.length;r++)for(var o,i=a[r],s=n(t);!(o=s()).done;){for(var u=o.value,l=Math.floor(3*Math.random())+1,d=[],h=0;h<l;h++)d.push(e[Math.floor(Math.random()*e.length)]);this._deck.push({suit:i,rank:u,conditions:d})}},i.onGameRoundStartDealCards=function(){var t=r(a().mark((function t(){var e=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u.instance.emit(d.DealCommunityCards,this._deck.splice(0,5)),t.next=3,new Promise((function(t){return e.scheduleOnce(t,.5)}));case 3:u.instance.emit(d.DealPlayerCards,[this._deck.splice(0,2),this._deck.splice(0,2),this._deck.splice(0,2)]);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o}(s))||h);o._RF.pop()}}}));

System.register("chunks:///_virtual/CounterComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o,r,i,c,u,a,s,l,p,f,C;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,r=t.assertThisInitialized,i=t.createClass},function(t){c=t.cclegacy,u=t._decorator,a=t.Label,s=t.Node,l=t.Vec3,p=t.tween,f=t.UIOpacity,C=t.Component}],execute:function(){var d,h,y,b,g;c._RF.push({},"a4592V7k85I6Y4OVwBiWMQr","CounterComponent",void 0);var v=u.ccclass,m=u.property;t("CounterComponent",(d=v("CounterComponent"),h=m(a),d((g=n((b=function(t){function n(){for(var n,e=arguments.length,i=new Array(e),c=0;c<e;c++)i[c]=arguments[c];return n=t.call.apply(t,[this].concat(i))||this,o(n,"counterLabel",g,r(n)),n.currentCount=0,n}e(n,t);var c=n.prototype;return c.start=function(){this.count=this.currentCount},c.addCount=function(t,n){var e=this;void 0===n&&(n=""),this.currentCount+=t;var o=new s;o.parent=this.node,o.position=new l(0,-80,0),o.addComponent(a).string="+"+t+"\n"+n,p(o).to(.5,{position:new l(0,0,0)},{easing:"cubicOut"}).call((function(){e.counterLabel.string=e.currentCount.toString(),e.counterEffect()})).removeSelf().start();var r=o.addComponent(f);p(r).to(.7,{opacity:120},{easing:"cubicOut"}).to(.1,{opacity:0}).start()},c.counterEffect=function(){p(this.counterLabel.node).to(.01,{scale:new l(1.5,1.5,1)}).to(.2,{scale:new l(1,1,1)}).start()},i(n,[{key:"count",set:function(t){this.currentCount=t,this.counterLabel.string=t.toString()}}]),n}(C)).prototype,"counterLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=b))||y));c._RF.pop()}}}));

System.register("chunks:///_virtual/DataModal.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"ef40bRP1clLMaIn/nRX0fUM","DataModal",void 0),n("DataModal",function(){function n(){this.wordPuzzleData=void 0}return n.getInstance=function(){return n.instance||(n.instance=new n)},n}()).instance=void 0,t._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/DeckCards.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseCardDisplay.ts","./CardComponent.ts"],(function(e){var t,n,r,o,c,s;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator,o=e.instantiate},function(e){c=e.BaseCardDisplay},function(e){s=e.CardComponent}],execute:function(){var a;n._RF.push({},"0e8f90i+8xITrVmsrBey4CN","DeckCards",void 0);var i=r.ccclass;r.property,e("default",i("DeckCards")(a=function(e){function n(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).discardLimit=3,t}t(n,e);var r=n.prototype;return r.doShowCard=function(e){this.showCards(e)},r.showCards=function(e){var t=this;this.positionContainer.children.length===e.length?(this.selectedCardNodes.length>0&&console.error("已經有選取的卡片，請先清除之前的選取"),this.cardContainer.removeAllChildren(),e.forEach((function(e,n){var r=o(t.cardPrefab);r.name="Card_"+n,r.getComponent(s).setup(e),r.parent=t.cardContainer}))):console.error("卡牌數量與定位節點數量不符")},r.toggleCardSelection=function(t){e.prototype.toggleCardSelection.call(this,t);var n=t.getComponent(s).card;this.selected.includes(n)},r.confirmSelection=function(){var e=this.selected.length>0;return e?console.log("Discarding cards:",this.selected):console.log("No card selected."),e},r.getSelectedCards=function(){return this.selected},r.getCardContentNodes=function(){return this.cardContainer.children},n}(c))||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/DeckCards2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseCardDisplay.ts","./GameEvents.ts","./EventManager.ts","./CardComponent2.ts"],(function(e){var t,n,r,c,o,a,s,i,l;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){c=e.cclegacy,o=e._decorator},function(e){a=e.BaseCardDisplay},function(e){s=e.GameUIEvent},function(e){i=e.EventManager},function(e){l=e.CardComponent}],execute:function(){var d;c._RF.push({},"a133dU/5xNPzr4FEm/RU8Jy","DeckCards",void 0);var u=o.ccclass;o.property,e("default",u("DeckCards")(d=function(e){function c(){for(var t,n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(t=e.call.apply(e,[this].concat(r))||this).discardLimit=3,t}t(c,e);var o=c.prototype;return o.toggleCardSelection=function(t){e.prototype.toggleCardSelection.call(this,t);var n=t.getComponent(l).card;this.selected.includes(n)?i.instance.emit(s.DeckCardUnselected,n):i.instance.emit(s.DeckCardSelected,n)},o.confirmSelection=function(){var e=this.selected.length>0;return e?console.log("Discarding cards:",this.selected):console.log("No card selected."),e},o.discardSelectedCards=function(){var e=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unselectAllCards();case 2:this.updatePositionLayout(),this.followPosition();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.getSelectedCards=function(){return this.selected},o.getCardContentNodes=function(){return this.cardContainer.children},c}(a))||d);c._RF.pop()}}}));

System.register("chunks:///_virtual/DeckCardsPile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameEvents.ts","./HandEvaluator.ts","./EventManager.ts","./CardMover.ts","./CardComponent2.ts","./DeckCards2.ts","./CommunityCards.ts","./PlayerHandCards.ts"],(function(e){var n,t,r,a,i,s,c,o,d,u,l,h,f,C,p,m,v,k,y,D,g;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,i=e.asyncToGenerator,s=e.regeneratorRuntime,c=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,d=e._decorator,u=e.Node,l=e.Vec3,h=e.Component},function(e){f=e.DeckPileEvent,C=e.GameLogicEvent},function(e){p=e.HandEvaluator},function(e){m=e.EventManager},function(e){v=e.CardMover},function(e){k=e.CardComponent},function(e){y=e.default},function(e){D=e.default},function(e){g=e.default}],execute:function(){var b,x,w,P,G,E,S,H,R,A,z,O,N;o._RF.push({},"2412cS1sUJNnI5q2nUpqzA/","DeckCardsPile",void 0);var T=d.ccclass,L=d.property;e("default",(b=T("DeckCardsPile"),x=L(u),w=L(u),P=L(u),G=L(D),E=L(g),b((R=n((H=function(e){function n(){for(var n,t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return n=e.call.apply(e,[this].concat(i))||this,r(n,"deckPile",R,a(n)),n.deckCardsPile=void 0,r(n,"deckGatherings",A,a(n)),r(n,"deckDiscard",z,a(n)),r(n,"communityCards",O,a(n)),r(n,"playerHands",N,a(n)),n}t(n,e);var o=n.prototype;return o.onLoad=function(){m.instance.on(f.ShowCards,this.onShowCards.bind(this)),m.instance.on(f.DeckGatherings,this.onDeckGatherings.bind(this)),m.instance.on(f.DiscardCards,this.onDiscardCards.bind(this)),m.instance.on(f.DealCommunityCards,this.onDealCommunityCards.bind(this)),m.instance.on(f.DealPlayerCards,this.onDealPlayerCards.bind(this)),m.instance.on(f.HideCards,this.eventHideCards.bind(this)),this.deckCardsPile=this.deckPile.getComponentsInChildren(y)},o.onDestroy=function(){m.instance.off(f.ShowCards,this.onShowCards),m.instance.off(f.DeckGatherings,this.onDeckGatherings),m.instance.off(f.DiscardCards,this.onDiscardCards),m.instance.off(f.DealCommunityCards,this.onDealCommunityCards),m.instance.off(f.DealPlayerCards,this.onDealPlayerCards),m.instance.off(f.HideCards,this.eventHideCards)},o.start=function(){this.node.position=l.ZERO},o.showdDeckPile=function(e){this.deckCardsPile.forEach((function(e){return e.node.active=!0}));var n=p.groupBySuit(e);this.deckCardsPile.forEach((function(e,t){var r=n[t];e.initPositionNodes(r.length),e.showCards(r),e.followPosition(),e.setToggleSelection()}))},o.collectAllCardsToDeckGatherings=function(){var e=i(s().mark((function e(){var n,t,r,a,i,o,d,u=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=c(this.deckCardsPile);case 1:if((t=n()).done){e.next=16;break}return r=t.value,e.next=5,r.unselectAllCards();case 5:r.stopToggleSelection(),a=r.getCardContentNodes().slice(),i=c(a);case 8:if((o=i()).done){e.next=14;break}return d=o.value,e.next=12,v.moveCard(d,this.deckGatherings,l.ZERO);case 12:e.next=8;break;case 14:e.next=1;break;case 16:return e.next=18,new Promise((function(e){return u.scheduleOnce(e,.25)}));case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.onShowCards=function(e){this.node.active=!0,this.communityCards.clearCards(),this.playerHands.forEach((function(e){return e.clearCards()})),this.deckGatherings.removeAllChildren(),this.deckDiscard.removeAllChildren(),this.showdDeckPile(e)},o.onDeckGatherings=function(){var e=i(s().mark((function e(n){var t,r,a,i=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.node.active=!0,t=c(this.deckDiscard.children.slice());case 2:if((r=t()).done){e.next=8;break}return a=r.value,e.next=6,v.moveCard(a,this.deckGatherings,l.ZERO);case 6:e.next=2;break;case 8:return e.next=10,new Promise((function(e){return i.scheduleOnce(e,.25)}));case 10:console.log("重洗"),m.instance.emit(C.GameRoundNextPlayerTurn);case 12:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),o.onDiscardCards=function(){var e=i(s().mark((function e(n){var t,r,a,o,d,u=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.node.active=!0,t=n,e.next=4,this.communityCards.unselectAllCards();case 4:r=this.communityCards.getCardNodes(t).slice(),a=c(r);case 6:if((o=a()).done){e.next=12;break}return d=o.value,e.next=10,v.moveCard(d,this.deckDiscard,l.ZERO);case 10:e.next=6;break;case 12:return e.next=14,this.playerHands.forEach(i(s().mark((function e(n){var a,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.unselectAllCards();case 2:r=n.getCardNodes(t).slice(),a=c(r);case 4:if((i=a()).done){e.next=10;break}return o=i.value,e.next=8,v.moveCard(o,u.deckDiscard,l.ZERO);case 8:e.next=4;break;case 10:case"end":return e.stop()}}),e)}))));case 14:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),o.onDealCommunityCards=function(e){var n=this;this.node.active=!0;var t=this.deckGatherings.children,r=e;console.log(r);var a=0;r.forEach(i(s().mark((function e(r){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=t[t.length-1]).getComponent(k).setup(r),e.next=4,n.communityCards.moveDealCard(a++,i);case 4:case"end":return e.stop()}}),e)}))))},o.onDealPlayerCards=function(e){var n=this,t=this.deckGatherings.children;e.forEach((function(e,r){n.playerHands[r].dealCards(e,t)}))},o.eventHideCards=function(e){this.node.active=!1},o.onDiscardClicked=function(){var e=[];this.deckCardsPile.forEach((function(n){n.confirmSelection()&&(n.discardSelectedCards(),e=e.concat(n.getSelectedCards()))})),0!=e.length&&m.instance.emit(C.GameRoundStartDiscardCards,e)},o.onGameStartDealClicked=function(){var e=i(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collectAllCardsToDeckGatherings();case 2:this.deckCardsPile.forEach((function(e){return e.node.active=!1})),m.instance.emit(C.GameRoundStartDealCards);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n}(h)).prototype,"deckPile",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=n(H.prototype,"deckGatherings",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(H.prototype,"deckDiscard",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=n(H.prototype,"communityCards",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=n(H.prototype,"playerHands",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S=H))||S));o._RF.pop()}}}));

System.register("chunks:///_virtual/DeckCardsPile2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PlayerHandCards2.ts","./CardMover.ts","./EventManager.ts","./GameEvents.ts","./DeckCards.ts"],(function(e){var n,t,r,i,a,s,c,o,l,d,u,h,f,k,p,C,v;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,s=e.regeneratorRuntime,c=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,l=e._decorator,d=e.Node,u=e.Vec3,h=e.Component},function(e){f=e.default},function(e){k=e.CardMover},function(e){p=e.EventManager},function(e){C=e.DeckPileEvent},function(e){v=e.default}],execute:function(){var g,D,P,y,b,m,w,x,G,S,E;o._RF.push({},"a010fbX4oxEuZIxUUTL9QBb","DeckCardsPile",void 0);var H=l.ccclass,R=l.property;e("default",(g=H("DeckCardsPile"),D=R(d),P=R(d),y=R(d),b=R(f),g((x=n((w=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=e.call.apply(e,[this].concat(a))||this,r(n,"deckPile",x,i(n)),n.deckCardsPile=void 0,r(n,"deckGatherings",G,i(n)),r(n,"deckDiscard",S,i(n)),r(n,"playerHands",E,i(n)),n.cards=[],n}t(n,e);var o=n.prototype;return o.onLoad=function(){p.instance.on(C.ShowCards,this.onShowCards.bind(this)),p.instance.on(C.DeckGatherings,this.onDeckGatherings.bind(this)),p.instance.on(C.DealPlayerCards,this.onDealPlayerCards.bind(this)),this.deckCardsPile=this.deckPile.getComponentsInChildren(v)},o.onDestroy=function(){p.instance.off(C.ShowCards,this.onShowCards),p.instance.off(C.DeckGatherings,this.onDeckGatherings),p.instance.off(C.DealPlayerCards,this.onDealPlayerCards)},o.start=function(){this.node.position=u.ZERO},o.showdDeckPile=function(e){this.cards=e,this.deckCardsPile.forEach((function(n,t){n.initPositionNodes(e.length),n.doShowCard(e),n.setToggleSelection(),n.followPosition()})),this.onGameStartDealClicked()},o.collectAllCardsToDeckGatherings=function(){var e=a(s().mark((function e(){var n,t,r,i,a,o,l,d=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=c(this.deckCardsPile);case 1:if((t=n()).done){e.next=13;break}r=t.value,i=r.getCardContentNodes().slice(),a=c(i);case 5:if((o=a()).done){e.next=11;break}return l=o.value,e.next=9,k.moveCard(l,this.deckGatherings,u.ZERO);case 9:e.next=5;break;case 11:e.next=1;break;case 13:return e.next=15,new Promise((function(e){return d.scheduleOnce(e,.25)}));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.onShowCards=function(e){this.node.active=!0,this.deckGatherings.removeAllChildren(),this.deckDiscard.removeAllChildren(),this.showdDeckPile(e)},o.onDeckGatherings=function(){var e=a(s().mark((function e(){var n,t,r,i=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.node.active=!0,n=c(this.deckDiscard.children.slice());case 2:if((t=n()).done){e.next=8;break}return r=t.value,e.next=6,k.moveCard(r,this.deckGatherings,u.ZERO);case 6:e.next=2;break;case 8:return e.next=10,new Promise((function(e){return i.scheduleOnce(e,.25)}));case 10:console.log("重洗");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.onDealPlayerCards=function(e){var n=this.deckGatherings.children;if(this.cards.length<e)p.instance.emit("ShuffleDeckRequest");else{var t=this.cards.splice(0,e);this.playerHands.initPositionNodes(e),this.playerHands.dealCards(t,n)}},o.eventHideCards=function(e){this.node.active=!1},o.onDiscardClicked=function(){var e=[];this.deckCardsPile.forEach((function(n){n.confirmSelection()&&(n.discardSelectedCards(),e=e.concat(n.getSelectedCards()))})),e.length},o.onGameStartDealClicked=function(){var e=a(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collectAllCardsToDeckGatherings();case 2:this.deckCardsPile.forEach((function(e){return e.node.active=!1}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n}(h)).prototype,"deckPile",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=n(w.prototype,"deckGatherings",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=n(w.prototype,"deckDiscard",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(w.prototype,"playerHands",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=w))||m));o._RF.pop()}}}));

System.register("chunks:///_virtual/DescriptionScrollView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FillBlanks.ts","./AnswerClipsAnimation.ts"],(function(i){var t,e,n,o,r,s,l,c,a,h,d,p,u,w,f,g,v;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,n=i.initializerDefineProperty,o=i.assertThisInitialized},function(i){r=i.cclegacy,s=i._decorator,l=i.ScrollView,c=i.Node,a=i.UITransform,h=i.Vec3,d=i.RichText,p=i.instantiate,u=i.UIOpacity,w=i.tween,f=i.Component},function(i){g=i.FillBlanks},function(i){v=i.AnswerClipsAnimation}],execute:function(){var y,m,V,x,k,C,S,T,b;r._RF.push({},"d4350Skx8NN8IRsBjiAsG5J","DescriptionScrollView",void 0);var A=s.ccclass,D=s.property;i("DescriptionScrollView",(y=A("DescriptionScrollView"),m=D(l),V=D(v),x=D(c),y((S=t((C=function(i){function t(){for(var t,e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return t=i.call.apply(i,[this].concat(r))||this,n(t,"scrollView",S,o(t)),n(t,"answerClipsAnimation",T,o(t)),n(t,"confirmButton",b,o(t)),t.centerPosition=void 0,t.quarterHeight=void 0,t.index=0,t.descriptions=void 0,t.keywords=[],t}e(t,i);var r=t.prototype;return r.onLoad=function(){var i,t;this.scrollView?(this.quarterHeight=this.scrollView.getComponent(a).height/4,this.centerPosition=this.scrollView.getComponent(a).convertToWorldSpaceAR(new h(0,0,0)),null==(i=this.scrollView)||null==(t=i.node)||t.on("scrolling",this.onScrolling,this)):console.warn("ScrollView component is not assigned.")},r.onDestroy=function(){var i,t;null==(i=this.scrollView)||null==(t=i.node)||t.off("scrolling",this.onScrolling,this)},r.setData=function(i){this.descriptions=i;var t=g.replaceMarkedWithKeywords([this.descriptions[this.index]],this.keywords),e=t.replacedTexts,n=t.storedTexts,o=e[0];this.scrollView.content.children[0].active=!0,this.scrollView.content.children[0].getComponentInChildren(d).string=o,this.index=0,this.showMarkedText(n[0]),this.confirmButton.active=!1},r.show=function(){this.node.active=!0},r.clear=function(){this.index=0,this.descriptions.length=0,this.keywords.length=0},r.close=function(){this.scrollView.content.children.forEach((function(i){return i.active=!1})),this.scrollView.scrollToPercentVertical(0),this.node.active=!1,this.index=0,this.descriptions.length=0},r.onScrolling=function(){for(var i=this.scrollView.content.children,t=this.scrollView.content.getComponent(a),e=0;e<i.length;e++){var n=i[e],o=t.convertToWorldSpaceAR(n.position);if(h.distance(o,this.centerPosition)<this.quarterHeight&&e===this.index){this.index++;var r=this.descriptions[this.index];if(void 0===r){this.confirmButton.active=!0;break}var s=n[this.index]||p(n);s.active=!0,s.parent=this.scrollView.content,s.position=h.ZERO;var l=g.replaceMarkedWithKeywords([r],this.keywords),c=l.replacedTexts,f=l.storedTexts,v=s.getComponentInChildren(d);v.string=c[0],this.showMarkedText(f[0]);var y=v.getComponent(u);y.opacity=0,w(y).to(.5,{opacity:255}).start()}}},r.showMarkedText=function(i){var t=this,e=i.filter((function(i){return!t.keywords.includes(i)}));e.length>0&&(this.answerClipsAnimation.spreadCards(e),this.keywords=this.keywords.concat(e))},t}(f)).prototype,"scrollView",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(C.prototype,"answerClipsAnimation",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(C.prototype,"confirmButton",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=C))||k));r._RF.pop()}}}));

System.register("chunks:///_virtual/DiscardCardsPile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CardComponent2.ts"],(function(n){var t,r,e,i,a,o,s,c,u,l,p,f,d,m,h;return{setters:[function(n){t=n.applyDecoratedDescriptor,r=n.inheritsLoose,e=n.initializerDefineProperty,i=n.assertThisInitialized,a=n.asyncToGenerator,o=n.regeneratorRuntime},function(n){s=n.cclegacy,c=n._decorator,u=n.Prefab,l=n.Node,p=n.Vec3,f=n.tween,d=n.Component,m=n.instantiate},function(n){h=n.CardComponent}],execute:function(){var v,C,P,w,b,g,y;s._RF.push({},"62966EzVs5FsrwzsHD7VcvV","DiscardCardsPile",void 0);var D=c.ccclass,x=c.property;n("default",(v=D("DiscardCardsPile"),C=x(u),P=x(l),v((g=t((b=function(n){function t(){for(var t,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=n.call.apply(n,[this].concat(a))||this,e(t,"cardPrefab",g,i(t)),e(t,"discardPileContainer",y,i(t)),t.animating=!1,t}r(t,n);var s=t.prototype;return s.addCardToDiscardPile=function(){var n=a(o().mark((function n(t){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.animating){n.next=3;break}return n.next=3,this.waitForAnimation();case 3:return this.animating=!0,(r=m(this.cardPrefab)).getComponent(h).setup(t),r.parent=this.discardPileContainer,r.position=p.ZERO,n.next=10,this.animateCard(r);case 10:this.animating=!1;case 11:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),s.waitForAnimation=function(){var n=a(o().mark((function n(){var t=this;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){!function r(){t.animating?setTimeout(r,100):n(!0)}()})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),s.animateCard=function(n){return new Promise((function(t){var r=new p(200,100,0);f(n).to(1,{position:r}).call((function(){t(!0)})).start()}))},t}(d)).prototype,"cardPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(b.prototype,"discardPileContainer",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=b))||w));s._RF.pop()}}}));

System.register("chunks:///_virtual/Dungeon.ts",["cc"],(function(t){var s;return{setters:[function(t){s=t.cclegacy}],execute:function(){s._RF.push({},"9b9b3IiH/9IjYT1OxoCsK5v","Dungeon",void 0);var o=t("Direction",function(t){return t[t.North=0]="North",t[t.South=1]="South",t[t.East=2]="East",t[t.West=3]="West",t}({})),i=t("Room",function(){function t(t,s){this.instanceNode=null,this.x=void 0,this.y=void 0,this.icon=void 0,this.name=void 0,this.descriptions=void 0,this.connections=void 0,this.question=void 0,this.cards=void 0,this.x=t,this.y=s,this.connections=[]}var s=t.prototype;return s.setInfo=function(t){this.icon=t.icon,this.name=t.name,this.descriptions=t.descriptions,this.question=t.question,this.cards=t.cards},s.connectWith=function(t){this.x<t.x?(this.connections.push(o.East),t.connections.push(o.West)):this.x>t.x?(this.connections.push(o.West),t.connections.push(o.East)):this.y<t.y?(this.connections.push(o.North),t.connections.push(o.South)):this.y>t.y&&(this.connections.push(o.South),t.connections.push(o.North))},t}());t("DungeonMaze",function(){function t(t,s){this.rooms=void 0,this.width=void 0,this.height=void 0,this.width=t,this.height=s,this.rooms=Array.from({length:s},(function(s,o){return Array.from({length:t},(function(t,s){return new i(s,o)}))}))}var s=t.prototype;return s.generateMaze=function(t,s){void 0===t&&(t=0),void 0===s&&(s=0);var o=[],i=this.rooms[t][s],n=new Set;for(n.add(i),o.push(i);o.length>0;){i=o.pop();var h=this.getUnvisitedNeighbors(i,n);if(h.length>0){o.push(i);var e=h[Math.floor(Math.random()*h.length)];i.connectWith(e),n.add(e),o.push(e)}}},s.getUnvisitedNeighbors=function(t,s){var o=[],i=t.x,n=t.y;return i>0&&!s.has(this.rooms[n][i-1])&&o.push(this.rooms[n][i-1]),i<this.width-1&&!s.has(this.rooms[n][i+1])&&o.push(this.rooms[n][i+1]),n>0&&!s.has(this.rooms[n-1][i])&&o.push(this.rooms[n-1][i]),n<this.height-1&&!s.has(this.rooms[n+1][i])&&o.push(this.rooms[n+1][i]),o},s.findExit=function(t,s){var o=[],i=new Set,n=this.rooms[s][t];for(i.add(n),o.push(n);o.length>0;){var h=o.shift();if(h!==n&&1===h.connections.length)return h;this.getNeighbors(h).forEach((function(t){i.has(t)||(i.add(t),o.push(t))})),console.log(o.length)}return null},s.getNeighbors=function(t){var s=[],i=t.x,n=t.y;return t.connections.includes(o.South)&&n>0&&s.push(this.rooms[n-1][i]),t.connections.includes(o.North)&&n<this.height-1&&s.push(this.rooms[n+1][i]),t.connections.includes(o.West)&&i>0&&s.push(this.rooms[n][i-1]),t.connections.includes(o.East)&&i<this.width-1&&s.push(this.rooms[n][i+1]),s},t}());s._RF.pop()}}}));

System.register("chunks:///_virtual/DungeonEscapeHandler.ts",["cc","./SocketBridge.ts","./DungeonEscapeRecord.ts"],(function(t){var i,e,n,s;return{setters:[function(t){i=t.cclegacy,e=t.randomRangeInt},function(t){n=t.SocketBridge},function(t){s=t.DungeonEscapeRecord}],execute:function(){i._RF.push({},"d68b09aVpdIe4fyzggjYLzz","DungeonEscapeHandler",void 0);t("DungeonEscapeHandler",function(){function t(t,i,e,n,s,o,a){this._honstGameRecord=void 0,this._roomID=void 0,this._isHonster=!1,this._masterID="",this._playerID="",this._myNickname="",this._players=void 0,this._gameView=void 0,this._communityCards=[],this._gameView=t,this._gameView.requestApplicate=this._applicate.bind(this),this._isHonster=i,i&&(this._players=a),this._gameView.init(e,n,s),this.startGame(e,o,a)}var i=t.prototype;return i._applicate=function(t,i){void 0===i&&(i=""),this._isHonster?(console.log("====== Applicate "+t+" 事件不透過連線發給自己:",i),this["notify_"+t](this._roomID,t,i)):n.Instance.applicate(t,i)},i._broadcast=function(t,i,e){if(void 0===i&&(i=""),this._isHonster){if(e===this._playerID)return console.log("====== Broadcast "+t+" 事件不透過連線發給自己:\n",i);n.Instance.broadcast(t,i,e)}},i.startGame=function(t,i,e){this._roomID=t,e&&(this._isHonster=!0,this._honstGameRecord=new s,i?this._honstGameRecord.readData():this._honstGameRecord.players=e),n.Instance.addDispatcher(t,this,{alert:this.notify_alert,update_game_step:this.notify_update_game_step,exploration:this.notify_exploration,reconnect:this.notify_reconnect}),this._isHonster,i&&this._applicate("reconnect",this._playerID)},i.endGame=function(t){n.Instance.removeDispatcher(t,this),this._isHonster&&(this._honstGameRecord.clearData(),this._honstGameRecord=null),this._masterID="",this._playerID="",this._myNickname=""},i.onExploration=function(t,i){e(1,20);return[]},i.notify_alert=function(t,i,e){this._gameView.onShowTip(e)},i.notify_update_game_step=function(t,i,e){},i.notify_quick_view=function(t,i,e){var n,s;if(this._isHonster){n=e.split(" ")[0];this.onExploration(n,6),e=n+" "+this._communityCards,this._broadcast(i,e)}var o=e.split(" ");n=o[0],s=o[1],this._gameView.onExplorationEvent(n,s)},i.notify_exploration=function(t,i,e){var n,s,o;if(this._isHonster){var a=e.split(" ");e=(n=a[0])+" "+(s=this.onExploration(n,60))+" "+this._communityCards,this._broadcast(i,e)}var r=e.split(" ");n=r[0],s=r[1],o=r[2],this._gameView.onExplorationEvent(n,o,s)},i.notify_reconnect=function(t,i,e){this._gameView.onShowTip("重連"+t)},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/DungeonEscapeRecord.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RandomString.ts"],(function(e){var r,t,n;return{setters:[function(e){r=e.createClass},function(e){t=e.cclegacy},function(e){n=e.RandomString}],execute:function(){t._RF.push({},"baba1oKE25Nga8ScDrOg25J","DungeonEscapeRecord",void 0);var a="DE_GAME_RECORD_INFO",s=e("Role",function(e){return e[e.PLAYER=0]="PLAYER",e[e.MASTER=1]="MASTER",e}({})),o=e("GameStatus",function(e){return e[e.GAMING=0]="GAMING",e}({})),i=e("AreaDirection",function(e){return e[e.UP=0]="UP",e[e.LEFT=1]="LEFT",e[e.DOWN=2]="DOWN",e[e.RIGHT=3]="RIGHT",e}({}));e("DungeonEscapeRecord",function(){function e(){this.masterID="",this._players={},this._roundPlayers=[],this._roundIndex=0,this._areaInfos={},this._doors={}}var t=e.prototype;return t.addPlayer=function(e,r,t){this._players[e]={nickname:r,gameStatus:t,role:s.PLAYER},this._roundPlayers=Object.keys(this._players)},t.delPlayer=function(e){delete this._players[e]},t.selectPlayer=function(e){return this._players[e]},t.nextPlayer=function(){this._roundIndex=(this._roundIndex+1)%this._roundPlayers.length},t.clearData=function(){this._players={},this._roundPlayers.length=0,this._roundIndex=0,localStorage.removeItem(a)},t.readData=function(){var e=JSON.parse(localStorage.getItem(a));console.log("Read data:",e),e&&(this.masterID=e.masterID,this._players=e.players,this._roundPlayers=e.roundPlayers)},t.writeData=function(){var e={masterID:this.masterID,players:this._players,roundPlayers:this._roundPlayers};localStorage.setItem(a,JSON.stringify(e))},t.dropAnswerHandCards=function(e,r){this.dropHandCard(this._players[e].answerHandCards,r)},t.dropHandCard=function(e,r){return r.every((function(r){return e.find((function(e,t,n){if(e===r)return n.splice(t,1),!0}))}))},t.createArea=function(e){var r;this._areaInfos[e]={doors:(r={},r[i.UP]="",r[i.LEFT]="",r[i.DOWN]="",r[i.RIGHT]="",r)}},t.linkDoor=function(e,r,t){var a,s,o,u,c=r.split("-"),l=parseInt(c[0]),d=parseInt(c[1]);switch(a=l+"-"+d,o=this._areaInfos[a],e){case i.UP:d++;break;case i.LEFT:l--;break;case i.DOWN:d--;break;case i.RIGHT:l++}s=l+"-"+d;var h=n.generate();t?(u=this._areaInfos[s],o.doors[e]=h,u.doors[(e+2)%4]=h):(this.createArea(s),this._areaInfos[s].doors[e]=h),this._doors[h]={rooms:[a,s]}},r(e,[{key:"players",set:function(e){var r=this;this._roundPlayers=Object.keys(e),this._roundPlayers.forEach((function(t){r.addPlayer(t,e[t],o.GAMING)}))}},{key:"roundPlayers",get:function(){return this._roundPlayers}}]),e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/DungeonEscapeView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./HandCards.ts","./EventManager.ts","./TipText.ts"],(function(e){var n,t,i,r,o,a,u,l,c,s,p,d,f;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,u=e.Label,l=e.Node,c=e.Vec3,s=e.Component},function(e){p=e.HandCards},function(e){d=e.EventManager},function(e){f=e.TipType}],execute:function(){var b,g,y,w,v,h,m,C,D,H,E;o._RF.push({},"86bf6dCbFdKo7HRujQDV1To","DungeonEscapeView",void 0);var z=a.ccclass,L=a.property;e("DungeonEscapeView",(b=z("DungeonEscapeView"),g=L(p),y=L(p),w=L(u),v=L(l),b((C=n((m=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,i(n,"questionHandCards",C,r(n)),i(n,"answerHandCards",D,r(n)),i(n,"infoLabel",H,r(n)),i(n,"blockNode",E,r(n)),n}t(n,e);var o=n.prototype;return o.onLoad=function(){this.node.setPosition(c.ZERO)},o.sendMessage=function(e){d.instance.emit(f.Normal,e)},n}(s)).prototype,"questionHandCards",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(m.prototype,"answerHandCards",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=n(m.prototype,"infoLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(m.prototype,"blockNode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=m))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/DungeonTest.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StoryData.ts","./Rogue.ts"],(function(e){var t,n,r,o,i,u,a,c,s;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,u=e._decorator,a=e.Component},function(e){c=e.StoryData},function(e){s=e.default}],execute:function(){var l,p,f,g,y;i._RF.push({},"f4526RX+5hPcLHQlE2ZMXV7","DungeonTest",void 0);var D=u.ccclass,h=u.property;e("DungeonTest",(l=D("DungeonTest"),p=h(s),l((y=t((g=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),u=0;u<n;u++)i[u]=arguments[u];return t=e.call.apply(e,[this].concat(i))||this,r(t,"rogue",y,o(t)),t}return n(t,e),t.prototype.start=function(){var e=(new c).dungeons.abcd234;this.rogue.setDungeonData(e)},t}(a)).prototype,"rogue",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=g))||f));i._RF.pop()}}}));

System.register("chunks:///_virtual/DynamicWidthScrollView.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var t,n,e,o,r,l,c,a,s,h,u,p;return{setters:[function(i){t=i.applyDecoratedDescriptor,n=i.inheritsLoose,e=i.initializerDefineProperty,o=i.assertThisInitialized,r=i.createForOfIteratorHelperLoose},function(i){l=i.cclegacy,c=i._decorator,a=i.ScrollView,s=i.UITransform,h=i.Vec3,u=i.v3,p=i.Component}],execute:function(){var d,m,f,w,g,v,W,y;l._RF.push({},"97f47FpcPJIjKbS1g4ndve0","DynamicWidthScrollView",void 0);var V=c.ccclass,b=c.property;i("DynamicWidthScrollView",(d=V("DynamicWidthScrollView"),m=b(a),d((g=t((w=function(i){function t(){for(var t,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=i.call.apply(i,[this].concat(r))||this,e(t,"scrollView",g,o(t)),e(t,"maxWidth",v,o(t)),e(t,"minWidth",W,o(t)),e(t,"spacingX",y,o(t)),t.centerPosition=void 0,t}n(t,i);var l=t.prototype;return l.onLoad=function(){var i,t;this.scrollView?(this.centerPosition=this.scrollView.getComponent(s).convertToWorldSpaceAR(new h(0,0,0)),null==(i=this.scrollView)||null==(t=i.node)||t.on("scrolling",this.onScrolling,this)):console.warn("ScrollView component is not assigned.")},l.onDestroy=function(){var i,t;null==(i=this.scrollView)||null==(t=i.node)||t.off("scrolling",this.onScrolling,this)},l.onScrolling=function(){for(var i,t=this.scrollView.content.children,n=this.scrollView.content.getComponent(s),e=r(t);!(i=e()).done;){var o=i.value,l=n.convertToWorldSpaceAR(o.position),c=h.distance(l,this.centerPosition),a=this.calculateWidth(c);o.getComponent(s).width=a;var p=Math.min(1+a/this.maxWidth,1.3);o.scale=u(p,p,1)}},l.calculateWidth=function(i){var t=this.scrollView.node.getComponent(s).width/2,n=this.minWidth+(this.maxWidth-this.minWidth)*(1-i/t);return n=Math.max(this.minWidth,Math.min(this.maxWidth,n))},t}(p)).prototype,"scrollView",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(w.prototype,"maxWidth",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),W=t(w.prototype,"minWidth",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),y=t(w.prototype,"spacingX",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),f=w))||f));l._RF.pop()}}}));

System.register("chunks:///_virtual/EffectManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,f;return{setters:[function(e){t=e.createClass},function(e){f=e.cclegacy}],execute:function(){f._RF.push({},"b2f1eX9FQRE4L/7VMvooGDE","EffectManager",void 0),e("EffectManager",function(){function e(){this.effects=new Map}var f=e.prototype;return f.addEffect=function(e,t){var f=this.effects.get(e)||[];f.push(t),this.effects.set(e,f),console.log("this.effects:",JSON.stringify(this.effects))},f.removeEffect=function(e,t){var f=this.effects.get(e)||[],n=f.indexOf(t);-1!==n&&f.splice(n,1),0===f.length&&this.effects.delete(e),console.log("Effect removed from "+e.name)},f.applySkillEffects=function(e,t){},f.updateEffects=function(){var e=this;console.log("updateEffects",this.effects),this.effects.forEach((function(t,f){f.resetBonuses(),e.effects.set(f,t.filter((function(t){return t.duration>0&&(t.duration--,!(t.duration<=0)||(e.removeEffect(f,t),!1))}))),0===t.length&&e.clearEffects(f)}))},f.clearEffects=function(e){this.effects.delete(e),console.log("All effects cleared from "+e.name)},t(e,null,[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}())._instance=void 0,f._RF.pop()}}}));

System.register("chunks:///_virtual/EventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t;return{setters:[function(e){n=e.createClass},function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"65c67rVRUBMuLluwFwAgOe1","EventManager",void 0),e("EventManager",function(){function e(){this._listeners=new Map}var t=e.prototype;return t.on=function(e,n){this._listeners.has(e)||this._listeners.set(e,[]),this._listeners.get(e).push(n)},t.emit=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),s=1;s<n;s++)t[s-1]=arguments[s];this._listeners.has(e)&&this._listeners.get(e).forEach((function(e){return e.apply(void 0,t)}))},t.off=function(e,n){if(this._listeners.has(e)){var t=this._listeners.get(e),s=t.indexOf(n);s>-1&&t.splice(s,1)}},n(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}())._instance=void 0,t._RF.pop()}}}));

System.register("chunks:///_virtual/EventSystem.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"211fa4FmRNN/rOqFXMgfjsU","EventSystem",void 0);t("NotifyEvent",(function(t,e){this.type=void 0,this.detail=void 0,this.type=t,this.detail=e})),t("EventBus",function(){function t(){this.listeners={}}var e=t.prototype;return e.subscribe=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e.unsubscribe=function(t,e){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter((function(t){return t!==e})))},e.publish=function(t){(this.listeners[t.type]||[]).forEach((function(e){return e(t.detail)}))},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/ExplorationCard.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Card.ts"],(function(e){var r,t,o,u,n;return{setters:[function(e){r=e.inheritsLoose,t=e.createClass},function(e){o=e.cclegacy,u=e.randomRangeInt},function(e){n=e.Card}],execute:function(){o._RF.push({},"0d421D24X1A45qQ4UMTsZR2","ExplorationCard",void 0);var s=e("CardSuit",function(e){return e[e.Prop=0]="Prop",e[e.Clue=1]="Clue",e[e.Doubt=2]="Doubt",e[e.Presage=3]="Presage",e}({}));e("ExplorationCard",function(e){function o(){for(var r,t=arguments.length,o=new Array(t),u=0;u<t;u++)o[u]=arguments[u];return(r=e.call.apply(e,[this].concat(o))||this)._intro="",r}r(o,e);var n=o.prototype;return n.getPropSetting=function(){var e=["夾層","書頁","文字","藏匿點","密道","機關"];return e[u(0,e.length-1)]},n.getClueSetting=function(){var e=["刻痕","沾染","燒焦","足跡","排序","留言","紀錄","手感"];return e[u(0,e.length-1)]},n.getDoubtSetting=function(){var e=["滅跡","缺失","短少","矛盾","陌生","異樣"];return e[u(0,e.length-1)]},n.getPresageSetting=function(){var e=["記憶","好奇","違和","不安","導引","聯想"];return e[u(0,e.length-1)]},n.getReasoning=function(e){var r=[this.test0(),this.test00(),this.test1(),this.test2(),this.test3(),this.test4(),this.test5()];return r[e%r.length]},n.test0=function(){var e,r;return{question:"這一道門上鎖了，找出[鑰匙]後即可<color=#ffcc00>開門</color>。",cards:[(e={},e[s.Prop]="[鑰匙]掛在牆壁上。",e[s.Presage]="牆上閃著銀色光芒，是一把[鑰匙]",e[s.Clue]="牆上有一把[鑰匙]，似乎可以用來開門。",e[s.Doubt]="[鑰匙]？看來這個難題太過容易。",e),(r={},r[s.Prop]="房間空盪盪，沒有其他東西。",r[s.Presage]="地板上似乎有些腐朽。",r[s.Clue]="牆上掛著一個小物件。",r[s.Doubt]="門真的鎖上了嗎？",r)]}},n.test00=function(){var e,r,t;return{question:"對應著上鎖的紅色門，找出[紅鑰匙]後即可<color=#ffcc00>開門</color>。",cards:[(e={},e[s.Prop]="[綠鑰匙]掛在牆壁上。",e[s.Presage]="牆上閃著銀色光芒，是一把[綠鑰匙]",e[s.Clue]="牆上有一把[綠鑰匙]，似乎可以用來開門。",e[s.Doubt]="[綠鑰匙]？看來這個難題太過容易。",e),(r={},r[s.Prop]="桌子上有一串鑰匙。",r[s.Presage]="藍色的[藍鑰匙]在桌子上很顯眼。",r[s.Clue]="桌上有一把[藍鑰匙]，似乎可以用來開門。",r[s.Doubt]="[藍鑰匙]？看來這個難題太過容易。",r),(t={},t[s.Prop]="枯死的盆栽在角落有些可憐。",t[s.Presage]="似乎在盆栽的深些有個紅色的東西",t[s.Clue]="探索盆栽後，有一個紅色的[紅鑰匙]。",t[s.Doubt]="盆栽是紅色的，是否跟紅色的門與鑰匙有關？",t)]}},n.test1=function(){var e,r,t;return{question:"輸入[三碼數字]的密碼解鎖[密碼鎖]後，順利打開[盒子]後從裡面取出一把精美的<color=#ffcc00>寶石匕首</color>。",cards:[(e={},e[s.Prop]="牆角邊有一個普通的木桶。",e[s.Presage]="木桶似乎有些新的小洞口。",e[s.Clue]="木桶的裡面有一個小小的洞，透過洞望進去可以看到一張寫著[三碼數字]的小紙條。",e[s.Doubt]="木桶的洞似乎被不斷挖開過，也許有些人想從中掏出什麼？",e),(r={},r[s.Prop]="[盒子]用[密碼鎖]上鎖了。",r[s.Presage]="[盒子]有些沉重，裡面裝著什麼。",r[s.Clue]="[盒子]上的鎖，是個三位數的[密碼鎖]。",r[s.Doubt]="[盒子]有個鎖，裡面的東西似乎很重要？",r),(t={},t[s.Prop]="一扇被破壞過的窗戶。",t[s.Presage]="窗戶上的窗簾看起來很破舊。",t[s.Clue]="窗簾似乎被巨大的爪子抓過…",t[s.Doubt]="窗戶的玻璃全被敲破，因此釘上許多木板，也許曾經有人想突破進來？",t)]}},n.test2=function(){var e,r,t,o;return{question:"透過寫在[照片]背面的開啟方法，打開[密封罐]後從中掏出一卷<color=#ffcc00>紅印文件</color>。",cards:[(e={},e[s.Prop]="展示櫃內部陳列著各式各樣的收藏品。",e[s.Presage]="當靠近展示櫃時，可以聽到微弱的機械運作聲。",e[s.Clue]="展示櫃的一個[密封罐]的位置發現了被頻繁觸碰或移動的磨損痕跡。",e[s.Doubt]="展示櫃中一件展品標籤與其他似乎略有不同",e),(r={},r[s.Prop]="展示櫃的[密封罐]中裝有一卷羊皮紙。",r[s.Presage]="[密封罐]外觀與它應有的重量還來得輕。",r[s.Clue]="[密封罐]的蓋子有特殊的旋轉機制，需按照特定順序旋轉才能打開。",r[s.Doubt]="罐內的物品看起來與展示櫃中其它展示物毫無關聯。",r),(t={},t[s.Prop]="[文書匣]內部分類細緻，但其中一個隔層異常緊固。",t[s.Presage]="打開[文書匣]時，一股陳年的紙張氣味撲面而來，中間卻夾帶著一絲[新墨水]的氣味。",t[s.Clue]="文書匣中一份文件因[紅色印記]而十分顯眼，但明顯是偽造的，用來掩蓋真實文件的存在。",t[s.Doubt]="[文書匣]中某些文件顯示出被重新放置的痕跡，似乎有人試圖隱藏或更改某些信息。",t),(o={},o[s.Prop]="相框是普通的裝飾品，背板可以拆卸取出[照片]",o[s.Presage]="觀察相框時，可以發現框架的某部分略有色差。",o[s.Clue]="相框中的[照片]的背面寫上如何開啟[密封罐]的方法。",o[s.Doubt]="照片中的人物與房間內其他照片的人物不同",o)]}},n.test3=function(){var e,r,t,o;return{question:"在[矮櫃]裡發現了一本[記事本]，用[鑰匙]開啟小鎖後從書頁中抽出一張<color=#ffcc00>邀請卡</color>。",cards:[(e={},e[s.Prop]="一張精緻的[茶几]，表面雕刻複雜，似乎能夠滑動，隱藏著一個[秘密抽屜]。",e[s.Presage]="靠近[茶几]時，你注意到桌面略有灰塵，但一個區域異常潔净，似乎有物體經常被放置在此。",e[s.Clue]="[茶几]上有明顯的刮痕，好像有重物被頻繁拖動過。",e[s.Doubt]="[茶几]的一個角落經常被某物撞擊，使得那裡的木材顯得略微凹陷。",e),(r={},r[s.Prop]="[矮櫃]裡藏有多個抽屜和小隔間，一個隔間似乎比其他的更難打開。",r[s.Presage]="打開[矮櫃]的時候，摸索後發現[木夾板]是用一本[記事本]偽裝而成的。",r[s.Clue]="[矮櫃]的背板有輕微的移動痕跡，暗示背後可能有[隱藏空間]。",r[s.Doubt]="[矮櫃]頂面有一塊顏色不匹配的[木夾板]，看起來是後來更換的。",r),(t={},t[s.Prop]="一本木制封面的記事本，皮革書封用[小鎖]鎖住無法打開這本記事，似乎藏有重要的秘密。",t[s.Presage]="輕撫記事本的書緣時，感覺到某些頁面比其他頁厚重。",t[s.Clue]="記事本的邊緣有奇怪的磨損，顯示經常被翻到某幾頁。",t[s.Doubt]="木製的封面將記事本偽裝成木夾板，是否意味著記事本的內容十分重要？",t),(o={},o[s.Prop]="這支筆外形奢華，裝有特殊的墨水，似乎只有特定的光線下才能看見其書寫的內容。",o[s.Presage]="拿起筆寫字時較沉重，且筆身搖動時有異音，讓人感覺它不只是用來寫字。",o[s.Clue]="筆桿被精心設計，可以轉動中間的金環，變成一支[鑰匙]。",o[s.Doubt]="筆的一端略顯磨損，不符合其整體保存狀態，似乎常被用於非正常用途？",o)]}},n.test4=function(){var e,r,t;return{question:"掀開[紅地毯]後發現下面有個方形[卡槽]，將[八音盒]放入其中後開始運作並奏著美妙的旋律，隨之在中心發現<color=#ffcc00>源質核心</color>。",cards:[(e={},e[s.Prop]="一幅描繪古典音樂家的[畫作]。",e[s.Presage]="畫框略顯老舊，但特定角度下會發現一個簽名。",e[s.Clue]="[畫作]的一個角落藏有微小的文字，提供了開啟[木盒]的線索。",e[s.Doubt]="[畫作]的繪製日期與畫框打印的日期相差很遠。",e),(r={},r[s.Prop]="精緻的小[木盒]，從[畫作]中的文字破解後發現這是一個[八音盒]。",r[s.Presage]="觸摸[木盒]時，你感受到一絲不尋常的震動，似乎內部裝有機械裝置，並繪著[音符]。",r[s.Clue]="[木盒]的側面雕刻著[音符]，與[紅地毯]上的圖案驚人地相似。",r[s.Doubt]="[木盒]的鎖看上去新近更換，與盒子的整體古老感覺不符。",r),(t={},t[s.Prop]="厚重的[紅地毯]，其圖案精美。",t[s.Presage]="踩上[紅地毯]後有個區塊有些凹陷，掀開後發現下面有個方形[卡槽]，與[木盒]的底部符合",t[s.Clue]="[紅地毯]的邊緣繪製的圖形與[木盒]底部的方形雕刻相似。",t[s.Doubt]="[紅地毯]有塊凹陷，掀開後發現下面有個方形[卡槽]",t)]}},n.test5=function(){var e,r,t,o,u,n,a;return{question:"跟隨著[箭頭花紋]發現到牆壁上的[畫作]後方的空間，並發現其中的[保險箱]，用薄片狀的[鐵片鑰匙]來開啟，獲得了<color=#ffcc00>金色鑰匙</color>。",cards:[(e={},e[s.Prop]="桌子上放置一個[花瓶]",e[s.Presage]="調整長短不一的桌腳使桌子穩定後，發現桌子底部貼有一本[日記]。",e[s.Clue]="轉動桌面讓符號相呼應後，一個[隱藏抽屜]被啟動，藏有一封[書信]。",e[s.Doubt]="試著解釋桌角磨損的原因後發現桌腳是可以旋轉的，擰開後掉出一張[紙條]。",e),(r={},r[s.Prop]="拉動特定的[書籍]可啟動機關。",r[s.Presage]="將錯位的[書籍]調整正確位置後，[書櫃]的一個[暗格]彈開，裡面有一把鑰匙。",r[s.Clue]="書脊上的隱喻指向[箭頭花紋]引導提示到[書櫃]後方，摸索後發現背後有一把薄片狀的[鐵片鑰匙]。",r[s.Doubt]="填補遺失[書籍]的空位後，觸發一陣機關轉動的聲音後，書櫃旁邊的[隱藏抽屜]打開，裡面有一把鑰匙。",r),(t={},t[s.Prop]="從桌子底下發現一本[日記]，提及[書櫃]的角落藏有某些秘密。",t[s.Presage]="好奇查找[日記]提及的[書櫃]上方角落，找到藏著的一把薄片狀的[鐵片鑰匙]。",t[s.Clue]="日記中提到一個特定日期，按照日期順序排列[書櫃]上的書，彈出[暗格]，發現一個[箭頭花紋]。",t[s.Doubt]="發現並解決[日記]中日期的矛盾後，從日記的暗號中獲得[隱藏抽屜]的提示。",t),(o={},o[s.Prop]="信中提到的秘密會面地點，實際上是指[羊毛毯]下的藏匿著重要的東西。",o[s.Presage]="地點相關聯的線索引導到一個秘密的[隱藏抽屜]，鑰匙孔適用一種薄片狀的鑰匙來開啟。",o[s.Clue]="信件邊緣的撕裂部分藏有一把薄片狀的[鐵片鑰匙]。",o[s.Doubt]="解開時間矛盾後，發現[羊毛毯]下方的[隱藏抽屜]，鑰匙孔適用一種薄片狀的鑰匙來開啟。",o),(u={},u[s.Prop]="移動[畫作]發現牆壁中的[保險箱]，鑰匙孔適用一種薄片狀的鑰匙來開啟。",u[s.Presage]="機械運作的聲音來源是牆後的一個隱藏門，移動[畫作]後可以發現牆壁中的[保險箱]。",u[s.Clue]="探索裂縫延伸而去的方向，意外發現隱藏牆後隱藏著一個放置[保險箱]的空間。",u[s.Doubt]="調查後發現[畫作]與房間的空間細節不符合後，找到畫背後的[保險箱]。",u),(n={},n[s.Prop]="掀開[羊毛毯]後，發現下方的[隱藏抽屜]。",n[s.Presage]="感到[羊毛毯]下的空洞迴響，發現下方的[隱藏抽屜]，使用薄片狀的鑰匙開啟後發現了[箭頭花紋]。",n[s.Clue]="地板符號是一個方向導引，使用薄片狀的鑰匙開啟後發現了[箭頭花紋]。感到[羊毛毯]下的空洞迴響，發現下方的[隱藏抽屜]，使用薄片狀的鑰匙開啟後發現了[箭頭花紋]。",n[s.Doubt]="日記的圖案與地板符號匹配後，使用薄片狀的鑰匙開啟後發現了[箭頭花紋]。",n),(a={},a[s.Prop]="花瓶的底部轉動後，發現藏有一把薄片狀的[鐵片鑰匙]。",a[s.Presage]="花瓶被移動的痕跡指向底座下的秘密抽屜，裡面有一把薄片狀的[鐵片鑰匙]。",a[s.Clue]="花瓶內部的隱藏底部打開，裡面藏有一把薄片狀的[鐵片鑰匙]。",a[s.Doubt]="花的新鮮度異常指引檢查花瓶水的底部，找到一把薄片狀的[鐵片鑰匙]。",a)]}},t(o,[{key:"intro",set:function(e){this._intro=e}}]),o}(n));o._RF.pop()}}}));

System.register("chunks:///_virtual/FillBlanks.ts",["cc"],(function(e){var r;return{setters:[function(e){r=e.cclegacy}],execute:function(){r._RF.push({},"29ba5DJel5CtJ7/DFwmBiNL","FillBlanks",void 0),e("FillBlanks",function(){function e(){}return e.answerQuestion=function(e,r,t){void 0===t&&(t="#FFFF00");var n=r.slice();return e.replace(/_/g,(function(e){return"<color="+t+"><u>"+(n.shift()||"_")+"</u></c>"}))},e.replaceAndStore=function(e,r,t){var n=[];return{replacedText:e.replace(r,(function(e,r){return n.push(r),t})),storedTexts:n}},e.replaceKeywordsWidthBlanks=function(e){for(var r=[],t=[],n=0;n<e.length;n++){var s=this.replaceAndStore(e[n],/\[(.*?)\]/g,"_"),c=s.replacedText,u=s.storedTexts;r.push(c),t.push(u)}return{replacedTexts:r,storedTexts:t}},e.replaceMarkedWithKeywords=function(r,t){for(var n=[],s=[],c=0;c<r.length;c++){var u=r[c],a=this.markedWithKeywords(u,t),o=a.replacedText,i=a.storedTexts;n.push(e.answerQuestion(o,i)),s.push(i)}return{replacedTexts:n,storedTexts:s}},e.markedWithKeywords=function(e,r){var t=this;return r.forEach((function(r){e.indexOf(r)>-1&&(e=t.replaceTextInBrackets(e,r))})),this.replaceAndStore(e,/\[(.*?)\]/g,"_")},e}()).replaceTextInBrackets=function(e,r){return e.replace(/\[(.*?)\]/g,(function(e,t){return t===r?r:e}))},r._RF.pop()}}}));

System.register("chunks:///_virtual/FirebaseBridge.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.esm.js","./index-77658911.js","./index.esm20172.js","./index.esm20173.js","./tslib.es6.mjs","./index.esm2017.js"],(function(e){var n,t,o,r,i,a,c,s,u,l,f,p,d,v;return{setters:[function(e){n=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){o=e.cclegacy},null,function(e){r=e.ab,i=e.o},function(e){a=e.initializeApp},null,null,function(e){c=e.onValue,s=e.ref,u=e.off,l=e.set,f=e.get,p=e.child,d=e.push,v=e.getDatabase}],execute:function(){o._RF.push({},"486ceOYX8JNTqCqKaRQagmq","FirebaseBridge",void 0);var h,g="DungeonEscape",m={},b=(e("default",function(){function e(){var e=a({apiKey:"AIzaSyAc5PRwmE14gBH5az8TSoqs9aBrQ8YWa4o",authDomain:"fir-test-756e1.firebaseapp.com",databaseURL:"https://fir-test-756e1.firebaseio.com",projectId:"fir-test-756e1",storageBucket:"fir-test-756e1.appspot.com",messagingSenderId:"182531440628"});h=v(e)}var o=e.prototype;return o.signInWithGoogleEmail=function(){var e=n(t().mark((function e(n,o){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r(i(),n,o);case 3:return a=e.sent,e.abrupt("return",a.user.uid);case 7:throw e.prev=7,e.t0=e.catch(0),new Error("登入失敗: "+e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,t){return e.apply(this,arguments)}}(),o._onReceive=function(e,n){var t,o=n,r="",i=n.indexOf(" ");i>0&&(o=n.slice(0,i),r=n.slice(i+1)),null==(t=m[e])||t.forEach((function(n){return n.onReceive(e,o,r)}))},o.addDispatcher=function(e,n,t){if(""===e)throw new Error("connectID 不能為空白");var o=m[e]||[];o.some((function(e){if(e.scope===n)return Object.keys(t).forEach((function(n){return e.callbackMap[n]=t[n]})),!0}))||o.push(new b(n,t)),m[e]=o},o.removeDispatcher=function(e,n){var t=m[e];if(t){var o=t.findIndex((function(e){return e.scope===n}));-1!==o&&t.splice(o,1),0===t.length&&delete m[e]}},o.addConnection=function(e,n,t){var o=this;void 0===t&&(t="");var r=g+"/C/"+e+"/"+n+"/"+t;c(s(h,r),(function(r){var i=r.val();console.log("[NOTIFY]",n,t,":",i),i&&function(n){o._onReceive(e,n)}(i)})),console.log("加入監聽:",r)},o.delConnection=function(e,n,t){void 0===t&&(t="");var o=g+"/C/"+e+"/"+n+"/"+t;u(s(h,o)),console.log("移除監聽:",o)},o.uploadInfo=function(e,n,t,o,r){void 0===r&&(r="");var i=t?n+" "+t:n;l(s(h,g+"/C/"+e+"/"+o+"/"+r),i)},o.loadAsync=function(e,n){var t=g+"/D/"+e+"/";return new Promise((function(o){f(n?p(s(h,t),n):s(h,t)).then((function(t){var r=t.val();o(r),console.log(e,n,"::::",r)}))}))},o.addDataLabel=function(e,n){void 0===n&&(n=-1);var t=g+"/D";return e?console.log(e+"刷新資料:"+JSON.stringify(n)):e=d(s(h,t)).key||"",l(s(h,t+"/"+e+"/"),n),e},o.delDataLabel=function(e){l(s(h,"DungeonEscape/D/"+e+"/"),null)},e}()),function(){function e(e,n){this.scope=void 0,this.callbackMap=void 0,this.scope=e,this.callbackMap=n}return e.prototype.onReceive=function(e,n,t){var o=this.callbackMap[n];if(o)try{o.call(this.scope,e,n,t)}catch(e){console.error("執行回調時錯誤: "+e.message)}},e}());o._RF.pop()}}}));

System.register("chunks:///_virtual/FloatingTextComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,a,l,s,u,c,p,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,l=t.Color,s=t.Vec3,u=t.Label,c=t.instantiate,p=t.tween,b=t.Component}],execute:function(){var f,g,m,v,h,y,d,C,w,P,z,L,x;r._RF.push({},"6e930lNmNxI/bj5j7OKSnzK","FloatingTextComponent",void 0);var F=a.ccclass,T=a.property;t("FloatingTextComponent",(f=F("FloatingTextComponent"),g=T(l),m=T(l),v=T(s),h=T(s),y=T(u),f((w=e((C=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"positiveColor",w,o(e)),i(e,"negativeColor",P,o(e)),i(e,"startPoint",z,o(e)),i(e,"endPoint",L,o(e)),i(e,"templateLabel",x,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){this.templateLabel.node.active=!1},r.showNumber=function(t,e){var n=c(this.templateLabel.node);n.setParent(this.node),n.active=!0;var i=n.getComponent(u);i.string=(t>=0?"+":"")+t.toString(),i.color=t>=0?this.positiveColor:this.negativeColor,n.setPosition(this.startPoint),p(n).to(1.5,{position:this.endPoint},{easing:"elasticOut"}).call((function(){n.destroy(),null==e||e()})).start()},e}(b)).prototype,"positiveColor",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(0,255,0)}}),P=e(C.prototype,"negativeColor",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(255,0,0)}}),z=e(C.prototype,"startPoint",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s(0,0,0)}}),L=e(C.prototype,"endPoint",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s(0,100,0)}}),x=e(C.prototype,"templateLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=C))||d));r._RF.pop()}}}));

System.register("chunks:///_virtual/FoldCards.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,o,n,r,i,l,c,s,a,d,u,h,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,l=e._decorator,c=e.Node,s=e.Button,a=e.Sprite,d=e.Color,u=e.instantiate,h=e.Label,C=e.Component}],execute:function(){var p,f,_,g,v,b,y;i._RF.push({},"a78ae3xgKlLYqn9+yGYTQTS","FoldCards",void 0);var m=l.ccclass,R=l.property;e("FoldCards",(p=m("FoldCards"),f=R(c),_=R(s),p((b=t((v=function(e){function t(){for(var t,o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return t=e.call.apply(e,[this].concat(i))||this,n(t,"cardRoot",b,r(t)),n(t,"sendButton",y,r(t)),t.eventSendCallback=null,t._secletedCards=[],t.selectMax=0,t._oriColor=void 0,t}o(t,e);var i=t.prototype;return i.show=function(e){this.node.active=e,this.sendButton.node.active=!1,this._secletedCards.length=0},i.list=function(e,t){var o=this,n=this.cardRoot.children;n.forEach((function(e){return e.active=!1}));var r=n[0].getComponent(a).color;this._oriColor=new d(r.r,r.g,r.b,r.a),e.forEach((function(e,r){var i=n[r];i||((i=u(n[0])).parent=o.cardRoot),i.active=!0,i.getComponentInChildren(h).string=e,i.off("click"),i.on("click",(function(){null==t||t(e),-1===o._secletedCards.indexOf(e)?(o._secletedCards.push(e),i.getComponent(a).color=d.RED):(o._secletedCards.splice(o._secletedCards.findIndex((function(t){return t===e})),1),i.getComponent(a).color=o._oriColor),console.log("this._secletedCards:",o._secletedCards),o.sendButton.node.active=o._secletedCards.length===o.selectMax}),o)}))},i.onSendButtonClicked=function(){var e,t=this;console.log("this._secletedCards:",this._secletedCards),this.cardRoot.children.forEach((function(e){return e.getComponent(a).color=t._oriColor})),null==(e=this.eventSendCallback)||e.call(this,this._secletedCards.slice()),this._secletedCards.length=0},t}(C)).prototype,"cardRoot",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(v.prototype,"sendButton",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=v))||g));i._RF.pop()}}}));

System.register("chunks:///_virtual/GameEvents.ts",["cc"],(function(a){var e;return{setters:[function(a){e=a.cclegacy}],execute:function(){e._RF.push({},"1950a+JJJlGvJeGTM+lZbMJ","GameEvents",void 0);a("GameLogicEvent",function(a){return a.GameStart="game-logic-game-start",a.GameEnd="game-logic-game-end",a.GameResume="game-logic-game-resume",a.GamePause="game-logic-game-pause",a.GameRoundStart="game-logic-game-round-start",a.GameRoundStartShowCards="game-logic-game-round-start-show-cards",a.GameRoundStartConfirmSelection="game-logic-game-round-start-confirm-selection",a.GameRoundPlayerDiscardCards="game-logic-game-round-player-discard-cards",a.GameRoundStartDiscardCards="game-logic-game-round-start-discard-cards",a.GameRoundStartDealCards="game-logic-game-round-start-deal-cards",a.GameRoundStartShowCommunityCards="game-logic-game-round-start-show-community-cards",a.GameRoundStartShowPlayerHands="game-logic-game-round-start-show-player-hands",a.GameRoundStartShowDiscardPile="game-logic-game-round-start-show-discard-pile",a.GameRoundNextPlayerTurn="game-logic-game-round-next-player-turn",a.GameRoundEndShowCards="game-logic-game-round-end-show-cards",a}({})),a("GameUIEvent",function(a){return a.GameStart="game-ui-game-start",a.GameEnd="game-ui-game-end",a.DeckCardSelected="game-ui-card-selected",a.DeckCardUnselected="game-ui-card-unselected",a.DeckCardDiscard="game-ui-card-discard",a.ShowCardConditions="game-ui-show-card-conditions",a.ShowCardConditions2="game-ui-show-card-conditions2",a}({})),a("DeckPileEvent",function(a){return a.ShowCards="deck-card-show-cards",a.DiscardCards="deck-card-discard-cards",a.DealCommunityCards="deck-card-deal-cards",a.DealPlayerCards="deck-card-deal-player-cards",a.DeckGatherings="deck-card-gatherings",a.HideCards="deck-card-hide-cards",a}({})),a("CommunityCardEvent",function(a){return a.DealCards="community-card-deal-cards",a.ShowCards="community-card-show-cards",a.CompareCards="community-card-campare-cards",a}({})),a("PlayerHandCardEvent",function(a){return a.DealCards="player-hand-card-deal-cards",a.ShowCards="player-hand-card-show-cards",a.CompareCards="player-hand-card-compare-cards",a.PlayCards="player-hand-card-play-cards",a}({})),a("WordPuzzleGameLogicEvent",function(a){return a.WordPuzzleGameStart="word-puzzle-game-start",a.WordPuzzleGameEnd="word-puzzle-game-end",a.ShowQuestion="word-puzzle-game-logic-show-question",a.ShowAnswer="word-puzzle-game-logic-show-answer",a.ShowHint="word-puzzle-game-logic-show-hint",a.TexasGameStart="word-puzzle-game-logic-texas-game-start",a.TexasGameResume="word-puzzle-game-logic-texas-game-resume",a}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/HandCards.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DynamicWidthScrollView.ts"],(function(e){var t,o,n,i,r,l,s,c,a,d,u,h,p,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,s=e.Node,c=e.Button,a=e.Color,d=e.Sprite,u=e.instantiate,h=e.Label,p=e.Component},function(e){C=e.DynamicWidthScrollView}],execute:function(){var f,_,b,g,v,m,w,y,P,x,S;r._RF.push({},"880f34hHldLa4t21nW2dLUl","HandCards",void 0);var k=l.ccclass,B=l.property;e("HandCards",(f=k("HandCards"),_=B(s),b=B(c),g=B(C),v=B(a),f((y=t((w=function(e){function t(){for(var t,o=arguments.length,r=new Array(o),l=0;l<o;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,n(t,"cardRoot",y,i(t)),n(t,"sendButton",P,i(t)),n(t,"dwScrollView",x,i(t)),n(t,"selectedColor",S,i(t)),t.eventSendCallback=null,t.selectMax=0,t._secletedCards=[],t._buttonTemps=[],t._oriColor=void 0,t._oriPositionY=void 0,t}o(t,e);var r=t.prototype;return r.show=function(e){console.log(e?"顯示":"隱藏",this.node.name),this.node.active=e,this.sendButton.node.active=!1,this._secletedCards.length=0},r.list=function(e,t){var o,n=this,i=this.cardRoot.children,r=i[0].getComponentInChildren(d).color;this._oriColor=new a(r.r,r.g,r.b,r.a),this._oriPositionY=i[0].position.y,i.forEach((function(e){e.setPosition(e.position.x,n._oriPositionY),e.active=!1})),this._buttonTemps.length=0,e.forEach((function(e,o){var r=i[o];r||((r=u(i[0])).parent=n.cardRoot),r.active=!0;var l=r.getComponentInChildren(c);l&&(l.enabled=!1,r.getComponentInChildren(h).string=e,l.node.off("click"),l.node.on("click",(function(){-1===n._secletedCards.indexOf(e)?(n._secletedCards.push(e),r.setPosition(r.position.x,r.position.y+50),r.getComponentInChildren(d).color=n.selectedColor):(n._secletedCards.splice(n._secletedCards.findIndex((function(t){return t===e})),1),r.setPosition(r.position.x,n._oriPositionY),r.getComponentInChildren(d).color=n._oriColor),null==t||t(e,n._secletedCards),n.sendButton.node.active=n._secletedCards.length===n.selectMax}),n),n._buttonTemps.push(l))})),null==(o=this.dwScrollView)||o.scrollView.scrollToPercentHorizontal(.5,.1,!0)},r.lock=function(e){this._buttonTemps.forEach((function(t){return t.enabled=!e}))},r.clear=function(){this._secletedCards.length=0,this.sendButton.node.active=!1,this.lock(!1)},r.onSendButtonClicked=function(){var e,t=this;this.selectMax===this._secletedCards.length&&(this.cardRoot.children.forEach((function(e){e.getComponentInChildren(d).color=t._oriColor,e.setPosition(e.position.x,t._oriPositionY)})),null==(e=this.eventSendCallback)||e.call(this,this._secletedCards.slice()),this._secletedCards.length=0)},t}(p)).prototype,"cardRoot",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(w.prototype,"sendButton",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(w.prototype,"dwScrollView",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(w.prototype,"selectedColor",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=w))||m));r._RF.pop()}}}));

System.register("chunks:///_virtual/HandEvaluator.ts",["cc","./ExplorationCard.ts"],(function(t){var r,n;return{setters:[function(t){r=t.cclegacy},function(t){n=t.CardSuit}],execute:function(){r._RF.push({},"63e51xG2fRFbK79cjtJZBqy","HandEvaluator",void 0);var u=t("CardEvaluations",function(t){return t.HighCard="High Card",t.OnePair="One Pair",t.TwoPairs="Two Pairs",t.ThreeOfAKind="Three of a Kind",t.Straight="Straight",t.Flush="Flush",t.FullHouse="Full House",t.FourOfAKind="Four of a Kind",t.StraightFlush="Straight Flush",t.RoyalFlush="Royal Flush",t}({}));t("HandEvaluator",function(){function t(){}return t.evaluateHand=function(t){if(5!==t.length)throw new Error("Must evaluate exactly 5 cards.");var r=this.countRanks(t),n=this.groupBySuit(t);return this.isRoyalFlush(n)?u.RoyalFlush:this.isStraightFlush(n)?u.StraightFlush:this.isFourOfAKind(r)?u.FourOfAKind:this.isFullHouse(r)?u.FullHouse:this.isFlush(n)?u.Flush:this.isStraight(t)?u.Straight:this.isThreeOfAKind(r)?u.ThreeOfAKind:this.isTwoPairs(r)?u.TwoPairs:this.isOnePair(r)?u.OnePair:u.HighCard},t.countRanks=function(t){var r={};return t.forEach((function(t){r[t.rank]=(r[t.rank]||0)+1})),r},t.groupBySuit=function(t){var r,u=((r={})[n.Prop]=[],r[n.Clue]=[],r[n.Doubt]=[],r[n.Presage]=[],r);return t.forEach((function(t){return u[t.suit].push(t)})),u},t.isRoyalFlush=function(t){return this.isStraightFlush(t)&&Object.values(t).some((function(t){return t.some((function(t){return"10"===t.rank}))}))},t.isStraightFlush=function(t){var r=this;return Object.values(t).some((function(t){return t.length>=5&&r.isStraight(t)}))},t.isFourOfAKind=function(t){return Object.values(t).some((function(t){return 4===t}))},t.isFullHouse=function(t){var r=Object.values(t).filter((function(t){return 3===t})).length,n=Object.values(t).filter((function(t){return 2===t})).length;return r>0&&(n>0||r>1)},t.isFlush=function(t){return Object.values(t).some((function(t){return t.length>=5}))},t.isStraight=function(t){var r=this;if(t.length<5)return!1;var n=[].concat(new Set(t.map((function(t){return r.getCardValue(t.rank)}))));n.sort((function(t,r){return t-r}));for(var u=0;u<n.length-4;u++){for(var i=!0,e=u;e<u+4;e++)if(n[e+1]!==n[e]+1){i=!1;break}if(i)return!0}return!1},t.isThreeOfAKind=function(t){return Object.values(t).some((function(t){return 3===t}))},t.isTwoPairs=function(t){return Object.values(t).filter((function(t){return 2===t})).length>=2},t.isOnePair=function(t){return Object.values(t).some((function(t){return 2===t}))},t.getCardValue=function(t){var r={2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13,A:14};if(r.hasOwnProperty(t))return r[t];throw new Error("Invalid card rank specified: "+t)},t}());r._RF.pop()}}}));

System.register("chunks:///_virtual/HitPointsBarComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FloatingTextComponent.ts"],(function(t){var n,e,i,o,r,a,p,s,l,u,c,h,f,m;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){a=t.cclegacy,p=t._decorator,s=t.ProgressBar,l=t.Node,u=t.Label,c=t.Vec3,h=t.tween,f=t.Component},function(t){m=t.FloatingTextComponent}],execute:function(){var b,H,d,g,x,B,P,w,y,C,v;a._RF.push({},"975d2k7B9dAQ7imcn3+VIGb","HitPointsBarComponent",void 0);var L=p.ccclass,T=p.property;t("HitPointsBarComponent",(b=L("HitPointsBarComponent"),H=T(s),d=T(m),g=T(l),x=T(u),b((w=n((P=function(t){function n(){for(var n,e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return n=t.call.apply(t,[this].concat(r))||this,i(n,"hpBar",w,o(n)),i(n,"floatingTextComponent",y,o(n)),i(n,"textSpawnPoint",C,o(n)),i(n,"hpLabel",v,o(n)),n.curHp=100,n.maxHp=100,n}e(n,t);var a=n.prototype;return a.changeHp=function(t){var n=this,e=Math.min(Math.max(this.curHp+t,0),this.maxHp),i=this.textSpawnPoint.position.clone(),o=t<0?i.add(new c(0,40,0)):i.add(new c(0,-40,0));this.floatingTextComponent.startPoint=o,this.floatingTextComponent.endPoint=this.textSpawnPoint.position,this.floatingTextComponent.showNumber(t,(function(){n.updateBar(e),n.updateHpLabel()}))},a.updateBar=function(t){this.hpBar.progress;var n=t/this.maxHp;h(this.hpBar).to(.25,{progress:n}).start(),this.curHp=t},a.updateHpLabel=function(){this.hpLabel.string="HP: "+this.curHp+" / "+this.maxHp},r(n,[{key:"defaultHp",set:function(t){this.maxHp=t,this.curHp=t,this.updateBar(this.curHp),this.updateHpLabel()}}]),n}(f)).prototype,"hpBar",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=n(P.prototype,"floatingTextComponent",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=n(P.prototype,"textSpawnPoint",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=n(P.prototype,"hpLabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=P))||B));a._RF.pop()}}}));

System.register("chunks:///_virtual/Logging.ts",["cc"],(function(){var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"24ad5yJ7FJOMqUWSZiPBSUY","Logging",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./MainScene.ts","./BaseCardDisplay.ts","./Card.ts","./CardComponent2.ts","./DungeonEscapeHandler.ts","./DungeonEscapeRecord.ts","./DungeonEscapeView.ts","./ExplorationCard.ts","./FoldCards.ts","./HandCards.ts","./HandEvaluator.ts","./NotifyHandler.ts","./StoryCardStack.ts","./StoryDescribeStack.ts","./YellowCardHandler.ts","./YellowCardPanel.ts","./YellowCardRecord.ts","./FirebaseBridge.ts","./SocketBridge.ts","./RoomHandler.ts","./DataModal.ts","./StoryData.ts","./WordPuzzleData.ts","./Ability.ts","./Character.ts","./Dungeon.ts","./MazeDisplay.ts","./NetworkGraph.ts","./Rogue.ts","./Skill.ts","./Weapon.ts","./ArcherySkill.ts","./CombatCharacter.ts","./CombatEntity.ts","./CombatIntent.ts","./CombatMonster.ts","./CombatSkill.ts","./CombatWeapon.ts","./AnswerClipsAnimation.ts","./EffectManager.ts","./EventManager.ts","./EventSystem.ts","./GameEvents.ts","./CardCombatTest.ts","./CommunityCardsTest.ts","./DungeonTest.ts","./ParticleEffectComponent.ts","./CommunityCards.ts","./DeckCards2.ts","./DeckCardsPile.ts","./DiscardCardsPile.ts","./PlayerHandCards.ts","./TexasGameLogic.ts","./TexasGamePlayer.ts","./TexasGameUI.ts","./AudioController.ts","./CardMover.ts","./CounterComponent.ts","./DescriptionScrollView.ts","./DynamicWidthScrollView.ts","./FillBlanks.ts","./FloatingTextComponent.ts","./Logging.ts","./RandomString.ts","./TipText.ts","./CharacterInfo.ts","./HitPointsBarComponent.ts","./CardComponent.ts","./CombatController.ts","./CombatFormation.ts","./CombatOption.ts","./CombatVisualizer.ts","./DeckCards.ts","./DeckCardsPile2.ts","./PlayerHandCards2.ts","./TeamMember.ts","./WordPuzzleGameLogic.ts","./WordPuzzleGameUI.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainScene.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DungeonEscapeHandler.ts","./DungeonEscapeView.ts"],(function(e){var t,o,n,i,a,r,c,l,s,u,m,d,h,R;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,c=e.Node,l=e.Button,s=e.EditBox,u=e.instantiate,m=e.Label,d=e.Component},function(e){h=e.DungeonEscapeHandler},function(e){R=e.DungeonEscapeView}],execute:function(){var f,v,p,b,y,B,g,w,_,G,H,E,C,x,k,z,S,D,L,M,j,N,O;a._RF.push({},"dc7a4oGyFRBH7m1+WQMgD4/","MainScene",void 0);var V=r.ccclass,I=r.property;e("MainScene",(f=V("MainScene"),v=I(c),p=I(c),b=I(l),y=I(l),B=I(l),g=I(l),w=I(l),_=I(s),G=I(R),H=I(c),f((x=t((C=function(e){function t(){for(var t,o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,n(t,"roomRoot",x,i(t)),n(t,"tableRoot",k,i(t)),n(t,"refreshRoomButton",z,i(t)),n(t,"newRoomButton",S,i(t)),n(t,"leaveRoomButton",D,i(t)),n(t,"readyGameButton",L,i(t)),n(t,"startGameButton",M,i(t)),n(t,"nameEditBox",j,i(t)),n(t,"gameView",N,i(t)),n(t,"spreadCardRoot",O,i(t)),t._roomHandler=null,t._gameHandler=null,t._indexGameReady=0,t._playerLocalCacheName="",t}o(t,e);var a=t.prototype;return a.start=function(){},a.onRenameEndEdit=function(){var e=this.nameEditBox.string;this._roomHandler.nickname=e,localStorage.setItem(this._playerLocalCacheName,JSON.stringify({nickname:e}))},a.onNewRoomClicked=function(){this._roomHandler.newRoom("YC-"+Math.round(1e5*Math.random())),this.roomRoot.active=!1,this.refreshRoomButton.node.active=!1,this.newRoomButton.node.active=!1,this.tableRoot.active=!0,this.readyGameButton.node.active=!1,this.startGameButton.node.active=!0,this.leaveRoomButton.node.active=!0},a.onJoinRoom=function(e,t,o){this.roomRoot.active=!1,this.refreshRoomButton.node.active=!1,this.newRoomButton.node.active=!1,this.nameEditBox.node.active=!1,this.tableRoot.active=!0,this.readyGameButton.node.active=!0,this.startGameButton.node.active=!1,this.leaveRoomButton.node.active=!0,this._roomHandler.joinRoom(e,t,o)},a.onUpdateTableList=function(e){var t=this;this.nameEditBox.node.active=!1;var o=this.tableRoot.children;o.forEach((function(e){return e.active=!1})),Object.keys(e).forEach((function(n,i){var a=e[n],r=o[i];r||((r=u(o[0])).parent=t.tableRoot),r.active=!0,r.getComponentInChildren(m).string=a}))},a.onExitRoomClicked=function(){this._roomHandler.leaveRoom(),this.onUpdateRoomList()},a.onUpdateRoomList=function(){var e=this,t=this.roomRoot.children;t.forEach((function(e){return e.active=!1})),this.roomRoot.active=!0,this.refreshRoomButton.node.active=!0,this.newRoomButton.node.active=!0,this.tableRoot.active=!1,this.readyGameButton.node.active=!1,this.startGameButton.node.active=!1,this.leaveRoomButton.node.active=!1,this.nameEditBox.node.active=!0,this._indexGameReady=0,this._roomHandler.loadRoomsAsync().then((function(o){o&&Object.keys(o).forEach((function(n,i){var a=o[n],r=t[i];r||((r=u(t[0])).parent=e.roomRoot),r.active=!0,r.getComponentInChildren(m).string=n,r.getComponent(l).node.off("click"),r.getComponent(l).node.once("click",(function(){return e.onJoinRoom(n,a)}),e)}))}))},a.onGameReady=function(e,t){console.log("onGameReady:",e,t);var o=this.tableRoot.children;Object.keys(t).forEach((function(n,i){var a=t[n],r=e[n];o[i].getComponentInChildren(m).string=a+" "+["","[READY]","[HONST]"][r]}))},a.onGameStart=function(e,t,o){console.log("開始遊戲",this._roomHandler.isHonster),this.roomRoot.active=!1,this.refreshRoomButton.node.active=!1,this.newRoomButton.node.active=!1,this.tableRoot.active=!1,this.readyGameButton.node.active=!1,this.startGameButton.node.active=!1;this._gameHandler=new h(this.gameView,this._roomHandler.isHonster,e,t,o,!1,this._roomHandler.players),this.leaveRoomButton.node.active=this._roomHandler.isHonster},a.onGameReconnect=function(e,t,o,n){console.log("遊戲重連!!");var i=n&&Object.keys(n).length>0;this._gameHandler=new h(this.gameView,i,e,t,o,!0,this._roomHandler.players),this.roomRoot.active=!1,this.refreshRoomButton.node.active=!1,this.newRoomButton.node.active=!1,this.nameEditBox.node.active=!1,this.leaveRoomButton.node.active=i},a.onRefreshRoomClicked=function(){this.onUpdateRoomList()},a.onGameReadyClicked=function(){this._indexGameReady=(this._indexGameReady+1)%2,this._roomHandler.gameReady(this._indexGameReady)},a.onGameStartClicked=function(){this._roomHandler.tryGameStart()},t}(d)).prototype,"roomRoot",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(C.prototype,"tableRoot",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(C.prototype,"refreshRoomButton",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(C.prototype,"newRoomButton",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(C.prototype,"leaveRoomButton",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(C.prototype,"readyGameButton",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(C.prototype,"startGameButton",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(C.prototype,"nameEditBox",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(C.prototype,"gameView",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(C.prototype,"spreadCardRoot",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=C))||E));a._RF.pop()}}}));

System.register("chunks:///_virtual/MazeDisplay.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n,t,o,i,a,c,l,s,u,p,f;return{setters:[function(e){r=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,c=e.Node,l=e.SpriteFrame,s=e.Sprite,u=e.UITransform,p=e.Color,f=e.Component}],execute:function(){var m,h,d,C,g,y,w,z,v;i._RF.push({},"160b41K30VI/rZHmbk/rqjk","MazeDisplay",void 0);var b=a.ccclass,F=a.property;e("MazeDisplay",(m=b("MazeDisplay"),h=F(c),d=F(l),C=F(l),m((w=r((y=function(e){function r(){for(var r,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=e.call.apply(e,[this].concat(i))||this,t(r,"mazeContainer",w,o(r)),t(r,"wallSpriteFrame",z,o(r)),t(r,"floorSpriteFrame",v,o(r)),r.currX=0,r.currY=0,r}n(r,e);var i=r.prototype;return i.start=function(){},i.showDungeon=function(e,r,n,t){var o=this;e.rooms.forEach((function(e,r){e.forEach((function(e,n){var t=new c("Tile-"+n+"-"+r);o.mazeContainer.addChild(t),t.setPosition(62*n,62*r),e.instanceNode=t,t.addComponent(s).spriteFrame=o.floorSpriteFrame;e.connections.forEach((function(e){var i=new c("Passage-"+n+"-"+r);t.addChild(i),i.addComponent(s).spriteFrame=o.wallSpriteFrame;var a=[[0,24],[0,-24],[24,0],[-24,0]][e];i.getComponent(u).setContentSize(16,16),i.setPosition(a[0],a[1])}))}))})),this.currX=r,this.currY=n,e.rooms.forEach((function(e,o){e.forEach((function(e,i){i===r&&o===n?e.instanceNode.getComponent(s).color=new p(0,255,0):e==t&&(e.instanceNode.getComponent(s).color=new p(255,0,0))}))})),this.mazeContainer.getComponent(u).setContentSize(62*(e.width-1),62*(e.height-1))},i.movePlayer=function(e,r,n){var t=this;e.rooms.forEach((function(e,o){e.forEach((function(e,i){i===t.currX&&o===t.currY&&(e.instanceNode.getComponent(s).color=new p(255,255,255)),i===r&&o===n&&(e.instanceNode.getComponent(s).color=new p(0,255,0))}))})),this.currX=r,this.currY=n},r}(f)).prototype,"mazeContainer",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=r(y.prototype,"wallSpriteFrame",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=r(y.prototype,"floorSpriteFrame",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=y))||g));i._RF.pop()}}}));

System.register("chunks:///_virtual/NetworkGraph.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var o,i,t,r,n,a,s,l,d,p,c,y,u,h,f;return{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inheritsLoose,t=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,s=e.Node,l=e.Vec3,d=e.Button,p=e.Sprite,c=e.resources,y=e.SpriteFrame,u=e.Label,h=e.tween,f=e.Component}],execute:function(){var N,v,m,w,L,g,C;n._RF.push({},"6734eYxrDdCyKvfzNSOwyjw","NetworkGraph",void 0);var b=a.ccclass,D=a.property;e("NetworkGraph",(N=b("NetworkGraph"),v=D(s),m=D(s),N((g=o((L=function(e){function o(){for(var o,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return o=e.call.apply(e,[this].concat(n))||this,t(o,"positionLayer",g,r(o)),t(o,"displayLayer",C,r(o)),o}i(o,e);var n=o.prototype;return n.createInitialNode=function(e,o,i){void 0===i&&(i=null);var t=new s(e);t.setPosition(new l(0,0,0)),this.positionLayer.addChild(t),this.createDisplayNode(t,e,o,i)},n.addNode=function(e,o,i,t,r,n){void 0===n&&(n=null);var a=this.positionLayer.getChildByName(e);if(a){var d=new s("NewNode");d.setPosition(new l(a.position.x+o,a.position.y+i,0)),this.positionLayer.addChild(d),this.createDisplayNode(d,t,r,n)}else console.error("Related node not found")},n.createDisplayNode=function(e,o,i,t){var r=new s("DisplayNode");this.displayLayer.addChild(r),r.setPosition(new l(e.position.x,e.position.y,0)),r.addComponent(d),r.on("click",(function(){console.log("Touch start on "+o),null==t||t(o)}));var n=r.addComponent(p),a="maps/"+o+"/spriteFrame";c.load(a,y,(function(e,o){e?console.error("Failed to load image: "+e):n.spriteFrame=o}));var f=new s("LabelNode");f.parent=r,f.setPosition(new l(0,0,0));var N=f.addComponent(u);N.string=i,N.fontSize=24,h(r).stop().to(.25,{scale:new l(1,1,1)}).start()},n.positionNodes=function(){for(var e=this.positionLayer.children,o=0;o<e.length;o++)for(var i=o+1;i<e.length;i++){var t=e[o].position.subtract(e[i].position).length();if(t<100){var r=100-t,n=e[i].position.subtract(e[o].position).normalize(),a=e[i].position.add(n.multiplyScalar(r));e[i].setPosition(a);var s=this.displayLayer.getChildByName(e[i].name.replace("Node","DisplayNode"));h(s).to(.25,{position:a}).start()}}},n.removeNode=function(e){var o=this.positionLayer.getChildByName(e);if(o){var i=this.displayLayer.getChildByName(e.replace("Node","DisplayNode"));i?(i.destroy(),o.destroy()):console.error("Display node not found")}else console.error("Node not found")},n.removeAllNodes=function(){this.positionLayer.children.forEach((function(e){return e.destroy()})),this.displayLayer.children.forEach((function(e){return e.destroy()}))},o}(f)).prototype,"positionLayer",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=o(L.prototype,"displayLayer",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=L))||w));n._RF.pop()}}}));

System.register("chunks:///_virtual/NotifyHandler.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"1132caDfNVPAIjfLTH87NX7","NotifyHandler",void 0),t("NotifyHandler",function(){function t(){this._isHonster=!1,this._masterID=void 0,this._playerID=void 0}return t.destroy=function(){this._instance=null},t.prototype.notify=function(t,e,n){var i;void 0===e&&(e=""),this._isHonster&&(i=t(),e&&e!=this._playerID)||null==n||n(undefined,i)},e(t,[{key:"isHonster",set:function(t){this._isHonster=t}},{key:"master",set:function(t){this._masterID?console.error("重複設定 master id:",t,"，請置 NotifyHandler"):this._masterID=t}},{key:"player",set:function(t){this._playerID?this._playerID=t:console.error("重複設定 player id:",t,"，請置 NotifyHandler")}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}())._instance=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/ParticleEffectComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,r,n,s,c,o,a,l,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,c=t._decorator,o=t.ParticleSystem2D,a=t.Vec2,l=t.Color,p=t.Component}],execute:function(){var y,u,f,m,h;s._RF.push({},"2ab372XCe1K05/29U+TyMEP","ParticleEffectComponent",void 0);var S=c.ccclass,d=c.property;t("ParticleEffectComponent",(y=S("ParticleEffectComponent"),u=d(o),y((h=e((m=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return e=t.call.apply(t,[this].concat(s))||this,r(e,"particleSystem",h,n(e)),e}i(e,t);var s=e.prototype;return s.playEffect=function(){var t=this;if(this.particleSystem){this.particleSystem.resetSystem();var e=this.particleSystem.duration+this.particleSystem.life;console.log("totalDuration",e),this.scheduleOnce((function(){t.particleSystem.stopSystem()}),e)}},s.setupEffect=function(){this.particleSystem.gravity=new a(0,-100),this.particleSystem.speed=50,this.particleSystem.startColor=new l(255,255,255,255),this.particleSystem.endColor=new l(255,255,255,0),this.particleSystem.startSize=10,this.particleSystem.endSize=0,this.particleSystem.duration=1},e}(p)).prototype,"particleSystem",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=m))||f));s._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerHandCards.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseCardDisplay.ts","./GameEvents.ts","./EventManager.ts","./CardComponent2.ts","./CardMover.ts"],(function(n){var t,r,e,a,s,o,i,c,d,u;return{setters:[function(n){t=n.inheritsLoose,r=n.asyncToGenerator,e=n.regeneratorRuntime},function(n){a=n.cclegacy,s=n._decorator},function(n){o=n.BaseCardDisplay},function(n){i=n.PlayerHandCardEvent},function(n){c=n.EventManager},function(n){d=n.CardComponent},function(n){u=n.CardMover}],execute:function(){var C;a._RF.push({},"962817kJY9H+LYU1/VczLnC","PlayerHandCards",void 0);var h=s.ccclass;s.property,n("default",h("PlayerHandCards")(C=function(n){function a(){return n.apply(this,arguments)||this}t(a,n);var s=a.prototype;return s.onLoad=function(){c.instance.on(i.DealCards,this.onDealCards.bind(this)),c.instance.on(i.ShowCards,this.onShowCards.bind(this)),c.instance.on(i.CompareCards,this.onCompareCards.bind(this))},s.onDestroy=function(){c.instance.off(i.DealCards,this.onDealCards),c.instance.off(i.ShowCards,this.onShowCards),c.instance.off(i.CompareCards,this.onCompareCards)},s.start=function(){this.node.active=!1},s.compareCards=function(n){var t=this,r=n[0];this.getCardNodes(r).forEach((function(n){t.toggleCardSelection(n)}))},s.dealCard=function(n,t){this.node.active=!0;var r=this.positionContainer.children[n].position;return u.moveCard(t,this.cardContainer,r,.3,.15*(n+1))},s.dealCards=function(n,t){var a=this;n.forEach(r(e().mark((function n(r,s){var o;return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(o=t[t.length-1]).getComponent(d).setup(r),n.next=4,a.dealCard(s,o);case 4:case"end":return n.stop()}}),n)}))))},s.clearCards=function(){this.cardContainer.removeAllChildren(),this.selected=[]},s.onDealCards=function(){var n=r(e().mark((function n(t){return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.node.active=!0,n.next=3,this.unselectAllCards();case 3:case 4:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),s.onShowCards=function(){var n=r(e().mark((function n(t){return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.node.active=!0,n.next=3,this.unselectAllCards();case 3:this.showCards(t);case 4:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),s.onCompareCards=function(n){this.compareCards(n)},a}(o))||C);a._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerHandCards2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./CardMover.ts","./GameEvents.ts","./CardComponent.ts","./BaseCardDisplay.ts"],(function(e){var t,n,r,a,o,i,s,c,d,u,l,p,f,h,C,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,o=e.asyncToGenerator,i=e.regeneratorRuntime,s=e.createForOfIteratorHelperLoose},function(e){c=e.cclegacy,d=e._decorator,u=e.Node,l=e.Vec3},function(e){p=e.EventManager},function(e){f=e.CardMover},function(e){h=e.PlayerHandCardEvent},function(e){C=e.CardComponent},function(e){v=e.BaseCardDisplay}],execute:function(){var y,g,P,m,x;c._RF.push({},"88570XPZuFEV5Sd/gF8v4Xx","PlayerHandCards",void 0);var w=d.ccclass,E=d.property;e("default",(y=w("PlayerHandCards"),g=E(u),y((x=t((m=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o))||this,r(t,"discardPile",x,a(t)),t}n(t,e);var c=t.prototype;return c.onLoad=function(){p.instance.on(h.PlayCards,this.onPlayCards.bind(this))},c.onDestroy=function(){p.instance.off(h.PlayCards,this.onPlayCards)},c.start=function(){this.node.active=!1},c.dealCard=function(e,t){var n=this.positionContainer.children[e].position;return f.moveCard(t,this.cardContainer,n,.3,.15*(e+1))},c.dealCards=function(e,t){var n=this;this.node.active=!0,this.updatePositionLayout(),e.forEach(o(i().mark((function e(r,a){var o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=t[t.length-1]).getComponent(C).setup(r),e.next=4,n.dealCard(a,o);case 4:case"end":return e.stop()}}),e)})))),this.stopToggleSelection(),this.setToggleSelection()},c.onPlayCards=function(){var e=o(i().mark((function e(){var t,n,r,a,c,d=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=s(this.selectedCardNodes);case 2:if((r=n()).done){e.next=11;break}return a=r.value,c=a.getComponent(C).card,console.log("card",c),t.push(c),e.next=9,f.moveCard(a,this.discardPile,l.ZERO,.05,.15);case 9:e.next=2;break;case 11:return e.next=13,new Promise((function(e){return d.scheduleOnce(e,.1)}));case 13:return this.cardContainer.children.slice().forEach(o(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.moveCard(t,d.discardPile,l.ZERO,.05,.15);case 2:case"end":return e.stop()}}),e)})))),e.next=17,new Promise((function(e){return d.scheduleOnce(e,.5)}));case 17:p.instance.emit("ExecuteSkill",t),this.selected.length=0,this.selectedCardNodes.length=0,this.stopToggleSelection();case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(v)).prototype,"discardPile",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=m))||P));c._RF.pop()}}}));

System.register("chunks:///_virtual/RandomString.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"dcab9+inZ5O3o+MXXMDy66u","RandomString",void 0);n("RandomString",function(){function n(){}return n.generate=function(n){void 0===n&&(n=10);for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="",o=0;o<n;o++){r+=t[Math.floor(Math.random()*t.length)]}return r},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/Rogue.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Dungeon.ts","./MazeDisplay.ts","./DescriptionScrollView.ts","./NetworkGraph.ts","./EventManager.ts","./GameEvents.ts"],(function(o){var n,t,e,i,r,s,c,a,u,l,h,d,p,f;return{setters:[function(o){n=o.applyDecoratedDescriptor,t=o.inheritsLoose,e=o.initializerDefineProperty,i=o.assertThisInitialized},function(o){r=o.cclegacy,s=o._decorator,c=o.Component},function(o){a=o.Direction,u=o.DungeonMaze},function(o){l=o.MazeDisplay},function(o){h=o.DescriptionScrollView},function(o){d=o.NetworkGraph},function(o){p=o.EventManager},function(o){f=o.WordPuzzleGameLogicEvent}],execute:function(){var g,m,v,D,w,k,y,z,R;r._RF.push({},"a9cf4ELFqtNM7zats1RDWJ0","Rogue",void 0);var S=s.ccclass,C=s.property;o("default",(g=S("Rogue"),m=C(d),v=C(h),D=C(l),g((y=n((k=function(o){function n(){for(var n,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return n=o.call.apply(o,[this].concat(r))||this,e(n,"networkGraph",y,i(n)),e(n,"descriptionScrollView",z,i(n)),e(n,"mazeDisplay",R,i(n)),n.dungeon=null,n.currX=0,n.currY=0,n.data=void 0,n}t(n,o);var r=n.prototype;return r.onLoad=function(){this.networkGraph.node.active=!1,this.descriptionScrollView.node.active=!1,this.mazeDisplay.node.active=!1},r.setDungeonData=function(o){this.data=o;o.roomType;var n=o.icon,t=o.name,e=o.descriptions;o.connectIn,o.locations;this.networkGraph.node.active=!0,this.networkGraph.createInitialNode(n,t,this.enterDungeon.bind(this)),this.descriptionScrollView.node.active=!0,this.descriptionScrollView.setData(e)},r.enterDungeon=function(o){console.log(o);var n=this.data.locations[0],t=(n.roomType,n.icon,n.name,n.size),e=n.position,i=n.rooms;this.descriptionScrollView.clear(),this.mazeDisplay.node.active=!0;var r=this.createDungeon(t[0],t[1],e[0],e[1]),s=this.getCurrentRoom();this.dungeon.rooms.forEach((function(o){var n=i[1];o.forEach((function(o){o.setInfo(n)}))}));var c=i[0];s.setInfo(c);var a=i[i.length-1];r.setInfo(a),this.setDungeonRoom(s)},r.setDungeonRoom=function(o){var n=this;console.log(o),o.descriptions.length>0&&(this.descriptionScrollView.node.active=!0,this.descriptionScrollView.setData(o.descriptions));this.networkGraph.removeAllNodes(),this.networkGraph.createInitialNode(o.icon,o.name,(function(){return p.instance.emit(f.WordPuzzleGameStart,o)})),o.connections.forEach((function(t){var e,i,r;switch(t){case a.North:e=0,i=200,r=function(){n.onNorthDoorClick()};break;case a.East:e=200,i=0,r=function(){n.onEastDoorClick()};break;case a.South:e=0,i=-200,r=function(){n.onSouthDoorClick()};break;case a.West:e=-200,i=0,r=function(){n.onWestDoorClick()}}n.networkGraph.addNode(o.icon,e,i,"creation1","門",r)}))},r.createDungeon=function(o,n,t,e){if(!(o<0||n<0||o<=t||n<=e||t<0||e<0)){this.dungeon=new u(o,n),this.dungeon.generateMaze(t,e);var i=this.dungeon.findExit(t,e);return console.log("exit:",i),this.mazeDisplay.showDungeon(this.dungeon,t,e,i),this.currX=t,this.currY=e,i}console.error("Invalid dungeon size or start position")},r.moveToRoom=function(o,n){if(o<0||n<0||o>=this.dungeon.width||n>=this.dungeon.height)console.error("Invalid room position");else{var t=this.dungeon.rooms[n][o];t?(this.currX=o,this.currY=n,this.mazeDisplay.movePlayer(this.dungeon,o,n),this.setDungeonRoom(t)):console.error("Invalid room")}},r.getCurrentRoom=function(){return this.dungeon.rooms[this.currY][this.currX]},r.onSouthDoorClick=function(){var o=this.getCurrentRoom();o&&o.connections.includes(a.South)&&this.moveToRoom(this.currX,this.currY-1)},r.onEastDoorClick=function(){var o=this.getCurrentRoom();o&&o.connections.includes(a.East)&&this.moveToRoom(this.currX+1,this.currY)},r.onNorthDoorClick=function(){var o=this.getCurrentRoom();o&&o.connections.includes(a.North)&&this.moveToRoom(this.currX,this.currY+1)},r.onWestDoorClick=function(){var o=this.getCurrentRoom();o&&o.connections.includes(a.West)&&this.moveToRoom(this.currX-1,this.currY)},n}(c)).prototype,"networkGraph",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(k.prototype,"descriptionScrollView",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=n(k.prototype,"mazeDisplay",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=k))||w));r._RF.pop()}}}));

System.register("chunks:///_virtual/RoomHandler.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SocketBridge.ts","./RandomString.ts"],(function(e){var t,o,s,i,n,a;return{setters:[function(e){t=e.createClass,o=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){i=e.cclegacy},function(e){n=e.SocketBridge},function(e){a=e.RandomString}],execute:function(){i._RF.push({},"bdac1KaEi9OoL28aGCdUil/","RoomHandler",void 0);e("RoomHandler",function(){function e(e,t){this.roomInfo=void 0,this.eventHandlers={},this._roomLocalCacheName="",this._needReconnect=!1,this.isHonster=!1,this.players={},this._readyPlayers={},this._roomList=[],this._roomID="",this._roomKey="",this._roomLockKey="",this._joinRoomInterval=void 0,this._isRoomJoining=!1,this._playerID="",this._nickname="",this.eventUpdateTableList=null,this.eventUpdateRoomList=null,this.eventGameReady=null,this.eventGameStart=null,this.eventGameReconnect=null,this._roomLocalCacheName="DE_ROOM_TEMP_"+e,this.roomInfo={id:"",key:"",lockKey:""},this._playerID=a.generate(),this._nickname=t}var i=e.prototype;return i.getEventHandlers=function(){return{join_room:this.notify_join_room.bind(this),take_seat:this.notify_take_seat.bind(this),leave_room:this.notify_leave_room.bind(this),kicked_out:this.notify_kicked_out.bind(this),game_ready:this.notify_game_ready.bind(this),game_start:this.notify_game_start.bind(this)}},i.handleRoomTimeout=function(e){var t=this;this._isRoomJoining=!0,this._joinRoomInterval&&clearTimeout(this._joinRoomInterval),this._joinRoomInterval=setTimeout((function(){var o;t._isRoomJoining&&(console.log("沒有對應的 Honster 回應"),n.Instance.clientDisconnect(t._playerID),console.log("只能把自己的 Broadcast 欄位移除"),n.Instance.delDataLabel("ROOMS/"+e),console.log("代替斷線的 Honster 把"+e+"從房間清單移除"),n.Instance.removeDispatcher(t._roomID,t),t._clearRoomInfo(),null==(o=t.eventUpdateRoomList)||o.call(t))}),1e3)},i._applicate=function(e,t){void 0===t&&(t=""),this.isHonster?this["notify_"+e](this._roomID,e,t):n.Instance.applicate(e,t)},i._broadcast=function(e,t,o){if(void 0===t&&(t=""),this.isHonster){if(console.log(e,t,"clientID?:",o),o===this._playerID)return console.log("不會發給自己");n.Instance.broadcast(e,t,o)}},i.loadRoomsAsync=function(){var e=this;return n.Instance.loadAsync("ROOMS").then((function(t){return e._roomList=t}))},i.newRoom=function(e,t){void 0===t&&(t="0");var o=a.generate();this._roomID=e,this._roomKey=o,n.Instance.addDataLabel("ROOMS/"+e,o),this._roomLockKey=t,this.isHonster=!0,this.joinRoom(this._roomID,this._roomKey,this._roomLockKey)},i.joinRoom=function(){var e=o(s().mark((function e(t,o,i){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===i&&(i="0"),e.prev=1,console.log("Joining room:",t),a={id:t,key:o,lockKey:i},e.next=6,n.Instance.addDispatcher(t,this,this.getEventHandlers());case 6:if(!this.isHonster){e.next=11;break}return e.next=9,n.Instance.addHonsterConnection(t);case 9:e.next=14;break;case 11:return e.next=13,n.Instance.addClientConnection(t,this._playerID);case 13:this.handleRoomTimeout(t);case 14:this.roomInfo=a,this._applicate("join_room",this._playerID+" "+o+" "+i),console.log("Player [",this._playerID,"] send joinRoom: id/roomkey:[",o,"] & roomLockKey:[",i,"]"),e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(1),console.error("Failed to join room:",e.t0),e.t0;case 23:case"end":return e.stop()}}),e,this,[[1,19]])})));return function(t,o,s){return e.apply(this,arguments)}}(),i.tryReconnect=function(){var e=o(s().mark((function e(){var t,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem(this._roomLocalCacheName))){e.next=14;break}return this._needReconnect=!0,o=JSON.parse(t),console.log("斷線重連:",o),this.isHonster=o.isHonster,o.playerID&&(console.log("重連後修改自己的playerID:",this._playerID,"->",o.playerID),this._playerID=o.playerID),this._roomID=o.roomID,this._roomKey=o.roomKey,this._roomLockKey=o.roomLockKey,this.players=o.players,e.next=13,this.joinRoom(this._roomID,this._roomKey);case 13:return e.abrupt("return",!0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.leaveRoom=function(){var e;console.log("leave room this._isHonster:",this.isHonster),this.isHonster?(console.log("發出 kicked_out!!! 然後斷線"),this._broadcast("kicked_out"),n.Instance.honsterDisconnect(),n.Instance.delBroadcastList(),n.Instance.delDataLabel("ROOMS/"+this._roomID)):(n.Instance.applicate("leave_room",this._playerID),n.Instance.clientDisconnect(this._playerID)),n.Instance.removeDispatcher(this._roomID,this),null==(e=this.eventUpdateRoomList)||e.call(this),this._clearRoomInfo()},i._clearRoomInfo=function(){localStorage.removeItem(this._roomLocalCacheName),this._roomID="",this._roomKey="",this._roomLockKey="0",this.isHonster=!1,this.players={},this._readyPlayers={}},i.notify_join_room=function(e,t,o){var s;if(this.isHonster){var i=o.split(" ");s=i[0];var a=i[1],r=i[2];if(console.log("this._roomKey:",this._roomKey,"---room key:",a),this._roomKey!=a){var l="不符合的 room key";console.log(l),o=s+" 0 "+l,this._broadcast(t,o,s)}else if(this._roomLockKey!=r){var c="輸入錯誤的密碼: "+r;console.log(c),o=s+" 0 "+c,this._broadcast(t,o,s)}else this._playerID!=s&&n.Instance.addToBroadcastList(s),o=s+" 1",this._broadcast(t,o,s)}var h=o.split(" ");if((s=h[0])==this._playerID){var _,m="1"===h[1];if(this._needReconnect)m?(null==(_=this.eventGameReconnect)||_.call(this,e,s,this._nickname,this.players),this._joinRoomInterval&&clearTimeout(this._joinRoomInterval),console.log("重連成功")):console.log("重連失敗: 已失去房間連結"),this._needReconnect=!1;else if(m)this._roomID=e,this._isRoomJoining=!1,console.log(this._nickname,"成功加入房間!!"),this._applicate("take_seat",s+" "+this._nickname);else{var y=h[2];console.log(t,"error:",y),this.leaveRoom()}}else console.log("playerID 不同",s,this._playerID)},i.notify_take_seat=function(e,t,o){var s,i,n;if(this.isHonster){var a=o.split(" ");i=a[0],n=a[1],console.log(n,i,"進行入桌"),this.players[i]=n,o=i+" "+JSON.stringify(this.players),this._broadcast(t,o)}var r=o.split(" ");i=r[0];var l=JSON.parse(r[1]);null==(s=this.eventUpdateTableList)||s.call(this,l),this._playerID===i&&this.gameReady(0)},i.notify_leave_room=function(e,t,o){var s,i,a=o;this.isHonster&&(i=this.players[a],delete this.players[a],delete this._readyPlayers[a],n.Instance.delBroadcastList(a),n.Instance.clientDisconnect(a),console.log("離開房間斷線:",a),o=JSON.stringify(this.players)+" "+i,this._broadcast(t,o));var r=o.split(" "),l=JSON.parse(r[0]),c=r[1];console.log("players:",l),null==(s=this.eventUpdateTableList)||s.call(this,l),console.log(c,"離開房間了")},i.notify_kicked_out=function(e,t,o){var s;this.isHonster?n.Instance.clientDisconnect():(n.Instance.removeDispatcher(e,this),null==(s=this.eventUpdateRoomList)||s.call(this),this._clearRoomInfo());console.log("有收到 kicked out哦!!")},i.notify_game_ready=function(e,t,o){var s,i;if(console.log("收到 notify_game_ready"),this.isHonster){var n=o.split(" ");i=n[0];var a=n[1];this._readyPlayers[i]=a,console.log("ready player:",this._readyPlayers),o=JSON.stringify(this._readyPlayers)+" "+JSON.stringify(this.players),this._broadcast(t,o)}var r=o.split(" "),l=JSON.parse(r[0]),c=JSON.parse(r[1]);null==(s=this.eventGameReady)||s.call(this,l,c)},i.notify_game_start=function(e,t,o){console.log("收到 notify_game_start",this.isHonster),this.isHonster&&(this._broadcast(t),n.Instance.delDataLabel("ROOMS/"+this._roomID)),this.eventGameStart(e,this._playerID,this._nickname);var s={roomID:this._roomID,roomKey:this._roomKey,roomLockKey:this._roomLockKey,playerID:this._playerID,isHonster:this.isHonster,players:this.players};localStorage.setItem(this._roomLocalCacheName,JSON.stringify(s)),console.log("\n\n存檔",s,"\n\n")},i.gameReady=function(e){this.isHonster&&(e="2"),this._applicate("game_ready",this._playerID+" "+e)},i.tryGameStart=function(){var e=this,t=Object.keys(this._readyPlayers),o=t.length&&t.every((function(t){return parseInt(e._readyPlayers[t],10)>0}));console.log("準備清單:",this._readyPlayers),o?this._applicate("game_start"):console.log("尚有人未準備好")},t(e,[{key:"nickname",set:function(e){this._nickname=e}}]),e}());i._RF.pop()}}}));

System.register("chunks:///_virtual/Skill.ts",["cc"],(function(e){var i;return{setters:[function(e){i=e.cclegacy}],execute:function(){i._RF.push({},"5af80/LSJVPJo3J7v5GCx6a","Skill",void 0);e("Skill",(function(e){void 0===e&&(e=0),this.level=void 0,this.level=e}));i._RF.pop()}}}));

System.register("chunks:///_virtual/SocketBridge.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FirebaseBridge.ts"],(function(t){var n,i,e,o,c;return{setters:[function(t){n=t.createClass,i=t.asyncToGenerator,e=t.regeneratorRuntime},function(t){o=t.cclegacy},function(t){c=t.default}],execute:function(){o._RF.push({},"2d4a25YPn1Bho37tEGXpZjX","SocketBridge",void 0),t("SocketBridge",function(){function t(){this._bridge=new c,this._connectID="",this._broadcastList=[]}var o=t.prototype;return o.connect=function(){var t=i(e().mark((function t(n){var i;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._bridge.signInWithGoogleEmail("xxfox"+n[0]+"@gmail.com",n[1]);case 3:return i=t.sent,t.abrupt("return",i);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));return function(n){return t.apply(this,arguments)}}(),o.addDispatcher=function(t,n,i){this._bridge.addDispatcher(t,n,i)},o.removeDispatcher=function(t,n){this._bridge.removeDispatcher(t,n)},o.loadAsync=function(t,n){return this._bridge.loadAsync(t,n)},o.addHonsterConnection=function(t){this._connectID=t,this._bridge.addConnection(t,"Applicate")},o.addClientConnection=function(t,n){this._connectID=t,this._bridge.addConnection(t,"Broadcast",n)},o.honsterDisconnect=function(){this._bridge.delConnection(this._connectID,"Applicate"),this._bridge.uploadInfo(this._connectID,"","","Applicate"),this._connectID=""},o.clientDisconnect=function(t){var n=this;t?(this._bridge.delConnection(this._connectID,"Broadcast",t),this._bridge.uploadInfo(this._connectID,"","","Broadcast",t)):this._broadcastList.forEach((function(t){n._bridge.delConnection(n._connectID,"Broadcast",t),n._bridge.uploadInfo(n._connectID,"","","Broadcast",t)})),this.delBroadcastList(t)},o.addToBroadcastList=function(t){this._broadcastList.push(t),console.log("新增",t,this._broadcastList)},o.delBroadcastList=function(t){t?this._broadcastList.indexOf(t)>-1&&(this._broadcastList.splice(this._broadcastList.findIndex((function(n){return n===t})),1),console.log("刪除",t,this._broadcastList)):(console.log("刪除",this._broadcastList,this._broadcastList),this._broadcastList.length=0)},o.applicate=function(t,n){this._bridge.uploadInfo(this._connectID,t,n,"Applicate")},o.broadcast=function(t,n,i){var e=this;if(!this._connectID)return console.log("Honster 已斷線");i?(console.log(t,"廣播對象:",i),this._bridge.uploadInfo(this._connectID,t,n,"Broadcast",i)):(console.log(t,"廣播對象:",this._broadcastList),this._broadcastList.forEach((function(i){return e._bridge.uploadInfo(e._connectID,t,n,"Broadcast",i)})))},o.addDataLabel=function(t,n){this._bridge.addDataLabel(t,n)},o.delDataLabel=function(t){this._bridge.delDataLabel(t)},n(t,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}())._instance=void 0,o._RF.pop()}}}));

System.register("chunks:///_virtual/StoryCardStack.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,r,i,n,o,a,c,s,g,l,u,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,c=t.Prefab,s=t.Node,g=t.instantiate,l=t.Vec3,u=t.UITransform,d=t.Component}],execute:function(){var h,p,f,v,C,y,b,m;o._RF.push({},"6dfabiwBrdFgJ5Dd54Bj6/C","StoryCardStack",void 0);var S=a.ccclass,k=a.property;t("StoryCardStack",(h=S("StoryCardStack"),p=k(c),f=k(s),h((y=e((C=function(t){function e(){for(var e,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"cardPrefab",y,n(e)),i(e,"stackNode",b,n(e)),i(e,"triggerHeight",m,n(e)),e.movingCard=null,e}r(e,t);var o=e.prototype;return o.onLoad=function(){this.generateCardStack()},o.generateCardStack=function(){for(var t=0;t<10;t++){var e=g(this.cardPrefab);e.setParent(this.stackNode),e.position=new l(0,5*-t,0),e.scale=new l(.2,.2,.2),this.registerCardEvents(e)}},o.registerCardEvents=function(t){t.on(s.EventType.TOUCH_MOVE,this.onCardMove,this),t.on(s.EventType.TOUCH_END,this.onCardRelease,this)},o.onCardMove=function(t){this.movingCard||(this.movingCard=t.currentTarget);var e=t.getUILocation(),r=this.node.getComponent(u).convertToNodeSpaceAR(new l(e.x,e.y,0));this.movingCard.position=r;var i=Math.min(1,(r.y-this.stackNode.position.y)/this.triggerHeight);this.movingCard.scale=new l(.2+.8*i,.2+.8*i,1)},o.onCardRelease=function(t){t.currentTarget.position.y>=this.triggerHeight&&this.triggerAction(),this.movingCard=null},o.triggerAction=function(){console.log("Triggered Action at Height!")},e}(d)).prototype,"cardPrefab",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(C.prototype,"stackNode",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=e(C.prototype,"triggerHeight",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),v=C))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/StoryData.ts",["cc","./ExplorationCard.ts"],(function(s){var o,e;return{setters:[function(s){o=s.cclegacy},function(s){e=s.CardSuit}],execute:function(){o._RF.push({},"47ed9Jj46dABa9sNHc8UxTB","StoryData",void 0);s("StoryData",(function(){var s,o,t,r,c,n,i,a;this.chapters=[],this.dungeons=void 0;this.chapters[0]=[],this.chapters[0].push("在遙遠的奇幻世界中，有一片被古老魔法和神秘生物統治的大陸。"),this.chapters[0].push("受到神的祝福，因而命名為[埃瑟隆]。"),this.chapters[0].push("大陸由五大王國組成，每個王國都有其獨特的文化和魔法學派。"),this.chapters[0].push("然而，和平的時光不再，一個[古老預言]應驗了…"),this.chapters[0].push("一條恐怖的龍，名為[卡札特]，從千年的封印中甦醒，帶來了[毀滅]與[死亡]。"),this.chapters[0].push("卡札特擁有焚燒一切的火焰呼吸和堅不可摧的鱗片，牠在暗夜中飛翔，籠罩大地於無盡的恐懼之中。"),this.chapters[0].push("各國的領袖們從古老的文書中發現，只有將五個[古老的神器]集齊，才能封印卡札特，重新帶來和平。"),this.chapters[0].push("這五個神器散落於[蠻獸荒野]、[幽深地城]和[遺忘聖殿]中。"),this.dungeons={abcd234:{roomType:"Dungeon",icon:"creation2",name:"幽深地城",descriptions:["這個深藏在圖書館之下的地下城，充滿了神秘的魔法。","這裡有一份紀錄著神器位置的文件，如果沒有它就無法找到幽深地城中的神器所在。"],connectIn:["def765"],locations:[{position:[2,0],size:[5,5],rooms:[{name:"入口",icon:"creation2",descriptions:["剛進入地下城，充滿了著霉味與腐朽的氣味，令人鼻子不禁癢了起來。"],question:"輸入[三碼數字]的密碼解鎖[密碼鎖]後，順利打開[盒子]後從裡面取出一把精美的<color=#ffcc00>寶石匕首</color>。",cards:[(s={},s[e.Prop]="牆角邊有一個普通的木桶。",s[e.Presage]="木桶似乎有些新的小洞口。",s[e.Clue]="木桶的裡面有一個小小的洞，透過洞望進去可以看到一張寫著[三碼數字]的小紙條。",s[e.Doubt]="木桶的洞似乎被不斷挖開過，也許有些人想從中掏出什麼？",s),(o={},o[e.Prop]="[盒子]用[密碼鎖]上鎖了。",o[e.Presage]="[盒子]有些沉重，裡面裝著什麼。",o[e.Clue]="[盒子]上的鎖，是個三位數的[密碼鎖]。",o[e.Doubt]="[盒子]有個鎖，裡面的東西似乎很重要？",o),(t={},t[e.Prop]="一扇被破壞過的窗戶。",t[e.Presage]="窗戶上的窗簾看起來很破舊。",t[e.Clue]="窗簾似乎被巨大的爪子抓過…",t[e.Doubt]="窗戶的玻璃全被敲破，因此釘上許多木板，也許曾經有人想突破進來？",t)]},{name:"某個房間",icon:"creation2",descriptions:[],question:"有<color=#ffcc00>寶石匕首</color>。",cards:[(r={},r[e.Prop]="牆角邊有一個普通的木桶。",r[e.Presage]="木桶似乎有些新的小洞口。",r[e.Clue]="木桶的裡面有一個小小的洞，透過洞望進去可以看到一張寫著[三碼數字]的小紙條。",r[e.Doubt]="木桶的洞似乎被不斷挖開過，也許有些人想從中掏出什麼？",r)]},{name:"出口",icon:"creation2",descriptions:[],question:"透過寫在[照片]背面的開啟方法，打開[密封罐]後從中掏出一卷<color=#ffcc00>紅印文件</color>。",cards:[(c={},c[e.Prop]="展示櫃內部陳列著各式各樣的收藏品。",c[e.Presage]="當靠近展示櫃時，可以聽到微弱的機械運作聲。",c[e.Clue]="展示櫃的一個[密封罐]的位置發現了被頻繁觸碰或移動的磨損痕跡。",c[e.Doubt]="展示櫃中一件展品標籤與其他似乎略有不同",c),(n={},n[e.Prop]="展示櫃的[密封罐]中裝有一卷羊皮紙。",n[e.Presage]="[密封罐]外觀與它應有的重量還來得輕。",n[e.Clue]="[密封罐]的蓋子有特殊的旋轉機制，需按照特定順序旋轉才能打開。",n[e.Doubt]="罐內的物品看起來與展示櫃中其它展示物毫無關聯。",n),(i={},i[e.Prop]="[文書匣]內部分類細緻，但其中一個隔層異常緊固。",i[e.Presage]="打開[文書匣]時，一股陳年的紙張氣味撲面而來，中間卻夾帶著一絲[新墨水]的氣味。",i[e.Clue]="文書匣中一份文件因[紅色印記]而十分顯眼，但明顯是偽造的，用來掩蓋真實文件的存在。",i[e.Doubt]="[文書匣]中某些文件顯示出被重新放置的痕跡，似乎有人試圖隱藏或更改某些信息。",i),(a={},a[e.Prop]="相框是普通的裝飾品，背板可以拆卸取出[照片]",a[e.Presage]="觀察相框時，可以發現框架的某部分略有色差。",a[e.Clue]="相框中的[照片]的背面寫上如何開啟[密封罐]的方法。",a[e.Doubt]="照片中的人物與房間內其他照片的人物不同",a)]}]}]},"蠻獸荒野":{RoomType:"Dungeon",name:"蠻獸荒野",description:"一個充滿了怪獸的荒野，充滿了恐怖的氣息。",locations:["蠻獸之穴","幽靈之穴","遺忘之穴"],items:["古老的神器","古老的魔杖","古老的長劍"],monsters:["古老的食人魔","古老的食屍鬼","古老的食人族","古老的食人魔獸"],npcs:["古老的神官","古老的魔法師","古老的法師","古老的神父"],quests:["古老的神器","古老的魔杖","古老的長劍"],skills:["古老的神器","古老的魔杖","古老的長劍"],spells:["古老的神器","古老的魔杖","古老的長劍"],weapons:["古老的神器","古老的魔杖","古老的長劍"],armors:["古老的神器","古老的魔杖","古老的長劍"],potions:["古老的神器","古老的魔杖","古老的長劍"],scrolls:["古老的神器","古老的魔杖","古老的長劍"],keys:["古老的神器","古老的魔杖","古老的長劍"]},"幽深地城":{name:"幽深地城",description:"一個充滿了神秘力量的城市，充滿了神秘的魔法。",locations:["遺忘之城","幽靈之城","古老之城"],items:["古老的神器","古老的魔杖","古老的長劍"],monsters:["古老的食人魔","古老的食屍鬼","古老的食人族","古老的食人魔獸"],npcs:["古老的神官","古老的魔法師","古老的法師","古老的神父"],quests:["古老的神器","古老的魔杖","古老的長劍"],skills:["古老的神器","古老的魔杖","古老的長劍"],spells:["古老的神器","古老的魔杖","古老的長劍"],weapons:["古老的神器","古老的魔杖","古老的長劍"],armors:["古老的神器","古老的魔杖","古老的長劍"],potions:["古老的神器","古老的魔杖","古老的長劍"],scrolls:["古老的神器","古老的魔杖","古老的長劍"],keys:["古老的神器","古老的魔杖","古老的長劍"]},"遺忘聖殿":{name:"遺忘聖殿",description:"一個充滿了神秘力量的城市，充滿了神秘的魔法。",locations:["遺忘之城","幽靈之城","古老之城"],items:["古老的神器","古老的魔杖","古老的長劍"],monsters:["古老的食人魔","古老的食屍鬼","古老的食人族","古老的食人魔獸"],npcs:["古老的神官","古老的魔法師","古老的法師","古老的神父"],quests:["古老的神器","古老的魔杖","古老的長劍"],skills:["古老的神器","古老的魔杖","古老的長劍"],spells:["古老的神器","古老的魔杖","古老的長劍"],weapons:["古老的神器","古老的魔杖","古老的長劍"],armors:["古老的神器","古老的魔杖","古老的長劍"],potions:["古老的神器","古老的魔杖","古老的長劍"],scrolls:["古老的神器","古老的魔杖","古老的長劍"],keys:["古老的神器","古老的魔杖","古老的長劍"]}}}));o._RF.pop()}}}));

System.register("chunks:///_virtual/StoryDescribeStack.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"da3e1QNrIJI+ZVHoaQZA5i2","StoryDescribeStack",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/TeamMember.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CombatCharacter.ts","./CombatMonster.ts","./EventManager.ts","./CombatWeapon.ts","./Ability.ts","./HitPointsBarComponent.ts"],(function(t){var e,n,i,o,a,r,c,s,l,u,m,h,f,p,b,d,g,v,y,C;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.createForOfIteratorHelperLoose,r=t.createClass},function(t){c=t.cclegacy,s=t._decorator,l=t.Node,u=t.Label,m=t.Sprite,h=t.resources,f=t.SpriteFrame,p=t.Component},function(t){b=t.CombatCharacter},function(t){d=t.CombatMonster},function(t){g=t.EventManager},function(t){v=t.CombatWeapon},function(t){y=t.AbilityName},function(t){C=t.HitPointsBarComponent}],execute:function(){var B,M,L,P,E,w,S,k,F,I,z,H,D,T,A;c._RF.push({},"20c84cTBANNhLVZZjAVC3YR","TeamMember",void 0);var W=s.ccclass,q=s.property;t("TeamMember",(B=W("TeamMember"),M=q(C),L=q(l),P=q(u),E=q(l),w=q(l),S=q(m),B((I=e((F=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,i(e,"hitPointsBar",I,o(e)),i(e,"selectButton",z,o(e)),i(e,"nameLabel",H,o(e)),i(e,"weaponLayout",D,o(e)),i(e,"equipmentLayout",T,o(e)),i(e,"photo",A,o(e)),e.combatEntity=void 0,e.movement=void 0,e.teamIndex=void 0,e.initiative=0,e.camp=0,e.combatWeapons=void 0,e}n(e,t);var c=e.prototype;return c.onLoad=function(){},c.joinTeam=function(){this.weaponLayout.active=!1,this.equipmentLayout.active=!1},c.initCharacter=function(t,e){this.combatWeapons=e.map((function(t){var e=t.properties,n=y.Strength;return new v(t.name,n,t.damage,e,t.range)})),this.movement=[t.movement,t.movement];var n=t.calculateProficiencies(),i=t.calculateCompositeAbilities();console.log("計算所有能力的熟練加值:",n),console.log("計算各能力屬性對應的綜合屬性:",i);var o="warrior";this.combatEntity=new b(o,i,16,n),this.nameLabel.string=o,this.combatEntity.equipWeapons(this.combatWeapons),this.setPhotoImage(o),this.hitPointsBar.defaultHp=i.constitution,this.initiative=n.agility+Math.floor(20*Math.random()+1),this.selectButton.off("click"),this.selectButton.on("click",this.onSelectCharacterClicked,this),this.camp=0},c.initMonster=function(t){var e="monster";this.combatEntity=new d(e,t,13,1),this.nameLabel.string=e,this.setPhotoImage(e),this.hitPointsBar.defaultHp=t.constitution;this.initiative=1+Math.floor(20*Math.random()+1),this.selectButton.off("click"),this.selectButton.on("click",this.onSelectMonsterClicked,this),this.camp=1},c.enableSelect=function(){this.selectButton.active=!0},c.disableSelect=function(){this.selectButton.active=!1},c.setPhotoImage=function(t){var e=this.photo.getComponent(m),n="maps/"+t+"/spriteFrame";h.load(n,f,(function(t,n){t?console.error("Failed to load image: "+t):e.spriteFrame=n}))},c.startFight=function(){console.log("開始戰鬥"),this.hitPointsBar.node.active=!1},c.endFight=function(){console.log("結束戰鬥"),this.hitPointsBar.node.active=!0},c.intent=function(t){console.log("執行卡牌轉意圖combatCards:",t);var e=this.combatEntity.combatIntent;e.clearIntents(),t.forEach((function(t){console.log("combatCard.modifiers length:",t.modifiers.length),t.modifiers.forEach((function(n){e.addIntent(n,t.target)}))})),this.combatEntity.intent()},c.attack=function(t){console.log("攻擊目標:",t);for(var e,n=a(t);!(e=n()).done;){var i=e.value;this.combatEntity.attack(i.combatEntity)}return this.combatEntity},c.resultDamage=function(){return this.combatEntity.resultDamage()},c.changeHpBar=function(t){this.hitPointsBar.node.active=!0,this.hitPointsBar.changeHp(t)},c.move=function(t){return this.movement[0]>=t&&(this.movement[0]-=t,!0)},c.roundOver=function(){this.movement[0]=this.movement[1]},c.onSelectCharacterClicked=function(){console.log("選擇角色"),this.disableSelect(),g.instance.emit("SelectCharacter",this)},c.onSelectMonsterClicked=function(){console.log("選擇怪物"),this.disableSelect(),g.instance.emit("SelectMonster",this)},r(e,[{key:"isDead",get:function(){return this.combatEntity.isDead}}]),e}(p)).prototype,"hitPointsBar",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(F.prototype,"selectButton",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(F.prototype,"nameLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(F.prototype,"weaponLayout",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(F.prototype,"equipmentLayout",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(F.prototype,"photo",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=F))||k));c._RF.pop()}}}));

System.register("chunks:///_virtual/TexasGameLogic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ExplorationCard.ts","./GameEvents.ts","./HandEvaluator.ts","./EventManager.ts","./FillBlanks.ts"],(function(e){var t,n,a,i,s,r,o,c,d,u,h,l,f,m,p,v,_,y,C;return{setters:[function(e){t=e.inheritsLoose,n=e.createForOfIteratorHelperLoose,a=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){s=e.cclegacy,r=e._decorator,o=e.Vec3,c=e.Component},function(e){d=e.CardSuit},function(e){u=e.GameLogicEvent,h=e.DeckPileEvent,l=e.CommunityCardEvent,f=e.PlayerHandCardEvent,m=e.GameUIEvent,p=e.WordPuzzleGameLogicEvent},function(e){v=e.CardEvaluations,_=e.HandEvaluator},function(e){y=e.EventManager},function(e){C=e.FillBlanks}],execute:function(){var g;s._RF.push({},"f06dbHBlopIvqT3D6bZcdTU","TexasGameLogic",void 0);var G=r.ccclass;r.property,e("default",G("TexasGameLogic")(g=function(e){function s(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this)._deck=[],t._community=[],t._players=[],t._discarded=[],t._gamePlayers=[],t._uniqueStoredTexts=[],t._intros=void 0,t}t(s,e);var r=s.prototype;return r.onLoad=function(){y.instance.on(u.GameStart,this.eventGameStart.bind(this)),y.instance.on(u.GameEnd,this.eventGameEnd.bind(this)),y.instance.on(u.GameResume,this.eventGameResume.bind(this)),y.instance.on(u.GameRoundStartDiscardCards,this.eventDiscardCards.bind(this)),y.instance.on(u.GameRoundStartDealCards,this.onGameRoundStartDealCards.bind(this)),y.instance.on(u.GameRoundNextPlayerTurn,this.playerNextTurn.bind(this)),y.instance.on(u.GameRoundEndShowCards,this.endShowCards.bind(this))},r.onDestroy=function(){y.instance.off(u.GameStart,this.eventGameStart),y.instance.off(u.GameEnd,this.eventGameEnd),y.instance.off(u.GameResume,this.eventGameResume),y.instance.off(u.GameRoundStartDiscardCards,this.eventDiscardCards),y.instance.off(u.GameRoundStartDealCards,this.onGameRoundStartDealCards),y.instance.off(u.GameRoundNextPlayerTurn,this.playerNextTurn),y.instance.off(u.GameRoundEndShowCards,this.endShowCards)},r.start=function(){this.node.position=o.ZERO,this.node.active=!1},r.initGame=function(e,t){this.node.active=!0,this._gamePlayers=e,this._intros=t,this.initializeDeck(),y.instance.emit(h.ShowCards,this._deck)},r.initializeDeck=function(){var e=this._intros;console.log("intros:",e);var t=[d.Prop,d.Clue,d.Doubt,d.Presage],a=["2","3","4","5","6","7","8","9","10","J","Q","K","A"].slice(13-e.length),i=["stealth","power","wisdom","speed","luck"];this._deck.length=0;for(var s=0,r=t;s<r.length;s++)for(var o,c=r[s],u=n(a);!(o=u()).done;){var h=o.value,l=a.indexOf(h),f=[];if(l<e.length)f=[e[l][c]];else{var m=Math.floor(3*Math.random())+1;f=[];for(var p=0;p<m;p++)f.push(i[Math.floor(Math.random()*i.length)])}this._deck.push({suit:c,rank:h,conditions:f})}},r.shuffleDeck=function(){for(var e=0;e<this._deck.length;e++){var t=Math.floor(Math.random()*(e+1)),n=[this._deck[t],this._deck[e]];this._deck[e]=n[0],this._deck[t]=n[1]}},r.startGame=function(){var e=a(i().mark((function e(){var t=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.shuffleDeck(),console.log("deck:",this._deck),e.next=4,this.dealCards();case 4:return e.next=6,new Promise((function(e){return t.scheduleOnce(e,.5)}));case 6:this.compareCards();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.dealCards=function(){var e=a(i().mark((function e(){var t,n,a=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._deck.length<7)){e.next=2;break}throw new Error("Not enough cards in the deck.");case 2:for(1,this._players.forEach((function(e){e.length=0})),t=0;t<1;t++)this._players[t]=[this._deck.pop(),this._deck.pop()];for(this._community.length=0,n=0;n<5;n++)this._community.push(this._deck.pop());return y.instance.emit(h.DealCommunityCards,this._community),e.next=10,new Promise((function(e){return a.scheduleOnce(e,.5)}));case 10:y.instance.emit(h.DealPlayerCards,this._players);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.compareCards=function(){var e=this,t=this._players[0].concat(this._community),n=this.findBestHand(t),a=this.findCombinationsForSpecificHandType(t,n);y.instance.emit(l.CompareCards,a),y.instance.emit(f.CompareCards,a);var i=a[0].map((function(e){return e.conditions[0]})),s=C.replaceMarkedWithKeywords(i,this._uniqueStoredTexts),r=(s.replacedTexts,s.storedTexts),o=Array.from(new Set(r.flat().filter((function(t){return!e._uniqueStoredTexts.includes(t)}))));y.instance.emit(m.ShowCardConditions2,{conditions:i}),this._uniqueStoredTexts=this._uniqueStoredTexts.concat(o),y.instance.emit(p.ShowAnswer,{answers:this._uniqueStoredTexts})},r.determineWinner=function(){var e=this;this._players.map((function(t,n){return{score:e.evaluateHand(t.concat(e._community)),conditions:t.reduce((function(e,t){return e.concat(t.conditions)}),[]),index:n}})).forEach((function(e){console.log("Player "+(e.index+1)+" score: "+e.score+", conditions: "+e.conditions.join(", "))}))},r.evaluateHand=function(e){var t=0,n={};for(var a in e.forEach((function(e){e.conditions.forEach((function(e){n[e]=(n[e]||0)+1}))})),n)t+=n[a];return t},r.nextRound=function(){var e=a(i().mark((function e(){var t=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y.instance.emit(h.DiscardCards,this._community.concat(this._players[0])),e.next=3,new Promise((function(e){return t.scheduleOnce(e,.5)}));case 3:this._deck.length<7?(y.instance.emit(h.DeckGatherings),this.initializeDeck()):this.startGame();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.updateGameState=function(e){},r.playerMakesMove=function(e,t){},r.selectOrDiscardCard=function(e,t,n){n?console.log("Player "+(e+1)+" keeps card: "+this._players[e][t].rank+" of "+this._players[e][t].suit):(this._players[e][t]=this._deck.pop(),console.log("Player "+(e+1)+" discards and draws a new card: "+this._players[e][t].rank+" of "+this._players[e][t].suit))},r.getCombinations=function(e,t){var n=[],a=[];return function i(s,r){for(var o=r;o<e.length-(t-s)+1;o++)a[s]=e[o],s<t-1?i(s+1,o+1):n.push(a.slice())}(0,0),n},r.findBestHand=function(e){var t=this;if(7!==e.length)throw new Error("Must evaluate exactly 7 cards.");var n=this.getCombinations(e,5),a=v.HighCard;return n.forEach((function(e){var n=_.evaluateHand(e);t.compareHands(n,a)>0&&(a=n)})),console.log("Best hand:",a),a},r.compareHands=function(e,t){var n=Object.values(v);return n.indexOf(e)-n.indexOf(t)},r.findCombinationsForSpecificHandType=function(e,t){if(e.length<5)throw new Error("Not enough cards to evaluate.");var n=this.getCombinations(e,5),a=[];return n.forEach((function(e){_.evaluateHand(e)===t&&a.push(e)})),a},r.handleDiscardCards=function(e){this._discarded=this._discarded.concat(e),console.log("Updated discard pile:",this._discarded),y.instance.emit(m.DeckCardDiscard,this._discarded)},r.eventDiscardCards=function(e){var t=e;this.handleDiscardCards(t)},r.playerNextTurn=function(e){this.nextRound()},r.endShowCards=function(e){console.log("End show cards:",e),this.findBestHand(e)},r.eventGameStart=function(e){console.log("Game start");var t=e.playersInfo,n=e.intros;this.initGame(t,n),y.instance.emit(m.GameStart)},r.eventGameResume=function(e){console.log("Game resume")},r.eventGameEnd=function(e){this._community.length=0,y.instance.emit(l.ShowCards,this._community),this._players.forEach((function(e){e.length=0})),y.instance.emit(f.ShowCards,this._players[0]),this._uniqueStoredTexts.length=0,y.instance.emit(m.GameEnd),y.instance.emit(p.WordPuzzleGameEnd),this.node.active=!1},r.onGameRoundStartDealCards=function(){console.log("Deal cards"),this.startGame()},s}(c))||g);s._RF.pop()}}}));

System.register("chunks:///_virtual/TexasGamePlayer.ts",["cc"],(function(e){var a,c;return{setters:[function(e){a=e.cclegacy,c=e._decorator}],execute:function(){var r;a._RF.push({},"bafc4UZqdFPnLGB1xBEv82A","TexasGamePlayer",void 0);var t=c.ccclass;c.property,e("TexasGamePlayer",t(r=function(){})||r);a._RF.pop()}}}));

System.register("chunks:///_virtual/TexasGameUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameEvents.ts","./EventManager.ts","./FillBlanks.ts","./HandCards.ts","./DiscardCardsPile.ts","./AnswerClipsAnimation.ts","./DescriptionScrollView.ts"],(function(e){var t,n,i,a,r,o,c,s,d,l,u,h,f,C,v,p,w,D,b,B;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){r=e.cclegacy,o=e._decorator,c=e.RichText,s=e.Node,d=e.Vec3,l=e.tween,u=e.Component},function(e){h=e.GameUIEvent,f=e.GameLogicEvent,C=e.WordPuzzleGameLogicEvent},function(e){v=e.EventManager},function(e){p=e.FillBlanks},function(e){w=e.HandCards},function(e){D=e.default},function(e){b=e.AnswerClipsAnimation},function(e){B=e.DescriptionScrollView}],execute:function(){var m,k,S,z,g,G,y,P,x,E,R,V,I,L,N,A,T,U,H,F,_;r._RF.push({},"9c23d2tFDNBnq8i9+EAEypr","TexasGameUI",void 0);var j=o.ccclass,M=o.property;e("default",(m=j("TexasGameUI"),k=M(D),S=M(w),z=M(c),g=M(B),G=M(s),y=M(s),P=M(s),x=M(s),E=M(b),m((I=t((V=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,i(t,"discardCardsPile",I,a(t)),i(t,"answerHandCards",L,a(t)),i(t,"cardIntroLabel",N,a(t)),i(t,"descriptionScrollView",A,a(t)),i(t,"BackPuzzleBtn",T,a(t)),i(t,"NextRoundBtn",U,a(t)),i(t,"DiscardCardBtn",H,a(t)),i(t,"DeckGatheringBtn",F,a(t)),i(t,"answerClipsAnimation",_,a(t)),t}n(t,e);var r=t.prototype;return r.onLoad=function(){v.instance.on(h.GameStart,this.eventGameStart.bind(this)),v.instance.on(h.GameEnd,this.eventGameEnd.bind(this)),v.instance.on(h.DeckCardSelected,this.eventDeckCardSelected.bind(this)),v.instance.on(h.DeckCardUnselected,this.eventDeckCardUnselected.bind(this)),v.instance.on(h.DeckCardDiscard,this.eventDeckCardDiscard.bind(this)),v.instance.on(h.ShowCardConditions,this.eventShowCardConditions.bind(this)),v.instance.on(h.ShowCardConditions2,this.eventShowCardConditions2.bind(this))},r.onDestroy=function(){v.instance.off(h.GameStart,this.eventGameStart),v.instance.off(h.GameEnd,this.eventGameEnd),v.instance.off(h.DeckCardSelected,this.eventDeckCardSelected),v.instance.off(h.DeckCardUnselected,this.eventDeckCardUnselected),v.instance.off(h.DeckCardDiscard,this.eventDeckCardDiscard),v.instance.off(h.ShowCardConditions,this.eventShowCardConditions),v.instance.off(h.ShowCardConditions2,this.eventShowCardConditions2)},r.start=function(){this.node.position=d.ZERO,this.answerHandCards.show(!1)},r.discardCards=function(e){var t=this;e.forEach((function(e){t.discardCardsPile.addCardToDiscardPile(e)}))},r.updateCardIntroLabel=function(e){void 0===e&&(e=""),this.cardIntroLabel.string=e},r.eventGameStart=function(e){this.BackPuzzleBtn.active=!1,this.NextRoundBtn.active=!1,this.DiscardCardBtn.active=!1,this.DeckGatheringBtn.active=!0},r.eventGameEnd=function(e){this.BackPuzzleBtn.active=!1,this.NextRoundBtn.active=!1,this.DiscardCardBtn.active=!1,this.DeckGatheringBtn.active=!1,console.log("關!!"),this.answerHandCards.show(!1),this.descriptionScrollView.clear(),this.descriptionScrollView.close()},r.eventDeckCardSelected=function(e){var t=e.conditions,n=p.replaceKeywordsWidthBlanks(t).replacedTexts;this.updateCardIntroLabel(n.join("\n"))},r.eventDeckCardUnselected=function(e){this.descriptionScrollView.clear()},r.eventDeckCardDiscard=function(e){this.descriptionScrollView.clear()},r.eventShowCardConditions=function(e){var t=e.conditions;this.updateCardIntroLabel(t.join("\n"));var n=e.answers;this.answerClipsAnimation.spreadCards(n),this.BackPuzzleBtn.active=!0,this.NextRoundBtn.active=!0,this.DiscardCardBtn.active=!1,this.DeckGatheringBtn.active=!1},r.eventShowCardConditions2=function(e){console.log("event.conditions:",e.conditions),this.descriptionScrollView.show(),this.descriptionScrollView.setData(e.conditions),this.BackPuzzleBtn.active=!0,this.NextRoundBtn.active=!0,this.DiscardCardBtn.active=!1,this.DeckGatheringBtn.active=!1},r.animateCardDeal=function(e,t,n){void 0===n&&(n=.25),l(t).delay(n).to(.5,{position:e.position}).start()},r.onNextPlayerTurn=function(){this.descriptionScrollView.close(),this.BackPuzzleBtn.active=!1,this.NextRoundBtn.active=!1,this.DiscardCardBtn.active=!1,this.DeckGatheringBtn.active=!1,v.instance.emit(f.GameRoundNextPlayerTurn)},r.onWordPuzzleClicked=function(){v.instance.emit(C.ShowHint,{active:!0})},t}(u)).prototype,"discardCardsPile",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(V.prototype,"answerHandCards",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(V.prototype,"cardIntroLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(V.prototype,"descriptionScrollView",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(V.prototype,"BackPuzzleBtn",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(V.prototype,"NextRoundBtn",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(V.prototype,"DiscardCardBtn",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(V.prototype,"DeckGatheringBtn",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(V.prototype,"answerClipsAnimation",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=V))||R));r._RF.pop()}}}));

System.register("chunks:///_virtual/TipText.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(i){var t,n,o,e,r,a,T,s,h;return{setters:[function(i){t=i.applyDecoratedDescriptor,n=i.inheritsLoose,o=i.initializerDefineProperty,e=i.assertThisInitialized},function(i){r=i.cclegacy,a=i._decorator,T=i.RichText,s=i.Component},function(i){h=i.EventManager}],execute:function(){var c,p,l,f,x;r._RF.push({},"aa1f8eOUGlFa4eC3sr3+wN3","TipText",void 0);var u=a.ccclass,w=a.property,d=i("TipType",function(i){return i.Normal="ShowTipText",i.NormalDelay="ShowTipTextDelay",i.Warning="ShowWarningText",i.Error="ShowErrorText",i.Hide="HideTipText",i}({}));i("TipText",(c=u("TipText"),p=w(T),c((x=t((f=function(i){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=i.call.apply(i,[this].concat(r))||this,o(t,"tipText",x,e(t)),t}n(t,i);var r=t.prototype;return r.onLoad=function(){this.node.active=!1,h.instance.on(d.Normal,this.onShowTipText.bind(this)),h.instance.on(d.NormalDelay,this.onShowDelayTipText.bind(this)),h.instance.on(d.Warning,this.onShowWarrningTipText.bind(this)),h.instance.on(d.Error,this.onShowErrorTipText.bind(this)),h.instance.on(d.Hide,this.onHideTipText.bind(this))},r.onDestroy=function(){h.instance.off(d.Normal,this.onShowTipText),h.instance.off(d.Normal,this.onShowDelayTipText),h.instance.off(d.Normal,this.onShowWarrningTipText),h.instance.off(d.Normal,this.onShowErrorTipText),h.instance.off(d.Normal,this.onHideTipText)},r.showTipText=function(i){this.tipText.string=i,this.node.active=!0},r.onShowTipText=function(i){var t=i;this.showTipText(t)},r.onShowDelayTipText=function(i){var t=i;this.showTipText(t)},r.onShowWarrningTipText=function(i){var t="<color=#ffff00>"+i+"</color>";this.showTipText(t)},r.onShowErrorTipText=function(i){var t="<color=#ff0000>"+i+"</color>";this.showTipText(t)},r.onHideTipText=function(){this.node.active=!1,this.tipText.string=""},t}(s)).prototype,"tipText",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=f))||l));r._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"893acKmpgBJPZ4aCELNvCzy","Weapon",void 0);t("Weapon",(function(t,i,e,s,o,n){this.name=void 0,this.cost=void 0,this.damage=void 0,this.weight=void 0,this.properties=void 0,this.range=void 0,this.name=t,this.cost=i,this.damage=e,this.weight=s,this.properties=o,this.range=n}));i._RF.pop()}}}));

System.register("chunks:///_virtual/WordPuzzleData.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"081e8hHWYtO0oke+7yDlL6q","WordPuzzleData",void 0);t("WordPuzzleData",(function(){}));e._RF.pop()}}}));

System.register("chunks:///_virtual/WordPuzzleGameLogic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./GameEvents.ts","./FillBlanks.ts","./WordPuzzleGameUI.ts"],(function(e){var n,t,o,i,s,a,r,c,u,h,l,d,m;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){s=e.cclegacy,a=e._decorator,r=e.Vec3,c=e.Component},function(e){u=e.EventManager},function(e){h=e.WordPuzzleGameLogicEvent,l=e.GameLogicEvent},function(e){d=e.FillBlanks},function(e){m=e.default}],execute:function(){var f,z,w,G,p;s._RF.push({},"f79c6JenbpK/pT47NpbhBEI","WordPuzzleGameLogic",void 0);var v=a.ccclass,S=a.property;e("default",(f=v("WordPuzzleGameLogic"),z=S(m),f((p=n((G=function(e){function n(){for(var n,t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s))||this,o(n,"gameUI",p,i(n)),n._data=void 0,n}t(n,e);var s=n.prototype;return s.onLoad=function(){this.node.setPosition(r.ZERO),u.instance.on(h.WordPuzzleGameStart,this.startWordPuzzleGame.bind(this)),u.instance.on(h.WordPuzzleGameEnd,this.endWordPuzzleGame.bind(this)),u.instance.on(h.ShowAnswer,this.onShowAnswer.bind(this)),u.instance.on(h.ShowHint,this.onShowHint.bind(this)),u.instance.on(h.TexasGameStart,this.onTexasGameStart.bind(this)),u.instance.on(h.TexasGameResume,this.onTexasGameResume.bind(this))},s.onDestroy=function(){u.instance.off(h.WordPuzzleGameStart,this.startWordPuzzleGame),u.instance.off(h.WordPuzzleGameEnd,this.endWordPuzzleGame),u.instance.off(h.ShowAnswer,this.onShowAnswer),u.instance.off(h.ShowHint,this.onShowHint),u.instance.off(h.TexasGameStart,this.onTexasGameStart),u.instance.off(h.TexasGameResume,this.onTexasGameResume)},s.start=function(){this.node.position=r.ZERO,this.node.active=!1},s.startWordPuzzleGame=function(e){this.node.active=!0,this._data=e,e.cards.sort((function(){return Math.random()-.5}));var n=[e.question];this.onShowQuestion(n)},s.endWordPuzzleGame=function(){this.node.active=!1},s.showQuestion=function(e,n){console.log("Question: "+e+", Answer: "+n),this.gameUI.showQuestion(e,n)},s.showAnswer=function(e){this.gameUI.showAnswer(e)},s.onShowQuestion=function(e){var n=d.replaceKeywordsWidthBlanks(e),t=n.replacedTexts,o=n.storedTexts,i=t[0],s=o[0];this.showQuestion(i,s)},s.onShowAnswer=function(e){var n=e.answers;console.log("Answer: "+n),this.showAnswer(n)},s.onShowHint=function(e){this.node.active=e.active},s.onTexasGameStart=function(e){u.instance.emit(l.GameStart,{plyaerInfo:null,intros:this._data.cards}),this.node.active=!1},s.onTexasGameResume=function(e){u.instance.emit(l.GameResume),this.node.active=!1},n}(c)).prototype,"gameUI",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=G))||w));s._RF.pop()}}}));

System.register("chunks:///_virtual/WordPuzzleGameUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./GameEvents.ts","./HandCards.ts","./FillBlanks.ts","./TipText.ts","./ExplorationCard.ts"],(function(t){var e,n,i,s,r,a,o,u,c,l,d,h,w,f,m,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,o=t.RichText,u=t.Node,c=t.Component},function(t){l=t.EventManager},function(t){d=t.WordPuzzleGameLogicEvent,h=t.GameLogicEvent},function(t){w=t.HandCards},function(t){f=t.FillBlanks},function(t){m=t.TipType},function(t){p=t.ExplorationCard}],execute:function(){var v,C,b,g,B,H,z,R,k,x,y,G,T;r._RF.push({},"1ed87ddISpPK7ueRW4/h8TV","WordPuzzleGameUI",void 0);var F=a.ccclass,L=a.property;t("default",(v=F("WordPuzzleGameUI"),C=L(o),b=L(w),g=L(u),B=L(u),H=L(u),v((k=e((R=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"wordLabel",k,s(e)),i(e,"answerHandCards",x,s(e)),i(e,"restartBtn",y,s(e)),i(e,"startBtn",G,s(e)),i(e,"resumeBtn",T,s(e)),e.question="",e.answers=[],e.isFirstRound=!0,e.index=-1,e}n(e,t);var r=e.prototype;return r.start=function(){},r.showQuestion=function(t,e){this.wordLabel.string=this.question=t,this.answers=e,this.answerHandCards.show(!1),this.answerHandCards.lock(!0),this.answerHandCards.selectMax=e.length,this.answerHandCards.eventSendCallback=this.onSendAnswerClicked.bind(this),this.restartBtn.active=!1,this.startBtn.active=this.isFirstRound,this.resumeBtn.active=!this.isFirstRound,this.isFirstRound=!1},r.showAnswer=function(t){var e=this;this.answerHandCards.show(!0),this.answerHandCards.list(t,(function(t,n){e.wordLabel.string=f.answerQuestion(e.question,n)})),this.answerHandCards.lock(!1)},r.checkQuestionAnswer=function(t){return this.answers.every((function(e,n){return e===t[n]}))},r.onSendAnswerClicked=function(t){this.checkQuestionAnswer(t)?(l.instance.emit(m.Normal,"回答正確！"),this.answerHandCards.lock(!0),this.answerHandCards.show(!1),this.answerHandCards.selectMax=0,this.answerHandCards.eventSendCallback=null,this.answerHandCards.clear(),this.wordLabel.string="",this.restartBtn.active=!0,this.startBtn.active=!1,this.resumeBtn.active=!1):l.instance.emit(m.Error,"回答錯誤！")},r.onTexasGameStartClicked=function(){this.isFirstRound=!1,this.restartBtn.active=!1,this.startBtn.active=this.isFirstRound,this.resumeBtn.active=!this.isFirstRound,l.instance.emit(d.TexasGameStart)},r.onTexasGameResumeClicked=function(){l.instance.emit(d.TexasGameResume)},r.onTexasGameRestartClicked=function(){this.wordLabel.string="",this.restartBtn.active=!1,this.startBtn.active=!1,this.resumeBtn.active=!1,this.isFirstRound=!0,this.node.parent.active=!0,l.instance.emit(m.Hide),l.instance.emit(h.GameEnd)},r.onrReasoningTest=function(){var t=new p;this.index++;var e=t.getReasoning(this.index);l.instance.emit(d.WordPuzzleGameStart,e)},e}(c)).prototype,"wordLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(R.prototype,"answerHandCards",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=e(R.prototype,"restartBtn",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(R.prototype,"startBtn",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(R.prototype,"resumeBtn",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=R))||z));r._RF.pop()}}}));

System.register("chunks:///_virtual/YellowCardHandler.ts",["cc","./SocketBridge.ts","./YellowCardRecord.ts"],(function(t){var e,s,n,o,a;return{setters:[function(t){e=t.cclegacy},function(t){s=t.SocketBridge},function(t){n=t.YellowCardRecord,o=t.GameStatus,a=t.Role}],execute:function(){e._RF.push({},"de129SoJGFNgrAtVVueT/S0","YellowCardHandler",void 0);t("YellowCardHandler",function(){function t(t,e){this._isHonster=!1,this._roomID="",this._honstCardMax={q:2,a:13},this._honstRoundPlayers=[],this._honstRoundIndex=0,this._honstQuestionAnswers={},this._honstWorstList=[],this._masterID="",this._playerID="",this._myNickname="",this._loseNum=5,this._honstGameRecord=null,this.eventUpdateQuestionCards=null,this.eventUpdateAnswerCards=null,this.eventShowQuestion=null,this.eventLockQuestionSelection=null,this.eventLockAnswerSelection=null,this.eventShowQuestionAnswer=null,this.eventShowAllQuestionAnswer=null,this.eventChooseQuestionAnswer=null,this.eventVoted=null,this.eventAnswerCardFold=null,this.eventShowBestAnswer=null,this.eventShowTip=null,this.eventClearPrevRound=null,this.eventRecordLose=null,this.eventGameEnd=null,this._playerID=t,this._myNickname=e}var e=t.prototype;return e.applicate=function(t,e){void 0===e&&(e=""),console.log("===== applicate:",t,e),this._isHonster?(console.log(t,"Applicate 事件不透過連線發給自己:",e),this["notify_"+t](this._roomID,t,e)):s.Instance.applicate(t,e)},e._broadcast=function(t,e,n){if(void 0===e&&(e=""),console.log("===== broadcast:",t,e),this._isHonster){if(n===this._playerID)return console.log(t,"Broadcast 事件不透過連線發給自己:",e);s.Instance.broadcast(t,e,n)}},e.startGame=function(t,e,a){var i=this;if(this._roomID=t,a){this._isHonster=!0,this._honstGameRecord=new n,this._honstRoundPlayers=Object.keys(a);var r=this._honstRoundPlayers.length;this._loseNum=r<6?6:r<8?5:4,e?this._honstGameRecord.readData():this._honstRoundPlayers.forEach((function(t){i._honstGameRecord.add(t,a[t],o.GAMING)}))}s.Instance.addDispatcher(t,this,{update_game_step:this.notify_update_game_step,game_round:this.notify_game_round,draw_question_cards:this.notify_draw_question_cards,draw_answer_cards:this.notify_draw_answer_cards,licensing:this.notify_licensing,fold_answer_card:this.notify_fold_answer_card,question:this.notify_question,answer:this.notify_answer,question_answers_result:this.notify_question_answers_result,choose_best_answer:this.notify_choose_best_answer,vote:this.notify_vote,vote_result:this.notify_vote_result,alert:this.notify_alert,next_round:this.notify_next_round,game_over:this.notify_game_over,reconnect:this.notify_reconnect}),this._isHonster?(console.log("HONSTER 連線!!"),e?this.applicate("reconnect",this._playerID):this.updateQuestionAsync().then((function(){return console.log("已下載問題卡牌庫")})).then((function(){return i.updateAnswerAsync()})).then((function(){return console.log("已下載答案卡牌庫")})).then((function(){return i.applicate("game_round")}))):(console.log("CLIENT 連線!!"),e&&this.applicate("reconnect",this._playerID))},e.endGame=function(t){s.Instance.removeDispatcher(t,this),this._isHonster&&(this._honstGameRecord.clear(),this._honstGameRecord=null,this._honstRoundPlayers.length=0,this._honstRoundIndex=0),this._masterID="",this._playerID="",this._myNickname=""},e.updateQuestionAsync=function(){var t=this,e=Math.round(3*Math.random());return s.Instance.loadAsync("Question",e.toString()).then((function(e){return t._honstGameRecord.questions=e.sort((function(){return Math.random()-.5}))}))},e.updateAnswerAsync=function(){var t=this,e=Math.round(1e3*Math.random()%2);return s.Instance.loadAsync("Answer",e.toString()).then((function(e){return t._honstGameRecord.answers=e.sort((function(){return Math.random()-.5}))}))},e.tryAllAnswered=function(){var t=this,e=this._honstRoundPlayers.every((function(e){return t._masterID===e||t._honstGameRecord.get(e).gameStatus===o.ANSWERED}));return e&&(console.log("全部都答題了，開始投票"),this._honstRoundPlayers.forEach((function(e){t._masterID!==e&&(t._honstGameRecord.get(e).gameStatus=o.VOTING)}))),this._honstGameRecord.writeData(),e},e.notify_update_game_step=function(t,e,s){var n,a;if(this._isHonster){switch(n=s.split(" ")[0],a=this._honstGameRecord.get(n),this._masterID=this._honstGameRecord.masterID,this._honstGameRecord.get(this._masterID).gameStatus){case o.REVIEW:if(this.tryAllAnswered())return void this.applicate("question_answers_result")}if(s=this._masterID+" "+n+" "+JSON.stringify(a),this._broadcast(e,s,n),this._playerID!=n)return}var i=s.split(" ");this._masterID=i[0],n=i[1],a=JSON.parse(i[2]),console.log(e,"GAME STATUS:",a.gameStatus);var r=a,h=r.gameStatus,c=r.nickname;switch(h){case o.ASKING:console.log("我是"+c+", 正在擔任裁判並發問",a),this.eventUpdateQuestionCards(a.questionHandCards),this.eventLockQuestionSelection(!1),this.eventShowTip("選擇題目並送出");break;case o.ASKED:console.log("UI 禁止選擇問題卡"),this.eventLockQuestionSelection(!0),this.eventShowTip("等待答案中...");break;case o.ANSWER:console.log("我是"+c+", 是一般玩家",a),this.eventUpdateAnswerCards(a.answerHandCards),this.eventShowTip("等待裁判出題");break;case o.ANSWERING:console.log("UI 進行選擇答案卡"),this.eventLockAnswerSelection(!1),this.eventShowTip("填空並送出");break;case o.FOLD:var l=a.answerCards.length-1,_=a.answerHandCards;this.eventAnswerCardFold(_,l),this.eventShowTip("請棄掉牌"+l+"張牌");break;case o.ANSWERED:this.eventShowTip("等待其他人…")}},e.notify_game_round=function(t,e,s){var n=this;if(this._isHonster){var i=this._honstRoundPlayers[this._honstRoundIndex];this._honstGameRecord.masterID=i;var r=this._honstGameRecord.get(i);r.role=a.MASTER,r.gameStatus=o.ASKING,console.log("裁判人選:",i,"master:",r),this.applicate("draw_question_cards",i),this._honstRoundPlayers.forEach((function(t){if(i!==t){var e=n._honstGameRecord.get(t);e.role=a.PLAYER,e.gameStatus=o.ANSWER,n.applicate("draw_answer_cards",t)}})),this._honstGameRecord.writeData(),s=""+i,this._broadcast(e,s)}var h=s.split(" ");this._masterID=h[0]},e.notify_draw_question_cards=function(t,e,s){var n=this;if(this._isHonster){var o=s.split(" ")[0],a=this._honstGameRecord.questions,i=this._honstGameRecord.get(o).questionHandCards,r=this._honstCardMax.q-i.length;console.log("抽",r,"張"),console.log("問題卡牌庫張數(應有"+this._honstCardMax.q+"), Honster 目前張數::",a.length);var h=function(){n._honstGameRecord.questions.splice(0,r).forEach((function(t){return i.push(t)})),console.log("獲得手牌:",i),n._honstGameRecord.writeData(),n.applicate("licensing",o)};r>a.length?this.updateQuestionAsync().then((function(){return h()})):h()}},e.notify_draw_answer_cards=function(t,e,s){var n=this;if(this._isHonster){var o=s.split(" ")[0],a=this._honstGameRecord.answers,i=this._honstGameRecord.get(o).answerHandCards,r=this._honstCardMax.a-i.length;console.log("抽",r,"張"),console.log("答案卡牌庫張數(應有"+this._honstCardMax.a+"), Honster 目前張數:",a.length);var h=function(){n._honstGameRecord.answers.splice(0,r).forEach((function(t){return i.push(t)})),console.log("獲得手牌:",i),n._honstGameRecord.writeData(),n.applicate("licensing",o)};r>a.length?this.updateAnswerAsync().then((function(){return h()})):h()}},e.notify_licensing=function(t,e,s){var n,o;if(this._isHonster&&(n=s.split(" ")[0],o=this._honstGameRecord.get(n),s=n+" "+JSON.stringify(o),this._broadcast(e,s,n),this._playerID!=n))return;var a=s.split(" ");if(n=a[0],this._playerID!=n)return console.error("playerID 不符合",n,"應該在honster 階段return");console.log("clientData[1]::::::",a[1]),o=JSON.parse(a[1]),this.applicate("update_game_step",n+" "+Math.random())},e.notify_question=function(t,e,s){var n,i=this;if(this._isHonster){n=s,this._honstGameRecord.askingQuestion=s,console.log("裁判送出的問題卡:",n);var r=this._honstGameRecord.get(this._masterID);if(r.role!==a.MASTER)return this._broadcast("alert","自己不是裁判，不應該問問題",this._masterID),console.log(this._masterID,"不是裁判，不應該問問題");if(r.gameStatus!==o.ASKING)return this._broadcast("alert","自己還不是問問題的狀態",this._masterID),console.log(this._masterID,"還不是問問題的狀態:",r.gameStatus);r.gameStatus=o.ASKED,this._honstGameRecord.get(this._masterID).questionHandCards.length=0,this._honstRoundPlayers.forEach((function(t){if(t!==i._masterID){var e=i._honstGameRecord.get(t);e.gameStatus===o.ANSWER?(e.gameStatus=o.ANSWERING,console.log("玩家"+t+"改為"+o.ANSWERING+"狀態")):console.error("玩家應該是"+o.ANSWER+"狀態，但現在卻是"+e.gameStatus)}})),this._honstGameRecord.writeData(),s=""+n,this._broadcast(e,s)}n=s.split(" ")[0],this.eventShowQuestion(n),console.log("題目顯示後，請 Honster 指引下一步該做的事",this._playerID),this.applicate("update_game_step",this._playerID+" "+Math.random())},e.notify_answer=function(t,e,s){var n,i;if(this._isHonster){var r=s.split(" ");n=r[0],i=JSON.parse(r[1]),console.log("玩家送出的答案卡:",i);var h=this._honstGameRecord.get(n);if(h.role!==a.PLAYER)return this._broadcast("alert","自己不是玩家，不應該回答問題",n),console.log(n,"不是玩家，不應該回答問題");if(h.gameStatus!==o.ANSWERING)return this._broadcast("alert","自己還不是回答問題的狀態",n),console.log(n,"還不是回答問題的狀態:",h.gameStatus);h.gameStatus=i.length>1?o.FOLD:o.ANSWERED,this._honstQuestionAnswers[n]=i,h.answerCards=i,console.log("this._honstQuestionAnswers:",this._honstQuestionAnswers);var c=h.answerHandCards;console.log("手牌整理前:",c),i.forEach((function(t){var e=c.findIndex((function(e){return e===t}));e>-1?c.splice(e,1):console.log("玩家手牌無此張卡片:",t)})),console.log("手牌整理後:",c);var l=this._honstGameRecord.get(this._masterID);if(l.gameStatus===o.ASKED&&(l.gameStatus=o.REVIEW),this._honstGameRecord.writeData(),s=n+" "+JSON.stringify(i),this._broadcast(e,s,n),this._broadcast(e,s,this._masterID),console.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! this._playerID != answerPlayerID",this._playerID!=n,"&& this._masterID != this._playerID",this._masterID!=this._playerID),this._playerID!=n&&this._masterID!=this._playerID)return}var _=s.split(" ");n=_[0],i=JSON.parse(_[1]),this._playerID===this._masterID?(this.eventShowQuestionAnswer(n,i),this.eventShowTip("收到玩家的答案")):this.eventShowTip("已送出你的答案"),this.applicate("update_game_step",this._playerID)},e.notify_fold_answer_card=function(t,e,s){var n,a;if(this._isHonster){var i=s.split(" ");n=i[0],a=JSON.parse(i[1]),console.log("玩家",n,"進行棄牌:",a);var r=this._honstGameRecord.get(n),h=r.answerHandCards;a.forEach((function(t){h.splice(h.findIndex((function(e){return e===t})),1)})),console.log("棄完牌後:",h),r.gameStatus===o.FOLD?r.gameStatus=o.ANSWERED:console.error(r.gameStatus,"狀態不是",o.FOLD,"，但正在進行棄牌"),this._honstGameRecord.writeData(),this.applicate("update_game_step",n),this.applicate("update_game_step",this._masterID)}},e.notify_question_answers_result=function(t,e,s){this._isHonster&&(s=""+JSON.stringify(this._honstQuestionAnswers),this._broadcast(e,s));var n=s.split(" "),o=JSON.parse(n[0]),a=this._playerID===this._masterID;a||(console.log("全員的答題清單:",o),this.eventShowAllQuestionAnswer(o)),this.eventChooseQuestionAnswer(a)},e.notify_vote=function(t,e,s){var n;if(this._isHonster){var a=s.split(" ");n=a[0];var i=a[1];this._honstWorstList.push(i),this._honstGameRecord.get(i).voted++;var r=this._honstGameRecord.get(n);r.gameStatus===o.VOTING?(console.log("玩家"+r.nickname+"已完成投票，並修改標記"),r.gameStatus=o.VOTED):console.error("玩家"+r.nickname+"再次完成投票，標記為"+o.VOTED.toString()),console.log("糟糕清單:",this._honstWorstList);var h=1;if(this._honstWorstList.length===this._honstRoundPlayers.length-1&&(h=0,this.applicate("vote_result")),this._honstGameRecord.writeData(),s=n+" "+h,this._broadcast(e,s,n),this._playerID!=n)return}var c="1"===s.split(" ")[1];this.eventVoted(!c),c&&this.eventShowTip("完成投票，請等候其他人投完票")},e.notify_vote_result=function(t,e,s){var n=this,o=[],a={};if(this._isHonster){var i={};this._honstWorstList.forEach((function(t){i[t]=i[t]||0,console.log(t,":",i[t]),i[t]++}));var r=Math.max.apply(Math,Object.keys(i).map((function(t){return i[t]})));console.log("voteResult:",i,r),Object.keys(i).forEach((function(t){i[t]===r&&(o.push(t),n._honstGameRecord.get(t).lose++)})),console.log("最糟的幾個人:",o),this._honstWorstList.length=0,this._honstRoundPlayers.forEach((function(t){var e=n._honstGameRecord.get(t);a[t]=e.lose})),this._honstGameRecord.writeData(),s=JSON.stringify(o)+" "+JSON.stringify(a),this._broadcast(e,s)}var h=s.split(" ");o=JSON.parse(h[0]),a=JSON.parse(h[1]),o.some((function(t){return n._playerID===t}))?(this.eventShowTip("恭喜，大家覺得你的問答組合是最爛的！"),this.eventRecordLose(a[this._playerID])):this._playerID!=this._masterID&&this.eventShowTip("很遺憾你的答案未獲選為最爛的問答組合…")},e.notify_choose_best_answer=function(t,e,s){var n,a,i=this,r=!0;if(this._isHonster){n=s.split(" ")[0],console.log("bestPlayerID:",n);var h=[];this._honstRoundPlayers.forEach((function(t){if(i._masterID!==t){var e=i._honstGameRecord.get(t);e.gameStatus===o.VOTING&&(h.push(t),r=!1),e.gameStatus===o.VOTED&&(e.gameStatus=o.GAMING)}})),r?(console.log("全員完成投票"),this._honstGameRecord.get(n).win++,a=this._honstQuestionAnswers[n],s="1 "+JSON.stringify(a)):(console.log("提醒未投票玩家進行投票"),s="0 "+JSON.stringify(h)),this._honstGameRecord.writeData(),this._broadcast(e,s)}var c=s.split(" ");(r="1"===c[0])?(a=JSON.parse(c[1]),this.eventShowBestAnswer(a,this._playerID===this._masterID),this.eventShowTip("裁判選出的最佳組合：")):JSON.parse(c[1]).some((function(t){return i._playerID===t}))?this.eventShowTip("快投票哦!!!大家都在等你!!!"):this._masterID===this._playerID&&this.eventShowTip("等待玩家完成最差組合投票")},e.notify_next_round=function(t,e,s){var n=this,o=!1;if(this._isHonster){if(this._honstRoundIndex=(this._honstRoundIndex+1)%this._honstRoundPlayers.length,this._honstQuestionAnswers={},this._honstGameRecord.clearAnswerCards(),this._honstGameRecord.clearWorstVote(),this._honstRoundPlayers.forEach((function(t){var e=n._honstGameRecord.get(t),s=-e.lose;s<=-n._loseNum&&(o=!0),console.log(e.nickname,"score:",s)})),console.log("檢查，還沒結束就下一輪"),o)return void this.applicate("game_over");this._broadcast(e,s)}var a=this._playerID===this._masterID;this.eventClearPrevRound(),a&&this.applicate("game_round")},e.notify_game_over=function(t,e,s){var n=this,o=[];if(this._isHonster){var a=Math.max.apply(Math,this._honstRoundPlayers.map((function(t){return n._honstGameRecord.get(t).win})));this._honstRoundPlayers.forEach((function(t){a===n._honstGameRecord.get(t).win&&o.push(n._honstGameRecord.get(t).nickname)})),s=""+JSON.stringify(o),this._broadcast(e,s)}var i=s.split(" ");o=JSON.parse(i[0]),this.eventShowTip("遊戲結束，最終大贏家是"+o.join("、")),this.eventGameEnd(),this.eventRecordLose(0)},e.notify_alert=function(t,e,s){this.eventShowTip(s)},e.notify_reconnect=function(t,e,s){var n,a,i,r,h,c=this;if(this._isHonster){n=s.split(" ")[0],this._masterID=this._honstGameRecord.masterID,this._honstRoundPlayers.forEach((function(t){var e=c._honstGameRecord.get(t).answerCards;e.length&&(c._honstQuestionAnswers[t]=e);for(var s=0;s<c._honstGameRecord.get(t).voted;s++)c._honstWorstList.push(t)})),console.log("notify_reconnect 答題:",this._honstQuestionAnswers),console.log("notify_reconnect 最糟投票:",this._honstWorstList),i=this._honstQuestionAnswers;var l=this._honstGameRecord.get(n),_=l.gameStatus;switch(_){case o.GAMING:return void this.applicate("licensing",n);case o.ASKING:return void this.applicate("update_game_step",n);case o.ASKED:a=this._honstGameRecord.askingQuestion,s=_+" "+this._masterID+" "+a,this._broadcast(e,s,n);break;case o.REVIEW:this._masterID===n&&(a=this._honstGameRecord.askingQuestion,s=_+" "+this._masterID+" "+a+" "+JSON.stringify(i),this._broadcast(e,s,n));break;case o.ANSWER:return void this.applicate("update_game_step",n);case o.ANSWERING:r=l.answerHandCards,a=this._honstGameRecord.askingQuestion,s=_+" "+this._masterID+" "+JSON.stringify(r)+" "+a,this._broadcast(e,s,n);break;case o.FOLD:r=l.answerHandCards,h=l.answerCards,a=this._honstGameRecord.askingQuestion,s=_+" "+this._masterID+" "+JSON.stringify(r)+" "+JSON.stringify(h)+" "+a,this._broadcast(e,s,n);break;case o.ANSWERED:return void this.applicate("update_game_step",n);case o.VOTING:a=this._honstGameRecord.askingQuestion,s=_+" "+this._masterID+" "+a+" "+JSON.stringify(i),this._broadcast(e,s,n);break;case o.VOTED:s=_+" "+this._masterID+" "+JSON.stringify(i),this._broadcast(e,s,n)}if(console.log("gameStatusgameStatusgameStatusgameStatus:",_),this._playerID!=n)return}var u=s.split(" "),d=parseInt(u[0]);switch(this._masterID=u[1],d){case o.ASKED:console.log("GameStatus.ASKED"),a=u[2],console.log("UI 禁止選擇問題卡"),this.eventLockQuestionSelection(!0),this.eventShowQuestion(a),this.eventShowTip("等待答案中...");break;case o.ANSWERING:console.log("GameStatus.ANSWERING"),r=JSON.parse(u[2]),a=u[3],this.eventUpdateAnswerCards(r),this.eventShowQuestion(a),console.log("UI 進行選擇答案卡"),this.eventLockAnswerSelection(!1),this.eventShowTip("填空並送出");break;case o.FOLD:r=JSON.parse(u[2]),h=JSON.parse(u[3]),a=u[4],this.eventShowQuestion(a);var m=h.length-1;this.eventAnswerCardFold(r,m),this.eventShowTip("請棄掉牌"+m+"張牌");break;case o.ANSWERED:this.eventShowTip("等待其他人…");break;case o.REVIEW:console.log("GameStatus.REVIEW"),a=u[2],this.eventShowQuestion(a),i=JSON.parse(u[3]),this.eventShowAllQuestionAnswer(i);break;case o.VOTING:console.log("GameStatus.VOTING"),a=u[2],this.eventShowQuestion(a),i=JSON.parse(u[3]),this.eventShowAllQuestionAnswer(i);var p=this._playerID===this._masterID;this.eventChooseQuestionAnswer(p);break;case o.VOTED:console.log("GameStatus.VOTED"),i=JSON.parse(u[2]),this.eventShowAllQuestionAnswer(i);var g=this._playerID===this._masterID;this.eventChooseQuestionAnswer(g);break;default:console.log("未設定 reconnet 該做的事")}},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/YellowCardPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./YellowCardHandler.ts","./HandCards.ts","./FoldCards.ts"],(function(e){var n,t,i,s,o,a,r,l,d,h,u,c,w,C,f,_;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,s=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,r=e.Node,l=e.Button,d=e.Label,h=e.Vec3,u=e.RichText,c=e.instantiate,w=e.Component},function(e){C=e.YellowCardHandler},function(e){f=e.HandCards},function(e){_=e.FoldCards}],execute:function(){var g,p,v,b,m,H,Q,A,S,y,q,L,B,k,F,x,V,R,I,M,D,z,E;o._RF.push({},"7a536XvrlROxY0P5Wdjctoi","YellowCardPanel",void 0);var P=a.ccclass,T=a.property;e("YellowCardPanel",(g=P("YellowCardPanel"),p=T(f),v=T(f),b=T(r),m=T(_),H=T(r),Q=T(r),A=T(l),S=T(d),y=T(d),q=T(r),g((k=n((B=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,i(n,"questionHandCards",k,s(n)),i(n,"answerHandCards",F,s(n)),i(n,"questionBoard",x,s(n)),i(n,"foldCards",V,s(n)),i(n,"answerQuestionListView",R,s(n)),i(n,"answerQuestionViewContent",I,s(n)),i(n,"nextRoundButton",M,s(n)),i(n,"infoLabel",D,s(n)),i(n,"tipLabel",z,s(n)),i(n,"yellowCardLayout",E,s(n)),n.eventMainSceneGameEnd=null,n._playerID="",n._roomID="",n._gameHandler=null,n._questionCardButtons=[],n._answerCardButtons=[],n._answerMax=0,n._selectedQuestion="",n._selectedAnswers=[],n._questionAnswers={},n._isFolding=!1,n._selectFoldMax=0,n._selectFoldNum=0,n._selectedFloadCards=[],n}t(n,e);var o=n.prototype;return o.start=function(){this.node.setPosition(h.ZERO),this.foldCards.node.setPosition(h.ZERO),this.close()},o.close=function(){this.node.active=!1,this.questionHandCards.show(!1),this.answerHandCards.show(!1),this.questionBoard.active=!1,this.answerQuestionListView.active=!1,this.nextRoundButton.node.active=!1,this._roomID&&(this._gameHandler.endGame(this._roomID),this._gameHandler=null),this.tipLabel.string="",this._roomID="",this._playerID="",this._questionAnswers={},this._questionCardButtons.length=0,this._answerCardButtons.length=0,this._selectedAnswers.length=0,this._selectedQuestion="",this._answerMax=0,this._isFolding=!1,this._selectFoldMax=0,this._selectFoldNum=0,this._selectedFloadCards.length=0},o.init=function(e,n,t,i,s){this.node.active=!0,this._gameHandler=new C(n,t),this._gameHandler.eventUpdateQuestionCards=this.onUpdateQuestionCards.bind(this),this._gameHandler.eventLockQuestionSelection=this.onLockQuestionSelection.bind(this),this._gameHandler.eventUpdateAnswerCards=this.onUpdateAnswerCards.bind(this),this._gameHandler.eventLockAnswerSelection=this.onLockAnswerSelection.bind(this),this._gameHandler.eventShowQuestion=this.onShowQuestion.bind(this),this._gameHandler.eventShowAllQuestionAnswer=this.onShowAllQuestionAnswer.bind(this),this._gameHandler.eventShowQuestionAnswer=this.onShowQuestionAnswer.bind(this),this._gameHandler.eventChooseQuestionAnswer=this.onChooseQuestionAnswer.bind(this),this._gameHandler.eventAnswerCardFold=this.onAnswerCardFold.bind(this),this._gameHandler.eventShowBestAnswer=this.onShowBestAnswer.bind(this),this._gameHandler.eventVoted=this.onVoted.bind(this),this._gameHandler.eventShowTip=this.onShowTip.bind(this),this._gameHandler.eventClearPrevRound=this.onClearPrevRound.bind(this),this._gameHandler.eventRecordLose=this.onRecordLose.bind(this),this._gameHandler.eventGameEnd=this.onGameEnd.bind(this),this._gameHandler.startGame(e,i,s),this._roomID=e,this.infoLabel.string=e+"\n"+t+"\n("+n+")",this._playerID=n,this.questionHandCards.eventSendCallback=this.onSendQuestionClicked.bind(this),this.answerHandCards.eventSendCallback=this.onSendAnswerClicked.bind(this)},o.fillBlanks=function(e,n){var t=n.slice();return console.log("fill question:",e,n),e.replace(/_/g,(function(e){return"<color=#FFFF00><u>"+(t.shift()||"_")+"</u></c>"}))},o.onUpdateQuestionCards=function(e){var n=this;this.questionHandCards.show(!0),this.questionHandCards.selectMax=1,this.questionHandCards.list(e,(function(e,t){n._selectedQuestion=e}))},o.onLockQuestionSelection=function(e){this.questionHandCards.lock(e),this.answerHandCards.show(!1)},o.onSendQuestionClicked=function(e){this.questionHandCards.show(!1),this.questionHandCards.lock(!0),this._gameHandler.applicate("question",e[0])},o.onUpdateAnswerCards=function(e){var n=this;this.answerHandCards.show(!0),this.answerHandCards.list(e,(function(e,t){n.questionBoard.active=!0;var i=n.fillBlanks(n._selectedQuestion,t);n.questionBoard.getComponentInChildren(u).string=i}))},o.onLockAnswerSelection=function(e){this.answerHandCards.lock(e),this.questionHandCards.show(!1)},o.onSendAnswerClicked=function(e){this.answerHandCards.show(!1),this._gameHandler.applicate("answer",this._playerID+" "+JSON.stringify(e))},o.onShowQuestion=function(e){console.log("UI 顯示問題:",e);var n=e.split("_");this._answerMax=Math.max(1,n.length-1),this.answerHandCards.selectMax=this._answerMax,this._selectedQuestion=e,this.questionBoard.active=!0,this.questionBoard.getComponentInChildren(u).string=e},o.onShowQuestionAnswer=function(e,n){console.log("玩家"+e+"送入答案:",n,typeof n),this._questionAnswers[e]=n,this.onShowAllQuestionAnswer(this._questionAnswers)},o.onShowAllQuestionAnswer=function(e){var n=this;this._questionAnswers=e,console.log("顯示所有的答案卡片:",this._questionAnswers),this.answerQuestionListView.active=!0;var t=this.answerQuestionViewContent.children;t.forEach((function(e){return e.active=!1})),Object.keys(e).forEach((function(i,s){var o=t[s];o||((o=c(t[0])).parent=n.answerQuestionViewContent),o.active=!0;var a=n.fillBlanks(n._selectedQuestion,e[i]);console.log("content:",a),o.getComponentInChildren(u).string=a,console.log("\t",o.getComponentInChildren(u).string),o.getComponent(l).node.off("click")})),console.log("顯示答案送出內容，移除 answerQuestionViewContent 的按鈕事件")},o.onChooseQuestionAnswer=function(e){var n=this,t=this.answerQuestionViewContent.children,i=e?this.sendBestQuestionAnswer.bind(this):this.sendWorstQuestionAnswer.bind(this);Object.keys(this._questionAnswers).forEach((function(e,s){t[s].getComponent(l).node.on("click",(function(){return i(e)}),n)})),console.log("設定選擇問答組合，設定觸發 answerQuestionViewContent 的按鈕事件"),this.answerQuestionListView.active=!this._isFolding,this._isFolding?e?this.onShowTip("選擇最符合你提出條件的組合"):(this.onShowTip("選擇不符裁判要求的組合(請先棄完牌)"),this.foldCards.show(!0)):this.onShowTip(e?"選擇最符合你提出條件的組合":"選擇不符裁判要求的組合")},o.onVoted=function(e){this.answerQuestionViewContent.children.forEach((function(e){return e.off("click")})),console.log("已投票，移除 answerQuestionViewContent 的按鈕事件"),this.answerQuestionListView.active=!1},o.onShowBestAnswer=function(e,n){this.questionBoard.active=!0;var t=this.fillBlanks(this._selectedQuestion,e);this.questionBoard.getComponentInChildren(u).string=t,this.answerQuestionListView.active=!1,this._questionAnswers={},this._answerMax=0,this._selectedQuestion="",this.nextRoundButton.node.active=n},o.sendBestQuestionAnswer=function(e){console.log("最佳組合的玩家:",e),this._gameHandler.applicate("choose_best_answer",e+" "+Math.round(1e6*Math.random()))},o.sendWorstQuestionAnswer=function(e){console.log("最差組合的玩家:",e),this._gameHandler.applicate("vote",this._playerID+" "+e)},o.onAnswerCardFold=function(e,n){this._isFolding=!0,console.log("進入棄牌流程"),this.foldCards.show(!0),this.foldCards.selectMax=n,this.foldCards.list(e),this.foldCards.eventSendCallback=this.onSendFoldAnswerClicked.bind(this)},o.onSendFoldAnswerClicked=function(e){this.answerHandCards.show(!1),this.foldCards.show(!1),this._isFolding=!1,this._gameHandler.applicate("fold_answer_card",this._playerID+" "+JSON.stringify(e))},o.onShowTip=function(e){this.tipLabel.string=e},o.onRecordLose=function(e){var n=this.yellowCardLayout.children;n.forEach((function(e){return e.active=!1}));for(var t=0;t<e;t++){var i=n[t];i||((i=c(n[0])).parent=this.yellowCardLayout),i.active=!0}},o.onClearPrevRound=function(){this.questionHandCards.show(!1),this.answerHandCards.show(!1),this.questionBoard.active=!1,this.answerQuestionListView.active=!1,this.nextRoundButton.node.active=!1,this._questionAnswers={},this._answerMax=0,this._selectedQuestion=""},o.onGameEnd=function(){var e;null==(e=this.eventMainSceneGameEnd)||e.call(this),this.nextRoundButton.node.active=!1,this.infoLabel.string=""},o.onNextRoundClicked=function(){this._gameHandler.applicate("next_round")},n}(w)).prototype,"questionHandCards",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=n(B.prototype,"answerHandCards",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=n(B.prototype,"questionBoard",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=n(B.prototype,"foldCards",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=n(B.prototype,"answerQuestionListView",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(B.prototype,"answerQuestionViewContent",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=n(B.prototype,"nextRoundButton",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(B.prototype,"infoLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(B.prototype,"tipLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(B.prototype,"yellowCardLayout",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=B))||L));o._RF.pop()}}}));

System.register("chunks:///_virtual/YellowCardRecord.ts",["cc"],(function(s){var e;return{setters:[function(s){e=s.cclegacy}],execute:function(){e._RF.push({},"962bfAm9SxBtKUI3CbrHESq","YellowCardRecord",void 0);var r=s("Role",function(s){return s[s.PLAYER=0]="PLAYER",s[s.MASTER=1]="MASTER",s}({})),t="YC_GAME_RECORD_INFO";s("GameStatus",function(s){return s[s.GAMING=0]="GAMING",s[s.ASKING=1]="ASKING",s[s.ASKED=2]="ASKED",s[s.REVIEW=3]="REVIEW",s[s.ANSWER=4]="ANSWER",s[s.ANSWERING=5]="ANSWERING",s[s.FOLD=6]="FOLD",s[s.ANSWERED=7]="ANSWERED",s[s.VOTING=8]="VOTING",s[s.VOTED=9]="VOTED",s[s.PICK=10]="PICK",s}({})),s("YellowCardRecord",function(){function s(){this.masterID="",this._players={},this._roundPlayers=[],this.questions=[],this.answers=[],this.askingQuestion=""}var e=s.prototype;return e.add=function(s,e,t){this._players[s]={nickname:e,gameStatus:t,win:0,lose:0,answerCards:[],answerHandCards:[],questionHandCards:[],voted:0,role:r.PLAYER},this._roundPlayers=Object.keys(this._players)},e.del=function(s){delete this._players[s]},e.get=function(s){return this._players[s]},e.clear=function(){this._players={},this._roundPlayers=[],this.questions=[],this.answers=[],this.askingQuestion="",localStorage.removeItem(t)},e.clearAnswerCards=function(){var s=this;this._roundPlayers.forEach((function(e){return s._players[e].answerCards.length=0}))},e.clearWorstVote=function(){var s=this;this._roundPlayers.forEach((function(e){return s._players[e].voted=0}))},e.readData=function(){var s=JSON.parse(localStorage.getItem(t));console.log("YellowCardRecord read localData:",s),this.masterID=s.masterID,this._players=s.players,this._roundPlayers=s.roundPlayers,this.questions=s.questions,this.answers=s.answers,this.askingQuestion=s.askingQuestion},e.writeData=function(){var s={masterID:this.masterID,players:this._players,roundPlayers:this._roundPlayers,questions:this.questions,answers:this.answers,askingQuestion:this.askingQuestion};localStorage.setItem(t,JSON.stringify(s))},e.dropAnswerHandCards=function(s,e){this.dropHandCard(this._players[s].answerHandCards,e)},e.dropHandCard=function(s,e){return e.every((function(e){return s.find((function(s,r,t){if(s===e)return t.splice(r,1),!0}))}))},s}());e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});